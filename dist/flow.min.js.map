{"version":3,"sources":["webpack:///flow.min.js","webpack:///webpack/bootstrap 7afc5a5d7ca4a9d9046f","webpack:///./src/config.js","webpack:///./src/channels/channel-utils.js","webpack:///./src/channels/middleware/utils/index.js","webpack:///./src/utils/parse-utils.js","webpack:///./src/channels/channel-router.js","webpack:///./src/utils/general.js","webpack:///./src/channels/middleware/epicenter-middleware/run-router/index.js","webpack:///./src/dom/nodes/default-input-node.js","webpack:///./src/dom/nodes/default-node.js","webpack:///./src/utils/base-view.js","webpack:///./src/channels/channel-manager-enhancements/interpolatable/interpolatable-utils.js","webpack:///./src/flow.js","webpack:///./src/dom/dom-manager.js","webpack:///./src/utils/dom.js","webpack:///./src/converters/converter-manager.js","webpack:///./src/converters/number-converter.js","webpack:///./src/converters/string-converter.js","webpack:///./src/converters/array-converter.js","webpack:///./src/converters/underscore-utils-converter.js","webpack:///./src/converters/numberformat-converter.js","webpack:///./src/dom/nodes/node-manager.js","webpack:///./src/dom/nodes/input-checkbox-node.js","webpack:///./src/dom/attributes/attribute-manager.js","webpack:///./src/dom/attributes/no-op-attr.js","webpack:///./src/dom/attributes/events/default-event-attr.js","webpack:///./src/dom/attributes/foreach/default-foreach-attr.js","webpack:///./src/dom/attributes/binds/checkbox-radio-bind-attr.js","webpack:///./src/dom/attributes/binds/input-bind-attr.js","webpack:///./src/dom/attributes/class-attr.js","webpack:///./src/dom/attributes/repeat-attr.js","webpack:///./src/dom/attributes/positive-boolean-attr.js","webpack:///./src/dom/attributes/negative-boolean-attr.js","webpack:///./src/dom/attributes/binds/default-bind-attr.js","webpack:///./src/dom/attributes/default-attr.js","webpack:///./src/dom/plugins/auto-update-bindings.js","webpack:///./src/channels/configured-channel-manager.js","webpack:///./src/channels/middleware/json-parse-middleware/index.js","webpack:///./src/channels/middleware/epicenter-middleware/index.js","webpack:///./src/channels/middleware/epicenter-middleware/run-manager-router.js","webpack:///./src/channels/middleware/epicenter-middleware/run-router/run-meta-channel.js","webpack:///./src/channels/middleware/epicenter-middleware/run-router/run-variables-channel.js","webpack:///./src/channels/middleware/epicenter-middleware/run-router/run-operations-channel.js","webpack:///./src/channels/middleware/utils/silencable.js","webpack:///./src/channels/middleware/utils/exclude-read-only.js","webpack:///./src/channels/middleware/epicenter-middleware/scenario-manager-router.js","webpack:///./src/channels/middleware/epicenter-middleware/custom-run-router.js","webpack:///./src/channels/middleware/epicenter-middleware/run-router-factory.js","webpack:///./src/channels/middleware/epicenter-middleware/runs-router/index.js","webpack:///./src/channels/channel-manager.js","webpack:///./src/channels/channel-manager-enhancements/interpolatable/index.js","webpack:///./src/channels/channel-manager-enhancements/interpolatable/subscribe-interpolator.js","webpack:///./src/channels/channel-manager-enhancements/interpolatable/publish-interpolator.js","webpack:///./src/channels/channel-manager-enhancements/with-middleware/index.js","webpack:///./src/channels/channel-manager-enhancements/with-middleware/middleware-manager.js"],"names":["Flow","modules","__webpack_require__","moduleId","installedModules","exports","module","i","l","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","prefix","defaultAttr","binderAttr","events","trigger","channelDataReceived","convert","operate","attrs","bindingsList","subscriptionId","classesAdded","repeat","template","templateId","foreachTemplate","keyAs","valueAs","bindTemplate","__webpack_exports__","findBestHandler","topic","handlers","length","thishandler","match","$","extend","matched","objectToArray","obj","keys","map","t","value","arrayToObject","arr","reduce","accum","normalizeParamOptions","publishValue","options","isPlainObject","params","isArray","groupByHandlers","topics","h","index","key","topicMapping","concat","bestHandler","data","push","_","values","groupSequentiallyByHandlers","dataPt","lastHandler","stripSuffixDelimiter","text","indexOf","CHANNEL_DELIMITER","replace","defaultPrefix","regex","toMatch","RegExp","mapWithPrefix","dataArray","datapt","withPrefix","callback","prefixList","forEach","mapped","unprefix","list","item","__WEBPACK_IMPORTED_MODULE_0__silencable__","__WEBPACK_IMPORTED_MODULE_1__exclude_read_only__","toImplicitType","objRegex","arrRegex","converted","trim","charAt","substring","isNumeric","test","bracketReplaced","parsed","split","val","JSON","parse","e","console","error","toOperationFormat","fnName","notifySubscribeHandlers","__WEBPACK_IMPORTED_MODULE_0_channels_channel_utils__","handler","subscribeHandler","mergedOptions","unprefixed","__WEBPACK_IMPORTED_MODULE_1_channels_middleware_utils__","notifyUnsubscribeHandlers","recentlyUnsubscribedTopics","remainingTopics","unsubsKey","unsubsGrouped","remainingGrouped","unsubscribeHandler","unprefixedUnsubs","matchingRemainingHandler","find","remainingHandler","matchingTopicsRemaining","unprefixedRemaining","passthroughPublishInterceptors","publishData","grouped","$initialProm","Deferred","resolve","promise","then","dataSoFar","publishableData","readOnly","result","publishHandler","published","silent","isDefault","Router","this","random","min","max","parseInt","uniqueId","number","debounceAndMerge","fn","debounceInterval","argumentsReducers","timer","argsToPass","newVal","$def","newArgs","toArray","arguments","arg","reducer","clearTimeout","setTimeout","res","apply","RunRouter","config","notifier","defaults","serviceOptions","channelOptions","variables","autoFetch","debounce","operations","meta","opts","window","F","service","Run","rs","metaChannel","__WEBPACK_IMPORTED_MODULE_0__run_meta_channel__","__WEBPACK_IMPORTED_MODULE_4_channels_middleware_utils__","operationsChannel","__WEBPACK_IMPORTED_MODULE_2__run_operations_channel__","variableschannel","__WEBPACK_IMPORTED_MODULE_1__run_variables_channel__","router","__WEBPACK_IMPORTED_MODULE_3_channels_channel_router__","oldhandler","r","fetch","BaseView","propertyHandlers","uiChangeEvent","getUIValue","$el","removeEvents","off","initialize","me","propName","on","selector","protoProps","staticProps","child","has","constructor","Surrogate","__super__","View","el","extractDependencies","interpolationRegex","interpolateWithValues","dependency","_ref","domManager","ChannelManager","default","dom","utils","model","channel","run","root","autoBind","prom","subscribe","unbindAll","bindAll","version","parseUtils","domUtils","converterManager","nodeManager","attrManager","autoUpdatePlugin","expr","pseudos","attributes","nodeName","webcomponent","getMatchingElements","$root","matchedElements","is","add","getElementOrError","element","context","Error","publicAPI","nodes","converters","private","unbindElement","without","Handler","getHandler","handle","each","nodeMap","attr","unbind","subsid","subs","unsubscribe","removeData","bindElement","includes","subsChannel","varsToBind","$bindEl","newsubs","attrBindings","nonBatchableVariables","channelConfig","getChannelConfig","attrVal","channelPrefix","getChannel","isBindableAttr","init","withConv","v","shift","binding","commaRegex","batch","elementsToBind","elementsToUnbind","attachChannelListener","evt","target","bindings","toconvert","variableName","interestedTopics","matching","pick","attachUIVariablesListener","parsedData","attrConverters","getConvertersList","bind","publish","attachUIOperationsListener","filtered","operation","getConverter","args","con","attachConversionListner","prop","toLowerCase","convertedValue","matchExpr","matchValue","isString","isFunction","isRegExp","undefined","$parentEl","closest","attrib","specified","normalize","alias","converter","acceptList","ret","matchConverter","isRegex","register","normalized","currentConverter","splice","currentValue","convertArray","converterName","convertObject","mapValues","reverse","defaultconverters","parseFloat","upperCase","toUpperCase","lowerCase","titleCase","txt","substr","oldfn","newfn","supported","isNegative","floatMatcher","results","exec","suffix","roundTo","digits","Math","round","pow","getDigits","ceil","log","LN10","TXT","numberTXT","toString","decimalSet","iTXT","addDecimals","decimals","minDecimals","hasCommas","hasDecimals","iDec","iChar","toADD","getSuffix","formatTXT","fixesTXT","isCurrency","string","format","isNumber","isNaN","formats","abs","sign","leftOfDecimal","lastIndexOf","isShortFormat","leadingText","rightOfPrefix","shortFormatTest","shortFormatTestResult","valScale","floor","Number","SUFFIX","valWithoutLeading","scales","limitDigits","subFormats","preffix","node","unshift","currentHandler","defaultHandlers","offVal","onVal","handlersList","attributeMatcher","nodeMatcher","matchAttr","attrMatch","matchNode","nodeFilter","filter","attrFilter","noop","$node","listOfOperations","refToMarkup","refKey","html","inMatch","itMatch","loopTemplate","$me","empty","cloop","defaultKey","keyAttr","valueAttr","keyRegex","valueRegex","closestKnownDataEl","knownData","closestParentWithMissing","missing","replacement","missingReferences","templateTagsUsed","tag","size","stringify","templateFn","dataval","datakey","templateData","isTemplated","templatedLoop","newNode","append","settableValue","isChecked","addedClasses","removeClass","addClass","gutils","id","nextUntil","remove","replaceWith","outerHTML","last","hasData","removeAttr","children","insertAfter","templated","valueToTemplate","oldHTML","cleanedHTML","MutationObserver","observer","mutations","mutation","added","addedNodes","removed","removedNodes","attributeName","mutconfig","attributeFilter","childList","subtree","characterData","observe","InterpolatableChannelManagerWithMiddleware","middlewares","__WEBPACK_IMPORTED_MODULE_0__middleware_json_parse_middleware__","__WEBPACK_IMPORTED_MODULE_1__middleware_epicenter_middleware__","__WEBPACK_IMPORTED_MODULE_2__channel_manager__","__WEBPACK_IMPORTED_MODULE_3__channel_manager_enhancements__","JSONMiddleware","sorted","acc","__WEBPACK_IMPORTED_MODULE_0_utils_parse_utils__","rest","claimed","getOptions","__WEBPACK_IMPORTED_MODULE_0__run_manager_router__","__WEBPACK_IMPORTED_MODULE_1__scenario_manager_router__","__WEBPACK_IMPORTED_MODULE_2__custom_run_router__","__WEBPACK_IMPORTED_MODULE_3__runs_router__","__WEBPACK_IMPORTED_MODULE_5_channels_channel_router__","sampleRunidLength","runidRegex","channelManagerContext","customRunChannelOpts","customRunChannel","runsChannel","exposable","runManagerOpts","runManager","scenarioManager","rm","expose","scenarioManagerOpts","sm","__WEBPACK_IMPORTED_MODULE_0__run_router__","__WEBPACK_IMPORTED_MODULE_2_channels_channel_router__","manager","RunManager","$creationPromise","getRun","currentChannelOpts","current","currentRunChannel","RunMetaChannel","$runServicePromise","mergeAndSend","runMeta","requestedTopics","toSend","runService","cachedValues","intersection","loadPromise","load","toSave","save","RunVariablesChannel","fetchFn","debouncedFetchers","__WEBPACK_IMPORTED_MODULE_0_utils_general__","query","__WEBPACK_IMPORTED_MODULE_1_channels_channel_utils__","newval","uniq","knownTopics","unsubscribedTopics","isAutoFetchEnabled","response","RunOperationsChannel","serial","silencable","silentOptions","except","excludeReadOnly","publishable","readOnlyOptions","remaining","ScenarioManager","baselinePromise","baseline","baselineOptions","currentRunPromise","runOptions","baselineChannel","__WEBPACK_IMPORTED_MODULE_0__run_router_factory__","runid","knownRunIDServiceChannels","runChannel","RunsRouter","extractFiltersFromTopic","topicString","_filter$split","_filter$split2","_slicedToArray","filters","include","runs","topicParamMap","debouncedFetch","subsMap","subscriptions","cache","sliceIterator","_arr","_n","_d","_e","_s","_i","Symbol","iterator","next","done","err","Array","TypeError","_window","_classCallCheck","instance","Constructor","makeSubs","callbackIfChanged","subscription","isEqual","sentDataBySubsId","checkAndNotifyBatch","cached","cacheBySubsId","merged","matchingTopics","checkAndNotify","getTopicsFromSubsList","subcriptionList","__WEBPACK_IMPORTED_MODULE_0__channel_utils__","_createClass","defineProperties","props","descriptor","writable","notify","cb","token","olderLength","__WEBPACK_IMPORTED_MODULE_0__interpolatable__","__WEBPACK_IMPORTED_MODULE_1__with_middleware__","_possibleConstructorReturn","self","ReferenceError","_inherits","subClass","superClass","create","setPrototypeOf","__proto__","interpolatable","subsidMap","_ChannelManager","InterpolatedChannelManager","_this","getPrototypeOf","__WEBPACK_IMPORTED_MODULE_0__subscribe_interpolator__","dependencySubsId","newDependentId","existing","__WEBPACK_IMPORTED_MODULE_1__publish_interpolator__","_get","receiver","Function","desc","getOwnPropertyDescriptor","parent","getDependencies","deps","inner","__WEBPACK_IMPORTED_MODULE_0__interpolatable_utils__","interpolateWithDependencies","mergeInterpolatedTopicsWithData","originalTopics","interpolatedTopics","interpolatedTopic","original","subscribeInterpolator","subscribeFn","onDependencyChange","dependencies","dependenciesMeta","outerSubsId","actualData","actualMeta","toSendback","publishInputs","input","valuesToInterpolate","ip","publishInterpolator","publishFunction","normalizedPublishInputs","resolvedDependencies","interpolated","newPublishProm","withMiddleware","ChannelWithMiddleware","__WEBPACK_IMPORTED_MODULE_0__middleware_manager__","_this2","__WEBPACK_IMPORTED_MODULE_1__channel_utils__","lastAvailableData","middleware","publishResponse","subscribeMiddlewares","newTopics","currentTopics","difference","currentlySubscribed","getSubscribedTopics","MiddlewareManager","optsToPassOn","omit","type"],"mappings":"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","file":"flow.min.js","sourcesContent":["/*!\n * \n * ++++++++   ++++++++   ++++++++         Flow.js\n * ++++++++   ,+++++++~   ++++++++        v0.11.0\n *  ++++++++   ++++++++   ++++++++\n *  ~+++++++~   ++++++++   ++++++++       Github: https://github.com/forio/flow.js\n *   ++++++++   ++++++++   ++++++++:\n *    :++++++++   ++++++++   ++++++++\n *      ++++++++   =+++++++   ,+++++++=\n *       ++++++++   ++++++++   ++++++++\n *       =+++++++    +++++++=   ++++++++\n *        ++++++++   ++++++++   ++++++++\n *        ,+++++++:   +++++++~   ++++++++\n *         +++++++=   +++++++=   ++++++++\n *        ++++++++   ++++++++   ++++++++\n *        ++++++++   ++++++++   ++++++++\n *        ++++++++   =+++++++   :+++++++,\n *         ++++++++   ++++++++   ++++++++\n *         ++++++++   ~+++++++    +++++++=\n *          ++++++++   ++++++++   ++++++++\n * \n */\nvar Flow =\n/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 11);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nmodule.exports = {\n    prefix: 'f',\n    defaultAttr: 'bind',\n\n    binderAttr: 'f-bind',\n\n    events: {\n        //UI Change to publish to the channel.\n        trigger: 'update.f.ui',\n\n        //Payload is of form {topic: value}. When triggered on a element dom-manager will trigger 'f.convert' on every attribute subscribed to that topic\n        channelDataReceived: 'update.f.model',\n\n        //Trigger with payload '{attrToUpdate: value}', for e.g. { bind: 34 }. This will run this through all the converts and pass it to attr handler. Useful to by-pass getting this from the model directly.\n        convert: 'f.convert',\n\n        //When triggered posts the payload to the operations API. Assumes payloaded is formmatted in a way Run Channel can understand\n        operate: 'f.ui.operate'\n    },\n\n    attrs: {\n        //Array with shape [{ attr: attribute, topics:[list of topics attribute is listening to]}]\n        bindingsList: 'f-attr-bindings',\n\n        //Subscription id returned by the channel. Used to ubsubscribe later\n        subscriptionId: 'f-subscription-id',\n\n        //Used by the classes attr handler to keep track of which classes were added by itself\n        classesAdded: 'f-added-classes',\n\n        //Used by repeat attr handler to keep track of template after first evaluation\n        repeat: {\n            template: 'repeat-template', //don't prefix by f or dom-manager unbind will kill it\n            templateId: 'repeat-template-id'\n        },\n\n        //Used by foreach attr handler to keep track of template after first evaluation\n        foreachTemplate: 'f-foreach-template',\n        keyAs: 'f-foreach-key-as',\n        valueAs: 'f-foreach-value-as',\n\n        //Used by bind attr handler to keep track of template after first evaluation\n        bindTemplate: 'f-bind-template'\n    }\n};\n\n/***/ }),\n/* 1 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* unused harmony export findBestHandler */\n/* harmony export (immutable) */ __webpack_exports__[\"e\"] = objectToArray;\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = arrayToObject;\n/* harmony export (immutable) */ __webpack_exports__[\"d\"] = normalizeParamOptions;\n/* harmony export (immutable) */ __webpack_exports__[\"b\"] = groupByHandlers;\n/* harmony export (immutable) */ __webpack_exports__[\"c\"] = groupSequentiallyByHandlers;\n/**\n * @param {String} topic\n * @param {Handler[]} handlers\n * @return {MatchedHandler | undefined}\n */\nfunction findBestHandler(topic, handlers) {\n    for (var i = 0; i < handlers.length; i++) {\n        var thishandler = handlers[i];\n        var match = thishandler.match(topic);\n        if (match !== false) {\n            return $.extend(true, {}, thishandler, { matched: match });\n        }\n    }\n    return undefined;\n}\n\n/**\n * \n * @param {Object} obj\n * @return {Publishable[]}\n */\nfunction objectToArray(obj) {\n    var mapped = Object.keys(obj || {}).map(function (t) {\n        return { name: t, value: obj[t] };\n    });\n    return mapped;\n}\n\n/**\n * Converts arrays of the form [{ name: '', value: ''}] to {[name]: value}\n * @param {Publishable[]} arr\n * @returns {Object}\n */\nfunction arrayToObject(arr) {\n    var result = (arr || []).reduce(function (accum, topic) {\n        accum[topic.name] = topic.value;\n        return accum;\n    }, {});\n    return result;\n}\n\n/**\n * @typedef NormalizedParam\n * @property {Publishable[]} params\n * @property {Object} options\n */\n\n/**\n *\n * @param {String|Object|array} topic \n * @param {*} publishValue \n * @param {Object} options\n * @return {NormalizedParam}\n */\nfunction normalizeParamOptions(topic, publishValue, options) {\n    if (!topic) {\n        return { params: [], options: {} };\n    }\n    if ($.isPlainObject(topic)) {\n        return { params: objectToArray(topic), options: publishValue };\n    }\n    if ($.isArray(topic)) {\n        return { params: topic, options: publishValue };\n    }\n    return { params: [{ name: topic, value: publishValue }], options: options };\n}\n\n/**\n * [groupByHandlers description]\n * @param  {String[]} topics   List of topics to match. Format can be anything your handler.match function handles\n * @param  {Handler[]} handlers Handlers of type [{ match: func }]\n * @return {MatchedHandler[]} The handler array with each item now having an additional 'data' attr added to it\n */\nfunction groupByHandlers(topics, handlers) {\n    handlers = handlers.map(function (h, index) {\n        h.key = index;\n        return h;\n    });\n    var topicMapping = [].concat(topics).reduce(function (accum, topic) {\n        var bestHandler = findBestHandler(topic, handlers);\n        if (bestHandler) {\n            //if handler matches different strings treat both as different handlers\n            var key = bestHandler.key + bestHandler.matched;\n            if (!accum[key]) {\n                bestHandler.data = [];\n                accum[key] = bestHandler;\n            }\n            accum[key].data.push(topic);\n        }\n        return accum;\n    }, {});\n    return _.values(topicMapping);\n}\n\n/**\n * Takes a `publish` dataset and groups it by handler maintaining the data sequence\n * @param  {Publishable[]} data     Of the form [{ name: 'X', }]\n * @param  {Handler[]} handlers Handlers of type [{ match: func }]\n * @return {MatchedHandler[]} The handler array with each item now having an additional 'data' attr added to it\n */\nfunction groupSequentiallyByHandlers(data, handlers) {\n    handlers = handlers.map(function (h, index) {\n        h.key = index;\n        return h;\n    });\n    var grouped = data.reduce(function (accum, dataPt) {\n        var lastHandler = accum[accum.length - 1];\n        var bestHandler = findBestHandler(dataPt.name, handlers);\n        if (bestHandler) {\n            if (lastHandler && bestHandler.key === lastHandler.key) {\n                lastHandler.data.push(dataPt);\n            } else {\n                accum.push($.extend({}, bestHandler, { data: [dataPt] }));\n            }\n        } else {\n            accum.push({ data: [dataPt], matched: false });\n        }\n        return accum;\n    }, []);\n    return grouped;\n}\n\n/***/ }),\n/* 2 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (immutable) */ __webpack_exports__[\"g\"] = stripSuffixDelimiter;\n/* harmony export (immutable) */ __webpack_exports__[\"d\"] = prefix;\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = defaultPrefix;\n/* harmony export (immutable) */ __webpack_exports__[\"e\"] = regex;\n/* harmony export (immutable) */ __webpack_exports__[\"c\"] = mapWithPrefix;\n/* harmony export (immutable) */ __webpack_exports__[\"i\"] = withPrefix;\n/* harmony export (immutable) */ __webpack_exports__[\"h\"] = unprefix;\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__silencable__ = __webpack_require__(42);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"f\", function() { return __WEBPACK_IMPORTED_MODULE_0__silencable__[\"a\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__exclude_read_only__ = __webpack_require__(43);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"b\", function() { return __WEBPACK_IMPORTED_MODULE_1__exclude_read_only__[\"a\"]; });\nvar CHANNEL_DELIMITER = ':';\n\n\n\n\n/**\n * \n * @param {string} text\n * @return {string}\n */\nfunction stripSuffixDelimiter(text) {\n    if (text && text.indexOf(CHANNEL_DELIMITER) === text.length - 1) {\n        text = text.replace(CHANNEL_DELIMITER, '');\n    }\n    return text;\n}\n\n/**\n * \n * @param {string} prefix\n * @returns {matchFunction}\n */\nfunction prefix(prefix) {\n    return function matchPrefix(topic) {\n        return topic.indexOf(prefix) === 0 ? prefix : false;\n    };\n}\n\n/**\n* \n* @param {string} prefix\n* @returns {matchFunction}\n*/\nfunction defaultPrefix(prefix) {\n    return function matchPrefix(topic) {\n        return prefix;\n    };\n}\n\n/**\n * \n * @param {string} regex\n * @returns {matchFunction}\n */\nfunction regex(regex) {\n    var toMatch = new RegExp('^' + regex + CHANNEL_DELIMITER);\n    return function matchRegex(topic) {\n        var match = topic.match(toMatch);\n        if (match && match.length) {\n            return match[0];\n        }\n        return false;\n    };\n}\n\n/**\n * \n * @param {Publishable[]} dataArray \n * @param {string} prefix \n * @return {Publishable} array with name prefixed\n */\nfunction mapWithPrefix(dataArray, prefix) {\n    if (!prefix) return dataArray;\n    return (dataArray || []).map(function (datapt) {\n        return $.extend(true, {}, datapt, { name: prefix + datapt.name });\n    });\n}\n\n/**\n * \n * @param {Function} callback \n * @param {string[]} prefixList\n * @return {Function}\n */\nfunction withPrefix(callback, prefixList) {\n    prefixList = [].concat(prefixList);\n\n    /**\n     * @param {Publishable[]} data\n     */\n    return function (data) {\n        prefixList.forEach(function (prefix) {\n            var mapped = mapWithPrefix(data, prefix);\n            callback(mapped);\n        });\n    };\n}\n\n/**\n * \n * @param {Publishable[]} list \n * @param {string} prefix\n * @return {Publishable[]} Item with prefix removed\n */\nfunction unprefix(list, prefix) {\n    if (!prefix) return list;\n    var unprefixed = list.map(function (item) {\n        if (item.name) {\n            return $.extend(true, {}, item, { name: item.name.replace(prefix, '') });\n        }\n        return item.replace(prefix, '');\n    });\n    return unprefixed;\n}\n\n/***/ }),\n/* 3 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"toImplicitType\", function() { return toImplicitType; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"toOperationFormat\", function() { return toOperationFormat; });\n\n\nfunction toImplicitType(data) {\n    var objRegex = /^(?:\\{.*\\})$/;\n    var arrRegex = /^(?:\\[.*])$/;\n\n    var converted = data;\n    if (typeof data === 'string') {\n        converted = data.trim();\n\n        if (converted === 'true') {\n            converted = true;\n        } else if (converted === 'false') {\n            converted = false;\n        } else if (converted === 'null') {\n            converted = null;\n        } else if (converted === 'undefined') {\n            converted = '';\n        } else if (converted.charAt(0) === '\\'' || converted.charAt(0) === '\"') {\n            converted = converted.substring(1, converted.length - 1);\n        } else if ($.isNumeric(converted)) {\n            converted = +converted;\n        } else if (arrRegex.test(converted)) {\n            var bracketReplaced = converted.replace(/[[\\]]/g, '');\n            if (!bracketReplaced) return [];\n            var parsed = bracketReplaced.split(/,(?![^[]*])/).map(function (val) {\n                return toImplicitType(val);\n            });\n            return parsed;\n        } else if (objRegex.test(converted)) {\n            try {\n                converted = JSON.parse(converted);\n            } catch (e) {\n                console.error('toImplicitType: couldn\\'t convert', converted);\n            }\n        }\n    }\n    return converted;\n}\n\nfunction toOperationFormat(value) {\n    var split = (value || '').split('|');\n    var listOfOperations = split.map(function (value) {\n        value = value.trim();\n        var fnName = value.split('(')[0];\n        var params = value.substring(value.indexOf('(') + 1, value.indexOf(')'));\n        var args = params.trim() !== '' ? params.split(',') : [];\n\n        return { name: fnName, value: args };\n    });\n    return listOfOperations;\n}\n\n\n\n/***/ }),\n/* 4 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* unused harmony export notifySubscribeHandlers */\n/* unused harmony export notifyUnsubscribeHandlers */\n/* unused harmony export passthroughPublishInterceptors */\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = Router;\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_channels_channel_utils__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_channels_middleware_utils__ = __webpack_require__(2);\n\n\n\n/**\n * Handle subscriptions\n * @param  {Handler[]} handlers Array of the form [{ match: function (){}, }]\n * @param  {String[]} topics   Array of strings\n * @param  {SubscribeOptions} [options]\n * @return {String[]} Returns the original topics array\n */\nfunction notifySubscribeHandlers(handlers, topics, options) {\n    var grouped = Object(__WEBPACK_IMPORTED_MODULE_0_channels_channel_utils__[\"b\" /* groupByHandlers */])(topics, handlers);\n    grouped.forEach(function (handler) {\n        if (handler.subscribeHandler) {\n            var mergedOptions = $.extend(true, {}, handler.options, options);\n            var unprefixed = Object(__WEBPACK_IMPORTED_MODULE_1_channels_middleware_utils__[\"h\" /* unprefix */])(handler.data, handler.matched);\n            handler.subscribeHandler(unprefixed, mergedOptions, handler.matched);\n        }\n    });\n    return topics;\n}\n\n/**\n * \n * @param {Handler[]} handlers \n * @param {String[]} recentlyUnsubscribedTopics\n * @param {String[]} remainingTopics \n */\nfunction notifyUnsubscribeHandlers(handlers, recentlyUnsubscribedTopics, remainingTopics) {\n    handlers = handlers.map(function (h, index) {\n        h.unsubsKey = index;\n        return h;\n    });\n\n    var unsubsGrouped = Object(__WEBPACK_IMPORTED_MODULE_0_channels_channel_utils__[\"b\" /* groupByHandlers */])(recentlyUnsubscribedTopics, handlers);\n    var remainingGrouped = Object(__WEBPACK_IMPORTED_MODULE_0_channels_channel_utils__[\"b\" /* groupByHandlers */])(remainingTopics, handlers);\n\n    unsubsGrouped.forEach(function (handler) {\n        if (handler.unsubscribeHandler) {\n            var unprefixedUnsubs = Object(__WEBPACK_IMPORTED_MODULE_1_channels_middleware_utils__[\"h\" /* unprefix */])(handler.data, handler.matched);\n            var matchingRemainingHandler = _.find(remainingGrouped, function (remainingHandler) {\n                return remainingHandler.unsubsKey === handler.unsubsKey;\n            });\n            var matchingTopicsRemaining = matchingRemainingHandler ? matchingRemainingHandler.data : [];\n            var unprefixedRemaining = Object(__WEBPACK_IMPORTED_MODULE_1_channels_middleware_utils__[\"h\" /* unprefix */])(matchingTopicsRemaining || [], handler.matched);\n            handler.unsubscribeHandler(unprefixedUnsubs, unprefixedRemaining);\n        }\n    });\n}\n\n/**\n * \n * @param {Handler[]} handlers \n * @param {Publishable[]} publishData \n * @param {PublishOptions} [options]\n * @return {Promise}\n */\nfunction passthroughPublishInterceptors(handlers, publishData, options) {\n    var grouped = Object(__WEBPACK_IMPORTED_MODULE_0_channels_channel_utils__[\"c\" /* groupSequentiallyByHandlers */])(publishData, handlers);\n    var $initialProm = $.Deferred().resolve([]).promise();\n    grouped.forEach(function (handler) {\n        $initialProm = $initialProm.then(function (dataSoFar) {\n            var mergedOptions = $.extend(true, {}, handler.options, options);\n            var unprefixed = Object(__WEBPACK_IMPORTED_MODULE_1_channels_middleware_utils__[\"h\" /* unprefix */])(handler.data, handler.matched);\n\n            var publishableData = Object(__WEBPACK_IMPORTED_MODULE_1_channels_middleware_utils__[\"b\" /* excludeReadOnly */])(unprefixed, mergedOptions.readOnly);\n            if (!publishableData.length) {\n                return dataSoFar;\n            }\n\n            var result = handler.publishHandler ? handler.publishHandler(publishableData, mergedOptions, handler.matched) : publishableData;\n            var publishProm = $.Deferred().resolve(result).promise();\n            return publishProm.then(function (published) {\n                return Object(__WEBPACK_IMPORTED_MODULE_1_channels_middleware_utils__[\"f\" /* silencable */])(published, mergedOptions.silent);\n            }).then(function (published) {\n                var mapped = Object(__WEBPACK_IMPORTED_MODULE_1_channels_middleware_utils__[\"c\" /* mapWithPrefix */])(published, handler.matched);\n                if (handler.isDefault && handler.matched) {\n                    mapped = mapped.concat(published);\n                }\n                return mapped;\n            }).then(function (mapped) {\n                return [].concat(dataSoFar, mapped);\n            });\n        });\n    });\n    return $initialProm;\n}\n\n/**\n * Router\n * @param  {Handler[]} handlers\n * @return {Router}\n */\nfunction Router(handlers) {\n    return $.extend(this, {\n        /**\n         * @param {String[]} topics\n         * @param {SubscribeOptions} [options]\n         * @return {String[]} Returns the original topics array\n         */\n        subscribeHandler: function (topics, options) {\n            return notifySubscribeHandlers(handlers, topics, options);\n        },\n        /**\n         * @param {String[]} recentlyUnsubscribedTopics\n         * @param {String[]} remainingTopics\n         * @return {void}\n         */\n        unsubscribeHandler: function (recentlyUnsubscribedTopics, remainingTopics) {\n            return notifyUnsubscribeHandlers(handlers, recentlyUnsubscribedTopics, remainingTopics);\n        },\n\n        /**\n         * @param {Publishable[]} data\n         * @param {PublishOptions} [options]\n         * @return {Promise}\n         */\n        publishHandler: function (data, options) {\n            return passthroughPublishInterceptors(handlers, data, options);\n        }\n\n        // Ignoring till ready to implement\n        // addRoute: function (handler) {\n        //     if (!handler || !handler.match) {\n        //         throw Error('Handler does not have a valid `match` property');\n        //     }\n        //     handler.id = uniqueId('routehandler-');\n        //     handlers.push(handler);\n        //     return handler.id;\n        // },\n        // removeRoute: function (routeid) {\n        //     handlers = handlers.reduce(function (accum, handler) {\n        //         if (handler.id !== routeid) {\n        //             accum.push(handler);\n        //         }\n        //         return accum;\n        //     }, []);\n        // }\n    });\n}\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nmodule.exports = {\n    random: function (prefix, min, max) {\n        if (!min) {\n            min = parseInt(_.uniqueId(), 10);\n        }\n        if (!max) {\n            max = 100000; //eslint-disable-line no-magic-numbers\n        }\n        var number = _.random(min, max, false) + '';\n        if (prefix) {\n            number = prefix + number;\n        }\n        return number;\n    },\n\n    /**\n     * A promise-returning debounce function. Also lets you decide what to do with arguments passed in while being debounced\n     * @param  {Function} fn                function to debounce\n     * @param  {Number}   debounceInterval  interval\n     * @param  {Array}   argumentsReducers A reducer for each argument to the function\n     * @return {Promise}                     \n     */\n    debounceAndMerge: function (fn, debounceInterval, argumentsReducers) {\n        var timer = null;\n\n        var argsToPass = [];\n        if (!argumentsReducers) {\n            var arrayReducer = function (accum, newVal) {\n                if (!accum) {\n                    accum = [];\n                }\n                return accum.concat(newVal);\n            };\n            argumentsReducers = [arrayReducer];\n        }\n        return function () {\n            var $def = $.Deferred();\n            var newArgs = _.toArray(arguments);\n            argsToPass = newArgs.map(function (arg, index) {\n                var reducer = argumentsReducers[index];\n                if (reducer) {\n                    return reducer(argsToPass[index], arg);\n                } else {\n                    return arg;\n                }\n            });\n\n            if (timer) {\n                clearTimeout(timer);\n            }\n            timer = setTimeout(function () {\n                timer = null;\n                var res = fn.apply(fn, argsToPass);\n                if (res && res.then) {\n                    return res.then(function (arg) {\n                        argsToPass = [];\n                        $def.resolve(arg);\n                    });\n                } else {\n                    argsToPass = [];\n                    $def.resolve(res);\n                }\n            }, debounceInterval);\n\n            return $def.promise();\n        };\n    }\n};\n\n/***/ }),\n/* 6 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = RunRouter;\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__run_meta_channel__ = __webpack_require__(39);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__run_variables_channel__ = __webpack_require__(40);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__run_operations_channel__ = __webpack_require__(41);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_channels_channel_router__ = __webpack_require__(4);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_channels_middleware_utils__ = __webpack_require__(2);\n\n\n\n\n\n\n\nfunction RunRouter(config, notifier) {\n    var defaults = {\n        serviceOptions: {},\n        channelOptions: {\n            variables: {\n                autoFetch: true,\n                debounce: 200,\n                silent: false,\n                readOnly: false\n            },\n            operations: {\n                readOnly: false,\n                silent: false\n            },\n            meta: {\n                silent: false,\n                autoFetch: true,\n                readOnly: ['id', 'created', 'account', 'project', 'model', 'lastModified']\n            }\n        }\n    };\n    var opts = $.extend(true, {}, defaults, config);\n\n    var serviceOptions = _.result(opts, 'serviceOptions');\n\n    var $initialProm = null;\n    if (serviceOptions instanceof window.F.service.Run) {\n        $initialProm = $.Deferred().resolve(serviceOptions).promise();\n    } else if (serviceOptions.then) {\n        $initialProm = serviceOptions;\n    } else {\n        var rs = new window.F.service.Run(serviceOptions);\n        $initialProm = $.Deferred().resolve(rs).promise();\n    }\n\n    var metaChannel = new __WEBPACK_IMPORTED_MODULE_0__run_meta_channel__[\"a\" /* default */]($initialProm, Object(__WEBPACK_IMPORTED_MODULE_4_channels_middleware_utils__[\"i\" /* withPrefix */])(notifier, 'meta:'));\n    var operationsChannel = new __WEBPACK_IMPORTED_MODULE_2__run_operations_channel__[\"a\" /* default */]($initialProm, Object(__WEBPACK_IMPORTED_MODULE_4_channels_middleware_utils__[\"i\" /* withPrefix */])(notifier, 'operations:'));\n    var variableschannel = new __WEBPACK_IMPORTED_MODULE_1__run_variables_channel__[\"a\" /* default */]($initialProm, Object(__WEBPACK_IMPORTED_MODULE_4_channels_middleware_utils__[\"i\" /* withPrefix */])(notifier, ['variables:', '']));\n\n    var handlers = [$.extend({}, metaChannel, {\n        name: 'meta',\n        match: Object(__WEBPACK_IMPORTED_MODULE_4_channels_middleware_utils__[\"d\" /* prefix */])('meta:'),\n        options: opts.channelOptions.meta\n    }), $.extend({}, operationsChannel, {\n        name: 'operations',\n        match: Object(__WEBPACK_IMPORTED_MODULE_4_channels_middleware_utils__[\"d\" /* prefix */])('operations:'),\n        options: opts.channelOptions.operations\n    }), $.extend({}, variableschannel, {\n        isDefault: true,\n        name: 'variables',\n        match: Object(__WEBPACK_IMPORTED_MODULE_4_channels_middleware_utils__[\"a\" /* defaultPrefix */])('variables:'),\n        options: opts.channelOptions.variables\n    })];\n\n    var router = new __WEBPACK_IMPORTED_MODULE_3_channels_channel_router__[\"a\" /* default */](handlers, notifier);\n    var oldhandler = router.publishHandler;\n    router.publishHandler = function () {\n        var prom = oldhandler.apply(router, arguments);\n        return prom.then(function (result) {\n            //all the silencing will be taken care of by the router\n            var shouldFetch = _.find(result, function (r) {\n                return r.name.indexOf('operations:') === 0 || r.name.indexOf('variables:') === 0;\n            });\n            if (shouldFetch) {\n                variableschannel.fetch();\n            }\n            return result;\n        });\n    };\n    return router;\n}\n\n/***/ }),\n/* 7 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar config = __webpack_require__(0);\nvar BaseView = __webpack_require__(8);\n\nmodule.exports = BaseView.extend({\n    propertyHandlers: [],\n\n    uiChangeEvent: 'change',\n    getUIValue: function () {\n        return this.$el.val();\n    },\n\n    removeEvents: function () {\n        this.$el.off(this.uiChangeEvent);\n    },\n\n    initialize: function () {\n        var me = this;\n        var propName = this.$el.data(config.binderAttr);\n\n        if (propName) {\n            this.$el.off(this.uiChangeEvent).on(this.uiChangeEvent, function () {\n                var val = me.getUIValue();\n\n                var params = {};\n                params[propName] = val;\n\n                me.$el.trigger(config.events.trigger, params);\n            });\n        }\n        BaseView.prototype.initialize.apply(this, arguments);\n    }\n}, { selector: 'input, select' });\n\n/***/ }),\n/* 8 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar BaseView = __webpack_require__(9);\n\nmodule.exports = BaseView.extend({\n    propertyHandlers: [],\n\n    initialize: function () {}\n}, { selector: '*' });\n\n/***/ }),\n/* 9 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar extend = function (protoProps, staticProps) {\n    var me = this;\n    var child;\n\n    // The constructor function for the new subclass is either defined by you\n    // (the \"constructor\" property in your `extend` definition), or defaulted\n    // by us to simply call the parent's constructor.\n    if (protoProps && _.has(protoProps, 'constructor')) {\n        child = protoProps.constructor;\n    } else {\n        child = function () {\n            return me.apply(this, arguments);\n        };\n    }\n\n    // Add static properties to the constructor function, if supplied.\n    _.extend(child, me, staticProps);\n\n    // Set the prototype chain to inherit from `parent`, without calling\n    // `parent`'s constructor function.\n    var Surrogate = function () {\n        this.constructor = child;\n    };\n    Surrogate.prototype = me.prototype;\n    child.prototype = new Surrogate();\n\n    // Add prototype properties (instance properties) to the subclass,\n    // if supplied.\n    if (protoProps) {\n        _.extend(child.prototype, protoProps);\n    }\n\n    // Set a convenience property in case the parent's prototype is needed\n    // later.\n    child.__super__ = me.prototype; //eslint-disable-line no-underscore-dangle\n\n    return child;\n};\n\nvar View = function (options) {\n    this.$el = options.$el || $(options.el);\n    this.el = options.el;\n    this.initialize.apply(this, arguments);\n};\n\n_.extend(View.prototype, {\n    initialize: function () {}\n});\n\nView.extend = extend;\n\nmodule.exports = View;\n\n/***/ }),\n/* 10 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = extractDependencies;\n/* harmony export (immutable) */ __webpack_exports__[\"b\"] = interpolateWithValues;\nvar _ref = _,\n    isArray = _ref.isArray;\n\n\nvar interpolationRegex = /<(.*?)>/g;\n/**\n *  \n * @param {String} topic topic to extract dependencies from\n * @return {String[]} dependencies\n */\nfunction extractDependencies(topic) {\n    var deps = (topic.match(interpolationRegex) || []).map(function (val) {\n        return val.substring(1, val.length - 1);\n    });\n    return deps;\n}\n\n/**\n * @param {String} topic topic with dependencies\n * @param {Object} data object with values of dependencies\n * @return {String} interpolated string\n */\nfunction interpolateWithValues(topic, data) {\n    var interpolatedTopic = topic.replace(interpolationRegex, function (match, dependency) {\n        var val = data[dependency];\n        var toReplace = isArray(val) ? val[val.length - 1] : val;\n        return toReplace;\n    });\n    return interpolatedTopic;\n}\n\n/***/ }),\n/* 11 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/**\n * ## Flow.js Initialization\n *\n * To use Flow.js in your project, simply call `Flow.initialize()` in your user interface. In the basic case, `Flow.initialize()` can be called without any arguments. While Flow.js needs to know the account, project, and model you are using, by default these values are extracted from the URL of Epicenter project and by the use of `data-f-model` in your `<body>` tag. See more on the [basics of using Flow.js in your project.](../../#using_in_project).\n *\n * However, sometimes you want to be explicit in your initialization call, and there are also some additional parameters that let you customize your use of Flow.js.\n *\n * #### Parameters\n *\n * The parameters for initializing Flow.js include:\n *\n * * `channel` Configuration details for the channel Flow.js uses in connecting with underlying APIs.\n * * `channel.strategy` The run creation strategy describes when to create new runs when an end user visits this page. The default is `new-if-persisted`, which creates a new run when the end user is idle for longer than your project's **Model Session Timeout** (configured in your project's [Settings](../../../updating_your_settings/)), but otherwise uses the current run.. See more on [Run Strategies](../../../api_adapters/strategy/).\n * * `channel.run` Configuration details for each run created.\n * * `channel.run.account` The **User ID** or **Team ID** for this project. By default, taken from the URL where the user interface is hosted, so you only need to supply this is you are running your project's user interface [on your own server](../../../how_to/self_hosting/).\n * * `channel.run.project` The **Project ID** for this project.\n * * `channel.run.model` Name of the primary model file for this project. By default, taken from `data-f-model` in your HTML `<body>` tag.\n * * `channel.run.variables` Configuration options for the variables being listened to on this channel.\n * * `channel.run.variables.silent` Provides granular control over when user interface updates happen for changes on this channel. See below for possible values.\n * * `channel.run.variables.autoFetch` Options for fetching variables from the API as they're being subscribed. See [Variables Channel](../channels/variables-channel/) for details.\n * * `channel.run.operations` Configuration options for the operations being listened to on this channel. Currently there is only one configuration option: `silent`.\n * * `channel.run.operations.silent` Provides granular control over when user interface updates happen for changes on this channel. See below for possible values.\n * * `channel.run.server` Object with additional server configuration, defaults to `host: 'api.forio.com'`.\n * * `channel.run.transport` An object which takes all of the jquery.ajax options at <a href=\"http://api.jquery.com/jQuery.ajax/\">http://api.jquery.com/jQuery.ajax/</a>.\n * * `dom` Configuration options for the DOM where this instance of Flow.js is created.\n * * `dom.root` The root HTML element being managed by the Flow.js DOM Manager. Defaults to `body`.\n * * `dom.autoBind` If `true` (default), automatically parse variables added to the DOM after this `Flow.initialize()` call. Note, this does not work in IE versions < 11.\n *\n * The `silent` configuration option for the `run.variables` and `run.operations` is a flag for providing more granular control over when user interface updates happen for changes on this channel. Values can be:\n *\n * * `false`: Always update the UI for any changes (variables updated, operations called) on this channel. This is the default behavior.\n * * `true`: Never update the UI for any on changes (variables updated, operations called) on this channel.\n * * Array of variables or operations for which the UI *should not* be updated. For example, `variables: { silent: [ 'price', 'sales' ] }` means this channel is silent (no updates for the UI) when the variables 'price' or 'sales' change, and the UI is always updated for any changes to other variables. This is useful if you know that changing 'price' or 'sales' does not impact anything else in the UI directly, for instance.\n * * `except`: With array of variables or operations for which the UI *should* be updated. For example, `variables { silent: { except: [ 'price', 'sales' ] } }` is the converse of the above. The UI is always updated when anything on this channel changes *except* when the variables 'price' or 'sales' are updated.\n *\n * Although Flow.js provides a bi-directional binding between the model and the user interface, the `silent` configuration option applies only for the binding from the model to the user interface; updates in the user interface (including calls to operations) are still sent to the model.\n *\n * The `Flow.initialize()` call is based on the Epicenter.js [Run Service](../../../api_adapters/generated/run-api-service/) from the [API Adapters](../../../api_adapters/). See those pages for additional information on parameters.\n *\n * The `Flow.initialize()` call returns a promise, which is resolved when initialization is complete.\n *\n * #### Example\n *\n *      Flow.initialize({\n *          channel: {\n *              strategy: 'new-if-persisted',\n *              run: {\n *                  model: 'supply-chain-game.py',\n *                  account: 'acme-simulations',\n *                  project: 'supply-chain-game',\n *                  server: { host: 'api.forio.com' },\n *                  variables: { silent: ['price', 'sales'] },\n *                  operations: { silent: false },\n *                  transport: {\n *                      beforeSend: function() { $('body').addClass('loading'); },\n *                      complete: function() { $('body').removeClass('loading'); }\n *                  }\n *              }\n *          }\n *      }).then(function() {\n *          // code that depends on initialization\n *      });\n *\n */\n\n\n\nvar domManager = __webpack_require__(12);\nvar BaseView = __webpack_require__(9);\n\nvar ChannelManager = __webpack_require__(35).default;\n// var parseUtils = require('utils/parse-utils');\n\nvar Flow = {\n    dom: domManager,\n    utils: {\n        BaseView: BaseView\n    },\n    initialize: function (config) {\n        var model = $('body').data('f-model');\n\n        var defaults = {\n            channel: {\n                //FIXME: Defaults can't be here..\n                defaults: {\n                    run: {\n                        model: model\n                    }\n                }\n            },\n            dom: {\n                root: 'body',\n                autoBind: true\n            }\n        };\n\n        var options = $.extend(true, {}, defaults, config);\n        // var $root = $(options.dom.root);\n\n        // var initialFn = $root.data('f-on-init');\n        // //TOOD: Should move this to DOM Manager and just prioritize on-inits\n        // if (initialFn) {\n        //     var listOfOperations = _.invoke(initialFn.split('|'), 'trim');\n        //     listOfOperations = listOfOperations.map(function (value) {\n        //         var fnName = value.split('(')[0];\n        //         var params = value.substring(value.indexOf('(') + 1, value.indexOf(')'));\n        //         var args = ($.trim(params) !== '') ? params.split(',') : [];\n        //         args = args.map(function (a) {\n        //             return parseUtils.toImplicitType(a.trim());\n        //         });\n        //         var toReturn = {};\n        //         toReturn[fnName] = args;\n        //         return toReturn;\n        //     });\n\n        //     //TODO: Make a channel configuration factory which gets the initial info\n        //     options.channel.options.runManager.defaults.initialOperation = listOfOperations;\n        // }\n\n        if (config && config.channel && config.channel instanceof ChannelManager) {\n            this.channel = config.channel;\n        } else {\n            this.channel = new ChannelManager(options.channel);\n        }\n\n        var prom = domManager.initialize($.extend(true, {\n            channel: this.channel\n        }, options.dom));\n\n        this.channel.subscribe('operations:reset', function () {\n            domManager.unbindAll();\n            domManager.bindAll();\n        });\n\n        return prom;\n    }\n};\nFlow.ChannelManager = ChannelManager;\n//set by grunt\nif (true) Flow.version = \"0.11.0\"; //eslint-disable-line no-undef\nmodule.exports = Flow;\n\n/***/ }),\n/* 12 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/**\n * ## DOM Manager\n *\n * The Flow.js DOM Manager provides two-way data bindings from your project's user interface to the channel. The DOM Manager is the 'glue' through which HTML DOM elements -- including the attributes and attribute handlers provided by Flow.js for [variables](../../attributes-overview/), [operations](../../operations-overview/) and [conversion](../../converter-overview/), and those [you create](./attributes/attribute-manager/) -- are bound to the variable and operations [channels](../../channel-overview/) to link them with your project's model. See the [Epicenter architecture details](../../../creating_your_interface/arch_details/) for a visual description of how the DOM Manager relates to the [rest of the Epicenter stack](../../../creating_your_interface/).\n *\n * The DOM Manager is an integral part of the Flow.js architecture but, in keeping with our general philosophy of extensibility and configurability, it is also replaceable. For instance, if you want to manage your DOM state with [Backbone Views](http://backbonejs.org) or [Angular.js](https://angularjs.org), while still using the channels to handle the communication with your model, this is the piece you'd replace. [Contact us](http://forio.com/about/contact/) if you are interested in extending Flow.js in this way -- we'll be happy to talk about it in more detail.\n *\n */\n\n\nmodule.exports = function () {\n    var config = __webpack_require__(0);\n    var parseUtils = __webpack_require__(3);\n    var domUtils = __webpack_require__(13);\n\n    var converterManager = __webpack_require__(14);\n    var nodeManager = __webpack_require__(20);\n    var attrManager = __webpack_require__(22);\n    var autoUpdatePlugin = __webpack_require__(34);\n\n    //Jquery selector to return everything which has a f- property set\n    $.expr.pseudos[config.prefix] = function (el) {\n        if (!el || !el.attributes) {\n            return false;\n        }\n        for (var i = 0; i < el.attributes.length; i++) {\n            var attr = el.attributes[i].nodeName;\n            if (attr.indexOf('data-' + config.prefix) === 0) {\n                return true;\n            }\n        }\n        return false;\n    };\n\n    $.expr.pseudos.webcomponent = function (obj) {\n        return obj.nodeName.indexOf('-') !== -1;\n    };\n\n    var getMatchingElements = function (root) {\n        var $root = $(root);\n        var matchedElements = $root.find(':' + config.prefix);\n        if ($root.is(':' + config.prefix)) {\n            matchedElements = matchedElements.add($root);\n        }\n        return matchedElements;\n    };\n\n    var getElementOrError = function (element, context) {\n        if (element instanceof $) {\n            element = element.get(0);\n        }\n        if (!element || !element.nodeName) {\n            console.error(context, 'Expected to get DOM Element, got ', element);\n            throw new Error(context + ': Expected to get DOM Element, got' + typeof element);\n        }\n        return element;\n    };\n\n    var publicAPI = {\n\n        nodes: nodeManager,\n        attributes: attrManager,\n        converters: converterManager,\n        //utils for testing\n        private: {\n            matchedElements: []\n        },\n\n        /**\n         * Unbind the element: unsubscribe from all updates on the relevant channels.\n         *\n         * @param {DomElement} element The element to remove from the data binding.\n         * @param {ChannelInstance} channel (Optional) The channel from which to unsubscribe. Defaults to the [variables channel](../channels/variables-channel/).\n         * @returns {undefined}\n         */\n        unbindElement: function (element, channel) {\n            if (!channel) {\n                channel = this.options.channel;\n            }\n            element = getElementOrError(element);\n            var $el = $(element);\n            if (!$el.is(':' + config.prefix)) {\n                return false;\n            }\n            this.private.matchedElements = _.without(this.private.matchedElements, element);\n\n            //FIXME: have to readd events to be able to remove them. Ugly\n            var Handler = nodeManager.getHandler($el);\n            var h = new Handler.handle({\n                el: element\n            });\n            if (h.removeEvents) {\n                h.removeEvents();\n            }\n\n            $(element.attributes).each(function (index, nodeMap) {\n                var attr = nodeMap.nodeName;\n                var wantedPrefix = 'data-f-';\n                if (attr.indexOf(wantedPrefix) === 0) {\n                    attr = attr.replace(wantedPrefix, '');\n                    var handler = attrManager.getHandler(attr, $el);\n                    if (handler.unbind) {\n                        handler.unbind.call($el, attr);\n                    }\n                }\n            });\n\n            var subsid = $el.data(config.attrs.subscriptionId) || [];\n            _.each([].concat(subsid), function (subs) {\n                channel.unsubscribe(subs);\n            });\n\n            _.each($el.data(), function (val, key) {\n                if (key.indexOf('f-') === 0 || key.match(/^f[A-Z]/)) {\n                    $el.removeData(key);\n                    // var hyphenated = key.replace(/([A-Z])/g, '-$1').toLowerCase();\n                    // $el.removeData(hyphenated);\n                }\n            });\n\n            return this;\n        },\n\n        /**\n         * Bind the element: subscribe from updates on the relevant channels.\n         *\n         * @param {DomElement} element The element to add to the data binding.\n         * @param {ChannelInstance} channel (Optional) The channel to subscribe to. Defaults to the [run channel](../channels/run-channel/).\n         * @returns {undefined}\n         */\n        bindElement: function (element, channel) {\n            if (!channel) {\n                channel = this.options.channel;\n            }\n            element = getElementOrError(element);\n            var $el = $(element);\n            if (!$el.is(':' + config.prefix)) {\n                return false;\n            }\n            if (!_.includes(this.private.matchedElements, element)) {\n                this.private.matchedElements.push(element);\n            }\n\n            //Send to node manager to handle ui changes\n            var Handler = nodeManager.getHandler($el);\n            new Handler.handle({\n                el: element\n            });\n\n            var subscribe = function (subsChannel, varsToBind, $bindEl, options) {\n                if (!varsToBind || !varsToBind.length) {\n                    return false;\n                }\n\n                var subsid = subsChannel.subscribe(varsToBind, function (params) {\n                    $bindEl.trigger(config.events.channelDataReceived, params);\n                }, options);\n                var newsubs = ($el.data(config.attrs.subscriptionId) || []).concat(subsid);\n                $el.data(config.attrs.subscriptionId, newsubs);\n            };\n\n            var attrBindings = [];\n            var nonBatchableVariables = [];\n            var channelConfig = domUtils.getChannelConfig(element);\n\n            //NOTE: looping through attributes instead of .data because .data automatically camelcases properties and make it hard to retrvieve. Also don't want to index dynamically added (by flow) data attrs\n            $(element.attributes).each(function (index, nodeMap) {\n                var attr = nodeMap.nodeName;\n                var attrVal = nodeMap.value;\n\n                var channelPrefix = domUtils.getChannel($el, attr);\n\n                var wantedPrefix = 'data-f-';\n                if (attr.indexOf(wantedPrefix) === 0) {\n                    attr = attr.replace(wantedPrefix, '');\n\n                    var handler = attrManager.getHandler(attr, $el);\n                    var isBindableAttr = true;\n                    if (handler && handler.init) {\n                        isBindableAttr = handler.init.call($el, attr, attrVal);\n                    }\n\n                    if (isBindableAttr) {\n                        //Convert pipes to converter attrs\n                        var withConv = attrVal.split('|').map(function (v) {\n                            return v.trim();\n                        });\n                        if (withConv.length > 1) {\n                            attrVal = withConv.shift();\n                            $el.data('f-convert-' + attr, withConv);\n                        }\n\n                        var binding = { attr: attr };\n                        var commaRegex = /,(?![^[]*])/;\n\n                        //NOTE: do this within init?\n                        if (handler && handler.parse) {\n                            //Let the handler do any pre-processing of inputs necessary\n                            attrVal = handler.parse.call($el, attrVal);\n                        }\n\n                        if (attrVal.indexOf('<%') !== -1) {\n                            //Assume it's templated for later use\n\n                        } else if (attrVal.split(commaRegex).length > 1) {\n                            var varsToBind = attrVal.split(commaRegex).map(function (v) {\n                                return v.trim();\n                            });\n                            if (channelPrefix) {\n                                varsToBind = varsToBind.map(function (v) {\n                                    return channelPrefix + ':' + v;\n                                });\n                            }\n                            subscribe(channel, varsToBind, $el, $.extend({ batch: true }, channelConfig)); //TODO: Move batch defaults to subscription manager\n                            binding.topics = varsToBind;\n                        } else {\n                            if (channelPrefix) {\n                                attrVal = channelPrefix + ':' + attrVal;\n                            }\n                            binding.topics = [attrVal];\n                            nonBatchableVariables.push(attrVal);\n                        }\n                        attrBindings.push(binding);\n                    }\n                }\n            });\n            $el.data(config.attrs.bindingsList, attrBindings);\n            if (nonBatchableVariables.length) {\n                subscribe(channel, nonBatchableVariables, $el, $.extend({ batch: false }, channelConfig));\n            }\n        },\n\n        /**\n         * Bind all provided elements.\n         *\n         * @param  {Array|jQuerySelector} elementsToBind (Optional) If not provided, binds all matching elements within default root provided at initialization.\n         * @returns {undefined}\n         */\n        bindAll: function (elementsToBind) {\n            if (!elementsToBind) {\n                elementsToBind = getMatchingElements(this.options.root);\n            } else if (!_.isArray(elementsToBind)) {\n                elementsToBind = getMatchingElements(elementsToBind);\n            }\n\n            var me = this;\n            //parse through dom and find everything with matching attributes\n            $.each(elementsToBind, function (index, element) {\n                me.bindElement(element, me.options.channel);\n            });\n        },\n        /**\n         * Unbind provided elements.\n         *\n         * @param  {Array} elementsToUnbind (Optional) If not provided, unbinds everything.\n         * @returns {undefined}\n         */\n        unbindAll: function (elementsToUnbind) {\n            var me = this;\n            if (!elementsToUnbind) {\n                elementsToUnbind = this.private.matchedElements;\n            } else if (!_.isArray(elementsToUnbind)) {\n                elementsToUnbind = getMatchingElements(elementsToUnbind);\n            }\n            $.each(elementsToUnbind, function (index, element) {\n                me.unbindElement(element, me.options.channel);\n            });\n        },\n\n        /**\n         * Initialize the DOM Manager to work with a particular HTML element and all elements within that root. Data bindings between individual HTML elements and the model variables specified in the attributes will happen via the channel.\n         *\n         * @param {Object} options (Optional) Overrides for the default options.\n         * @param {String} options.root The root HTML element being managed by this instance of the DOM Manager. Defaults to `body`.\n         * @param {Object} options.channel The channel to communicate with. Defaults to the Channel Manager from [Epicenter.js](../../../api_adapters/).\n         * @param {Boolean} options.autoBind If `true` (default), any variables added to the DOM after `Flow.initialize()` has been called will be automatically parsed, and subscriptions added to channels. Note, this does not work in IE versions < 11.\n         * @returns {undefined}\n         */\n        initialize: function (options) {\n            var defaults = {\n                /**\n                 * Root of the element for flow.js to manage from.\n                 * @type {String} jQuery selector\n                 */\n                root: 'body',\n                channel: null,\n\n                /**\n                 * Any variables added to the DOM after `Flow.initialize()` has been called will be automatically parsed, and subscriptions added to channels. Note, this does not work in IE versions < 11.\n                 * @type {Boolean}\n                 */\n                autoBind: true\n            };\n            $.extend(defaults, options);\n\n            var channel = defaults.channel;\n\n            this.options = defaults;\n\n            var me = this;\n            var $root = $(defaults.root);\n\n            var attachChannelListener = function ($root) {\n                $root.off(config.events.channelDataReceived).on(config.events.channelDataReceived, function (evt, data) {\n                    var $el = $(evt.target);\n                    var bindings = $el.data(config.attrs.bindingsList);\n                    var toconvert = {};\n                    $.each(data, function (variableName, value) {\n                        _.each(bindings, function (binding) {\n                            var channelPrefix = domUtils.getChannel($el, binding.attr);\n                            var interestedTopics = binding.topics;\n                            if (_.includes(interestedTopics, variableName)) {\n                                if (binding.topics.length > 1) {\n                                    var matching = _.pick(data, interestedTopics);\n                                    if (!channelPrefix) {\n                                        value = matching;\n                                    } else {\n                                        value = Object.keys(matching).reduce(function (accum, key) {\n                                            var k = key.replace(channelPrefix + ':', '');\n                                            accum[k] = matching[key];\n                                            return accum;\n                                        }, {});\n                                    }\n                                }\n                                toconvert[binding.attr] = value;\n                            }\n                        });\n                    });\n                    $el.trigger(config.events.convert, toconvert);\n                });\n            };\n\n            var attachUIVariablesListener = function ($root) {\n                $root.off(config.events.trigger).on(config.events.trigger, function (evt, data) {\n                    var parsedData = {}; //if not all subsequent listeners will get the modified data\n\n                    var $el = $(evt.target);\n                    var attrConverters = domUtils.getConvertersList($el, 'bind');\n\n                    _.each(data, function (val, key) {\n                        key = key.split('|')[0].trim(); //in case the pipe formatting syntax was used\n                        val = converterManager.parse(val, attrConverters);\n                        parsedData[key] = parseUtils.toImplicitType(val);\n\n                        $el.trigger(config.events.convert, { bind: val });\n                    });\n\n                    channel.publish(parsedData);\n                });\n            };\n\n            var attachUIOperationsListener = function ($root) {\n                $root.off(config.events.operate).on(config.events.operate, function (evt, data) {\n                    var filtered = [].concat(data.operations || []).reduce(function (accum, operation) {\n                        var val = operation.value ? [].concat(operation.value) : [];\n                        operation.value = val.map(function (val) {\n                            return parseUtils.toImplicitType($.trim(val));\n                        });\n                        var isConverter = converterManager.getConverter(operation.name);\n                        if (isConverter) {\n                            accum.converters.push(operation);\n                        } else {\n                            //TODO: Add a test for this\n                            if (operation.name.indexOf(':') === -1) {\n                                operation.name = 'operations:' + operation.name;\n                            }\n                            accum.operations.push(operation);\n                        }\n                        return accum;\n                    }, { operations: [], converters: [] });\n\n                    var promise = filtered.operations.length ? channel.publish(filtered.operations, data.options) : $.Deferred().resolve().promise();\n\n                    //FIXME: Needed for the 'gotopage' in interfacebuilder. Remove this once we add a window channel\n                    promise.then(function (args) {\n                        _.each(filtered.converters, function (con) {\n                            converterManager.convert(con.value, [con.name]);\n                        });\n                    });\n                });\n            };\n\n            var attachConversionListner = function ($root) {\n                // data = {proptoupdate: value} || just a value (assumes 'bind' if so)\n                $root.off(config.events.convert).on(config.events.convert, function (evt, data) {\n                    var $el = $(evt.target);\n\n                    var convert = function (val, prop) {\n                        prop = prop.toLowerCase();\n                        var attrConverters = domUtils.getConvertersList($el, prop);\n\n                        var handler = attrManager.getHandler(prop, $el);\n                        var convertedValue = converterManager.convert(val, attrConverters);\n                        handler.handle.call($el, convertedValue, prop);\n                    };\n\n                    if ($.isPlainObject(data)) {\n                        _.each(data, convert);\n                    } else {\n                        convert(data, 'bind');\n                    }\n                });\n            };\n\n            var promise = $.Deferred();\n            $(function () {\n                me.bindAll();\n\n                attachChannelListener($root);\n                attachUIVariablesListener($root);\n                attachUIOperationsListener($root);\n                attachConversionListner($root);\n\n                if (me.options.autoBind) {\n                    autoUpdatePlugin($root.get(0), me);\n                }\n\n                promise.resolve($root);\n                $root.trigger('f.domready');\n            });\n\n            return promise;\n        }\n    };\n\n    return $.extend(this, publicAPI);\n}();\n\n/***/ }),\n/* 13 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nmodule.exports = {\n\n    match: function (matchExpr, matchValue, context) {\n        if (_.isString(matchExpr)) {\n            return matchExpr === '*' || matchExpr.toLowerCase() === matchValue.toLowerCase();\n        } else if (_.isFunction(matchExpr)) {\n            return matchExpr(matchValue, context);\n        } else if (_.isRegExp(matchExpr)) {\n            return matchValue.match(matchExpr);\n        }\n    },\n\n    getChannel: function ($el, property) {\n        property = property.replace('data-f-', '');\n        var channel = $el.data('f-channel-' + property);\n        if (channel === undefined) {\n            channel = $el.attr('data-f-channel'); //.data shows value cached by jquery\n            if (channel === undefined) {\n                var $parentEl = $el.closest('[data-f-channel]');\n                if ($parentEl) {\n                    channel = $parentEl.attr('data-f-channel');\n                }\n            }\n        }\n        return channel;\n    },\n\n    getChannelConfig: function (el) {\n        var attrs = el.attributes;\n        var config = {};\n        for (var i = 0; i < attrs.length; i++) {\n            var attrib = el.attributes[i];\n            if (attrib.specified && attrib.name.indexOf('data-f-channel-') === 0) {\n                var key = attrib.name.replace('data-f-channel-', '');\n                config[key] = attrib.value;\n            }\n        }\n        return config;\n    },\n\n    getConvertersList: function ($el, property) {\n        var attrConverters = $el.data('f-convert-' + property);\n        //FIXME: figure out how not to hard-code names here\n        if (!attrConverters && (property === 'bind' || property === 'foreach' || property === 'repeat')) {\n            attrConverters = $el.attr('data-f-convert'); //.data shows value cached by jquery\n            if (!attrConverters) {\n                var $parentEl = $el.closest('[data-f-convert]');\n                if ($parentEl) {\n                    attrConverters = $parentEl.attr('data-f-convert');\n                }\n            }\n            if (attrConverters) {\n                attrConverters = attrConverters.split('|').map(function (v) {\n                    return v.trim();\n                });\n            }\n        }\n\n        return attrConverters;\n    }\n};\n\n/***/ }),\n/* 14 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/**\n * ## Converter Manager: Make your own Converters\n *\n * Converters allow you to convert data -- in particular, model variables that you display in your project's user interface -- from one form to another.\n *\n * Basic converting and formatting options are built in to Flow.js.\n *\n * You can also create your own converters. Each converter should be a function that takes in a value or values to convert. To use your converter, `register()` it in your instance of Flow.js.\n *\n */\n\n\n\nvar normalize = function (alias, converter, acceptList) {\n    var ret = [];\n    //nomalize('flip', fn)\n    if (_.isFunction(converter)) {\n        ret.push({\n            alias: alias,\n            convert: converter,\n            acceptList: acceptList\n        });\n    } else if ($.isPlainObject(converter) && converter.convert) {\n        converter.alias = alias;\n        converter.acceptList = acceptList;\n        ret.push(converter);\n    } else if ($.isPlainObject(alias)) {\n        //normalize({alias: 'flip', convert: function})\n        if (alias.convert) {\n            ret.push(alias);\n        } else {\n            // normalize({flip: fun})\n            $.each(alias, function (key, val) {\n                ret.push({\n                    alias: key,\n                    convert: val,\n                    acceptList: acceptList\n                });\n            });\n        }\n    }\n    return ret;\n};\n\nvar matchConverter = function (alias, converter) {\n    if (_.isString(converter.alias)) {\n        return alias === converter.alias;\n    } else if (_.isFunction(converter.alias)) {\n        return converter.alias(alias);\n    } else if (_.isRegex(converter.alias)) {\n        return converter.alias.match(alias);\n    }\n    return false;\n};\n\nvar converterManager = {\n    private: {\n        matchConverter: matchConverter\n    },\n\n    list: [],\n    /**\n     * Add a new attribute converter to this instance of Flow.js.\n     *\n     * **Example**\n     *\n     *      Flow.dom.converters.register('max', function (value) {\n     *          return _.max(value);\n     *      }, true);\n     *\n     *      Flow.dom.converters.register({\n     *          alias: 'sig',\n     *          parse: $.noop,\n     *          convert: function (value) {\n     *              return value.firstName + ' ' + value.lastName + ', ' + value.jobTitle;\n     *      }, false);\n     *\n     *      <div>\n     *          The largest sales you had was <span data-f-bind=\"salesByYear | max | $#,###\"></span>.\n     *          The current sales manager is <span data-f-bind=\"salesMgr | sig\"></span>.\n     *      </div>\n     *\n     * @param  {String|Function|Regex} alias Formatter name.\n     * @param  {Function|Object} converter If a function, `converter` is called with the value. If an object, should include fields for `alias` (name), `parse` (function), and `convert` (function).\n     * @param {Boolean} acceptList Determines if the converter is a 'list' converter or not. List converters take in arrays as inputs, others expect single values.\n     * @returns {undefined}\n     */\n    register: function (alias, converter, acceptList) {\n        var normalized = normalize(alias, converter, acceptList);\n        this.list = normalized.concat(this.list);\n    },\n\n    /**\n     * Replace an already registered converter with a new one of the same name.\n     *\n     * @param {String} alias Formatter name.\n     * @param {Function|Object} converter If a function, `converter` is called with the value. If an object, should include fields for `alias` (name), `parse` (function), and `convert` (function).\n     * @returns {undefined}\n     */\n    replace: function (alias, converter) {\n        var index;\n        _.each(this.list, function (currentConverter, i) {\n            if (matchConverter(alias, currentConverter)) {\n                index = i;\n                return false;\n            }\n        });\n        this.list.splice(index, 1, normalize(alias, converter)[0]);\n    },\n\n    getConverter: function (alias) {\n        return _.find(this.list, function (converter) {\n            return matchConverter(alias, converter);\n        });\n    },\n\n    /**\n     * Pipes the value sequentially through a list of provided converters.\n     *\n     * @param  {Any} value Input for the converter to tag.\n     * @param  {Array|Object} list List of converters (maps to converter alias).\n     *\n     * @return {Any} Converted value.\n     */\n    convert: function (value, list) {\n        if (!list || !list.length) {\n            return value;\n        }\n        list = [].concat(list).map(function (v) {\n            return v.trim();\n        });\n\n        var currentValue = value;\n        var me = this;\n\n        var convertArray = function (converter, val, converterName) {\n            return _.map(val, function (v) {\n                return converter.convert(v, converterName);\n            });\n        };\n        var convert = function (converter, value, converterName) {\n            var converted;\n            if (_.isArray(value) && converter.acceptList !== true) {\n                converted = convertArray(converter, value, converterName);\n            } else {\n                converted = converter.convert(value, converterName);\n            }\n            return converted;\n        };\n        var convertObject = function (converter, value, converterName) {\n            return _.mapValues(value, function (val) {\n                return convert(converter, val, converterName);\n            });\n        };\n        _.each(list, function (converterName) {\n            var converter = me.getConverter(converterName);\n            if (!converter) {\n                throw new Error('Could not find converter for ' + converterName);\n            }\n            if ($.isPlainObject(currentValue) && converter.acceptList !== true) {\n                currentValue = convertObject(converter, currentValue, converterName);\n            } else {\n                currentValue = convert(converter, currentValue, converterName);\n            }\n        });\n        return currentValue;\n    },\n\n    /**\n     * Counter-part to `convert()`. Translates converted values back to their original form.\n     *\n     * @param  {String} value Value to parse.\n     * @param  {String|Array} list  List of parsers to run the value through. Outermost is invoked first.\n     * @return {Any} Original value.\n     */\n    parse: function (value, list) {\n        if (!list || !list.length) {\n            return value;\n        }\n        list = [].concat(list).reverse().map(function (v) {\n            return v.trim();\n        });\n\n        var currentValue = value;\n        var me = this;\n        _.each(list, function (converterName) {\n            var converter = me.getConverter(converterName);\n            if (converter.parse) {\n                currentValue = converter.parse(currentValue, converterName);\n            }\n        });\n        return currentValue;\n    }\n};\n\n//Bootstrap\nvar defaultconverters = [__webpack_require__(15), __webpack_require__(16), __webpack_require__(17), __webpack_require__(18), __webpack_require__(19)];\n\n$.each(defaultconverters.reverse(), function (index, converter) {\n    if (_.isArray(converter)) {\n        _.each(converter, function (c) {\n            converterManager.register(c);\n        });\n    } else {\n        converterManager.register(converter);\n    }\n});\n\nmodule.exports = converterManager;\n\n/***/ }),\n/* 15 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/**\n * ## Number Converters\n *\n * Converters allow you to convert data -- in particular, model variables that you display in your project's user interface -- from one form to another.\n *\n * There are two ways to specify conversion or formatting for the display output of a particular model variable:\n *\n * * Add the attribute `data-f-convert` to any element that also has the `data-f-bind` or `data-f-foreach`.\n * * Use the `|` (pipe) character within the value of any `data-f-` attribute (not just `data-f-bind` or `data-f-foreach`).\n *\n */\n\n\n\nmodule.exports = {\n  /**\n   * Convert the model variable to an integer. Often used for chaining to another converter.\n   *\n   * **Example**\n   *\n   *      <div>\n   *          Your car has driven\n   *          <span data-f-bind=\"Odometer | i | s0.0\"></span> miles.\n   *      </div>\n   *\n   * @param {Array} value The model variable.\n   */\n  alias: 'i',\n  convert: function (value) {\n    return parseFloat(value, 10);\n  }\n};\n\n/***/ }),\n/* 16 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/**\n * ## String Converters\n *\n * Converters allow you to convert data -- in particular, model variables that you display in your project's user interface -- from one form to another.\n *\n * There are two ways to specify conversion or formatting for the display output of a particular model variable:\n *\n * * Add the attribute `data-f-convert` to any element that also has the `data-f-bind` or `data-f-foreach`.\n * * Use the `|` (pipe) character within the value of any `data-f-` attribute (not just `data-f-bind` or `data-f-foreach`).\n *\n * For model variables that are strings (or that have been converted to strings), there are several special string formats you can apply.\n */\n\n\n\nmodule.exports = {\n\n    /**\n     * Convert the model variable to a string. Often used for chaining to another converter.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          This year you are in charge of sales for\n     *          <span data-f-bind=\"salesMgr.region | s | upperCase\"></span>.\n     *      </div>\n     *\n     * @param {Array} val The model variable.\n     * @returns {String} converted string\n     */\n    s: function (val) {\n        return val + '';\n    },\n\n    /**\n     * Convert the model variable to UPPER CASE.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          This year you are in charge of sales for\n     *          <span data-f-bind=\"salesMgr.region | s | upperCase\"></span>.\n     *      </div>\n     *\n     * @param {Array} val The model variable.\n     * @returns {String} converted string\n     */\n    upperCase: function (val) {\n        return (val + '').toUpperCase();\n    },\n\n    /**\n     * Convert the model variable to lower case.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          Enter your user name:\n     *          <input data-f-bind=\"userName | lowerCase\"></input>.\n     *      </div>\n     *\n     * @param {Array} val The model variable.\n     * @returns {String} converted string\n     */\n    lowerCase: function (val) {\n        return (val + '').toLowerCase();\n    },\n\n    /**\n     * Convert the model variable to Title Case.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          Congratulations on your promotion!\n     *          Your new title is: <span data-f-bind=\"currentRole | titleCase\"></span>.\n     *      </div>\n     *\n     * @param {Array} val The model variable.\n     * @returns {String} converted string\n     */\n    titleCase: function (val) {\n        val = val + '';\n        return val.replace(/\\w\\S*/g, function (txt) {\n            return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();\n        });\n    }\n};\n\n/***/ }),\n/* 17 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/**\n * ## Array Converters\n *\n * Converters allow you to convert data -- in particular, model variables that you display in your project's user interface -- from one form to another.\n *\n * There are two ways to specify conversion or formatting for the display output of a particular model variable:\n *\n * * Add the attribute `data-f-convert` to any element that also has the `data-f-bind` or `data-f-foreach`.\n * * Use the `|` (pipe) character within the value of any `data-f-` attribute (not just `data-f-bind` or `data-f-foreach`).\n *\n * In general, if the model variable is an array, the converter is applied to each element of the array. There are a few built in array converters which, rather than converting all elements of an array, select particular elements from within the array or otherwise treat array variables specially.\n *\n */\n\n\n\nvar list = [{\n    /**\n     * Convert the input into an array. Concatenates all elements of the input.\n     *\n     * @param {Array} val The array model variable.\n     */\n    alias: 'list',\n    acceptList: true,\n    convert: function (val) {\n        return [].concat(val);\n    }\n}, {\n    /**\n     * Select only the last element of the array.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          In the current year, we have <span data-f-bind=\"Sales | last\"></span> in sales.\n     *      </div>\n     *\n     * @param {Array} val The array model variable.\n     */\n    alias: 'last',\n    acceptList: true,\n    convert: function (val) {\n        val = [].concat(val);\n        return val[val.length - 1];\n    }\n}, {\n    /**\n     * Reverse the array.\n     *\n     * **Example**\n     *\n     *      <p>Show the history of our sales, starting with the last (most recent):</p>\n     *      <ul data-f-foreach=\"Sales | reverse\">\n     *          <li></li>\n     *      </ul>\n     *\n     * @param {Array} val The array model variable.\n     */\n    alias: 'reverse',\n    acceptList: true,\n    convert: function (val) {\n        val = [].concat(val);\n        return val.reverse();\n    }\n}, {\n    /**\n     * Select only the first element of the array.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          Our initial investment was <span data-f-bind=\"Capital | first\"></span>.\n     *      </div>\n     *\n     * @param {Array} val The array model variable.\n     */\n    alias: 'first',\n    acceptList: true,\n    convert: function (val) {\n        val = [].concat(val);\n        return val[0];\n    }\n}, {\n    /**\n     * Select only the previous (second to last) element of the array.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          Last year we had <span data-f-bind=\"Sales | previous\"></span> in sales.\n     *      </div>\n     *\n     * @param {Array} val The array model variable.\n     */\n    alias: 'previous',\n    acceptList: true,\n    convert: function (val) {\n        val = [].concat(val);\n        return val.length <= 1 ? val[0] : val[val.length - 2];\n    }\n}];\n\n_.each(list, function (item) {\n    var oldfn = item.convert;\n    var newfn = function (val) {\n        if ($.isPlainObject(val)) {\n            return _.mapValues(val, oldfn);\n        }\n        return oldfn(val);\n    };\n    item.convert = newfn;\n});\nmodule.exports = list;\n\n/***/ }),\n/* 18 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar list = [];\n\nvar supported = ['values', 'keys', 'compact', 'difference', 'union', 'uniq', 'without', 'xor', 'zip'];\n_.each(supported, function (fn) {\n    var item = {\n        alias: fn,\n        acceptList: true,\n        convert: function (val) {\n            if ($.isPlainObject(val)) {\n                return _.mapValues(val, _[fn]);\n            }\n            return _[fn](val);\n        }\n    };\n    list.push(item);\n});\nmodule.exports = list;\n\n/***/ }),\n/* 19 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/**\n * ## Number Format Converters\n *\n * Converters allow you to convert data -- in particular, model variables that you display in your project's user interface -- from one form to another.\n *\n * There are two ways to specify conversion or formatting for the display output of a particular model variable:\n *\n * * Add the attribute `data-f-convert` to any element that also has the `data-f-bind` or `data-f-foreach`.\n * * Use the `|` (pipe) character within the value of any `data-f-` attribute (not just `data-f-bind` or `data-f-foreach`).\n *\n * For model variables that are numbers (or that have been [converted to numbers](../number-converter/)), there are several special number formats you can apply.\n *\n * ####Currency Number Format\n *\n * After the `|` (pipe) character, use `$` (dollar sign), `0`, and `.` (decimal point) in your converter to describe how currency should appear. The specifications follow the Excel currency formatting conventions.\n *\n * **Example**\n *\n *      <!-- convert to dollars (include cents) -->\n *      <input type=\"text\" data-f-bind=\"price[car]\" data-f-convert=\"$0.00\" />\n *      <input type=\"text\" data-f-bind=\"price[car] | $0.00\" />\n *\n *      <!-- convert to dollars (truncate cents) -->\n *      <input type=\"text\" data-f-bind=\"price[car]\" data-f-convert=\"$0.\" />\n *      <input type=\"text\" data-f-bind=\"price[car] | $0.\" />\n *\n *\n * ####Specific Digits Number Format\n *\n * After the `|` (pipe) character, use `#` (pound) and `,` (comma) in your converter to describe how the number should appear. The specifications follow the Excel number formatting conventions.\n *\n * **Example**\n *\n *      <!-- convert to thousands -->\n *      <input type=\"text\" data-f-bind=\"sales[car]\" data-f-convert=\"#,###\" />\n *      <input type=\"text\" data-f-bind=\"sales[car] | #,###\" />\n *\n *\n * ####Percentage Number Format\n *\n * After the `|` (pipe) character, use `%` (percent) and `0` in your converter to display the number as a percent.\n *\n * **Example**\n *\n *      <!-- convert to percentage -->\n *      <input type=\"text\" data-f-bind=\"profitMargin[car]\" data-f-convert=\"0%\" />\n *      <input type=\"text\" data-f-bind=\"profitMargin[car] | 0%\" />\n *\n *\n * ####Short Number Format\n *\n * After the `|` (pipe) character, use `s` and `0` in your converter to describe how the number should appear.\n *\n * The `0`s describe the significant digits.\n *\n * The `s` describes the \"short format,\" which uses 'K' for thousands, 'M' for millions, 'B' for billions. For example, `2468` converted with `s0.0` displays as `2.5K`.\n *\n * **Example**\n *\n *      <!-- convert to thousands (show 12,468 as 12.5K) -->\n *      <span type=\"text\" data-f-bind=\"price[car] | s0.0\"></span>\n *\n */\n\n\n\nmodule.exports = {\n    alias: function (name) {\n        //TODO: Fancy regex to match number formats here\n        return name.indexOf('#') !== -1 || name.indexOf('0') !== -1;\n    },\n\n    parse: function (val) {\n        val += '';\n        var isNegative = val.charAt(0) === '-';\n\n        val = val.replace(/,/g, '');\n        var floatMatcher = /([-+]?[0-9]*\\.?[0-9]+)(K?M?B?%?)/i;\n        var results = floatMatcher.exec(val);\n        var number;\n        var suffix = '';\n        if (results && results[1]) {\n            number = results[1];\n        }\n        if (results && results[2]) {\n            suffix = results[2].toLowerCase();\n        }\n\n        /*eslint no-magic-numbers: 0*/\n        switch (suffix) {\n            case '%':\n                number = number / 100;\n                break;\n            case 'k':\n                number = number * 1000;\n                break;\n            case 'm':\n                number = number * 1000000;\n                break;\n            case 'b':\n                number = number * 1000000000;\n                break;\n            default:\n        }\n        number = parseFloat(number);\n        if (isNegative && number > 0) {\n            number = number * -1;\n        }\n        return number;\n    },\n\n    convert: function (value) {\n        var scales = ['', 'K', 'M', 'B', 'T'];\n        function roundTo(value, digits) {\n            return Math.round(value * Math.pow(10, digits)) / Math.pow(10, digits);\n        }\n\n        function getDigits(value, digits) {\n            value = value === 0 ? 0 : roundTo(value, Math.max(0, digits - Math.ceil(Math.log(value) / Math.LN10)));\n\n            var TXT = '';\n            var numberTXT = value.toString();\n            var decimalSet = false;\n\n            for (var iTXT = 0; iTXT < numberTXT.length; iTXT++) {\n                TXT += numberTXT.charAt(iTXT);\n                if (numberTXT.charAt(iTXT) === '.') {\n                    decimalSet = true;\n                } else {\n                    digits--;\n                }\n\n                if (digits <= 0) {\n                    return TXT;\n                }\n            }\n\n            if (!decimalSet) {\n                TXT += '.';\n            }\n            while (digits > 0) {\n                TXT += '0';\n                digits--;\n            }\n            return TXT;\n        }\n\n        function addDecimals(value, decimals, minDecimals, hasCommas) {\n            hasCommas = !!hasCommas;\n            var numberTXT = value.toString();\n            var hasDecimals = numberTXT.split('.').length > 1;\n            var iDec = 0;\n\n            if (hasCommas) {\n                for (var iChar = numberTXT.length - 1; iChar > 0; iChar--) {\n                    if (hasDecimals) {\n                        hasDecimals = numberTXT.charAt(iChar) !== '.';\n                    } else {\n                        iDec = (iDec + 1) % 3;\n                        if (iDec === 0) {\n                            numberTXT = numberTXT.substr(0, iChar) + ',' + numberTXT.substr(iChar);\n                        }\n                    }\n                }\n            }\n            if (decimals > 0) {\n                var toADD;\n                if (numberTXT.split('.').length <= 1) {\n                    toADD = minDecimals;\n                    if (toADD > 0) {\n                        numberTXT += '.';\n                    }\n                } else {\n                    toADD = minDecimals - numberTXT.split('.')[1].length;\n                }\n\n                while (toADD > 0) {\n                    numberTXT += '0';\n                    toADD--;\n                }\n            }\n            return numberTXT;\n        }\n\n        function getSuffix(formatTXT) {\n            formatTXT = formatTXT.replace('.', '');\n            var fixesTXT = formatTXT.split(new RegExp('[0|,|#]+', 'g'));\n            return fixesTXT.length > 1 ? fixesTXT[1].toString() : '';\n        }\n\n        function isCurrency(string) {\n            // eslint-disable-line\n            var s = $.trim(string);\n\n            if (s === '$' || s === 'â‚¬' || s === 'Â¥' || s === 'Â£' || s === 'â‚¡' || s === 'â‚±' || s === 'KÄ?' || s === 'kr' || s === 'Â¢' || s === 'â‚ª' || s === 'Æ’' || s === 'â‚©' || s === 'â‚«') {\n\n                return true;\n            }\n\n            return false;\n        }\n\n        function format(number, formatTXT) {\n            // eslint-disable-line\n            if (_.isArray(number)) {\n                number = number[number.length - 1];\n            }\n            if (!_.isString(number) && !_.isNumber(number)) {\n                return number;\n            }\n\n            if (!formatTXT || formatTXT.toLowerCase() === 'default') {\n                return number.toString();\n            }\n\n            if (isNaN(number)) {\n                return '?';\n            }\n\n            //var formatTXT;\n            formatTXT = formatTXT.replace('&euro;', 'â‚¬');\n\n            // Divide +/- Number Format\n            var formats = formatTXT.split(';');\n            if (formats.length > 1) {\n                return format(Math.abs(number), formats[number >= 0 ? 0 : 1]);\n            }\n\n            // Save Sign\n            var sign = number >= 0 ? '' : '-';\n            number = Math.abs(number);\n\n            var leftOfDecimal = formatTXT;\n            var d = leftOfDecimal.indexOf('.');\n            if (d > -1) {\n                leftOfDecimal = leftOfDecimal.substring(0, d);\n            }\n\n            var normalized = leftOfDecimal.toLowerCase();\n            var index = normalized.lastIndexOf('s');\n            var isShortFormat = index > -1;\n\n            if (isShortFormat) {\n                var nextChar = leftOfDecimal.charAt(index + 1);\n                if (nextChar === ' ') {\n                    isShortFormat = false;\n                }\n            }\n\n            var leadingText = isShortFormat ? formatTXT.substring(0, index) : '';\n            var rightOfPrefix = isShortFormat ? formatTXT.substr(index + 1) : formatTXT.substr(index);\n\n            //first check to make sure 's' is actually short format and not part of some leading text\n            if (isShortFormat) {\n                var shortFormatTest = /[0-9#*]/;\n                var shortFormatTestResult = rightOfPrefix.match(shortFormatTest);\n                if (!shortFormatTestResult || shortFormatTestResult.length === 0) {\n                    //no short format characters so this must be leading text ie. 'weeks '\n                    isShortFormat = false;\n                    leadingText = '';\n                }\n            }\n\n            //if (formatTXT.charAt(0) == 's')\n            if (isShortFormat) {\n                var valScale = number === 0 ? 0 : Math.floor(Math.log(Math.abs(number)) / (3 * Math.LN10));\n                valScale = number / Math.pow(10, 3 * valScale) < 1000 ? valScale : valScale + 1;\n                valScale = Math.max(valScale, 0);\n                valScale = Math.min(valScale, 4);\n                number = number / Math.pow(10, 3 * valScale);\n                //if (!isNaN(Number(formatTXT.substr(1) ) ) )\n\n                if (!isNaN(Number(rightOfPrefix)) && rightOfPrefix.indexOf('.') === -1) {\n                    var limitDigits = Number(rightOfPrefix);\n                    if (number < Math.pow(10, limitDigits)) {\n                        if (isCurrency(leadingText)) {\n                            return sign + leadingText + getDigits(number, Number(rightOfPrefix)) + scales[valScale];\n                        } else {\n                            return leadingText + sign + getDigits(number, Number(rightOfPrefix)) + scales[valScale];\n                        }\n                    } else if (isCurrency(leadingText)) {\n                        return sign + leadingText + Math.round(number) + scales[valScale];\n                    } else {\n                        return leadingText + sign + Math.round(number) + scales[valScale];\n                    }\n                } else {\n                    //formatTXT = formatTXT.substr(1);\n                    formatTXT = formatTXT.substr(index + 1);\n                    var SUFFIX = getSuffix(formatTXT);\n                    formatTXT = formatTXT.substr(0, formatTXT.length - SUFFIX.length);\n\n                    var valWithoutLeading = format((sign === '' ? 1 : -1) * number, formatTXT) + scales[valScale] + SUFFIX;\n                    if (isCurrency(leadingText) && sign !== '') {\n                        valWithoutLeading = valWithoutLeading.substr(sign.length);\n                        return sign + leadingText + valWithoutLeading;\n                    }\n\n                    return leadingText + valWithoutLeading;\n                }\n            }\n\n            var subFormats = formatTXT.split('.');\n            var decimals;\n            var minDecimals;\n            if (subFormats.length > 1) {\n                decimals = subFormats[1].length - subFormats[1].replace(new RegExp('[0|#]+', 'g'), '').length;\n                minDecimals = subFormats[1].length - subFormats[1].replace(new RegExp('0+', 'g'), '').length;\n                formatTXT = subFormats[0] + subFormats[1].replace(new RegExp('[0|#]+', 'g'), '');\n            } else {\n                decimals = 0;\n            }\n\n            var fixesTXT = formatTXT.split(new RegExp('[0|,|#]+', 'g'));\n            var preffix = fixesTXT[0].toString();\n            var suffix = fixesTXT.length > 1 ? fixesTXT[1].toString() : '';\n\n            number = number * (formatTXT.split('%').length > 1 ? 100 : 1);\n            //            if (formatTXT.indexOf('%') !== -1) number = number * 100;\n            number = roundTo(number, decimals);\n\n            sign = number === 0 ? '' : sign;\n\n            var hasCommas = formatTXT.substr(formatTXT.length - 4 - suffix.length, 1) === ',';\n            var formatted = sign + preffix + addDecimals(number, decimals, minDecimals, hasCommas) + suffix;\n\n            //  console.log(originalNumber, originalFormat, formatted)\n            return formatted;\n        }\n\n        return format;\n    }()\n};\n\n/***/ }),\n/* 20 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar normalize = function (selector, handler) {\n    if (_.isFunction(handler)) {\n        handler = {\n            handle: handler\n        };\n    }\n    if (!selector) {\n        selector = '*';\n    }\n    handler.selector = selector;\n    return handler;\n};\n\nvar match = function (toMatch, node) {\n    if (_.isString(toMatch)) {\n        return toMatch === node.selector;\n    }\n    return $(toMatch).is(node.selector);\n};\n\nvar nodeManager = {\n    list: [],\n\n    /**\n     * Add a new node handler\n     * @param  {string} selector jQuery-compatible selector to use to match nodes\n     * @param  {function} handler  Handlers are new-able functions. They will be called with $el as context.? TODO: Think this through\n     * @returns {undefined}\n     */\n    register: function (selector, handler) {\n        this.list.unshift(normalize(selector, handler));\n    },\n\n    getHandler: function (selector) {\n        return _.find(this.list, function (node) {\n            return match(selector, node);\n        });\n    },\n\n    replace: function (selector, handler) {\n        var index;\n        _.each(this.list, function (currentHandler, i) {\n            if (selector === currentHandler.selector) {\n                index = i;\n                return false;\n            }\n        });\n        this.list.splice(index, 1, normalize(selector, handler));\n    }\n};\n\n//bootstraps\nvar defaultHandlers = [__webpack_require__(21), __webpack_require__(7), __webpack_require__(8)];\n_.each(defaultHandlers.reverse(), function (handler) {\n    nodeManager.register(handler.selector, handler);\n});\n\nmodule.exports = nodeManager;\n\n/***/ }),\n/* 21 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar BaseView = __webpack_require__(7);\n\nmodule.exports = BaseView.extend({\n\n    propertyHandlers: [],\n\n    getUIValue: function () {\n        var $el = this.$el;\n        var offVal = typeof $el.data('f-off') !== 'undefined' ? $el.data('f-off') : false;\n        //attr = initial value, prop = current value\n        var onVal = typeof $el.attr('value') !== 'undefined' ? $el.prop('value') : true;\n\n        var val = $el.is(':checked') ? onVal : offVal;\n        return val;\n    },\n    initialize: function () {\n        BaseView.prototype.initialize.apply(this, arguments);\n    }\n}, { selector: ':checkbox,:radio' });\n\n/***/ }),\n/* 22 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/**\n * ## Attribute Manager\n *\n * Flow.js provides a set of custom DOM attributes that serve as a data binding between variables and operations in your project's model and HTML elements in your project's user interface. Under the hood, Flow.js is doing automatic conversion of these custom attributes, like `data-f-bind`, into HTML specific to the attribute's assigned value, like the current value of `myModelVar`.\n *\n * If you are looking for examples of using particular attributes, see the [specific attributes subpages](../../../../attributes-overview/).\n *\n * If you would like to extend Flow.js with your own custom attributes, you can add them to Flow.js using the Attribute Manager.\n *\n * The Attribute Manager is specific to adding custom attributes and describing their implementation (handlers). (The [Dom Manager](../../) contains the general implementation.)\n *\n *\n * **Examples**\n *\n * Built-in attribute handlers like `data-f-value` and `data-f-foreach` automatically bind variables in your project's model to particular HTML elements. However, your UI may sometimes require displaying only part of the variable (e.g. if it's an object), or \"doing something\" with the value of the variable, rather than simply displaying it.\n *\n * One example of when custom attribute handlers are useful is when your model variable is a complex object and you want to display the fields in a particular way, or you only want to display some of the fields. While the combination of the [`data-f-foreach` attribute](../foreach/default-foreach-attr/) and [templating](../../../../#templates) can help with this, sometimes it's easier to write your own attribute handler. (This is especially true if you will be reusing the attribute handler -- you won't have to copy your templating code over and over.)\n *\n *      Flow.dom.attributes.register('showSched', '*', function (sched) {\n *            // display all the schedule milestones\n *            // sched is an object, each element is an array\n *            // of ['Formal Milestone Name', milestoneMonth, completionPercentage]\n *\n *            var schedStr = '<ul>';\n *            var sortedSched = _.sortBy(sched, function(el) { return el[1]; });\n *\n *            for (var i = 0; i < sortedSched.length; i++) {\n *                  schedStr += '<li><strong>' + sortedSched[i][0]\n *                        + '</strong> currently scheduled for <strong>Month '\n *                        + sortedSched[i][1] + '</strong></li>';\n *            }\n *            schedStr += '</ul>';\n *\n *            this.html(schedStr);\n *      });\n *\n * Then, you can use the attribute handler in your HTML just like other Flow.js attributes:\n *\n *      <div data-f-showSched=\"schedule\"></div>\n *\n */\n\n\n\nvar defaultHandlers = [__webpack_require__(23),\n// require('./events/init-event-attr'),\n__webpack_require__(24), __webpack_require__(25), __webpack_require__(26), __webpack_require__(27), __webpack_require__(28), __webpack_require__(29), __webpack_require__(30), __webpack_require__(31), __webpack_require__(32), __webpack_require__(33)];\n\nvar handlersList = [];\n\nvar normalize = function (attributeMatcher, nodeMatcher, handler) {\n    if (!nodeMatcher) {\n        nodeMatcher = '*';\n    }\n    if (_.isFunction(handler)) {\n        handler = {\n            handle: handler\n        };\n    }\n    return $.extend(handler, { test: attributeMatcher, target: nodeMatcher });\n};\n\n$.each(defaultHandlers, function (index, handler) {\n    handlersList.push(normalize(handler.test, handler.target, handler));\n});\n\nvar matchAttr = function (matchExpr, attr, $el) {\n    var attrMatch;\n\n    if (_.isString(matchExpr)) {\n        attrMatch = matchExpr === '*' || matchExpr.toLowerCase() === attr.toLowerCase();\n    } else if (_.isFunction(matchExpr)) {\n        //TODO: remove element selectors from attributes\n        attrMatch = matchExpr(attr, $el);\n    } else if (_.isRegExp(matchExpr)) {\n        attrMatch = attr.match(matchExpr);\n    }\n    return attrMatch;\n};\n\nvar matchNode = function (target, nodeFilter) {\n    return _.isString(nodeFilter) ? nodeFilter === target : nodeFilter.is(target);\n};\n\nmodule.exports = {\n    list: handlersList,\n    /**\n     * Add a new attribute handler.\n     *\n     * @param  {String|Function|Regex} attributeMatcher Description of which attributes to match.\n     * @param  {String} nodeMatcher Which nodes to add attributes to. Use [jquery Selector syntax](https://api.jquery.com/category/selectors/).\n     * @param  {Function|Object} handler If `handler` is a function, the function is called with `$element` as context, and attribute value + name. If `handler` is an object, it should include two functions, and have the form: `{ init: fn,  handle: fn }`. The `init` function is called when the page loads; use this to define event handlers. The `handle` function is called with `$element` as context, and attribute value + name.\n     * @returns {undefined}\n     */\n    register: function (attributeMatcher, nodeMatcher, handler) {\n        handlersList.unshift(normalize.apply(null, arguments));\n    },\n\n    /**\n     * Find an attribute matcher matching some criteria.\n     *\n     * @param  {String} attrFilter Attribute to match.\n     * @param  {String|$el} nodeFilter Node to match.\n     *\n     * @return {Array|Null} An array of matching attribute handlers, or null if no matches found.\n     */\n    filter: function (attrFilter, nodeFilter) {\n        var filtered = _.filter(handlersList, function (handler) {\n            return matchAttr(handler.test, attrFilter);\n        });\n        if (nodeFilter) {\n            filtered = _.filter(filtered, function (handler) {\n                return matchNode(handler.target, nodeFilter);\n            });\n        }\n        return filtered;\n    },\n\n    /**\n     * Replace an existing attribute handler.\n     *\n     * @param  {String} attrFilter Attribute to match.\n     * @param  {String | $el} nodeFilter Node to match.\n     * @param  {Function|Object} handler The updated attribute handler. If `handler` is a function, the function is called with `$element` as context, and attribute value + name. If `handler` is an object, it should include two functions, and have the form: `{ init: fn,  handle: fn }`. The `init` function is called when the page loads; use this to define event handlers. The `handle` function is called with `$element` as context, and attribute value + name.\n     * @returns {undefined}\n     */\n    replace: function (attrFilter, nodeFilter, handler) {\n        var index;\n        _.each(handlersList, function (currentHandler, i) {\n            if (matchAttr(currentHandler.test, attrFilter) && matchNode(currentHandler.target, nodeFilter)) {\n                index = i;\n                return false;\n            }\n        });\n        handlersList.splice(index, 1, normalize(attrFilter, nodeFilter, handler));\n    },\n\n    /**\n     *  Retrieve the appropriate handler for a particular attribute. There may be multiple matching handlers, but the first (most exact) match is always used.\n     *\n     * @param {String} property The attribute.\n     * @param {$el} $el The DOM element.\n     *\n     * @return {Object} The attribute handler.\n     */\n    getHandler: function (property, $el) {\n        var filtered = this.filter(property, $el);\n        //There could be multiple matches, but the top first has the most priority\n        return filtered[0];\n    }\n};\n\n/***/ }),\n/* 23 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/**\n * ## No-op Attributes\n *\n * Flow.js provides special handling for both `data-f-model` (described [here](../../../../#using_in_project)) and `data-f-convert` (described [here](../../../../converter-overview/)). For these attributes, the default behavior is to do nothing, so that this additional special handling can take precendence.\n *\n */\n\n\n\n// Attributes which are just parameters to others and can just be ignored\n\nmodule.exports = {\n\n    target: '*',\n\n    test: /^(?:model|convert|channel)/i,\n\n    handle: $.noop,\n\n    init: function () {\n        return false;\n    }\n};\n\n/***/ }),\n/* 24 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/**\n * ## Call Operation in Response to User Action\n *\n * Many models call particular operations in response to end user actions, such as clicking a button or submitting a form.\n *\n * #### data-f-on-event\n *\n * For any HTML attribute using `on` -- typically on click or on submit -- you can add the attribute `data-f-on-XXX`, and set the value to the name of the operation. To call multiple operations, use the `|` (pipe) character to chain operations. Operations are called serially, in the order listed.\n *\n * **Example**\n *\n *      <button data-f-on-click=\"reset\">Reset</button>\n *\n *      <button data-f-on-click=\"step(1)\">Advance One Step</button>\n *\n */\n\n\n\nvar config = __webpack_require__(0);\nvar toOperationFormat = __webpack_require__(3).toOperationFormat;\n\nmodule.exports = {\n\n    target: '*',\n\n    test: function (attr, $node) {\n        return attr.indexOf('on-') === 0;\n    },\n\n    unbind: function (attr) {\n        attr = attr.replace('on-', '');\n        this.off(attr);\n    },\n\n    init: function (attr, value) {\n        attr = attr.replace('on-', '');\n        var me = this;\n        this.off(attr).on(attr, function () {\n            var listOfOperations = toOperationFormat(value);\n            me.trigger(config.events.operate, { operations: listOfOperations });\n        });\n        return false; //Don't bother binding on this attr. NOTE: Do readonly, true instead?;\n    }\n};\n\n/***/ }),\n/* 25 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/**\n * ## Display Array and Object Variables: data-f-foreach\n *\n * If your model variable is an array, you can reference specific elements of the array using `data-f-bind`: `data-f-bind=\"sales[3]\"` or `data-f-bind=\"sales[<currentRegion>]\"`, as described under [data-f-bind](../../binds/default-bind-attr/).\n *\n * However, sometimes you want to loop over *all* of the children of the referenced variable. The `data-f-foreach` attribute allows you to automatically loop over all the 'children' of a referenced variable &mdash; that is, all the elements of an array, or all the fields of an object.\n *\n * You can use the `data-f-foreach` attribute to name the variable, then use a combination of templates and aliases to access the index and value of each child for display. (Templates are available as part of Flow.js's lodash dependency. See more background on [working with templates](../../../../../#templates).)\n *\n * **To display a DOM element based on an array variable from your model:**\n *\n * 1. Add the `data-f-foreach` attribute to any HTML element that has repeated sub-elements. The two most common examples are lists and tables. The `data-f-foreach` goes on the enclosing element. For a list, this is the `<ul>`, and for a table, it's the `<tbody>`.\n * 2. Set the value of the `data-f-foreach` attribute in your top-level HTML element to reference the model array variable. You can do this either with or without introducing an alias to reference the array elements: `<ul data-f-foreach=\"Time\"></ul>` or `<ul data-f-foreach=\"t in Time\"></ul>`.\n * 3. Add the HTML in which the value of your model array variable should appear. Optionally, inside this inner HTML element, you can use templates (`<%= %>`) to reference the `index` (for arrays) or `key` (for objects) and `value` to display, or to reference the alias you introduced. The `index`, `key`, and `value` are special variables that Flow.js populates for you. \n *\n *\n * **Examples:**\n *\n * **Basic use of data-f-foreach.** Start with an HTML element that has repeated sub-elements. Add the model variable to this HTML element. Then, add the HTML sub-element where your model variable should appear. \n *\n * By default, the `value` of the array element or object field is automatically added to the generated HTML:\n *\n *      <!-- the model variable Time is an array of years\n *          create a list that shows which year -->\n *\n *      <ul data-f-foreach=\"Time\">\n *          <li></li>\n *      </ul>\n *\n * In the third step of the model, this example generates the HTML:\n *\n *      <ul data-f-foreach=\"Time\">\n *            <li>2015</li>\n *            <li>2016</li>\n *            <li>2017</li>\n *      </ul>\n *\n * which appears as:\n *\n *      * 2015\n *      * 2016\n *      * 2017\n *\n * **Add templates to reference the index and value.** Optionally, you can use templates (`<%= %>`) to reference the `index` and `value` of the array element to display.\n *\n *      <!-- the model variable Time is an array of years\n *          create a list that shows which year -->\n *\n *      <ul data-f-foreach=\"Time\">\n *          <li> Year <%= index %>: <%= value %> </li>\n *      </ul>\n *\n * In the third step of the model, this example generates:\n *\n *      <ul data-f-foreach=\"Time\">\n *          <li>Year 1: 2015</li>\n *          <li>Year 2: 2016</li>\n *          <li>Year 3: 2017</li>\n *      </ul>\n *\n * which appears as:\n *\n *      * Year 1: 2015\n *      * Year 2: 2016\n *      * Year 3: 2017\n *\n *\n * **Add an alias for the value.** Alternatively, you can add an alias when you initially introduce your model array variable, then reference that alias within templates (`<%= %>`). For example:\n *\n *      <ul data-f-foreach=\"f in Fruits\">\n *          <li> <%= f %> </li>\n *      </ul>\n *\n * which generates:\n *\n *      <ul data-f-foreach=\"f in Fruits\">\n *          <li> apples </li>\n *          <li> bananas </li>\n *          <li> cherries </li>\n *          <li> oranges </li>\n * \n * **Nesting with aliases.** An advantage to introducing aliases is that you can nest HTML elements that have repeated sub-elements. For example:\n *\n *      <!-- given Sales, an array whose elements are themselves arrays of the sales for each Region -->\n *      <ul data-f-foreach=\"r in Regions\">\n *          <li>Region <%= r %>: \n *              <ul data-f-foreach=\"s in Sales[<%= r %>]\">\n *                  <li>Sales <%= s %></li>\n *              </ul>\n *          </li>\n *      </ul>\n *\n * **Logic, data processing.** Finally, note that you can add logic to the display of your data by combining templating with either the `value` or an alias. For example, suppose you only want to display the sales total if it is greater than 250:\n *\n *      <table>\n *          <tbody data-f-foreach=\"r in regions\">\n *              <tr data-f-foreach=\"s in sales\">\n *                  <td><%= r + \": \" %> <%= (s > 250) ? s : \"sales below threshold\" %></td>\n *              </tr>\n *          </tbody>\n *      </table>\n *\n * (However, if you want to completely hide the table cell for the region if the sales total is too low, you still need to [write your own converter](../../../../../converter-overview).)\n *\n * **Notes:**\n *\n * * You can use the `data-f-foreach` attribute with both arrays and objects. If the model variable is an object, reference the `key` instead of the `index` in your templates.\n * * You can use nested `data-f-foreach` attributes to created nested loops of your data. \n * * The `data-f-foreach`, whether using aliases or not, goes on the enclosing element. For a list, this is the `<ul>`, and for a table, it's the `<tbody>`.\n * * The template syntax is to enclose each code fragment (including `index`, `key`, `variable`, or alias) in `<%=` and `%>`. Templates are available as part of Flow.js's lodash dependency. See more background on [working with templates](../../../../../#templates).\n * * The `key`, `index`, and `value` are special variables that Flow.js populates for you. However, they are *no longer available* if you use aliases.\n * * As with other `data-f-` attributes, you can specify [converters](../../../../../converter-overview) to convert data from one form to another:\n *\n *          <ul data-f-foreach=\"Sales | $x,xxx\">\n *              <li> Year <%= index %>: Sales of <%= value %> </li>\n *          </ul>\n *\n * * The `data-f-foreach` attribute is [similar to the `data-f-repeat` attribute](../../repeat-attr/), so you may want to review the examples there as well.\n */\n\n\n\nvar parseUtils = __webpack_require__(3);\nvar config = __webpack_require__(0);\n\nfunction refToMarkup(refKey) {\n    return '<!--' + refKey + '-->';\n}\n\nmodule.exports = {\n\n    test: 'foreach',\n\n    target: '*',\n\n    unbind: function (attr) {\n        var template = this.data(config.attrs.foreachTemplate);\n        if (template) {\n            this.html(template);\n            this.removeData(config.attrs.foreachTemplate);\n            this.removeData(config.attrs.keyAs);\n            this.removeData(config.attrs.valueAs);\n        }\n    },\n\n    parse: function (attrVal) {\n        var inMatch = attrVal.match(/(.*) (?:in|of) (.*)/);\n        if (inMatch) {\n            var itMatch = inMatch[1].match(/\\((.*),(.*)\\)/);\n            if (itMatch) {\n                this.data(config.attrs.keyAs, itMatch[1].trim());\n                this.data(config.attrs.valueAs, itMatch[2].trim());\n            } else {\n                this.data(config.attrs.valueAs, inMatch[1].trim());\n            }\n            attrVal = inMatch[2];\n        }\n        return attrVal;\n    },\n\n    handle: function (value, prop) {\n        value = $.isPlainObject(value) ? value : [].concat(value);\n        var loopTemplate = this.data(config.attrs.foreachTemplate);\n        if (!loopTemplate) {\n            loopTemplate = this.html();\n            this.data(config.attrs.foreachTemplate, loopTemplate);\n        }\n        var $me = this.empty();\n        var cloop = loopTemplate.replace(/&lt;/g, '<').replace(/&gt;/g, '>');\n\n        var defaultKey = $.isPlainObject(value) ? 'key' : 'index';\n        var keyAttr = $me.data(config.attrs.keyAs) || defaultKey;\n        var valueAttr = $me.data(config.attrs.valueAs) || 'value';\n\n        var keyRegex = new RegExp('\\\\b' + keyAttr + '\\\\b');\n        var valueRegex = new RegExp('\\\\b' + valueAttr + '\\\\b');\n\n        var closestKnownDataEl = this.closest('[data-current-index]');\n        var knownData = {};\n        if (closestKnownDataEl.length) {\n            knownData = closestKnownDataEl.data('current-index');\n        }\n        var closestParentWithMissing = this.closest('[data-missing-references]');\n        if (closestParentWithMissing.length) {\n            //(grand)parent already stubbed out missing references\n            var missing = closestParentWithMissing.data('missing-references');\n            _.each(missing, function (replacement, template) {\n                if (keyRegex.test(template) || valueRegex.test(template)) {\n                    cloop = cloop.replace(refToMarkup(replacement), template);\n                }\n            });\n        } else {\n            var missingReferences = {};\n            var templateTagsUsed = cloop.match(/<%[=-]?([\\s\\S]+?)%>/g);\n            if (templateTagsUsed) {\n                templateTagsUsed.forEach(function (tag) {\n                    if (tag.match(/\\w+/) && !keyRegex.test(tag) && !valueRegex.test(tag)) {\n                        var refKey = missingReferences[tag];\n                        if (!refKey) {\n                            refKey = _.uniqueId('no-ref');\n                            missingReferences[tag] = refKey;\n                        }\n                        var r = new RegExp(tag, 'g');\n                        cloop = cloop.replace(r, refToMarkup(refKey));\n                    }\n                });\n            }\n            if (_.size(missingReferences)) {\n                //Attr, not data, to make jQ selector easy. No f- prefix to keep this from flow.\n                this.attr('data-missing-references', JSON.stringify(missingReferences));\n            }\n        }\n\n        var templateFn = _.template(cloop);\n        _.each(value, function (dataval, datakey) {\n            if (!dataval) {\n                dataval = dataval + '';\n            }\n            var templateData = {};\n            templateData[keyAttr] = datakey;\n            templateData[valueAttr] = dataval;\n\n            $.extend(templateData, knownData);\n\n            var nodes;\n            var isTemplated;\n            try {\n                var templatedLoop = templateFn(templateData);\n                isTemplated = templatedLoop !== cloop;\n                nodes = $(templatedLoop);\n            } catch (e) {\n                //you don't have all the references you need;\n                nodes = $(cloop);\n                isTemplated = true;\n                $(nodes).attr('data-current-index', JSON.stringify(templateData));\n            }\n\n            nodes.each(function (i, newNode) {\n                newNode = $(newNode);\n                _.each(newNode.data(), function (val, key) {\n                    newNode.data(key, parseUtils.toImplicitType(val));\n                });\n                if (!isTemplated && !newNode.html().trim()) {\n                    newNode.html(dataval);\n                }\n            });\n            $me.append(nodes);\n        });\n    }\n};\n\n/***/ }),\n/* 26 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/**\n * ## Checkboxes and Radio Buttons\n *\n * In the [default case](../default-bind-attr/), the `data-f-bind` attribute creates a bi-directional binding between the DOM element and the model variable. This binding is **bi-directional**, meaning that as the model changes, the interface is automatically updated; and when end users change values in the interface, the model is automatically updated.\n *\n * Flow.js provides special handling for DOM elements with `type=\"checkbox\"` and `type=\"radio\"`.\n *\n * In particular, if you add the `data-f-bind` attribute to an `input` with `type=\"checkbox\"` and `type=\"radio\"`, the checkbox or radio button is automatically selected if the `value` matches the value of the model variable referenced, or if the model variable is `true`.\n *\n * **Example**\n *\n *      <!-- radio button, selected if sampleInt is 8 -->\n *      <input type=\"radio\" data-f-bind=\"sampleInt\" value=\"8\" />\n *\n *      <!-- checkbox, checked if sampleBool is true -->\n *      <input type=\"checkbox\" data-f-bind=\"sampleBool\" />\n *\n */\n\n\n\nmodule.exports = {\n\n    target: ':checkbox,:radio',\n\n    test: 'bind',\n\n    handle: function (value) {\n        if (_.isArray(value)) {\n            value = value[value.length - 1];\n        }\n        var settableValue = this.attr('value'); //initial value\n        var isChecked = typeof settableValue !== 'undefined' ? settableValue == value : !!value; //eslint-disable-line eqeqeq\n        this.prop('checked', isChecked);\n    }\n};\n\n/***/ }),\n/* 27 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/**\n * ## Inputs and Selects\n *\n * In the [default case](../default-bind-attr/), the `data-f-bind` attribute creates a bi-directional binding between the DOM element and the model variable. This binding is **bi-directional**, meaning that as the model changes, the interface is automatically updated; and when end users change values in the interface, the model is automatically updated.\n *\n * Flow.js provides special handling for DOM elements `input` and `select`.\n *\n * In particular, if you add the `data-f-bind` attribute to a `select` or `input` element, the option matching the value of the model variable is automatically selected.\n *\n * **Example**\n *\n * \t\t<!-- option selected if sample_int is 8, 10, or 12 -->\n * \t\t<select data-f-bind=\"sample_int\">\n * \t\t\t<option value=\"8\"> 8 </option>\n * \t\t\t<option value=\"10\"> 10 </option>\n * \t\t\t<option value=\"12\"> 12 </option>\n * \t\t</select>\n *\n */\n\n\n\nmodule.exports = {\n    target: 'input, select',\n\n    test: 'bind',\n\n    handle: function (value) {\n        if (_.isArray(value)) {\n            value = value[value.length - 1];\n        }\n        this.val(value);\n    }\n};\n\n/***/ }),\n/* 28 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/**\n * ## Class Attribute: data-f-class\n *\n * You can bind model variables to names of CSS classes, so that you can easily change the styling of HTML elements based on the values of model variables.\n *\n * **To bind model variables to CSS classes:**\n *\n * 1. Add the `data-f-class` attribute to an HTML element.\n * 2. Set the value to the name of the model variable.\n * 3. Optionally, add an additional `class` attribute to the HTML element.\n *      * If you only use the `data-f-class` attribute, the value of `data-f-class` is the class name.\n *      * If you *also* add a `class` attribute, the value of `data-f-class` is *appended* to the class name.\n * 4. Add classes to your CSS code whose names include possible values of that model variable.\n *\n * **Example**\n *\n *      <style type=\"text/css\">\n *          .North { color: grey }\n *          .South { color: purple }\n *          .East { color: blue }\n *          .West { color: orange }\n *          .sales.good { color: green }\n *          .sales.bad { color: red }\n *          .sales.value-100 { color: yellow }\n *       </style>\n *\n *       <div data-f-class=\"salesMgr.region\">\n *           Content colored by region\n *       </div>\n *\n *       <div data-f-class=\"salesMgr.performance\" class=\"sales\">\n *           Content green if salesMgr.performance is good, red if bad\n *       </div>\n *\n *       <div data-f-class=\"salesMgr.numRegions\" class=\"sales\">\n *           Content yellow if salesMgr.numRegions is 100\n *       </div>\n *\n */\n\n\n\nvar config = __webpack_require__(0);\n\nmodule.exports = {\n\n    test: 'class',\n\n    target: '*',\n\n    handle: function (value, prop) {\n        if (_.isArray(value)) {\n            value = value[value.length - 1];\n        }\n\n        var addedClasses = this.data(config.classesAdded);\n        if (!addedClasses) {\n            addedClasses = {};\n        }\n        if (addedClasses[prop]) {\n            this.removeClass(addedClasses[prop]);\n        }\n\n        if (_.isNumber(value)) {\n            value = 'value-' + value;\n        }\n        addedClasses[prop] = value;\n        //Fixme: prop is always \"class\"\n        this.addClass(value);\n        this.data(config.classesAdded, addedClasses);\n    }\n};\n\n/***/ }),\n/* 29 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/**\n * ## Display Array Variables: data-f-repeat\n *\n * The `data-f-repeat` attribute allows you to automatically loop over a referenced variable. The most common use case is in time-based models, like those written in [SimLang](../../../../../model_code/forio_simlang/) or [Vensim](../../../../../model_code/vensim/), when you want to report the value of the variable at every time step so far. The `data-f-repeat` attribute automatically repeats the DOM element it's attached to, filling in the value.\n *\n * **To display a DOM element repeatedly based on an array variable from the model:**\n *\n * 1. Add the `data-f-repeat` attribute to any HTML element that has repeated sub-elements. The two most common examples are lists and tables.\n * 2. Set the value of the `data-f-repeat` attribute in the HTML element you want to repeat to the name of the array variable.\n * 3. Optionally, you can use templates (`<%= %>`) to reference the `index` (for arrays) or `key` (for objects) and `value` to display. The `index`, `key`, and `value` are special variables that Flow.js populates for you.\n *\n *\n * **Examples:**\n *\n * For example, to create a table that displays the year and cost for every step of the model that has occurred so far:\n *\n *      <table>\n *          <tr>\n *              <td>Year</td>\n *              <td data-f-repeat=\"Cost[Products]\"><%= index + 1 %></td>\n *          </tr>\n *          <tr>\n *              <td>Cost of Products</td>\n *              <td data-f-repeat=\"Cost[Products]\"></td>\n *          </tr>\n *      </table>\n *\n * In the third step of the model, this example generates the HTML:\n *\n *      <table>\n *          <tr>\n *              <td>Year</td>\n *              <td data-f-repeat=\"Cost[Products]\">1</td>\n *              <td>2</td>\n *              <td>3</td>\n *          </tr>\n *          <tr>\n *              <td>Cost of Products</td>\n *              <td data-f-repeat=\"Cost[Products]\">100</td>\n *              <td>102</td>\n *              <td>105</td>\n *          </tr>\n *      </table>\n *\n * You can also use this with a `<div>` and have the `<div>` itself repeated. For example:\n *\n *      <div data-f-repeat=\"sample_array\"></div>\n *\n * generates:\n *\n *      <div data-f-repeat=\"sample_array\">2</div>\n *      <div>4</div>\n *      <div>6</div>\n *\n * **Notes:**\n *\n * * You can use the `data-f-repeat` attribute with both arrays and objects. If the model variable is an object, reference the `key` instead of the `index` in your templates.\n * * The `key`, `index`, and `value` are special variables that Flow.js populates for you.\n * * The template syntax is to enclose each keyword (`index`, `key`, `variable`) in `<%=` and `%>`. Templates are available as part of Flow.js's lodash dependency. See more background on [working with templates](../../../../#templates).\n * * In most cases the same effect can be achieved with the [`data-f-foreach` attribute](../../attributes/foreach/default-foreach-attr/), which is similar. In the common use case of a table of data displayed over time, the `data-f-repeat` can be more concise and easier to read. However, the `data-f-foreach` allows aliasing, and so can be more useful especially if you are nesting HTML elements or want to introduce logic about how to display the values.\n *\n */\n\n\n\nvar parseUtils = __webpack_require__(3);\nvar gutils = __webpack_require__(5);\nvar config = __webpack_require__(0).attrs;\nmodule.exports = {\n\n    test: 'repeat',\n\n    target: '*',\n\n    unbind: function (attr) {\n        var id = this.data(config.repeat.templateId);\n        if (id) {\n            this.nextUntil(':not([data-' + id + '])').remove();\n            // this.removeAttr('data-' + config.repeat.templateId); //FIXME: Something about calling rebind multiple times in IB makes this happen without the removal\n        }\n        var loopTemplate = this.data(config.repeat.template);\n        if (loopTemplate) {\n            this.removeData(config.repeat.template);\n            this.replaceWith(loopTemplate);\n        }\n    },\n\n    handle: function (value, prop) {\n        value = $.isPlainObject(value) ? value : [].concat(value);\n        var loopTemplate = this.data(config.repeat.template);\n        var id = this.data(config.repeat.templateId);\n\n        if (!loopTemplate) {\n            loopTemplate = this.get(0).outerHTML;\n            this.data(config.repeat.template, loopTemplate);\n        }\n\n        if (id) {\n            this.nextUntil(':not([data-' + id + '])').remove();\n        } else {\n            id = gutils.random('repeat-');\n            this.attr('data-' + config.repeat.templateId, id);\n        }\n\n        var last;\n        var me = this;\n        _.each(value, function (dataval, datakey) {\n            var cloop = loopTemplate.replace(/&lt;/g, '<').replace(/&gt;/g, '>');\n            var templatedLoop = _.template(cloop)({ value: dataval, key: datakey, index: datakey });\n            var isTemplated = templatedLoop !== cloop;\n            var nodes = $(templatedLoop);\n            var hasData = dataval !== null && dataval !== undefined;\n\n            nodes.each(function (i, newNode) {\n                newNode = $(newNode).removeAttr('data-f-repeat').removeAttr('data-' + config.repeat.templateId);\n                _.each(newNode.data(), function (val, key) {\n                    if (!last) {\n                        me.data(key, parseUtils.toImplicitType(val));\n                    } else {\n                        newNode.data(key, parseUtils.toImplicitType(val));\n                    }\n                });\n                newNode.attr('data-' + id, true);\n                if (!isTemplated && !newNode.children().length && hasData) {\n                    newNode.html(dataval + '');\n                }\n            });\n            if (!last) {\n                last = me.html(nodes.html());\n            } else {\n                last = nodes.insertAfter(last);\n            }\n        });\n    }\n};\n\n/***/ }),\n/* 30 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/**\n * ## Binding for data-f-[boolean]\n *\n * Flow.js provides special handling for HTML attributes that take Boolean values.\n *\n * In particular, for most HTML attributes that expect Boolean values, the attribute is directly set to the value of the model variable. This is true for `checked`, `selected`, `async`, `autofocus`, `autoplay`, `controls`, `defer`, `ismap`, `loop`, `multiple`, `open`, `required`, and `scoped`.\n *\n * However, there are a few notable exceptions. For the HTML attributes `disabled`, `hidden`, and `readonly`, the attribute is set to the *opposite* of the value of the model variable. This makes the resulting HTML easier to read.\n *\n * **Example**\n *\n *      <!-- this checkbox is CHECKED when sampleBool is TRUE,\n *           and UNCHECKED when sampleBool is FALSE -->\n *      <input type=\"checkbox\" data-f-checked=\"sampleBool\" />\n *\n *      <!-- this button is ENABLED when sampleBool is TRUE,\n *           and DISABLED when sampleBool is FALSE -->\n *      <button data-f-disabled=\"sampleBool\">Click Me</button>\n *\n */\n\n\n\nmodule.exports = {\n    target: '*',\n\n    test: /^(?:checked|selected|async|autofocus|autoplay|controls|defer|ismap|loop|multiple|open|required|scoped)$/i,\n\n    handle: function (value, prop) {\n        if (_.isArray(value)) {\n            value = value[value.length - 1];\n        }\n        var val = this.attr('value') ? value == this.prop('value') : !!value; //eslint-disable-line eqeqeq\n        this.prop(prop, val);\n    }\n};\n\n/***/ }),\n/* 31 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/**\n * ## Binding for data-f-[boolean]\n *\n * Flow.js provides special handling for HTML attributes that take Boolean values.\n *\n * In particular, for most HTML attributes that expect Boolean values, the attribute is directly set to the value of the model variable. This is true for `checked`, `selected`, `async`, `autofocus`, `autoplay`, `controls`, `defer`, `ismap`, `loop`, `multiple`, `open`, `required`, and `scoped`.\n *\n * However, there are a few notable exceptions. For the HTML attributes `disabled`, `hidden`, and `readonly`, the attribute is set to the *opposite* of the value of the model variable. This makes the resulting HTML easier to read.\n *\n * **Example**\n *\n *      <!-- this checkbox is CHECKED when sampleBool is TRUE,\n *           and UNCHECKED when sampleBool is FALSE -->\n *      <input type=\"checkbox\" data-f-checked=\"sampleBool\" />\n *\n *      <!-- this button is ENABLED when sampleBool is TRUE,\n *           and DISABLED when sampleBool is FALSE -->\n *      <button data-f-disabled=\"sampleBool\">Click Me</button>\n *\n */\n\n\n\nmodule.exports = {\n\n    target: '*',\n\n    test: /^(?:disabled|hidden|readonly)$/i,\n\n    handle: function (value, prop) {\n        if (_.isArray(value)) {\n            value = value[value.length - 1];\n        }\n        this.prop(prop, !value);\n    }\n};\n\n/***/ }),\n/* 32 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/**\n * ## Default Bi-directional Binding: data-f-bind\n *\n * The most commonly used attribute provided by Flow.js is the `data-f-bind` attribute.\n *\n * #### data-f-bind with a single value\n *\n * You can bind variables from the model in your interface by setting the `data-f-bind` attribute. This attribute binding is bi-directional, meaning that as the model changes, the interface is automatically updated; and when users change values in the interface, the model is automatically updated. Specifically:\n *\n * * The binding from the model to the interface ensures that the current value of the variable is displayed in the HTML element. This includes automatic updates to the displayed value if something else changes in the model.\n *\n * * The binding from the interface to the model ensures that if the HTML element is editable, changes are sent to the model.\n *\n * Once you set `data-f-bind`, Flow.js figures out the appropriate action to take based on the element type and the data response from your model.\n *\n * **To display and automatically update a variable in the interface:**\n *\n * 1. Add the `data-f-bind` attribute to any HTML element that normally takes a value.\n * 2. Set the value of the `data-f-bind` attribute to the name of the variable.\n *\n * **Example**\n *\n *      <span data-f-bind=\"salesManager.name\" />\n *\n *      <input type=\"text\" data-f-bind=\"sampleString\" />\n *\n * **Notes:**\n *\n * * Use square brackets, `[]`, to reference arrayed variables: `sales[West]`.\n * * Use angle brackets, `<>`, to reference other variables in your array index: `sales[<currentRegion>]`.\n * * Remember that if your model is in Vensim, the time step is the last array index.\n * * By default, all HTML elements update for any change for each variable. However, you can prevent the user interface from updating &mdash; either for all variables or for particular variables &mdash; by setting the `silent` property when you initialize Flow.js. See more on [additional options for the Flow.initialize() method](../../../../../#custom-initialize).\n *\n * #### data-f-bind with multiple values and templates\n *\n * If you have multiple variables, you can use the shortcut of listing multiple variables in an enclosing HTML element and then referencing each variable using templates. (Templates are available as part of Flow.js's lodash dependency. See more background on [working with templates](../../../../../#templates).)\n *\n * **To display and automatically update multiple variables in the interface:**\n *\n * 1. Add the `data-f-bind` attribute to any HTML element from which you want to reference model variables, such as a `div` or `table`.\n * 2. Set the value of the `data-f-bind` attribute in your top-level HTML element to a comma-separated list of the variables. (The variables may or may not be case-sensitive, depending on your modeling language.)\n *\n * 3. Inside the HTML element, use templates (`<%= %>`) to reference the specific variable names. These variable names are case-sensitive: they should match the case you used in the `data-f-bind` in step 2.\n *\n * **Example**\n *\n *      <!-- make these three model variables available throughout div -->\n *\n *      <div data-f-bind=\"CurrentYear, Revenue, Profit\">\n *          In <%= CurrentYear %>,\n *          our company earned <%= Revenue %>,\n *          resulting in <%= Profit %> profit.\n *      </div>\n *\n * This example is shorthand for repeatedly using data-f-bind. For instance, this code also generates the same output:\n *\n *      <div>\n *          In <span data-f-bind=\"CurrentYear\"></span>,\n *          our company earned <span data-f-bind=\"Revenue\"></span>,\n *          resulting in <span data-f-bind=\"Profit\"> profit</span>.\n *      </div>\n *\n * **Notes:**\n *\n * * Adding `data-f-bind` to the enclosing HTML element rather than repeatedly using it within the element is a code style preference. In many cases, adding `data-f-bind` at the top level, as in the first example, can make your code easier to read and maintain.\n * * However, you might choose to repeatedly use `data-f-bind` in some cases, for example if you want different [formatting](../../../../../converter-overview/) for different variables:\n *\n *          <div>\n *              In <span data-f-bind=\"CurrentYear | #\"></span>,\n *              our company earned <span data-f-bind=\"Revenue | $#,###\"></span>\n *          </div>\n *\n * * Because everything within your template (`<%= %>`) is evaluated as JavaScript, you can use templates to pass expressions to other Flow.js attributes. For example,\n *\n *          <div data-f-bind=\"myCurrentTimeStep\">\n *              <div data-f-bind=\"Revenue[<%= value + 1%>]\"></div>\n *          </div>\n *\n * will display the value of `Revenue[myCurrentTimeStep + 1]` (for example an estimate of future revenue in your model).\n *\n */\n\n\n\nvar config = __webpack_require__(0);\n\nmodule.exports = {\n\n    target: '*',\n\n    test: 'bind',\n\n    unbind: function (attr) {\n        var template = this.data(config.attrs.bindTemplate);\n        if (template) {\n            this.html(template);\n        }\n    },\n\n    handle: function (value) {\n        var templated;\n        var valueToTemplate = $.extend({}, value);\n        if (!$.isPlainObject(value)) {\n            var variableName = this.data('f-bind'); //Hack because i don't have access to variable name here otherwise\n            valueToTemplate = { value: value };\n            valueToTemplate[variableName] = value;\n        } else {\n            valueToTemplate.value = value; //If the key has 'weird' characters like '<>' hard to get at with a template otherwise\n        }\n        var bindTemplate = this.data(config.attrs.bindTemplate);\n        if (bindTemplate) {\n            templated = _.template(bindTemplate)(valueToTemplate);\n            this.html(templated);\n        } else {\n            var oldHTML = this.html();\n            var cleanedHTML = oldHTML.replace(/&lt;/g, '<').replace(/&gt;/g, '>');\n            templated = _.template(cleanedHTML)(valueToTemplate);\n            if (cleanedHTML === templated) {\n                //templating did nothing\n                if (_.isArray(value)) {\n                    value = value[value.length - 1];\n                }\n                value = $.isPlainObject(value) ? JSON.stringify(value) : value + '';\n                this.html(value);\n            } else {\n                this.data(config.attrs.bindTemplate, cleanedHTML);\n                this.html(templated);\n            }\n        }\n    }\n};\n\n/***/ }),\n/* 33 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/**\n * ## Default Attribute Handling: Read-only Binding\n *\n * Flow.js uses the HTML5 convention of prepending data- to any custom HTML attribute. Flow.js also adds `f` for easy identification of Flow.js. For example, Flow.js provides several custom attributes and attribute handlers -- including [data-f-bind](../binds/default-bind-attr), [data-f-foreach](../foreach/default-foreach-attr/), [data-f-on-init](../events/init-event-attr/), etc. You can also [add your own attribute handlers](../attribute-manager/).\n *\n * The default behavior for handling a known attribute is to use the value of the model variable as the value of the attribute. (There are exceptions for some [boolean attributes](../boolean-attr/).)\n *\n * This means you can bind variables from the model in your interface by adding the `data-f-` prefix to any standard DOM attribute. This attribute binding is **read-only**, so as the model changes, the interface is automatically updated; but when users change values in the interface, no action occurs.\n *\n * **To display a DOM element based on a variable from the model:**\n *\n * 1. Add the prefix `data-f-` to any attribute in any HTML element that normally takes a value.\n * 2. Set the value of the attribute to the name of the model variable.\n *\n * **Example**\n *\n * \t\t<!-- input element displays value of sample_int, however,\n * \t\t\tno call to the model is made if user changes sample_int\n *\n *\t\t\tif sample_int is 8, this is the equivalent of <input value=\"8\"></input> -->\n *\n *\t\t<input data-f-value=\"sample_int\"></input>\n *\n */\n\n\n\nmodule.exports = {\n\n    test: '*',\n\n    target: '*',\n\n    handle: function (value, prop) {\n        this.prop(prop, value);\n    }\n};\n\n/***/ }),\n/* 34 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nmodule.exports = function (target, domManager) {\n    if (!window.MutationObserver) {\n        return false;\n    }\n\n    // Create an observer instance\n    var observer = new MutationObserver(function (mutations) {\n        mutations.forEach(function (mutation) {\n            var added = $(mutation.addedNodes).find(':f');\n            added = added.add($(mutation.addedNodes).filter(':f'));\n\n            var removed = $(mutation.removedNodes).find(':f');\n            removed = removed.add($(mutation.removedNodes).filter(':f'));\n\n            if (added && added.length) {\n                domManager.bindAll(added);\n            }\n            if (removed && removed.length) {\n                domManager.unbindAll(removed);\n            }\n            if (mutation.attributeName === 'data-f-channel') {\n                domManager.unbindAll(mutation.target);\n                domManager.bindAll(mutation.target);\n            }\n        });\n    });\n\n    var mutconfig = {\n        attributes: true,\n        attributeFilter: ['data-f-channel'], //FIXME: Make this a config param\n        childList: true,\n        subtree: true,\n        characterData: false\n    };\n    observer.observe(target, mutconfig);\n    // Later, you can stop observing\n    // observer.disconnect();\n};\n\n/***/ }),\n/* 35 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony export (immutable) */ __webpack_exports__[\"default\"] = ChannelManager;\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__middleware_json_parse_middleware__ = __webpack_require__(36);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__middleware_epicenter_middleware__ = __webpack_require__(37);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__channel_manager__ = __webpack_require__(48);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__channel_manager_enhancements__ = __webpack_require__(49);\n\n\n\n\n\n\n//Moving  epicenter-centric glue here so channel-manager can be tested in isolation\nvar InterpolatableChannelManagerWithMiddleware = Object(__WEBPACK_IMPORTED_MODULE_3__channel_manager_enhancements__[\"a\" /* interpolatable */])(Object(__WEBPACK_IMPORTED_MODULE_3__channel_manager_enhancements__[\"b\" /* withMiddleware */])(__WEBPACK_IMPORTED_MODULE_2__channel_manager__[\"a\" /* default */]));\nfunction ChannelManager(opts) {\n    var cm = new InterpolatableChannelManagerWithMiddleware($.extend(true, {}, {\n        middlewares: [__WEBPACK_IMPORTED_MODULE_0__middleware_json_parse_middleware__[\"a\" /* default */], __WEBPACK_IMPORTED_MODULE_1__middleware_epicenter_middleware__[\"a\" /* default */]]\n    }, opts));\n    return cm;\n}\n\n/***/ }),\n/* 36 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = JSONMiddleware;\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_utils_parse_utils__ = __webpack_require__(3);\n\n\nfunction JSONMiddleware(config, notifier) {\n    return {\n        /**\n         * Subscribe to string literals\n         * @param  {string[]} topics\n         * @return {string[]}        topics excluding parsed\n         */\n        subscribeHandler: function (topics) {\n            var sorted = [].concat(topics).reduce(function (acc, topic) {\n                var parsed = Object(__WEBPACK_IMPORTED_MODULE_0_utils_parse_utils__[\"toImplicitType\"])(topic);\n                if (typeof parsed === 'string') {\n                    acc.rest.push(topic);\n                } else {\n                    acc.claimed.push({\n                        name: topic,\n                        value: parsed\n                    });\n                }\n                return acc;\n            }, { claimed: [], rest: [] });\n\n            if (sorted.claimed.length) {\n                notifier(sorted.claimed);\n            }\n\n            return sorted.rest;\n        }\n    };\n}\n\n/***/ }),\n/* 37 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__run_manager_router__ = __webpack_require__(38);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__scenario_manager_router__ = __webpack_require__(44);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__custom_run_router__ = __webpack_require__(45);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__runs_router__ = __webpack_require__(47);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_channels_middleware_utils__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_channels_channel_router__ = __webpack_require__(4);\n\n\n\n\n\n\n\n\n\n\nfunction getOptions(opts, key) {\n    var serviceOptions = $.extend(true, {}, opts.defaults, opts[key]);\n    var channelOptions = $.extend(true, {}, serviceOptions.channelOptions);\n    delete serviceOptions.channelOptions;\n\n    return { serviceOptions: serviceOptions, channelOptions: channelOptions };\n}\n\nvar SCENARIO_PREFIX = 'sm:';\nvar RUN_PREFIX = 'rm:';\n\nvar sampleRunidLength = '000001593dd81950d4ee4f3df14841769a0b'.length;\nvar runidRegex = '(?:.{' + sampleRunidLength + '})';\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (function (config, notifier, channelManagerContext) {\n    var opts = $.extend(true, {}, config);\n\n    var customRunChannelOpts = getOptions(opts, 'runid');\n    var customRunChannel = new __WEBPACK_IMPORTED_MODULE_2__custom_run_router__[\"a\" /* default */](customRunChannelOpts, notifier);\n    var runsChannel = new __WEBPACK_IMPORTED_MODULE_3__runs_router__[\"a\" /* default */](customRunChannelOpts, Object(__WEBPACK_IMPORTED_MODULE_4_channels_middleware_utils__[\"i\" /* withPrefix */])(notifier, 'runs'), channelManagerContext);\n\n    /** @type {Handler[]} **/\n    var handlers = [$.extend({}, customRunChannel, {\n        name: 'customRun',\n        match: Object(__WEBPACK_IMPORTED_MODULE_4_channels_middleware_utils__[\"e\" /* regex */])(runidRegex),\n        options: customRunChannelOpts.channelOptions\n    }), $.extend({}, runsChannel, {\n        name: 'archiveRuns',\n        match: Object(__WEBPACK_IMPORTED_MODULE_4_channels_middleware_utils__[\"d\" /* prefix */])('runs'),\n        options: customRunChannelOpts.channelOptions\n    })];\n    var exposable = {};\n\n    var runManagerOpts = getOptions(opts, 'runManager');\n    if (opts.runManager || !opts.scenarioManager && runManagerOpts.serviceOptions.run) {\n        var rm;\n        if (opts.scenarioManager) {\n            rm = new __WEBPACK_IMPORTED_MODULE_0__run_manager_router__[\"a\" /* default */](runManagerOpts, Object(__WEBPACK_IMPORTED_MODULE_4_channels_middleware_utils__[\"i\" /* withPrefix */])(notifier, RUN_PREFIX));\n            handlers.push($.extend({}, rm, {\n                name: 'run',\n                match: Object(__WEBPACK_IMPORTED_MODULE_4_channels_middleware_utils__[\"d\" /* prefix */])(RUN_PREFIX),\n                options: runManagerOpts.channelOptions\n            }));\n        } else {\n            rm = new __WEBPACK_IMPORTED_MODULE_0__run_manager_router__[\"a\" /* default */](runManagerOpts, Object(__WEBPACK_IMPORTED_MODULE_4_channels_middleware_utils__[\"i\" /* withPrefix */])(notifier, [RUN_PREFIX, '']));\n            handlers.push($.extend({}, rm, {\n                name: 'run',\n                match: Object(__WEBPACK_IMPORTED_MODULE_4_channels_middleware_utils__[\"a\" /* defaultPrefix */])(RUN_PREFIX),\n                isDefault: true,\n                options: runManagerOpts.channelOptions\n            }));\n        }\n\n        $.extend(exposable, rm.expose);\n    }\n\n    if (opts.scenarioManager) {\n        var scenarioManagerOpts = getOptions(opts, 'scenarioManager');\n        var sm = new __WEBPACK_IMPORTED_MODULE_1__scenario_manager_router__[\"a\" /* default */](scenarioManagerOpts, Object(__WEBPACK_IMPORTED_MODULE_4_channels_middleware_utils__[\"i\" /* withPrefix */])(notifier, [SCENARIO_PREFIX, '']));\n        handlers.push($.extend({}, sm, {\n            name: 'scenario',\n            match: Object(__WEBPACK_IMPORTED_MODULE_4_channels_middleware_utils__[\"a\" /* defaultPrefix */])(SCENARIO_PREFIX),\n            options: scenarioManagerOpts.channelOptions,\n            isDefault: true\n        }));\n\n        $.extend(exposable, sm.expose);\n    }\n\n    var router = new __WEBPACK_IMPORTED_MODULE_5_channels_channel_router__[\"a\" /* default */](handlers, notifier);\n    router.expose = exposable;\n\n    return router;\n});\n\n/***/ }),\n/* 38 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__run_router__ = __webpack_require__(6);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_channels_middleware_utils__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_channels_channel_router__ = __webpack_require__(4);\n\n\n\n\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (function (config, notifier) {\n    var defaults = {\n        serviceOptions: {},\n        channelOptions: {}\n    };\n    var opts = $.extend(true, {}, defaults, config);\n\n    var rm = new window.F.manager.RunManager(opts.serviceOptions);\n    var $creationPromise = rm.getRun().then(function () {\n        return rm.run;\n    });\n    var currentChannelOpts = $.extend(true, { serviceOptions: $creationPromise }, opts.defaults, opts.current);\n    var currentRunChannel = new __WEBPACK_IMPORTED_MODULE_0__run_router__[\"a\" /* default */](currentChannelOpts, Object(__WEBPACK_IMPORTED_MODULE_1_channels_middleware_utils__[\"i\" /* withPrefix */])(notifier, ['current:', '']));\n\n    var handlers = [$.extend(currentRunChannel, {\n        match: Object(__WEBPACK_IMPORTED_MODULE_1_channels_middleware_utils__[\"a\" /* defaultPrefix */])('current:'),\n        isDefault: true,\n        options: currentChannelOpts.channelOptions\n    })];\n\n    var router = new __WEBPACK_IMPORTED_MODULE_2_channels_channel_router__[\"a\" /* default */](handlers, notifier);\n    router.expose = { runManager: rm };\n    return router;\n});\n\n/***/ }),\n/* 39 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = RunMetaChannel;\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_channels_channel_utils__ = __webpack_require__(1);\n\n\nvar _ref = _,\n    intersection = _ref.intersection;\n\n\nfunction RunMetaChannel($runServicePromise, notifier) {\n\n    function mergeAndSend(runMeta, requestedTopics) {\n        var toSend = [].concat(requestedTopics).reduce(function (accum, meta) {\n            if (runMeta[meta] !== undefined) {\n                accum.push({ name: meta, value: runMeta[meta] });\n            }\n            return accum;\n        }, []);\n        return notifier(toSend);\n    }\n    return {\n        subscribeHandler: function (topics, options) {\n            topics = [].concat(topics);\n            return $runServicePromise.then(function (runService) {\n                var cachedValues = intersection(Object.keys(runService.runMeta || {}), topics);\n                if (options.autoFetch === false) {\n                    return $.Deferred().resolve({}).promise();\n                } else if (cachedValues.length === topics.length) {\n                    //FIXME: Add 'updated time' to meta, and fetch if that's < debounce interval -- use the custom debounce fn with the custom merge (debounce save as well?)\n                    //Make run service factory return patched run-service?\n                    return $.Deferred().resolve(mergeAndSend(runService.runMeta, topics)).promise();\n                }if (!runService.loadPromise) {\n                    runService.loadPromise = runService.load().then(function (data) {\n                        runService.runMeta = data;\n                        return data;\n                    });\n                }\n                return runService.loadPromise.then(function (data) {\n                    mergeAndSend(data, topics);\n                });\n            });\n        },\n        publishHandler: function (topics, options) {\n            return $runServicePromise.then(function (runService) {\n                var toSave = Object(__WEBPACK_IMPORTED_MODULE_0_channels_channel_utils__[\"a\" /* arrayToObject */])(topics);\n                return runService.save(toSave).then(function (res) {\n                    runService.runMeta = $.extend({}, true, runService.runMeta, res);\n                    return Object(__WEBPACK_IMPORTED_MODULE_0_channels_channel_utils__[\"e\" /* objectToArray */])(res);\n                });\n            });\n        }\n    };\n}\n\n/***/ }),\n/* 40 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = RunVariablesChannel;\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_utils_general__ = __webpack_require__(5);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_utils_general___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_utils_general__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_channels_channel_utils__ = __webpack_require__(1);\n\n\n\nfunction RunVariablesChannel($runServicePromise, notifier) {\n\n    var id = _.uniqueId('variable-channel');\n\n    var fetchFn = function (runService, debounceInterval) {\n        if (!runService.debouncedFetchers) {\n            runService.debouncedFetchers = {};\n        }\n        if (!runService.debouncedFetchers[id]) {\n            runService.debouncedFetchers[id] = Object(__WEBPACK_IMPORTED_MODULE_0_utils_general__[\"debounceAndMerge\"])(function (variables) {\n                if (!variables || !variables.length) {\n                    return $.Deferred().resolve([]).promise();\n                }\n                return runService.variables().query(variables).then(__WEBPACK_IMPORTED_MODULE_1_channels_channel_utils__[\"e\" /* objectToArray */]);\n            }, debounceInterval, [function mergeVariables(accum, newval) {\n                if (!accum) {\n                    accum = [];\n                }\n                return _.uniq(accum.concat(newval)).filter(function (v) {\n                    return !!(v && v.trim());\n                });\n            }]);\n        }\n        return runService.debouncedFetchers[id];\n    };\n\n    var knownTopics = [];\n    return {\n        fetch: function () {\n            return $runServicePromise.then(function (runService) {\n                return fetchFn(runService, 0)(knownTopics).then(notifier);\n            });\n        },\n\n        unsubscribeHandler: function (unsubscribedTopics, remainingTopics) {\n            knownTopics = remainingTopics;\n        },\n        subscribeHandler: function (topics, options) {\n            var isAutoFetchEnabled = options.autoFetch;\n            var debounceInterval = options.debounce;\n\n            return $runServicePromise.then(function (runService) {\n                knownTopics = _.uniq(knownTopics.concat(topics));\n                if (!knownTopics.length) {\n                    return $.Deferred().resolve([]).promise();\n                } else if (!isAutoFetchEnabled) {\n                    return $.Deferred().resolve(topics).promise();\n                }\n                return fetchFn(runService, debounceInterval)(topics).then(notifier);\n            });\n        },\n        publishHandler: function (topics, options) {\n            return $runServicePromise.then(function (runService) {\n                var toSave = Object(__WEBPACK_IMPORTED_MODULE_1_channels_channel_utils__[\"a\" /* arrayToObject */])(topics);\n                return runService.variables().save(toSave).then(function (response) {\n                    return Object(__WEBPACK_IMPORTED_MODULE_1_channels_channel_utils__[\"e\" /* objectToArray */])(response);\n                });\n            });\n        }\n    };\n}\n\n/***/ }),\n/* 41 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = RunOperationsChannel;\nfunction RunOperationsChannel($runServicePromise) {\n    return {\n        publishHandler: function (topics, options) {\n            return $runServicePromise.then(function (runService) {\n                var toSave = topics.map(function (topic) {\n                    return { name: topic.name, params: topic.value };\n                });\n                return runService.serial(toSave).then(function (result) {\n                    var toReturn = result.map(function (response, index) {\n                        return { name: topics[index].name, value: response };\n                    });\n                    return toReturn;\n                });\n            });\n        }\n    };\n}\n\n/***/ }),\n/* 42 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = silencable;\nvar _ref = _,\n    isArray = _ref.isArray,\n    includes = _ref.includes;\n\n/**\n * @param {Publishable[]} published \n * @param {boolean|String[]|{except: String[]}} [silentOptions]\n * @return {Publishable[]} filtered list\n */\n\nfunction silencable(published, silentOptions) {\n    if (silentOptions === true || !published) {\n        return [];\n    } else if (isArray(silentOptions)) {\n        return published.filter(function (data) {\n            return !includes(silentOptions, data.name);\n        });\n    } else if (silentOptions && silentOptions.except) {\n        return published.filter(function (data) {\n            return includes(silentOptions.except || [], data.name);\n        });\n    }\n    return published;\n}\n\n/***/ }),\n/* 43 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = excludeReadOnly;\nvar _ref = _,\n    isArray = _ref.isArray,\n    includes = _ref.includes,\n    isFunction = _ref.isFunction;\n\n/**\n * \n * @param {Publishable[]} publishable \n * @param {boolean|string[]|Function} readOnlyOptions \n * @return {Publishable[]} filtered list\n */\n\nfunction excludeReadOnly(publishable, readOnlyOptions) {\n    if (isFunction(readOnlyOptions)) {\n        readOnlyOptions = readOnlyOptions();\n    }\n    if (readOnlyOptions === true) {\n        console.error('Tried to publish to a readonly channel', publishable);\n        return [];\n    } else if (isArray(readOnlyOptions)) {\n        var split = publishable.reduce(function (accum, data) {\n            var isReadonly = includes(readOnlyOptions, data.name);\n            if (isReadonly) {\n                accum.readOnly.push(data);\n            } else {\n                accum.remaining.push(data);\n            }\n            return accum;\n        }, { readOnly: [], remaining: [] });\n\n        if (split.readOnly.length) {\n            console.error('Ignoring readonly publishes', split.readOnly);\n        }\n        return split.remaining;\n    }\n    return publishable;\n}\n\n/***/ }),\n/* 44 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__run_router__ = __webpack_require__(6);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_channels_middleware_utils__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_channels_channel_router__ = __webpack_require__(4);\n\n\n\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (function (config, notifier) {\n    var defaults = {\n        serviceOptions: {},\n        channelOptions: {}\n    };\n    var opts = $.extend(true, {}, defaults, config);\n\n    var sm = new window.F.manager.ScenarioManager(opts.serviceOptions);\n\n    var baselinePromise = sm.baseline.getRun().then(function () {\n        return sm.baseline.run;\n    });\n    var baselineOptions = $.extend(true, {\n        serviceOptions: baselinePromise,\n        channelOptions: {\n            meta: {\n                readOnly: true\n            },\n            variables: {\n                readOnly: true\n            }\n        }\n    }, opts.defaults, opts.baseline);\n    var currentRunPromise = sm.current.getRun().then(function () {\n        return sm.current.run;\n    });\n\n    var runOptions = $.extend(true, {\n        serviceOptions: currentRunPromise\n    }, opts.defaults, opts.current);\n\n    var baselineChannel = new __WEBPACK_IMPORTED_MODULE_0__run_router__[\"a\" /* default */](baselineOptions, Object(__WEBPACK_IMPORTED_MODULE_1_channels_middleware_utils__[\"i\" /* withPrefix */])(notifier, 'baseline:'));\n    var currentRunChannel = new __WEBPACK_IMPORTED_MODULE_0__run_router__[\"a\" /* default */](runOptions, Object(__WEBPACK_IMPORTED_MODULE_1_channels_middleware_utils__[\"i\" /* withPrefix */])(notifier, ['current:', '']));\n    var handlers = [$.extend(baselineChannel, {\n        name: 'baseline',\n        match: Object(__WEBPACK_IMPORTED_MODULE_1_channels_middleware_utils__[\"d\" /* prefix */])('baseline:'),\n        options: baselineOptions.channelOptions\n    }), $.extend(currentRunChannel, {\n        isDefault: true,\n        name: 'current',\n        match: Object(__WEBPACK_IMPORTED_MODULE_1_channels_middleware_utils__[\"a\" /* defaultPrefix */])('current:'),\n        options: runOptions.channelOptions\n    })];\n\n    var router = new __WEBPACK_IMPORTED_MODULE_2_channels_channel_router__[\"a\" /* default */](handlers, notifier);\n    router.expose = { scenarioManager: sm };\n    return router;\n});\n\n/***/ }),\n/* 45 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__run_router_factory__ = __webpack_require__(46);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_channels_middleware_utils__ = __webpack_require__(2);\n\n\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (function (options, notifier) {\n    if (!options) options = {};\n\n    var opts = {};\n    opts.serviceOptions = options.serviceOptions && options.serviceOptions.run ? options.serviceOptions.run : {};\n    opts.channelOptions = options.channelOptions;\n\n    return {\n        subscribeHandler: function (topics, options, prefix) {\n            var runid = Object(__WEBPACK_IMPORTED_MODULE_1_channels_middleware_utils__[\"g\" /* stripSuffixDelimiter */])(prefix);\n            //FIXME: Should i merge options here?\n            var channel = Object(__WEBPACK_IMPORTED_MODULE_0__run_router_factory__[\"a\" /* default */])(runid, opts, Object(__WEBPACK_IMPORTED_MODULE_1_channels_middleware_utils__[\"i\" /* withPrefix */])(notifier, prefix));\n            return channel.subscribeHandler(topics, options, prefix);\n        },\n        publishHandler: function (topics, options, prefix) {\n            var runid = Object(__WEBPACK_IMPORTED_MODULE_1_channels_middleware_utils__[\"g\" /* stripSuffixDelimiter */])(prefix);\n            var channel = Object(__WEBPACK_IMPORTED_MODULE_0__run_router_factory__[\"a\" /* default */])(runid, opts, Object(__WEBPACK_IMPORTED_MODULE_1_channels_middleware_utils__[\"i\" /* withPrefix */])(notifier, prefix));\n            return channel.publishHandler(topics);\n        }\n    };\n});\n\n/***/ }),\n/* 46 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__run_router__ = __webpack_require__(6);\n\nvar knownRunIDServiceChannels = {};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (function (runid, options, notifier) {\n    var runChannel = knownRunIDServiceChannels[runid];\n    if (!runChannel) {\n        var runOptions = $.extend(true, {}, options, { serviceOptions: { id: runid } });\n        runChannel = new __WEBPACK_IMPORTED_MODULE_0__run_router__[\"a\" /* default */](runOptions, notifier);\n        knownRunIDServiceChannels[runid] = runChannel;\n    }\n    return runChannel;\n});\n\n/***/ }),\n/* 47 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = RunsRouter;\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_utils_general__ = __webpack_require__(5);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_utils_general___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_utils_general__);\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\n\nvar _window = window,\n    F = _window.F;\n\n\nfunction RunsRouter(options, notifier, channelManagerContext) {\n    var runService = new F.service.Run(options.serviceOptions.run);\n\n    var topicParamMap = {};\n\n    function extractFiltersFromTopic(topicString) {\n        var filters = topicString.replace('(', '').replace(')', '');\n        var filterParam = filters.split(';').reduce(function (accum, filter) {\n            var _filter$split = filter.split('='),\n                _filter$split2 = _slicedToArray(_filter$split, 2),\n                key = _filter$split2[0],\n                val = _filter$split2[1];\n\n            if (val) {\n                val = true;\n            }\n            accum[key] = val;\n            return accum;\n        }, {});\n        return filterParam;\n    }\n\n    function fetch(topic, variables) {\n        var filters = extractFiltersFromTopic(topic);\n        return runService.query(filters, { include: variables }).then(function (runs) {\n            notifier([{ name: topic, value: runs }]);\n\n            // if (topicParamMap[topic]) {\n            //     Object.keys(topicParamMap[topic]).forEach((runid)=> {\n            //         channelManagerContext.unsubscribe(topicParamMap[topic][runid]);\n            //     });\n            // }\n\n            return runs;\n        });\n    }\n\n    return {\n        fetch: fetch,\n\n        unsubscribeHandler: function (unsubscribedTopics, remainingTopics) {\n            console.log('unsubs');\n            // knownTopics = remainingTopics;\n        },\n        subscribeHandler: function (topics, options) {\n            var topic = [].concat(topics)[0];\n\n            var filters = extractFiltersFromTopic(topic);\n            var variables = options && options.include;\n\n            var debounceInterval = 300;\n            var debouncedFetch = Object(__WEBPACK_IMPORTED_MODULE_0_utils_general__[\"debounceAndMerge\"])(fetch, debounceInterval, function (accum, newval) {\n                return newval;\n            });\n            return fetch(topic, variables).then(function (runs) {\n                var subsMap = {};\n                //TODO: Provide this meta information to runs-factory so it doesn't trigger a fetch to get meta for each run\n                runs.forEach(function (run) {\n                    var subscriptions = Object.keys(filters).map(function (filter) {\n                        return run.id + ':meta:' + filter;\n                    });\n                    var subsid = channelManagerContext.subscribe(subscriptions, function () {\n                        debouncedFetch(topic, variables);\n                    }, { batch: false, autoFetch: false, cache: false });\n                    subsMap[run.id] = subsid;\n                });\n\n                topicParamMap[topic] = subsMap;\n                return runs;\n            });\n        }\n    };\n}\n\n/***/ }),\n/* 48 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__channel_utils__ = __webpack_require__(1);\n\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n\nvar _ref = _,\n    uniqueId = _ref.uniqueId,\n    isFunction = _ref.isFunction,\n    intersection = _ref.intersection,\n    includes = _ref.includes,\n    uniq = _ref.uniq;\n/**\n * \n * @param {String[]|String} topics \n * @param {Function} callback \n * @param {Object} options\n * @return {Subscription}\n */\n\nfunction makeSubs(topics, callback, options) {\n    var id = uniqueId('subs-');\n    var defaults = {\n        batch: false,\n\n        /**\n         * Determines if the last published data should be cached for future notifications. For e.g.,\n         *\n         * channel.subscribe(['price', 'cost'], callback1, { batch: true, cache: false });\n         * channel.subscribe(['price', 'cost'], callback2, { batch: true, cache: true });\n         *\n         * channel.publish({ price: 1 });\n         * channel.publish({ cost: 1 });\n         *\n         * callback1 will have been called once, and callback2 will not have been called. i.e., the channel caches the first publish value and notifies after all dependent topics have data\n         * If we'd done channel.publish({ price: 1, cost: 1 }) would have called both callback1 and callback2\n         *\n         * `cache: true` is useful if you know if your topics will can published individually, but you still want to handle them together.\n         * `cache: false` is useful if you know if your topics will *always* be published together and they'll be called at the same time.\n         *\n         * Note this has no discernible effect if batch is false\n         * @type {Boolean}\n         */\n        cache: true\n    };\n    var opts = $.extend({}, defaults, options);\n    if (!callback || !isFunction(callback)) {\n        throw new Error('subscribe callback should be a function');\n    }\n    return $.extend(true, {\n        id: id,\n        topics: [].concat(topics),\n        callback: callback\n    }, opts);\n}\n\nvar cacheBySubsId = {};\nvar sentDataBySubsId = {};\n\n/**\n* @param {Subscription} subscription \n* @param {*} data\n*/\nfunction callbackIfChanged(subscription, data) {\n    var id = subscription.id;\n    if (!_.isEqual(sentDataBySubsId[id], data)) {\n        sentDataBySubsId[id] = data;\n        subscription.callback(data, { id: id });\n    }\n}\n\n/**\n* @param {Publishable[]} topics\n* @param {Subscription} subscription \n*/\nfunction checkAndNotifyBatch(topics, subscription) {\n    var cached = cacheBySubsId[subscription.id] || {};\n    var merged = topics.reduce(function (accum, topic) {\n        accum[topic.name] = topic.value;\n        return accum;\n    }, $.extend({}, true, cached));\n    var matchingTopics = intersection(Object.keys(merged), subscription.topics);\n    if (matchingTopics.length > 0) {\n        var toSend = subscription.topics.reduce(function (accum, topic) {\n            accum[topic] = merged[topic];\n            return accum;\n        }, {});\n\n        if (subscription.cache) {\n            cacheBySubsId[subscription.id] = toSend;\n        }\n        if (matchingTopics.length === subscription.topics.length) {\n            callbackIfChanged(subscription, toSend);\n        }\n    }\n}\n\n/**\n * @param {Publishable[]} topics\n * @param {Subscription} subscription \n */\nfunction checkAndNotify(topics, subscription) {\n    topics.forEach(function (topic) {\n        if (includes(subscription.topics, topic.name) || includes(subscription.topics, '*')) {\n            var toSend = {};\n            toSend[topic.name] = topic.value;\n            callbackIfChanged(subscription, toSend);\n        }\n    });\n}\n\n/**\n* @param {Subscription[]} subcriptionList\n* @return {String[]}\n*/\nfunction getTopicsFromSubsList(subcriptionList) {\n    return subcriptionList.reduce(function (accum, subs) {\n        accum = accum.concat(subs.topics);\n        return accum;\n    }, []);\n}\n\n/**\n * @implements {ChannelManager}\n */\n\nvar ChannelManager = function () {\n    function ChannelManager(options) {\n        _classCallCheck(this, ChannelManager);\n\n        this.subscriptions = [];\n    }\n\n    /**\n     * @param {String | Publishable } topic\n     * @param {any} [value] item to publish\n     * @param {Object} [options]\n     * @return {Promise}\n     */\n\n\n    _createClass(ChannelManager, [{\n        key: 'publish',\n        value: function publish(topic, value, options) {\n            var normalized = Object(__WEBPACK_IMPORTED_MODULE_0__channel_utils__[\"d\" /* normalizeParamOptions */])(topic, value, options);\n            var prom = $.Deferred().resolve(normalized.params).promise();\n            prom = prom.then(this.notify.bind(this));\n            return prom;\n        }\n    }, {\n        key: 'notify',\n        value: function notify(topic, value, options) {\n            var normalized = Object(__WEBPACK_IMPORTED_MODULE_0__channel_utils__[\"d\" /* normalizeParamOptions */])(topic, value, options);\n            // console.log('notify', normalized);\n            return this.subscriptions.forEach(function (subs) {\n                var fn = subs.batch ? checkAndNotifyBatch : checkAndNotify;\n                fn(normalized.params, subs);\n            });\n        }\n\n        //TODO: Allow subscribing to regex? Will solve problem of listening only to variables etc\n        /**\n         * @param {String[] | String} topics\n         * @param {Function} cb\n         * @param {Object} [options]\n         * @return {String}\n         */\n\n    }, {\n        key: 'subscribe',\n        value: function subscribe(topics, cb, options) {\n            var subs = makeSubs(topics, cb, options);\n            this.subscriptions = this.subscriptions.concat(subs);\n            return subs.id;\n        }\n\n        /**\n         * @param {String} token\n         */\n\n    }, {\n        key: 'unsubscribe',\n        value: function unsubscribe(token) {\n            var olderLength = this.subscriptions.length;\n            if (!olderLength) {\n                throw new Error('No subscriptions found to unsubscribe from');\n            }\n\n            var remaining = this.subscriptions.filter(function (subs) {\n                return subs.id !== token;\n            });\n            if (!remaining.length === olderLength) {\n                throw new Error('No subscription found for token ' + token);\n            }\n            delete cacheBySubsId[token];\n            delete sentDataBySubsId[token];\n            this.subscriptions = remaining;\n        }\n    }, {\n        key: 'unsubscribeAll',\n        value: function unsubscribeAll() {\n            this.subscriptions = [];\n        }\n\n        /**\n         * @return {String[]}\n         */\n\n    }, {\n        key: 'getSubscribedTopics',\n        value: function getSubscribedTopics() {\n            var list = uniq(getTopicsFromSubsList(this.subscriptions));\n            return list;\n        }\n\n        /**\n         * @param {String} [topic] optional topic to filter by\n         * @return {Subscription[]}\n         */\n\n    }, {\n        key: 'getSubscribers',\n        value: function getSubscribers(topic) {\n            if (topic) {\n                return this.subscriptions.filter(function (subs) {\n                    return includes(subs.topics, topic);\n                });\n            }\n            return this.subscriptions;\n        }\n    }]);\n\n    return ChannelManager;\n}();\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (ChannelManager);\n\n/***/ }),\n/* 49 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__interpolatable__ = __webpack_require__(50);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return __WEBPACK_IMPORTED_MODULE_0__interpolatable__[\"a\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__with_middleware__ = __webpack_require__(53);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"b\", function() { return __WEBPACK_IMPORTED_MODULE_1__with_middleware__[\"a\"]; });\n\n\n\n/***/ }),\n/* 50 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = interpolatable;\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__subscribe_interpolator__ = __webpack_require__(51);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__publish_interpolator__ = __webpack_require__(52);\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\n\n\n\n/**\n * Decorates passed channel manager with interpolation functionality\n * @param  {ChannelManager} ChannelManager\n * @return {ChannelManager}                wrapped channel manager\n */\nfunction interpolatable(ChannelManager) {\n    var subsidMap = {};\n\n    /**\n     * @implements {ChannelManager}\n     */\n    return function (_ChannelManager) {\n        _inherits(InterpolatedChannelManager, _ChannelManager);\n\n        function InterpolatedChannelManager(options) {\n            _classCallCheck(this, InterpolatedChannelManager);\n\n            var _this = _possibleConstructorReturn(this, (InterpolatedChannelManager.__proto__ || Object.getPrototypeOf(InterpolatedChannelManager)).call(this, options));\n\n            _this.subscribe = Object(__WEBPACK_IMPORTED_MODULE_0__subscribe_interpolator__[\"a\" /* default */])(_this.subscribe.bind(_this), function (dependencySubsId, newDependentId) {\n                var existing = subsidMap[dependencySubsId];\n                if (existing) {\n                    _this.unsubscribe(existing);\n                }\n                subsidMap[dependencySubsId] = newDependentId;\n            });\n\n            _this.publish = Object(__WEBPACK_IMPORTED_MODULE_1__publish_interpolator__[\"a\" /* default */])(_this.publish.bind(_this), function (variables, cb) {\n                _get(InterpolatedChannelManager.prototype.__proto__ || Object.getPrototypeOf(InterpolatedChannelManager.prototype), 'subscribe', _this).call(_this, variables, function (response, meta) {\n                    _this.unsubscribe(meta.id);\n                    cb(response);\n                }, { autoFetch: true, batch: true });\n            });\n            return _this;\n        }\n\n        _createClass(InterpolatedChannelManager, [{\n            key: 'unsubscribe',\n            value: function unsubscribe(token) {\n                var existing = subsidMap[token];\n                if (existing) {\n                    _get(InterpolatedChannelManager.prototype.__proto__ || Object.getPrototypeOf(InterpolatedChannelManager.prototype), 'unsubscribe', this).call(this, existing);\n                }\n                _get(InterpolatedChannelManager.prototype.__proto__ || Object.getPrototypeOf(InterpolatedChannelManager.prototype), 'unsubscribe', this).call(this, token);\n                delete subsidMap[token];\n            }\n        }, {\n            key: 'unsubscribeAll',\n            value: function unsubscribeAll() {\n                subsidMap = {};\n                _get(InterpolatedChannelManager.prototype.__proto__ || Object.getPrototypeOf(InterpolatedChannelManager.prototype), 'unsubscribeAll', this).call(this);\n            }\n        }]);\n\n        return InterpolatedChannelManager;\n    }(ChannelManager);\n}\n\n/***/ }),\n/* 51 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* unused harmony export getDependencies */\n/* unused harmony export interpolateWithDependencies */\n/* unused harmony export mergeInterpolatedTopicsWithData */\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = subscribeInterpolator;\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__interpolatable_utils__ = __webpack_require__(10);\n\nvar _ref = _,\n    uniq = _ref.uniq;\n\n/**\n * @param {String[]} topics\n * @return {String[]} interpolated\n */\n\nfunction getDependencies(topics) {\n    var deps = topics.reduce(function (accum, topic) {\n        var inner = Object(__WEBPACK_IMPORTED_MODULE_0__interpolatable_utils__[\"a\" /* extractDependencies */])(topic);\n        accum = accum.concat(inner);\n        return accum;\n    }, []);\n    return uniq(deps);\n}\n\n/**\n * @param {String[]} topics\n * @param {Object} data\n * @return {String[]}\n */\nfunction interpolateWithDependencies(topics, data) {\n    return topics.map(function (topic) {\n        return Object(__WEBPACK_IMPORTED_MODULE_0__interpolatable_utils__[\"b\" /* interpolateWithValues */])(topic, data);\n    });\n}\n\n/**\n * @param  {String[]} originalTopics     \n * @param  {String[]} interpolatedTopics \n * @param  {Object} data               \n * @return {Object}                    Interpolated\n */\nfunction mergeInterpolatedTopicsWithData(originalTopics, interpolatedTopics, data) {\n    return interpolatedTopics.reduce(function (accum, interpolatedTopic, index) {\n        var original = originalTopics[index];\n        var val = data[interpolatedTopic];\n        if (val !== undefined) {\n            accum[original] = data[interpolatedTopic];\n        }\n        return accum;\n    }, {});\n}\n\n/**\n * Takes a subscribe function and resolves any interpolated inputs\n * @param  {Function} subscribeFn        function to wrap\n * @param  {Function} onDependencyChange callback function when any dependencies change\n * @return {Function}                    wrapped function\n */\nfunction subscribeInterpolator(subscribeFn, onDependencyChange) {\n    return function interpolatedSubscribe(topics, cb, options) {\n        topics = [].concat(topics);\n        var dependencies = getDependencies(topics);\n        if (!dependencies.length) {\n            return subscribeFn(topics, cb, options);\n        }\n        var innerSubsId = subscribeFn(dependencies, function handleDependencyValueChange(data, dependenciesMeta) {\n            var interpolatedTopics = interpolateWithDependencies(topics, data);\n\n            var outerSubsId = subscribeFn(interpolatedTopics, function handleInterpolatedValueChange(actualData, actualMeta) {\n                var toSendback = mergeInterpolatedTopicsWithData(topics, interpolatedTopics, actualData);\n\n                cb(toSendback, actualMeta);\n            }, options);\n\n            (onDependencyChange || $.noop)(dependenciesMeta.id, outerSubsId);\n            return outerSubsId;\n        }, { autoFetch: true, batch: true });\n\n        return innerSubsId;\n    };\n}\n\n/***/ }),\n/* 52 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* unused harmony export getDependencies */\n/* unused harmony export interpolateWithDependencies */\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = publishInterpolator;\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__interpolatable_utils__ = __webpack_require__(10);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_channels_channel_utils__ = __webpack_require__(1);\n\n\n\nvar _ref = _,\n    uniq = _ref.uniq;\n/**\n * @param {Publishable[]} publishInputs\n * @returns {String[]} dependencies for inputs\n */\n\nfunction getDependencies(publishInputs) {\n    var deps = publishInputs.reduce(function (accum, input) {\n        var inner = Object(__WEBPACK_IMPORTED_MODULE_0__interpolatable_utils__[\"a\" /* extractDependencies */])(input.name);\n        accum = accum.concat(inner);\n        return accum;\n    }, []);\n    return uniq(deps);\n}\n\n/**\n * @param {Publishable[]} publishInputs\n * @param {Object} valuesToInterpolate\n * @returns {Publishable[]} inputs with resolved dependencies\n */\nfunction interpolateWithDependencies(publishInputs, valuesToInterpolate) {\n    return publishInputs.map(function (ip) {\n        return {\n            name: Object(__WEBPACK_IMPORTED_MODULE_0__interpolatable_utils__[\"b\" /* interpolateWithValues */])(ip.name, valuesToInterpolate),\n            value: ip.value\n        };\n    });\n}\n\n/**\n * Publish function to wrap\n * @param  {Function} publishFunction\n * @param  {Function} fetchFn         function to get interpolated values from\n * @return {Function}                 wrapped function\n */\nfunction publishInterpolator(publishFunction, fetchFn) {\n    return function interpolatedPublishfunction(topic, value, options) {\n        var normalizedPublishInputs = Object(__WEBPACK_IMPORTED_MODULE_1_channels_channel_utils__[\"d\" /* normalizeParamOptions */])(topic, value, options);\n        var dependencies = getDependencies(normalizedPublishInputs.params);\n        if (!dependencies.length) {\n            return publishFunction(topic, value, options);\n        }\n\n        var prom = $.Deferred();\n        fetchFn(dependencies, function handleDependencyChange(resolvedDependencies) {\n            var interpolated = interpolateWithDependencies(normalizedPublishInputs.params, resolvedDependencies);\n            var newPublishProm = publishFunction(interpolated, normalizedPublishInputs.options);\n            prom.resolve(newPublishProm);\n        });\n        return prom.promise();\n    };\n}\n\n/***/ }),\n/* 53 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = withMiddleware;\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__middleware_manager__ = __webpack_require__(54);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__channel_utils__ = __webpack_require__(1);\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\n\n\n\nfunction getTopicsFromSubsList(subcriptionList) {\n    return subcriptionList.reduce(function (accum, subs) {\n        accum = accum.concat(subs.topics);\n        return accum;\n    }, []);\n}\n\n/**\n * Decorates passed channel manager with middleware functionality\n * @param  {ChannelManager} ChannelManager\n * @return {ChannelManager}                wrapped channel manager\n */\nfunction withMiddleware(ChannelManager) {\n    /**\n     * @implements {ChannelManager}\n     */\n    return function (_ChannelManager) {\n        _inherits(ChannelWithMiddleware, _ChannelManager);\n\n        function ChannelWithMiddleware(options) {\n            _classCallCheck(this, ChannelWithMiddleware);\n\n            var _this = _possibleConstructorReturn(this, (ChannelWithMiddleware.__proto__ || Object.getPrototypeOf(ChannelWithMiddleware)).call(this, options));\n\n            var defaults = {\n                middlewares: []\n            };\n            var opts = $.extend(true, {}, defaults, options);\n            _this.middlewares = new __WEBPACK_IMPORTED_MODULE_0__middleware_manager__[\"a\" /* default */](opts, _this.notify.bind(_this), _this);\n            return _this;\n        }\n\n        /**\n         * Allow intercepting and handling/suppressing data to publish calls.\n         * @param {string | Publishable } topic\n         * @param {any} [value] item to publish\n         * @param {Object} [options]\n         * @return {Promise}\n         */\n\n\n        _createClass(ChannelWithMiddleware, [{\n            key: 'publish',\n            value: function publish(topic, value, options) {\n                var _this2 = this;\n\n                var normalized = Object(__WEBPACK_IMPORTED_MODULE_1__channel_utils__[\"d\" /* normalizeParamOptions */])(topic, value, options);\n                var prom = $.Deferred().resolve(normalized.params).promise();\n                var lastAvailableData = normalized.params;\n                var middlewares = this.middlewares.filter('publish');\n                middlewares.forEach(function (middleware) {\n                    prom = prom.then(function (publishResponse) {\n                        return middleware(publishResponse, normalized.options);\n                    }).then(function (response) {\n                        lastAvailableData = response || lastAvailableData;\n                        return lastAvailableData;\n                    });\n                });\n                prom = prom.then(function (published) {\n                    return _get(ChannelWithMiddleware.prototype.__proto__ || Object.getPrototypeOf(ChannelWithMiddleware.prototype), 'publish', _this2).call(_this2, published, normalized.options);\n                });\n                return prom;\n            }\n            /**\n             * Allow intercepting and excluding topics from subscription\n             * @param  {string | string[]}   topics\n             * @param  {Function} cb\n             * @param  {Object}   options\n             * @return {string}           subscription id\n             */\n\n        }, {\n            key: 'subscribe',\n            value: function subscribe(topics, cb, options) {\n                var subscribeMiddlewares = this.middlewares.filter('subscribe');\n                var newTopics = [].concat(topics);\n                subscribeMiddlewares.forEach(function (middleware) {\n                    newTopics = middleware(newTopics, options) || newTopics;\n                });\n                return _get(ChannelWithMiddleware.prototype.__proto__ || Object.getPrototypeOf(ChannelWithMiddleware.prototype), 'subscribe', this).call(this, newTopics, cb, options);\n            }\n\n            /**\n             * Calls unsubscribe middleware *after* unsubscription with a list of recently unsubscribed topics\n             * @param  {string} token\n             * @return {void}\n             */\n\n        }, {\n            key: 'unsubscribe',\n            value: function unsubscribe(token) {\n                var currentTopics = getTopicsFromSubsList(this.subscriptions);\n                _get(ChannelWithMiddleware.prototype.__proto__ || Object.getPrototypeOf(ChannelWithMiddleware.prototype), 'unsubscribe', this).call(this, token);\n                var remainingTopics = getTopicsFromSubsList(this.subscriptions);\n\n                var unsubscribedTopics = _.difference(currentTopics, remainingTopics);\n                var middlewares = this.middlewares.filter('unsubscribe');\n                middlewares.forEach(function (middleware) {\n                    return middleware(unsubscribedTopics, remainingTopics);\n                });\n            }\n\n            /**\n             * Calls unsubscribe middleware after unsubscribeAll on the channel\n             * @return {void}\n             */\n\n        }, {\n            key: 'unsubscribeAll',\n            value: function unsubscribeAll() {\n                var currentlySubscribed = this.getSubscribedTopics();\n                _get(ChannelWithMiddleware.prototype.__proto__ || Object.getPrototypeOf(ChannelWithMiddleware.prototype), 'unsubscribeAll', this).call(this);\n                var middlewares = this.middlewares.filter('unsubscribe');\n                middlewares.forEach(function (middleware) {\n                    return middleware(currentlySubscribed, []);\n                });\n            }\n        }]);\n\n        return ChannelWithMiddleware;\n    }(ChannelManager);\n}\n\n/***/ }),\n/* 54 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = MiddlewareManager;\nfunction MiddlewareManager(options, notifier, channelManagerContext) {\n    var defaults = {\n        middlewares: []\n    };\n    var opts = $.extend(true, {}, defaults, options);\n    var optsToPassOn = _.omit(opts, Object.keys(defaults));\n\n    var list = [];\n    var publicAPI = {\n        list: list,\n\n        add: function (middleware, index) {\n            if (_.isFunction(middleware)) {\n                //FIXME: move channelManagerContext functionality to router\n                middleware = new middleware(optsToPassOn, notifier, channelManagerContext);\n            }\n            $.extend(channelManagerContext, middleware.expose); //add any public props middleware wants to expose\n            list.push(middleware);\n        },\n\n        filter: function (type) {\n            type = type + 'Handler';\n            return list.reduce(function (accum, m) {\n                if (m[type]) {\n                    accum.push(m[type]);\n                }\n                return accum;\n            }, []);\n        }\n    };\n\n    $.extend(this, publicAPI);\n    opts.middlewares.forEach(this.add);\n}\n\n/***/ })\n/******/ ]);\n\n\n// WEBPACK FOOTER //\n// flow.min.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 11);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 7afc5a5d7ca4a9d9046f","'use strict';\nmodule.exports = {\n    prefix: 'f',\n    defaultAttr: 'bind',\n\n    binderAttr: 'f-bind',\n\n    events: {\n        //UI Change to publish to the channel.\n        trigger: 'update.f.ui',\n\n        //Payload is of form {topic: value}. When triggered on a element dom-manager will trigger 'f.convert' on every attribute subscribed to that topic\n        channelDataReceived: 'update.f.model',\n\n        //Trigger with payload '{attrToUpdate: value}', for e.g. { bind: 34 }. This will run this through all the converts and pass it to attr handler. Useful to by-pass getting this from the model directly.\n        convert: 'f.convert',\n\n        //When triggered posts the payload to the operations API. Assumes payloaded is formmatted in a way Run Channel can understand\n        operate: 'f.ui.operate'\n    },\n\n    attrs: {\n        //Array with shape [{ attr: attribute, topics:[list of topics attribute is listening to]}]\n        bindingsList: 'f-attr-bindings',\n\n        //Subscription id returned by the channel. Used to ubsubscribe later\n        subscriptionId: 'f-subscription-id',\n\n        //Used by the classes attr handler to keep track of which classes were added by itself\n        classesAdded: 'f-added-classes',\n\n        //Used by repeat attr handler to keep track of template after first evaluation\n        repeat: {\n            template: 'repeat-template', //don't prefix by f or dom-manager unbind will kill it\n            templateId: 'repeat-template-id'\n        },\n\n        //Used by foreach attr handler to keep track of template after first evaluation\n        foreachTemplate: 'f-foreach-template',\n        keyAs: 'f-foreach-key-as',\n        valueAs: 'f-foreach-value-as',\n\n        //Used by bind attr handler to keep track of template after first evaluation\n        bindTemplate: 'f-bind-template'\n    }\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/config.js","/**\n * @param {String} topic\n * @param {Handler[]} handlers\n * @return {MatchedHandler | undefined}\n */\nexport function findBestHandler(topic, handlers) {\n    for (var i = 0; i < handlers.length; i++) {\n        var thishandler = handlers[i];\n        var match = thishandler.match(topic);\n        if (match !== false) {\n            return $.extend(true, {}, thishandler, { matched: match });\n        }\n    }\n    return undefined;\n}\n\n/**\n * \n * @param {Object} obj\n * @return {Publishable[]}\n */\nexport function objectToArray(obj) {\n    var mapped = Object.keys(obj || {}).map(function (t) {\n        return { name: t, value: obj[t] };\n    });\n    return mapped;\n}\n\n/**\n * Converts arrays of the form [{ name: '', value: ''}] to {[name]: value}\n * @param {Publishable[]} arr\n * @returns {Object}\n */\nexport function arrayToObject(arr) {\n    var result = (arr || []).reduce(function (accum, topic) {\n        accum[topic.name] = topic.value;\n        return accum;\n    }, {});\n    return result;\n}\n\n/**\n * @typedef NormalizedParam\n * @property {Publishable[]} params\n * @property {Object} options\n */\n\n/**\n *\n * @param {String|Object|array} topic \n * @param {*} publishValue \n * @param {Object} options\n * @return {NormalizedParam}\n */\nexport function normalizeParamOptions(topic, publishValue, options) {\n    if (!topic) {\n        return { params: [], options: {} };\n    }\n    if ($.isPlainObject(topic)) {\n        return { params: objectToArray(topic), options: publishValue };\n    }\n    if ($.isArray(topic)) {\n        return { params: topic, options: publishValue };\n    }\n    return { params: [{ name: topic, value: publishValue }], options: options };\n}\n\n\n/**\n * [groupByHandlers description]\n * @param  {String[]} topics   List of topics to match. Format can be anything your handler.match function handles\n * @param  {Handler[]} handlers Handlers of type [{ match: func }]\n * @return {MatchedHandler[]} The handler array with each item now having an additional 'data' attr added to it\n */\nexport function groupByHandlers(topics, handlers) {\n    handlers = handlers.map(function (h, index) {\n        h.key = index;\n        return h;\n    });\n    var topicMapping = ([].concat(topics)).reduce(function (accum, topic) {\n        var bestHandler = findBestHandler(topic, handlers);\n        if (bestHandler) {\n            //if handler matches different strings treat both as different handlers\n            var key = bestHandler.key + bestHandler.matched;\n            if (!accum[key]) {\n                bestHandler.data = [];\n                accum[key] = bestHandler;\n            }\n            accum[key].data.push(topic);\n        }\n        return accum;\n    }, {});\n    return _.values(topicMapping);\n}\n\n/**\n * Takes a `publish` dataset and groups it by handler maintaining the data sequence\n * @param  {Publishable[]} data     Of the form [{ name: 'X', }]\n * @param  {Handler[]} handlers Handlers of type [{ match: func }]\n * @return {MatchedHandler[]} The handler array with each item now having an additional 'data' attr added to it\n */\nexport function groupSequentiallyByHandlers(data, handlers) {\n    handlers = handlers.map(function (h, index) {\n        h.key = index;\n        return h;\n    });\n    var grouped = data.reduce(function (accum, dataPt) {\n        var lastHandler = accum[accum.length - 1];\n        var bestHandler = findBestHandler(dataPt.name, handlers);\n        if (bestHandler) {\n            if (lastHandler && bestHandler.key === lastHandler.key) {\n                lastHandler.data.push(dataPt);\n            } else {\n                accum.push($.extend({}, bestHandler, { data: [dataPt] }));\n            }\n        } else {\n            accum.push({ data: [dataPt], matched: false });\n        }\n        return accum;\n    }, []);\n    return grouped;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/channel-utils.js","var CHANNEL_DELIMITER = ':';\n\nexport { default as silencable } from './silencable';\nexport { default as excludeReadOnly } from './exclude-read-only';\n\n/**\n * \n * @param {string} text\n * @return {string}\n */\nexport function stripSuffixDelimiter(text) {\n    if (text && text.indexOf(CHANNEL_DELIMITER) === (text.length - 1)) {\n        text = text.replace(CHANNEL_DELIMITER, '');\n    }\n    return text;\n}\n\n/**\n * \n * @param {string} prefix\n * @returns {matchFunction}\n */\nexport function prefix(prefix) {\n    return function matchPrefix(topic) {\n        return (topic.indexOf(prefix) === 0) ? prefix : false;\n    };\n}\n\n/**\n* \n* @param {string} prefix\n* @returns {matchFunction}\n*/\nexport function defaultPrefix(prefix) {\n    return function matchPrefix(topic) {\n        return prefix;\n    };\n}\n\n/**\n * \n * @param {string} regex\n * @returns {matchFunction}\n */\nexport function regex(regex) {\n    var toMatch = new RegExp('^' + regex + CHANNEL_DELIMITER);\n    return function matchRegex(topic) {\n        var match = topic.match(toMatch);\n        if (match && match.length) {\n            return match[0];\n        }\n        return false;\n    };\n}\n\n/**\n * \n * @param {Publishable[]} dataArray \n * @param {string} prefix \n * @return {Publishable} array with name prefixed\n */\nexport function mapWithPrefix(dataArray, prefix) {\n    if (!prefix) return dataArray;\n    return (dataArray || []).map(function (datapt) {\n        return $.extend(true, {}, datapt, { name: prefix + datapt.name });\n    });\n}\n\n/**\n * \n * @param {Function} callback \n * @param {string[]} prefixList\n * @return {Function}\n */\nexport function withPrefix(callback, prefixList) {\n    prefixList = [].concat(prefixList);\n\n    /**\n     * @param {Publishable[]} data\n     */\n    return function (data) {\n        prefixList.forEach(function (prefix) {\n            var mapped = mapWithPrefix(data, prefix);\n            callback(mapped);\n        });\n    };\n}\n\n/**\n * \n * @param {Publishable[]} list \n * @param {string} prefix\n * @return {Publishable[]} Item with prefix removed\n */\nexport function unprefix(list, prefix) {\n    if (!prefix) return list;\n    var unprefixed = list.map(function (item) {\n        if (item.name) {\n            return $.extend(true, {}, item, { name: item.name.replace(prefix, '') });\n        }\n        return item.replace(prefix, '');\n    });\n    return unprefixed;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/middleware/utils/index.js","'use strict';\n\nfunction toImplicitType(data) {\n    var objRegex = /^(?:\\{.*\\})$/;\n    var arrRegex = /^(?:\\[.*])$/;\n\n    var converted = data;\n    if (typeof data === 'string') {\n        converted = data.trim();\n\n        if (converted === 'true') {\n            converted = true;\n        } else if (converted === 'false') {\n            converted = false;\n        } else if (converted === 'null') {\n            converted = null;\n        } else if (converted === 'undefined') {\n            converted = '';\n        } else if (converted.charAt(0) === '\\'' || converted.charAt(0) === '\"') {\n            converted = converted.substring(1, converted.length - 1);\n        } else if ($.isNumeric(converted)) {\n            converted = +converted;\n        } else if (arrRegex.test(converted)) {\n            const bracketReplaced = converted.replace(/[[\\]]/g, '');\n            if (!bracketReplaced) return [];\n            const parsed = bracketReplaced.split(/,(?![^[]*])/).map((val)=> {\n                return toImplicitType(val);\n            });\n            return parsed;\n        } else if (objRegex.test(converted)) {\n            try {\n                converted = JSON.parse(converted);\n            } catch (e) {\n                console.error('toImplicitType: couldn\\'t convert', converted);\n            }\n        }\n    }\n    return converted;\n}\n\nfunction toOperationFormat(value) {\n    var split = (value || '').split('|');\n    var listOfOperations = split.map(function (value) {\n        value = value.trim();\n        var fnName = value.split('(')[0];\n        var params = value.substring(value.indexOf('(') + 1, value.indexOf(')'));\n        var args = params.trim() !== '' ? params.split(',') : [];\n\n        return { name: fnName, value: args };\n    });\n    return listOfOperations;\n}\n\nexport { toImplicitType, toOperationFormat };\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils/parse-utils.js","import { groupByHandlers, groupSequentiallyByHandlers } from 'channels/channel-utils';\nimport { unprefix, mapWithPrefix, silencable, excludeReadOnly } from 'channels/middleware/utils';\n\n/**\n * Handle subscriptions\n * @param  {Handler[]} handlers Array of the form [{ match: function (){}, }]\n * @param  {String[]} topics   Array of strings\n * @param  {SubscribeOptions} [options]\n * @return {String[]} Returns the original topics array\n */\nexport function notifySubscribeHandlers(handlers, topics, options) {\n    var grouped = groupByHandlers(topics, handlers);\n    grouped.forEach(function (handler) {\n        if (handler.subscribeHandler) {\n            var mergedOptions = $.extend(true, {}, handler.options, options);\n            var unprefixed = unprefix(handler.data, handler.matched);\n            handler.subscribeHandler(unprefixed, mergedOptions, handler.matched);\n        }\n    });\n    return topics;\n}\n\n/**\n * \n * @param {Handler[]} handlers \n * @param {String[]} recentlyUnsubscribedTopics\n * @param {String[]} remainingTopics \n */\nexport function notifyUnsubscribeHandlers(handlers, recentlyUnsubscribedTopics, remainingTopics) {\n    handlers = handlers.map(function (h, index) {\n        h.unsubsKey = index;\n        return h;\n    });\n\n    var unsubsGrouped = groupByHandlers(recentlyUnsubscribedTopics, handlers);\n    var remainingGrouped = groupByHandlers(remainingTopics, handlers);\n\n    unsubsGrouped.forEach(function (handler) {\n        if (handler.unsubscribeHandler) {\n            var unprefixedUnsubs = unprefix(handler.data, handler.matched);\n            var matchingRemainingHandler = _.find(remainingGrouped, function (remainingHandler) {\n                return remainingHandler.unsubsKey === handler.unsubsKey;\n            });\n            var matchingTopicsRemaining = matchingRemainingHandler ? matchingRemainingHandler.data : [];\n            var unprefixedRemaining = unprefix(matchingTopicsRemaining || [], handler.matched);\n            handler.unsubscribeHandler(unprefixedUnsubs, unprefixedRemaining);\n        }\n    });\n}\n\n/**\n * \n * @param {Handler[]} handlers \n * @param {Publishable[]} publishData \n * @param {PublishOptions} [options]\n * @return {Promise}\n */\nexport function passthroughPublishInterceptors(handlers, publishData, options) {\n    var grouped = groupSequentiallyByHandlers(publishData, handlers);\n    var $initialProm = $.Deferred().resolve([]).promise();\n    grouped.forEach(function (handler) {\n        $initialProm = $initialProm.then(function (dataSoFar) {\n            var mergedOptions = $.extend(true, {}, handler.options, options);\n            var unprefixed = unprefix(handler.data, handler.matched);\n\n            var publishableData = excludeReadOnly(unprefixed, mergedOptions.readOnly);\n            if (!publishableData.length) {\n                return dataSoFar;\n            }\n\n            var result = handler.publishHandler ? handler.publishHandler(publishableData, mergedOptions, handler.matched) : publishableData;\n            var publishProm = $.Deferred().resolve(result).promise();\n            return publishProm.then(function (published) {\n                return silencable(published, mergedOptions.silent);\n            }).then(function (published) {\n                var mapped = mapWithPrefix(published, handler.matched);\n                if (handler.isDefault && handler.matched) {\n                    mapped = mapped.concat(published);\n                }\n                return mapped;\n            }).then(function (mapped) {\n                return [].concat(dataSoFar, mapped);\n            });\n        });\n    });\n    return $initialProm;\n}\n\n/**\n * Router\n * @param  {Handler[]} handlers\n * @return {Router}\n */\nexport default function Router(handlers) {\n    return $.extend(this, {\n        /**\n         * @param {String[]} topics\n         * @param {SubscribeOptions} [options]\n         * @return {String[]} Returns the original topics array\n         */\n        subscribeHandler: function (topics, options) {\n            return notifySubscribeHandlers(handlers, topics, options);\n        },\n        /**\n         * @param {String[]} recentlyUnsubscribedTopics\n         * @param {String[]} remainingTopics\n         * @return {void}\n         */\n        unsubscribeHandler: function (recentlyUnsubscribedTopics, remainingTopics) {\n            return notifyUnsubscribeHandlers(handlers, recentlyUnsubscribedTopics, remainingTopics);\n        },\n\n        /**\n         * @param {Publishable[]} data\n         * @param {PublishOptions} [options]\n         * @return {Promise}\n         */\n        publishHandler: function (data, options) {\n            return passthroughPublishInterceptors(handlers, data, options);\n        },\n\n        // Ignoring till ready to implement\n        // addRoute: function (handler) {\n        //     if (!handler || !handler.match) {\n        //         throw Error('Handler does not have a valid `match` property');\n        //     }\n        //     handler.id = uniqueId('routehandler-');\n        //     handlers.push(handler);\n        //     return handler.id;\n        // },\n        // removeRoute: function (routeid) {\n        //     handlers = handlers.reduce(function (accum, handler) {\n        //         if (handler.id !== routeid) {\n        //             accum.push(handler);\n        //         }\n        //         return accum;\n        //     }, []);\n        // }\n    });\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/channel-router.js","'use strict';\n\nmodule.exports = {\n    random: function (prefix, min, max) {\n        if (!min) {\n            min = parseInt(_.uniqueId(), 10);\n        }\n        if (!max) {\n            max = 100000; //eslint-disable-line no-magic-numbers\n        }\n        var number = _.random(min, max, false) + '';\n        if (prefix) {\n            number = prefix + number;\n        }\n        return number;\n    },\n\n    /**\n     * A promise-returning debounce function. Also lets you decide what to do with arguments passed in while being debounced\n     * @param  {Function} fn                function to debounce\n     * @param  {Number}   debounceInterval  interval\n     * @param  {Array}   argumentsReducers A reducer for each argument to the function\n     * @return {Promise}                     \n     */\n    debounceAndMerge: function (fn, debounceInterval, argumentsReducers) {\n        var timer = null;\n\n        var argsToPass = [];\n        if (!argumentsReducers) {\n            var arrayReducer = function (accum, newVal) {\n                if (!accum) {\n                    accum = [];\n                }\n                return accum.concat(newVal);\n            };\n            argumentsReducers = [\n                arrayReducer\n            ];\n        }\n        return function () {\n            var $def = $.Deferred();\n            var newArgs = _.toArray(arguments);\n            argsToPass = newArgs.map(function (arg, index) {\n                var reducer = argumentsReducers[index];\n                if (reducer) {\n                    return reducer(argsToPass[index], arg);\n                } else {\n                    return arg;\n                }\n            });\n\n            if (timer) {\n                clearTimeout(timer);\n            }\n            timer = setTimeout(function () {\n                timer = null;\n                var res = fn.apply(fn, argsToPass);\n                if (res && res.then) {\n                    return res.then(function (arg) {\n                        argsToPass = [];\n                        $def.resolve(arg);\n                    });\n                } else {\n                    argsToPass = [];\n                    $def.resolve(res);\n                }\n            }, debounceInterval);\n\n            return $def.promise();\n        };\n    }\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils/general.js","import MetaChannel from './run-meta-channel';\nimport VariablesChannel from './run-variables-channel';\nimport OperationsChannel from './run-operations-channel';\n\nimport Router from 'channels/channel-router';\nimport { withPrefix, prefix, defaultPrefix } from 'channels/middleware/utils';\n\nexport default function RunRouter(config, notifier) {\n    var defaults = {\n        serviceOptions: {},\n        channelOptions: {\n            variables: {\n                autoFetch: true,\n                debounce: 200,\n                silent: false,\n                readOnly: false,\n            },\n            operations: {\n                readOnly: false,\n                silent: false,\n            },\n            meta: {\n                silent: false,\n                autoFetch: true,\n                readOnly: ['id', 'created', 'account', 'project', 'model', 'lastModified']\n            },\n        }\n    };\n    var opts = $.extend(true, {}, defaults, config);\n\n    var serviceOptions = _.result(opts, 'serviceOptions');\n\n    var $initialProm = null;\n    if (serviceOptions instanceof window.F.service.Run) {\n        $initialProm = $.Deferred().resolve(serviceOptions).promise();\n    } else if (serviceOptions.then) {\n        $initialProm = serviceOptions;\n    } else {\n        var rs = new window.F.service.Run(serviceOptions);\n        $initialProm = $.Deferred().resolve(rs).promise();\n    }\n\n\n    var metaChannel = new MetaChannel($initialProm, withPrefix(notifier, 'meta:'));\n    var operationsChannel = new OperationsChannel($initialProm, withPrefix(notifier, 'operations:'));\n    var variableschannel = new VariablesChannel($initialProm, withPrefix(notifier, ['variables:', '']));\n\n    var handlers = [\n        $.extend({}, metaChannel, { \n            name: 'meta',\n            match: prefix('meta:'),\n            options: opts.channelOptions.meta,\n        }),\n        $.extend({}, operationsChannel, { \n            name: 'operations',\n            match: prefix('operations:'),\n            options: opts.channelOptions.operations,\n        }),\n        $.extend({}, variableschannel, { \n            isDefault: true,\n            name: 'variables',\n            match: defaultPrefix('variables:'),\n            options: opts.channelOptions.variables,\n        }),\n    ];\n\n    var router = new Router(handlers, notifier);\n    var oldhandler = router.publishHandler;\n    router.publishHandler = function () {\n        var prom = oldhandler.apply(router, arguments);\n        return prom.then(function (result) { //all the silencing will be taken care of by the router\n            var shouldFetch = _.find(result, (r)=> r.name.indexOf('operations:') === 0 || r.name.indexOf('variables:') === 0);\n            if (shouldFetch) {\n                variableschannel.fetch();\n            }\n            return result;\n        });\n    };\n    return router;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/middleware/epicenter-middleware/run-router/index.js","'use strict';\nvar config = require('../../config');\nvar BaseView = require('./default-node');\n\nmodule.exports = BaseView.extend({\n    propertyHandlers: [],\n\n    uiChangeEvent: 'change',\n    getUIValue: function () {\n        return this.$el.val();\n    },\n\n    removeEvents: function () {\n        this.$el.off(this.uiChangeEvent);\n    },\n\n    initialize: function () {\n        var me = this;\n        var propName = this.$el.data(config.binderAttr);\n\n        if (propName) {\n            this.$el.off(this.uiChangeEvent).on(this.uiChangeEvent, function () {\n                var val = me.getUIValue();\n\n                var params = {};\n                params[propName] = val;\n\n                me.$el.trigger(config.events.trigger, params);\n            });\n        }\n        BaseView.prototype.initialize.apply(this, arguments);\n    }\n}, { selector: 'input, select' });\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/nodes/default-input-node.js","'use strict';\n\nvar BaseView = require('../../utils/base-view');\n\nmodule.exports = BaseView.extend({\n    propertyHandlers: [\n\n    ],\n\n    initialize: function () {\n    }\n}, { selector: '*' });\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/nodes/default-node.js","'use strict';\n\nvar extend = function (protoProps, staticProps) {\n    var me = this;\n    var child;\n\n    // The constructor function for the new subclass is either defined by you\n    // (the \"constructor\" property in your `extend` definition), or defaulted\n    // by us to simply call the parent's constructor.\n    if (protoProps && _.has(protoProps, 'constructor')) {\n        child = protoProps.constructor;\n    } else {\n        child = function () { return me.apply(this, arguments); };\n    }\n\n    // Add static properties to the constructor function, if supplied.\n    _.extend(child, me, staticProps);\n\n    // Set the prototype chain to inherit from `parent`, without calling\n    // `parent`'s constructor function.\n    var Surrogate = function () { this.constructor = child; };\n    Surrogate.prototype = me.prototype;\n    child.prototype = new Surrogate();\n\n    // Add prototype properties (instance properties) to the subclass,\n    // if supplied.\n    if (protoProps) {\n        _.extend(child.prototype, protoProps);\n    }\n\n    // Set a convenience property in case the parent's prototype is needed\n    // later.\n    child.__super__ = me.prototype; //eslint-disable-line no-underscore-dangle\n\n    return child;\n};\n\nvar View = function (options) {\n    this.$el = (options.$el) || $(options.el);\n    this.el = options.el;\n    this.initialize.apply(this, arguments);\n\n};\n\n_.extend(View.prototype, {\n    initialize: function () {},\n});\n\nView.extend = extend;\n\nmodule.exports = View;\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils/base-view.js","var { isArray } = _;\n\nvar interpolationRegex = /<(.*?)>/g;\n/**\n *  \n * @param {String} topic topic to extract dependencies from\n * @return {String[]} dependencies\n */\nexport function extractDependencies(topic) {\n    var deps = (topic.match(interpolationRegex) || []).map((val) => {\n        return val.substring(1, val.length - 1); \n    });\n    return deps;\n}\n\n/**\n * @param {String} topic topic with dependencies\n * @param {Object} data object with values of dependencies\n * @return {String} interpolated string\n */\nexport function interpolateWithValues(topic, data) {\n    var interpolatedTopic = topic.replace(interpolationRegex, (match, dependency)=> {\n        var val = data[dependency];\n        var toReplace = isArray(val) ? val[val.length - 1] : val;\n        return toReplace;\n    });\n    return interpolatedTopic;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/channel-manager-enhancements/interpolatable/interpolatable-utils.js","/**\n * ## Flow.js Initialization\n *\n * To use Flow.js in your project, simply call `Flow.initialize()` in your user interface. In the basic case, `Flow.initialize()` can be called without any arguments. While Flow.js needs to know the account, project, and model you are using, by default these values are extracted from the URL of Epicenter project and by the use of `data-f-model` in your `<body>` tag. See more on the [basics of using Flow.js in your project.](../../#using_in_project).\n *\n * However, sometimes you want to be explicit in your initialization call, and there are also some additional parameters that let you customize your use of Flow.js.\n *\n * #### Parameters\n *\n * The parameters for initializing Flow.js include:\n *\n * * `channel` Configuration details for the channel Flow.js uses in connecting with underlying APIs.\n * * `channel.strategy` The run creation strategy describes when to create new runs when an end user visits this page. The default is `new-if-persisted`, which creates a new run when the end user is idle for longer than your project's **Model Session Timeout** (configured in your project's [Settings](../../../updating_your_settings/)), but otherwise uses the current run.. See more on [Run Strategies](../../../api_adapters/strategy/).\n * * `channel.run` Configuration details for each run created.\n * * `channel.run.account` The **User ID** or **Team ID** for this project. By default, taken from the URL where the user interface is hosted, so you only need to supply this is you are running your project's user interface [on your own server](../../../how_to/self_hosting/).\n * * `channel.run.project` The **Project ID** for this project.\n * * `channel.run.model` Name of the primary model file for this project. By default, taken from `data-f-model` in your HTML `<body>` tag.\n * * `channel.run.variables` Configuration options for the variables being listened to on this channel.\n * * `channel.run.variables.silent` Provides granular control over when user interface updates happen for changes on this channel. See below for possible values.\n * * `channel.run.variables.autoFetch` Options for fetching variables from the API as they're being subscribed. See [Variables Channel](../channels/variables-channel/) for details.\n * * `channel.run.operations` Configuration options for the operations being listened to on this channel. Currently there is only one configuration option: `silent`.\n * * `channel.run.operations.silent` Provides granular control over when user interface updates happen for changes on this channel. See below for possible values.\n * * `channel.run.server` Object with additional server configuration, defaults to `host: 'api.forio.com'`.\n * * `channel.run.transport` An object which takes all of the jquery.ajax options at <a href=\"http://api.jquery.com/jQuery.ajax/\">http://api.jquery.com/jQuery.ajax/</a>.\n * * `dom` Configuration options for the DOM where this instance of Flow.js is created.\n * * `dom.root` The root HTML element being managed by the Flow.js DOM Manager. Defaults to `body`.\n * * `dom.autoBind` If `true` (default), automatically parse variables added to the DOM after this `Flow.initialize()` call. Note, this does not work in IE versions < 11.\n *\n * The `silent` configuration option for the `run.variables` and `run.operations` is a flag for providing more granular control over when user interface updates happen for changes on this channel. Values can be:\n *\n * * `false`: Always update the UI for any changes (variables updated, operations called) on this channel. This is the default behavior.\n * * `true`: Never update the UI for any on changes (variables updated, operations called) on this channel.\n * * Array of variables or operations for which the UI *should not* be updated. For example, `variables: { silent: [ 'price', 'sales' ] }` means this channel is silent (no updates for the UI) when the variables 'price' or 'sales' change, and the UI is always updated for any changes to other variables. This is useful if you know that changing 'price' or 'sales' does not impact anything else in the UI directly, for instance.\n * * `except`: With array of variables or operations for which the UI *should* be updated. For example, `variables { silent: { except: [ 'price', 'sales' ] } }` is the converse of the above. The UI is always updated when anything on this channel changes *except* when the variables 'price' or 'sales' are updated.\n *\n * Although Flow.js provides a bi-directional binding between the model and the user interface, the `silent` configuration option applies only for the binding from the model to the user interface; updates in the user interface (including calls to operations) are still sent to the model.\n *\n * The `Flow.initialize()` call is based on the Epicenter.js [Run Service](../../../api_adapters/generated/run-api-service/) from the [API Adapters](../../../api_adapters/). See those pages for additional information on parameters.\n *\n * The `Flow.initialize()` call returns a promise, which is resolved when initialization is complete.\n *\n * #### Example\n *\n *      Flow.initialize({\n *          channel: {\n *              strategy: 'new-if-persisted',\n *              run: {\n *                  model: 'supply-chain-game.py',\n *                  account: 'acme-simulations',\n *                  project: 'supply-chain-game',\n *                  server: { host: 'api.forio.com' },\n *                  variables: { silent: ['price', 'sales'] },\n *                  operations: { silent: false },\n *                  transport: {\n *                      beforeSend: function() { $('body').addClass('loading'); },\n *                      complete: function() { $('body').removeClass('loading'); }\n *                  }\n *              }\n *          }\n *      }).then(function() {\n *          // code that depends on initialization\n *      });\n *\n */\n\n'use strict';\n\nvar domManager = require('./dom/dom-manager');\nvar BaseView = require('./utils/base-view');\n\nvar ChannelManager = require('channels/configured-channel-manager').default;\n// var parseUtils = require('utils/parse-utils');\n\nvar Flow = {\n    dom: domManager,\n    utils: {\n        BaseView: BaseView\n    },\n    initialize: function (config) {\n        var model = $('body').data('f-model');\n\n        var defaults = {\n            channel: {\n                //FIXME: Defaults can't be here..\n                defaults: {\n                    run: {\n                        model: model,\n                    }\n                },\n            },\n            dom: {\n                root: 'body',\n                autoBind: true\n            }\n        };\n\n        var options = $.extend(true, {}, defaults, config);\n        // var $root = $(options.dom.root);\n\n        // var initialFn = $root.data('f-on-init');\n        // //TOOD: Should move this to DOM Manager and just prioritize on-inits\n        // if (initialFn) {\n        //     var listOfOperations = _.invoke(initialFn.split('|'), 'trim');\n        //     listOfOperations = listOfOperations.map(function (value) {\n        //         var fnName = value.split('(')[0];\n        //         var params = value.substring(value.indexOf('(') + 1, value.indexOf(')'));\n        //         var args = ($.trim(params) !== '') ? params.split(',') : [];\n        //         args = args.map(function (a) {\n        //             return parseUtils.toImplicitType(a.trim());\n        //         });\n        //         var toReturn = {};\n        //         toReturn[fnName] = args;\n        //         return toReturn;\n        //     });\n\n        //     //TODO: Make a channel configuration factory which gets the initial info\n        //     options.channel.options.runManager.defaults.initialOperation = listOfOperations;\n        // }\n   \n        if (config && config.channel && (config.channel instanceof ChannelManager)) {\n            this.channel = config.channel;\n        } else {\n            this.channel = new ChannelManager(options.channel);\n        }\n\n        var prom = domManager.initialize($.extend(true, {\n            channel: this.channel\n        }, options.dom));\n        \n        this.channel.subscribe('operations:reset', function () {\n            domManager.unbindAll();\n            domManager.bindAll();\n        });\n\n        return prom;\n    }\n};\nFlow.ChannelManager = ChannelManager;\n//set by grunt\nif (RELEASE_VERSION) Flow.version = RELEASE_VERSION; //eslint-disable-line no-undef\nmodule.exports = Flow;\n\n\n\n// WEBPACK FOOTER //\n// ./src/flow.js","/**\n * ## DOM Manager\n *\n * The Flow.js DOM Manager provides two-way data bindings from your project's user interface to the channel. The DOM Manager is the 'glue' through which HTML DOM elements -- including the attributes and attribute handlers provided by Flow.js for [variables](../../attributes-overview/), [operations](../../operations-overview/) and [conversion](../../converter-overview/), and those [you create](./attributes/attribute-manager/) -- are bound to the variable and operations [channels](../../channel-overview/) to link them with your project's model. See the [Epicenter architecture details](../../../creating_your_interface/arch_details/) for a visual description of how the DOM Manager relates to the [rest of the Epicenter stack](../../../creating_your_interface/).\n *\n * The DOM Manager is an integral part of the Flow.js architecture but, in keeping with our general philosophy of extensibility and configurability, it is also replaceable. For instance, if you want to manage your DOM state with [Backbone Views](http://backbonejs.org) or [Angular.js](https://angularjs.org), while still using the channels to handle the communication with your model, this is the piece you'd replace. [Contact us](http://forio.com/about/contact/) if you are interested in extending Flow.js in this way -- we'll be happy to talk about it in more detail.\n *\n */\n'use strict';\n\nmodule.exports = (function () {\n    var config = require('config');\n    var parseUtils = require('utils/parse-utils');\n    var domUtils = require('utils/dom');\n\n    var converterManager = require('converters/converter-manager');\n    var nodeManager = require('./nodes/node-manager');\n    var attrManager = require('./attributes/attribute-manager');\n    var autoUpdatePlugin = require('./plugins/auto-update-bindings');\n\n    //Jquery selector to return everything which has a f- property set\n    $.expr.pseudos[config.prefix] = function (el) {\n        if (!el || !el.attributes) {\n            return false;\n        }\n        for (var i = 0; i < el.attributes.length; i++) {\n            var attr = el.attributes[i].nodeName;\n            if (attr.indexOf('data-' + config.prefix) === 0) {\n                return true;\n            }\n        }\n        return false;\n    };\n\n    $.expr.pseudos.webcomponent = function (obj) {\n        return obj.nodeName.indexOf('-') !== -1;\n    };\n\n    var getMatchingElements = function (root) {\n        var $root = $(root);\n        var matchedElements = $root.find(':' + config.prefix);\n        if ($root.is(':' + config.prefix)) {\n            matchedElements = matchedElements.add($root);\n        }\n        return matchedElements;\n    };\n\n    var getElementOrError = function (element, context) {\n        if (element instanceof $) {\n            element = element.get(0);\n        }\n        if (!element || !element.nodeName) {\n            console.error(context, 'Expected to get DOM Element, got ', element);\n            throw new Error(context + ': Expected to get DOM Element, got' + (typeof element));\n        }\n        return element;\n    };\n\n    var publicAPI = {\n\n        nodes: nodeManager,\n        attributes: attrManager,\n        converters: converterManager,\n        //utils for testing\n        private: {\n            matchedElements: []\n        },\n\n        /**\n         * Unbind the element: unsubscribe from all updates on the relevant channels.\n         *\n         * @param {DomElement} element The element to remove from the data binding.\n         * @param {ChannelInstance} channel (Optional) The channel from which to unsubscribe. Defaults to the [variables channel](../channels/variables-channel/).\n         * @returns {undefined}\n         */\n        unbindElement: function (element, channel) {\n            if (!channel) {\n                channel = this.options.channel;\n            }\n            element = getElementOrError(element);\n            var $el = $(element);\n            if (!$el.is(':' + config.prefix)) {\n                return false;\n            }\n            this.private.matchedElements = _.without(this.private.matchedElements, element);\n\n            //FIXME: have to readd events to be able to remove them. Ugly\n            var Handler = nodeManager.getHandler($el);\n            var h = new Handler.handle({\n                el: element\n            });\n            if (h.removeEvents) {\n                h.removeEvents();\n            }\n\n            $(element.attributes).each(function (index, nodeMap) {\n                var attr = nodeMap.nodeName;\n                var wantedPrefix = 'data-f-';\n                if (attr.indexOf(wantedPrefix) === 0) {\n                    attr = attr.replace(wantedPrefix, '');\n                    var handler = attrManager.getHandler(attr, $el);\n                    if (handler.unbind) {\n                        handler.unbind.call($el, attr);\n                    }\n                }\n            });\n\n            var subsid = $el.data(config.attrs.subscriptionId) || [];\n            _.each([].concat(subsid), function (subs) {\n                channel.unsubscribe(subs);\n            });\n\n            _.each($el.data(), function (val, key) {\n                if (key.indexOf('f-') === 0 || key.match(/^f[A-Z]/)) {\n                    $el.removeData(key);\n                    // var hyphenated = key.replace(/([A-Z])/g, '-$1').toLowerCase();\n                    // $el.removeData(hyphenated);\n                }\n            });\n\n            return this;\n        },\n\n        /**\n         * Bind the element: subscribe from updates on the relevant channels.\n         *\n         * @param {DomElement} element The element to add to the data binding.\n         * @param {ChannelInstance} channel (Optional) The channel to subscribe to. Defaults to the [run channel](../channels/run-channel/).\n         * @returns {undefined}\n         */\n        bindElement: function (element, channel) {\n            if (!channel) {\n                channel = this.options.channel;\n            }\n            element = getElementOrError(element);\n            var $el = $(element);\n            if (!$el.is(':' + config.prefix)) {\n                return false;\n            }\n            if (!_.includes(this.private.matchedElements, element)) {\n                this.private.matchedElements.push(element);\n            }\n\n            //Send to node manager to handle ui changes\n            var Handler = nodeManager.getHandler($el);\n            new Handler.handle({\n                el: element\n            });\n\n            var subscribe = function (subsChannel, varsToBind, $bindEl, options) {\n                if (!varsToBind || !varsToBind.length) {\n                    return false;\n                }\n\n                var subsid = subsChannel.subscribe(varsToBind, function (params) {\n                    $bindEl.trigger(config.events.channelDataReceived, params);\n                }, options);\n                var newsubs = ($el.data(config.attrs.subscriptionId) || []).concat(subsid);\n                $el.data(config.attrs.subscriptionId, newsubs);\n            };\n\n            var attrBindings = [];\n            var nonBatchableVariables = [];\n            var channelConfig = domUtils.getChannelConfig(element);\n\n            //NOTE: looping through attributes instead of .data because .data automatically camelcases properties and make it hard to retrvieve. Also don't want to index dynamically added (by flow) data attrs\n            $(element.attributes).each(function (index, nodeMap) {\n                var attr = nodeMap.nodeName;\n                var attrVal = nodeMap.value;\n\n                var channelPrefix = domUtils.getChannel($el, attr);\n                \n                var wantedPrefix = 'data-f-';\n                if (attr.indexOf(wantedPrefix) === 0) {\n                    attr = attr.replace(wantedPrefix, '');\n\n                    var handler = attrManager.getHandler(attr, $el);\n                    var isBindableAttr = true;\n                    if (handler && handler.init) {\n                        isBindableAttr = handler.init.call($el, attr, attrVal);\n                    }\n\n                    if (isBindableAttr) {\n                        //Convert pipes to converter attrs\n                        var withConv = attrVal.split('|').map((v)=> v.trim());\n                        if (withConv.length > 1) {\n                            attrVal = withConv.shift();\n                            $el.data('f-convert-' + attr, withConv);\n                        }\n\n                        var binding = { attr: attr };\n                        var commaRegex = /,(?![^[]*])/;\n\n                        //NOTE: do this within init?\n                        if (handler && handler.parse) {\n                            //Let the handler do any pre-processing of inputs necessary\n                            attrVal = handler.parse.call($el, attrVal);\n                        }\n\n                        if (attrVal.indexOf('<%') !== -1) {\n                            //Assume it's templated for later use\n\n                        } else if (attrVal.split(commaRegex).length > 1) {\n                            var varsToBind = attrVal.split(commaRegex).map((v)=> v.trim());\n                            if (channelPrefix) {\n                                varsToBind = varsToBind.map(function (v) {\n                                    return channelPrefix + ':' + v;\n                                });\n                            }\n                            subscribe(channel, varsToBind, $el, $.extend({ batch: true }, channelConfig)); //TODO: Move batch defaults to subscription manager\n                            binding.topics = varsToBind;\n                        } else {\n                            if (channelPrefix) {\n                                attrVal = channelPrefix + ':' + attrVal;\n                            }\n                            binding.topics = [attrVal];\n                            nonBatchableVariables.push(attrVal);\n                        }\n                        attrBindings.push(binding);\n                    }\n                }\n            });\n            $el.data(config.attrs.bindingsList, attrBindings);\n            if (nonBatchableVariables.length) {\n                subscribe(channel, nonBatchableVariables, $el, $.extend({ batch: false }, channelConfig));\n            }\n        },\n\n        /**\n         * Bind all provided elements.\n         *\n         * @param  {Array|jQuerySelector} elementsToBind (Optional) If not provided, binds all matching elements within default root provided at initialization.\n         * @returns {undefined}\n         */\n        bindAll: function (elementsToBind) {\n            if (!elementsToBind) {\n                elementsToBind = getMatchingElements(this.options.root);\n            } else if (!_.isArray(elementsToBind)) {\n                elementsToBind = getMatchingElements(elementsToBind);\n            }\n\n            var me = this;\n            //parse through dom and find everything with matching attributes\n            $.each(elementsToBind, function (index, element) {\n                me.bindElement(element, me.options.channel);\n            });\n        },\n        /**\n         * Unbind provided elements.\n         *\n         * @param  {Array} elementsToUnbind (Optional) If not provided, unbinds everything.\n         * @returns {undefined}\n         */\n        unbindAll: function (elementsToUnbind) {\n            var me = this;\n            if (!elementsToUnbind) {\n                elementsToUnbind = this.private.matchedElements;\n            } else if (!_.isArray(elementsToUnbind)) {\n                elementsToUnbind = getMatchingElements(elementsToUnbind);\n            }\n            $.each(elementsToUnbind, function (index, element) {\n                me.unbindElement(element, me.options.channel);\n            });\n        },\n\n        /**\n         * Initialize the DOM Manager to work with a particular HTML element and all elements within that root. Data bindings between individual HTML elements and the model variables specified in the attributes will happen via the channel.\n         *\n         * @param {Object} options (Optional) Overrides for the default options.\n         * @param {String} options.root The root HTML element being managed by this instance of the DOM Manager. Defaults to `body`.\n         * @param {Object} options.channel The channel to communicate with. Defaults to the Channel Manager from [Epicenter.js](../../../api_adapters/).\n         * @param {Boolean} options.autoBind If `true` (default), any variables added to the DOM after `Flow.initialize()` has been called will be automatically parsed, and subscriptions added to channels. Note, this does not work in IE versions < 11.\n         * @returns {undefined}\n         */\n        initialize: function (options) {\n            var defaults = {\n                /**\n                 * Root of the element for flow.js to manage from.\n                 * @type {String} jQuery selector\n                 */\n                root: 'body',\n                channel: null,\n\n                /**\n                 * Any variables added to the DOM after `Flow.initialize()` has been called will be automatically parsed, and subscriptions added to channels. Note, this does not work in IE versions < 11.\n                 * @type {Boolean}\n                 */\n                autoBind: true\n            };\n            $.extend(defaults, options);\n\n            var channel = defaults.channel;\n\n            this.options = defaults;\n\n            var me = this;\n            var $root = $(defaults.root);\n\n            var attachChannelListener = function ($root) {\n                $root.off(config.events.channelDataReceived).on(config.events.channelDataReceived, function (evt, data) {\n                    var $el = $(evt.target);\n                    var bindings = $el.data(config.attrs.bindingsList);\n                    var toconvert = {};\n                    $.each(data, function (variableName, value) {\n                        _.each(bindings, function (binding) {\n                            var channelPrefix = domUtils.getChannel($el, binding.attr);\n                            var interestedTopics = binding.topics;\n                            if (_.includes(interestedTopics, variableName)) {\n                                if (binding.topics.length > 1) {\n                                    var matching = _.pick(data, interestedTopics);\n                                    if (!channelPrefix) {\n                                        value = matching;\n                                    } else {\n                                        value = Object.keys(matching).reduce(function (accum, key) {\n                                            var k = key.replace(channelPrefix + ':', '');\n                                            accum[k] = matching[key]; \n                                            return accum;\n                                        }, {});\n                                    }\n                                }\n                                toconvert[binding.attr] = value;\n                            }\n                        });\n                    });\n                    $el.trigger(config.events.convert, toconvert);\n                });\n            };\n\n            var attachUIVariablesListener = function ($root) {\n                $root.off(config.events.trigger).on(config.events.trigger, function (evt, data) {\n                    var parsedData = {}; //if not all subsequent listeners will get the modified data\n\n                    var $el = $(evt.target);\n                    var attrConverters = domUtils.getConvertersList($el, 'bind');\n\n                    _.each(data, function (val, key) {\n                        key = key.split('|')[0].trim(); //in case the pipe formatting syntax was used\n                        val = converterManager.parse(val, attrConverters);\n                        parsedData[key] = parseUtils.toImplicitType(val);\n\n                        $el.trigger(config.events.convert, { bind: val });\n                    });\n\n                    channel.publish(parsedData);\n                });\n            };\n\n            var attachUIOperationsListener = function ($root) {\n                $root.off(config.events.operate).on(config.events.operate, function (evt, data) {\n                    var filtered = ([].concat(data.operations || [])).reduce(function (accum, operation) {\n                        var val = operation.value ? [].concat(operation.value) : [];\n                        operation.value = val.map(function (val) {\n                            return parseUtils.toImplicitType($.trim(val));\n                        });\n                        var isConverter = converterManager.getConverter(operation.name);\n                        if (isConverter) {\n                            accum.converters.push(operation);\n                        } else {\n                            //TODO: Add a test for this\n                            if (operation.name.indexOf(':') === -1) {\n                                operation.name = 'operations:' + operation.name;\n                            }\n                            accum.operations.push(operation);\n                        }\n                        return accum;\n                    }, { operations: [], converters: [] });\n\n                    var promise = (filtered.operations.length) ?\n                        channel.publish(filtered.operations, data.options) :\n                        $.Deferred().resolve().promise();\n                     \n                    //FIXME: Needed for the 'gotopage' in interfacebuilder. Remove this once we add a window channel\n                    promise.then(function (args) {\n                        _.each(filtered.converters, function (con) {\n                            converterManager.convert(con.value, [con.name]);\n                        });\n                    });\n                });\n            };\n\n            var attachConversionListner = function ($root) {\n                // data = {proptoupdate: value} || just a value (assumes 'bind' if so)\n                $root.off(config.events.convert).on(config.events.convert, function (evt, data) {\n                    var $el = $(evt.target);\n\n                    var convert = function (val, prop) {\n                        prop = prop.toLowerCase();\n                        var attrConverters = domUtils.getConvertersList($el, prop);\n\n                        var handler = attrManager.getHandler(prop, $el);\n                        var convertedValue = converterManager.convert(val, attrConverters);\n                        handler.handle.call($el, convertedValue, prop);\n                    };\n\n                    if ($.isPlainObject(data)) {\n                        _.each(data, convert);\n                    } else {\n                        convert(data, 'bind');\n                    }\n                });\n            };\n            \n            var promise = $.Deferred();\n            $(function () {\n                me.bindAll();\n\n                attachChannelListener($root);\n                attachUIVariablesListener($root);\n                attachUIOperationsListener($root);\n                attachConversionListner($root);\n\n                if (me.options.autoBind) {\n                    autoUpdatePlugin($root.get(0), me);\n                }\n                \n                promise.resolve($root);\n                $root.trigger('f.domready');\n            });\n\n            return promise;\n        }\n    };\n\n    return $.extend(this, publicAPI);\n}());\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/dom-manager.js","'use strict';\n\nmodule.exports = {\n\n    match: function (matchExpr, matchValue, context) {\n        if (_.isString(matchExpr)) {\n            return (matchExpr === '*' || (matchExpr.toLowerCase() === matchValue.toLowerCase()));\n        } else if (_.isFunction(matchExpr)) {\n            return matchExpr(matchValue, context);\n        } else if (_.isRegExp(matchExpr)) {\n            return matchValue.match(matchExpr);\n        }\n    },\n\n    getChannel: function ($el, property) {\n        property = property.replace('data-f-', '');\n        var channel = $el.data('f-channel-' + property);\n        if (channel === undefined) {\n            channel = $el.attr('data-f-channel'); //.data shows value cached by jquery\n            if (channel === undefined) {\n                var $parentEl = $el.closest('[data-f-channel]');\n                if ($parentEl) {\n                    channel = $parentEl.attr('data-f-channel');\n                }\n            }\n        }\n        return channel;\n    },\n\n    getChannelConfig: function (el) {\n        var attrs = el.attributes;\n        var config = {};\n        for (var i = 0; i < attrs.length; i++) {\n            var attrib = el.attributes[i];\n            if (attrib.specified && attrib.name.indexOf('data-f-channel-') === 0) {\n                var key = attrib.name.replace('data-f-channel-', '');\n                config[key] = attrib.value;\n            }\n        }\n        return config;\n    },\n\n    getConvertersList: function ($el, property) {\n        var attrConverters = $el.data('f-convert-' + property);\n        //FIXME: figure out how not to hard-code names here\n        if (!attrConverters && (property === 'bind' || property === 'foreach' || property === 'repeat')) {\n            attrConverters = $el.attr('data-f-convert'); //.data shows value cached by jquery\n            if (!attrConverters) {\n                var $parentEl = $el.closest('[data-f-convert]');\n                if ($parentEl) {\n                    attrConverters = $parentEl.attr('data-f-convert');\n                }\n            }\n            if (attrConverters) {\n                attrConverters = attrConverters.split('|').map((v)=> v.trim());\n            }\n        }\n\n        return attrConverters;\n    }\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils/dom.js","/**\n * ## Converter Manager: Make your own Converters\n *\n * Converters allow you to convert data -- in particular, model variables that you display in your project's user interface -- from one form to another.\n *\n * Basic converting and formatting options are built in to Flow.js.\n *\n * You can also create your own converters. Each converter should be a function that takes in a value or values to convert. To use your converter, `register()` it in your instance of Flow.js.\n *\n */\n\n'use strict';\n\nvar normalize = function (alias, converter, acceptList) {\n    var ret = [];\n    //nomalize('flip', fn)\n    if (_.isFunction(converter)) {\n        ret.push({\n            alias: alias,\n            convert: converter,\n            acceptList: acceptList\n        });\n    } else if ($.isPlainObject(converter) && converter.convert) {\n        converter.alias = alias;\n        converter.acceptList = acceptList;\n        ret.push(converter);\n    } else if ($.isPlainObject(alias)) {\n        //normalize({alias: 'flip', convert: function})\n        if (alias.convert) {\n            ret.push(alias);\n        } else {\n            // normalize({flip: fun})\n            $.each(alias, function (key, val) {\n                ret.push({\n                    alias: key,\n                    convert: val,\n                    acceptList: acceptList\n                });\n            });\n        }\n    }\n    return ret;\n};\n\nvar matchConverter = function (alias, converter) {\n    if (_.isString(converter.alias)) {\n        return alias === converter.alias;\n    } else if (_.isFunction(converter.alias)) {\n        return converter.alias(alias);\n    } else if (_.isRegex(converter.alias)) {\n        return converter.alias.match(alias);\n    }\n    return false;\n};\n\nvar converterManager = {\n    private: {\n        matchConverter: matchConverter\n    },\n\n    list: [],\n    /**\n     * Add a new attribute converter to this instance of Flow.js.\n     *\n     * **Example**\n     *\n     *      Flow.dom.converters.register('max', function (value) {\n     *          return _.max(value);\n     *      }, true);\n     *\n     *      Flow.dom.converters.register({\n     *          alias: 'sig',\n     *          parse: $.noop,\n     *          convert: function (value) {\n     *              return value.firstName + ' ' + value.lastName + ', ' + value.jobTitle;\n     *      }, false);\n     *\n     *      <div>\n     *          The largest sales you had was <span data-f-bind=\"salesByYear | max | $#,###\"></span>.\n     *          The current sales manager is <span data-f-bind=\"salesMgr | sig\"></span>.\n     *      </div>\n     *\n     * @param  {String|Function|Regex} alias Formatter name.\n     * @param  {Function|Object} converter If a function, `converter` is called with the value. If an object, should include fields for `alias` (name), `parse` (function), and `convert` (function).\n     * @param {Boolean} acceptList Determines if the converter is a 'list' converter or not. List converters take in arrays as inputs, others expect single values.\n     * @returns {undefined}\n     */\n    register: function (alias, converter, acceptList) {\n        var normalized = normalize(alias, converter, acceptList);\n        this.list = normalized.concat(this.list);\n    },\n\n    /**\n     * Replace an already registered converter with a new one of the same name.\n     *\n     * @param {String} alias Formatter name.\n     * @param {Function|Object} converter If a function, `converter` is called with the value. If an object, should include fields for `alias` (name), `parse` (function), and `convert` (function).\n     * @returns {undefined}\n     */\n    replace: function (alias, converter) {\n        var index;\n        _.each(this.list, function (currentConverter, i) {\n            if (matchConverter(alias, currentConverter)) {\n                index = i;\n                return false;\n            }\n        });\n        this.list.splice(index, 1, normalize(alias, converter)[0]);\n    },\n\n    getConverter: function (alias) {\n        return _.find(this.list, function (converter) {\n            return matchConverter(alias, converter);\n        });\n    },\n\n    /**\n     * Pipes the value sequentially through a list of provided converters.\n     *\n     * @param  {Any} value Input for the converter to tag.\n     * @param  {Array|Object} list List of converters (maps to converter alias).\n     *\n     * @return {Any} Converted value.\n     */\n    convert: function (value, list) {\n        if (!list || !list.length) {\n            return value;\n        }\n        list = ([].concat(list)).map((v)=> v.trim());\n\n        var currentValue = value;\n        var me = this;\n\n        var convertArray = function (converter, val, converterName) {\n            return _.map(val, function (v) {\n                return converter.convert(v, converterName);\n            });\n        };\n        var convert = function (converter, value, converterName) {\n            var converted;\n            if (_.isArray(value) && converter.acceptList !== true) {\n                converted = convertArray(converter, value, converterName);\n            } else {\n                converted = converter.convert(value, converterName);\n            }\n            return converted;\n        };\n        var convertObject = function (converter, value, converterName) {\n            return _.mapValues(value, function (val) {\n                return convert(converter, val, converterName);\n            });\n        };\n        _.each(list, function (converterName) {\n            var converter = me.getConverter(converterName);\n            if (!converter) {\n                throw new Error('Could not find converter for ' + converterName);\n            }\n            if ($.isPlainObject(currentValue) && converter.acceptList !== true) {\n                currentValue = convertObject(converter, currentValue, converterName);\n            } else {\n                currentValue = convert(converter, currentValue, converterName);\n            }\n        });\n        return currentValue;\n    },\n\n    /**\n     * Counter-part to `convert()`. Translates converted values back to their original form.\n     *\n     * @param  {String} value Value to parse.\n     * @param  {String|Array} list  List of parsers to run the value through. Outermost is invoked first.\n     * @return {Any} Original value.\n     */\n    parse: function (value, list) {\n        if (!list || !list.length) {\n            return value;\n        }\n        list = [].concat(list).reverse().map((v)=> v.trim());\n\n        var currentValue = value;\n        var me = this;\n        _.each(list, function (converterName) {\n            var converter = me.getConverter(converterName);\n            if (converter.parse) {\n                currentValue = converter.parse(currentValue, converterName);\n            }\n        });\n        return currentValue;\n    }\n};\n\n\n//Bootstrap\nvar defaultconverters = [\n    require('./number-converter'),\n    require('./string-converter'),\n    require('./array-converter'),\n    require('./underscore-utils-converter'),\n    require('./numberformat-converter'),\n];\n\n$.each(defaultconverters.reverse(), function (index, converter) {\n    if (_.isArray(converter)) {\n        _.each(converter, function (c) {\n            converterManager.register(c);\n        });\n    } else {\n        converterManager.register(converter);\n    }\n});\n\nmodule.exports = converterManager;\n\n\n\n// WEBPACK FOOTER //\n// ./src/converters/converter-manager.js","/**\n * ## Number Converters\n *\n * Converters allow you to convert data -- in particular, model variables that you display in your project's user interface -- from one form to another.\n *\n * There are two ways to specify conversion or formatting for the display output of a particular model variable:\n *\n * * Add the attribute `data-f-convert` to any element that also has the `data-f-bind` or `data-f-foreach`.\n * * Use the `|` (pipe) character within the value of any `data-f-` attribute (not just `data-f-bind` or `data-f-foreach`).\n *\n */\n\n'use strict';\nmodule.exports = {\n    /**\n     * Convert the model variable to an integer. Often used for chaining to another converter.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          Your car has driven\n     *          <span data-f-bind=\"Odometer | i | s0.0\"></span> miles.\n     *      </div>\n     *\n     * @param {Array} value The model variable.\n     */\n    alias: 'i',\n    convert: function (value) {\n        return parseFloat(value, 10);\n    }\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/converters/number-converter.js","/**\n * ## String Converters\n *\n * Converters allow you to convert data -- in particular, model variables that you display in your project's user interface -- from one form to another.\n *\n * There are two ways to specify conversion or formatting for the display output of a particular model variable:\n *\n * * Add the attribute `data-f-convert` to any element that also has the `data-f-bind` or `data-f-foreach`.\n * * Use the `|` (pipe) character within the value of any `data-f-` attribute (not just `data-f-bind` or `data-f-foreach`).\n *\n * For model variables that are strings (or that have been converted to strings), there are several special string formats you can apply.\n */\n\n'use strict';\nmodule.exports = {\n\n    /**\n     * Convert the model variable to a string. Often used for chaining to another converter.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          This year you are in charge of sales for\n     *          <span data-f-bind=\"salesMgr.region | s | upperCase\"></span>.\n     *      </div>\n     *\n     * @param {Array} val The model variable.\n     * @returns {String} converted string\n     */\n    s: function (val) {\n        return val + '';\n    },\n\n    /**\n     * Convert the model variable to UPPER CASE.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          This year you are in charge of sales for\n     *          <span data-f-bind=\"salesMgr.region | s | upperCase\"></span>.\n     *      </div>\n     *\n     * @param {Array} val The model variable.\n     * @returns {String} converted string\n     */\n    upperCase: function (val) {\n        return (val + '').toUpperCase();\n    },\n\n    /**\n     * Convert the model variable to lower case.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          Enter your user name:\n     *          <input data-f-bind=\"userName | lowerCase\"></input>.\n     *      </div>\n     *\n     * @param {Array} val The model variable.\n     * @returns {String} converted string\n     */\n    lowerCase: function (val) {\n        return (val + '').toLowerCase();\n    },\n\n    /**\n     * Convert the model variable to Title Case.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          Congratulations on your promotion!\n     *          Your new title is: <span data-f-bind=\"currentRole | titleCase\"></span>.\n     *      </div>\n     *\n     * @param {Array} val The model variable.\n     * @returns {String} converted string\n     */\n    titleCase: function (val) {\n        val = val + '';\n        return val.replace(/\\w\\S*/g, function (txt) {\n            return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();\n        });\n    }\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/converters/string-converter.js","/**\n * ## Array Converters\n *\n * Converters allow you to convert data -- in particular, model variables that you display in your project's user interface -- from one form to another.\n *\n * There are two ways to specify conversion or formatting for the display output of a particular model variable:\n *\n * * Add the attribute `data-f-convert` to any element that also has the `data-f-bind` or `data-f-foreach`.\n * * Use the `|` (pipe) character within the value of any `data-f-` attribute (not just `data-f-bind` or `data-f-foreach`).\n *\n * In general, if the model variable is an array, the converter is applied to each element of the array. There are a few built in array converters which, rather than converting all elements of an array, select particular elements from within the array or otherwise treat array variables specially.\n *\n */\n\n\n'use strict';\nvar list = [\n    {\n        /**\n         * Convert the input into an array. Concatenates all elements of the input.\n         *\n         * @param {Array} val The array model variable.\n         */\n        alias: 'list',\n        acceptList: true,\n        convert: function (val) {\n            return [].concat(val);\n        }\n    },\n    {\n        /**\n         * Select only the last element of the array.\n         *\n         * **Example**\n         *\n         *      <div>\n         *          In the current year, we have <span data-f-bind=\"Sales | last\"></span> in sales.\n         *      </div>\n         *\n         * @param {Array} val The array model variable.\n         */\n        alias: 'last',\n        acceptList: true,\n        convert: function (val) {\n            val = [].concat(val);\n            return val[val.length - 1];\n        }\n    },\n    {\n        /**\n         * Reverse the array.\n         *\n         * **Example**\n         *\n         *      <p>Show the history of our sales, starting with the last (most recent):</p>\n         *      <ul data-f-foreach=\"Sales | reverse\">\n         *          <li></li>\n         *      </ul>\n         *\n         * @param {Array} val The array model variable.\n         */\n        alias: 'reverse',\n        acceptList: true,\n        convert: function (val) {\n            val = [].concat(val);\n            return val.reverse();\n        }\n    },\n    {\n        /**\n         * Select only the first element of the array.\n         *\n         * **Example**\n         *\n         *      <div>\n         *          Our initial investment was <span data-f-bind=\"Capital | first\"></span>.\n         *      </div>\n         *\n         * @param {Array} val The array model variable.\n         */\n        alias: 'first',\n        acceptList: true,\n        convert: function (val) {\n            val = [].concat(val);\n            return val[0];\n        }\n    },\n    {\n        /**\n         * Select only the previous (second to last) element of the array.\n         *\n         * **Example**\n         *\n         *      <div>\n         *          Last year we had <span data-f-bind=\"Sales | previous\"></span> in sales.\n         *      </div>\n         *\n         * @param {Array} val The array model variable.\n         */\n        alias: 'previous',\n        acceptList: true,\n        convert: function (val) {\n            val = [].concat(val);\n            return (val.length <= 1) ? val[0] : val[val.length - 2];\n        }\n    }\n];\n\n_.each(list, function (item) {\n    var oldfn = item.convert;\n    var newfn = function (val) {\n        if ($.isPlainObject(val)) {\n            return _.mapValues(val, oldfn);\n        }\n        return oldfn(val);\n    };\n    item.convert = newfn;\n});\nmodule.exports = list;\n\n\n\n// WEBPACK FOOTER //\n// ./src/converters/array-converter.js","'use strict';\nvar list = [];\n\nvar supported = [\n    'values', 'keys', 'compact', 'difference',\n    'union',\n    'uniq', 'without',\n    'xor', 'zip'\n];\n_.each(supported, function (fn) {\n    var item = {\n        alias: fn,\n        acceptList: true,\n        convert: function (val) {\n            if ($.isPlainObject(val)) {\n                return _.mapValues(val, _[fn]);\n            }\n            return _[fn](val);\n        }\n    };\n    list.push(item);\n});\nmodule.exports = list;\n\n\n\n// WEBPACK FOOTER //\n// ./src/converters/underscore-utils-converter.js","/**\n * ## Number Format Converters\n *\n * Converters allow you to convert data -- in particular, model variables that you display in your project's user interface -- from one form to another.\n *\n * There are two ways to specify conversion or formatting for the display output of a particular model variable:\n *\n * * Add the attribute `data-f-convert` to any element that also has the `data-f-bind` or `data-f-foreach`.\n * * Use the `|` (pipe) character within the value of any `data-f-` attribute (not just `data-f-bind` or `data-f-foreach`).\n *\n * For model variables that are numbers (or that have been [converted to numbers](../number-converter/)), there are several special number formats you can apply.\n *\n * ####Currency Number Format\n *\n * After the `|` (pipe) character, use `$` (dollar sign), `0`, and `.` (decimal point) in your converter to describe how currency should appear. The specifications follow the Excel currency formatting conventions.\n *\n * **Example**\n *\n *      <!-- convert to dollars (include cents) -->\n *      <input type=\"text\" data-f-bind=\"price[car]\" data-f-convert=\"$0.00\" />\n *      <input type=\"text\" data-f-bind=\"price[car] | $0.00\" />\n *\n *      <!-- convert to dollars (truncate cents) -->\n *      <input type=\"text\" data-f-bind=\"price[car]\" data-f-convert=\"$0.\" />\n *      <input type=\"text\" data-f-bind=\"price[car] | $0.\" />\n *\n *\n * ####Specific Digits Number Format\n *\n * After the `|` (pipe) character, use `#` (pound) and `,` (comma) in your converter to describe how the number should appear. The specifications follow the Excel number formatting conventions.\n *\n * **Example**\n *\n *      <!-- convert to thousands -->\n *      <input type=\"text\" data-f-bind=\"sales[car]\" data-f-convert=\"#,###\" />\n *      <input type=\"text\" data-f-bind=\"sales[car] | #,###\" />\n *\n *\n * ####Percentage Number Format\n *\n * After the `|` (pipe) character, use `%` (percent) and `0` in your converter to display the number as a percent.\n *\n * **Example**\n *\n *      <!-- convert to percentage -->\n *      <input type=\"text\" data-f-bind=\"profitMargin[car]\" data-f-convert=\"0%\" />\n *      <input type=\"text\" data-f-bind=\"profitMargin[car] | 0%\" />\n *\n *\n * ####Short Number Format\n *\n * After the `|` (pipe) character, use `s` and `0` in your converter to describe how the number should appear.\n *\n * The `0`s describe the significant digits.\n *\n * The `s` describes the \"short format,\" which uses 'K' for thousands, 'M' for millions, 'B' for billions. For example, `2468` converted with `s0.0` displays as `2.5K`.\n *\n * **Example**\n *\n *      <!-- convert to thousands (show 12,468 as 12.5K) -->\n *      <span type=\"text\" data-f-bind=\"price[car] | s0.0\"></span>\n *\n */\n\n'use strict';\nmodule.exports = {\n    alias: function (name) {\n        //TODO: Fancy regex to match number formats here\n        return (name.indexOf('#') !== -1 || name.indexOf('0') !== -1);\n    },\n\n    parse: function (val) {\n        val += '';\n        var isNegative = val.charAt(0) === '-';\n\n        val = val.replace(/,/g, '');\n        var floatMatcher = /([-+]?[0-9]*\\.?[0-9]+)(K?M?B?%?)/i;\n        var results = floatMatcher.exec(val);\n        var number;\n        var suffix = '';\n        if (results && results[1]) {\n            number = results[1];\n        }\n        if (results && results[2]) {\n            suffix = results[2].toLowerCase();\n        }\n\n        /*eslint no-magic-numbers: 0*/\n        switch (suffix) {\n            case '%':\n                number = number / 100;\n                break;\n            case 'k':\n                number = number * 1000;\n                break;\n            case 'm':\n                number = number * 1000000;\n                break;\n            case 'b':\n                number = number * 1000000000;\n                break;\n            default:\n        }\n        number = parseFloat(number);\n        if (isNegative && number > 0) {\n            number = number * -1;\n        }\n        return number;\n    },\n\n    convert: (function (value) {\n        var scales = ['', 'K', 'M', 'B', 'T'];\n        function roundTo(value, digits) {\n            return Math.round(value * Math.pow(10, digits)) / Math.pow(10, digits);\n        }\n\n        function getDigits(value, digits) {\n            value = value === 0 ? 0 : roundTo(value, Math.max(0, digits - Math.ceil(Math.log(value) / Math.LN10)));\n\n            var TXT = '';\n            var numberTXT = value.toString();\n            var decimalSet = false;\n\n            for (var iTXT = 0; iTXT < numberTXT.length; iTXT++) {\n                TXT += numberTXT.charAt(iTXT);\n                if (numberTXT.charAt(iTXT) === '.') {\n                    decimalSet = true;\n                } else {\n                    digits--;\n                }\n\n                if (digits <= 0) {\n                    return TXT;\n                }\n            }\n\n            if (!decimalSet) {\n                TXT += '.';\n            }\n            while (digits > 0) {\n                TXT += '0';\n                digits--;\n            }\n            return TXT;\n        }\n\n        function addDecimals(value, decimals, minDecimals, hasCommas) {\n            hasCommas = !!hasCommas;\n            var numberTXT = value.toString();\n            var hasDecimals = (numberTXT.split('.').length > 1);\n            var iDec = 0;\n\n            if (hasCommas) {\n                for (var iChar = numberTXT.length - 1; iChar > 0; iChar--) {\n                    if (hasDecimals) {\n                        hasDecimals = (numberTXT.charAt(iChar) !== '.');\n                    } else {\n                        iDec = (iDec + 1) % 3;\n                        if (iDec === 0) {\n                            numberTXT = numberTXT.substr(0, iChar) + ',' + numberTXT.substr(iChar);\n                        }\n                    }\n                }\n\n            }\n            if (decimals > 0) {\n                var toADD;\n                if (numberTXT.split('.').length <= 1) {\n                    toADD = minDecimals;\n                    if (toADD > 0) {\n                        numberTXT += '.';\n                    }\n                } else {\n                    toADD = minDecimals - numberTXT.split('.')[1].length;\n                }\n\n                while (toADD > 0) {\n                    numberTXT += '0';\n                    toADD--;\n                }\n            }\n            return numberTXT;\n        }\n\n        function getSuffix(formatTXT) {\n            formatTXT = formatTXT.replace('.', '');\n            var fixesTXT = formatTXT.split(new RegExp('[0|,|#]+', 'g'));\n            return (fixesTXT.length > 1) ? fixesTXT[1].toString() : '';\n        }\n\n        function isCurrency(string) { // eslint-disable-line\n            var s = $.trim(string);\n\n            if (s === '$' ||\n                s === 'â‚¬' ||\n                s === 'Â¥' ||\n                s === 'Â£' ||\n                s === 'â‚¡' ||\n                s === 'â‚±' ||\n                s === 'KÄ?' ||\n                s === 'kr' ||\n                s === 'Â¢' ||\n                s === 'â‚ª' ||\n                s === 'Æ’' ||\n                s === 'â‚©' ||\n                s === 'â‚«') {\n\n                return true;\n            }\n\n            return false;\n        }\n\n        function format (number, formatTXT) { // eslint-disable-line\n            if (_.isArray(number)) {\n                number = number[number.length - 1];\n            }\n            if (!_.isString(number) && !_.isNumber(number)) {\n                return number;\n            }\n\n            if (!formatTXT || formatTXT.toLowerCase() === 'default') {\n                return number.toString();\n            }\n\n            if (isNaN(number)) {\n                return '?';\n            }\n\n            //var formatTXT;\n            formatTXT = formatTXT.replace('&euro;', 'â‚¬');\n\n            // Divide +/- Number Format\n            var formats = formatTXT.split(';');\n            if (formats.length > 1) {\n                return format(Math.abs(number), formats[((number >= 0) ? 0 : 1)]);\n            }\n\n            // Save Sign\n            var sign = (number >= 0) ? '' : '-';\n            number = Math.abs(number);\n\n\n            var leftOfDecimal = formatTXT;\n            var d = leftOfDecimal.indexOf('.');\n            if (d > -1) {\n                leftOfDecimal = leftOfDecimal.substring(0, d);\n            }\n\n            var normalized = leftOfDecimal.toLowerCase();\n            var index = normalized.lastIndexOf('s');\n            var isShortFormat = index > -1;\n\n            if (isShortFormat) {\n                var nextChar = leftOfDecimal.charAt(index + 1);\n                if (nextChar === ' ') {\n                    isShortFormat = false;\n                }\n            }\n\n            var leadingText = isShortFormat ? formatTXT.substring(0, index) : '';\n            var rightOfPrefix = isShortFormat ? formatTXT.substr(index + 1) : formatTXT.substr(index);\n\n            //first check to make sure 's' is actually short format and not part of some leading text\n            if (isShortFormat) {\n                var shortFormatTest = /[0-9#*]/;\n                var shortFormatTestResult = rightOfPrefix.match(shortFormatTest);\n                if (!shortFormatTestResult || shortFormatTestResult.length === 0) {\n                    //no short format characters so this must be leading text ie. 'weeks '\n                    isShortFormat = false;\n                    leadingText = '';\n                }\n            }\n\n            //if (formatTXT.charAt(0) == 's')\n            if (isShortFormat) {\n                var valScale = number === 0 ? 0 : Math.floor(Math.log(Math.abs(number)) / (3 * Math.LN10));\n                valScale = ((number / Math.pow(10, 3 * valScale)) < 1000) ? valScale : (valScale + 1);\n                valScale = Math.max(valScale, 0);\n                valScale = Math.min(valScale, 4);\n                number = number / Math.pow(10, 3 * valScale);\n                //if (!isNaN(Number(formatTXT.substr(1) ) ) )\n\n                if (!isNaN(Number(rightOfPrefix)) && rightOfPrefix.indexOf('.') === -1) {\n                    var limitDigits = Number(rightOfPrefix);\n                    if (number < Math.pow(10, limitDigits)) {\n                        if (isCurrency(leadingText)) {\n                            return sign + leadingText + getDigits(number, Number(rightOfPrefix)) + scales[valScale];\n                        } else {\n                            return leadingText + sign + getDigits(number, Number(rightOfPrefix)) + scales[valScale];\n                        }\n                    } else if (isCurrency(leadingText)) {\n                        return sign + leadingText + Math.round(number) + scales[valScale];\n                    } else {\n                        return leadingText + sign + Math.round(number) + scales[valScale];\n                    }\n                } else {\n                    //formatTXT = formatTXT.substr(1);\n                    formatTXT = formatTXT.substr(index + 1);\n                    var SUFFIX = getSuffix(formatTXT);\n                    formatTXT = formatTXT.substr(0, formatTXT.length - SUFFIX.length);\n\n                    var valWithoutLeading = format(((sign === '') ? 1 : -1) * number, formatTXT) + scales[valScale] + SUFFIX;\n                    if (isCurrency(leadingText) && sign !== '') {\n                        valWithoutLeading = valWithoutLeading.substr(sign.length);\n                        return sign + leadingText + valWithoutLeading;\n                    }\n\n                    return leadingText + valWithoutLeading;\n                }\n            }\n\n            var subFormats = formatTXT.split('.');\n            var decimals;\n            var minDecimals;\n            if (subFormats.length > 1) {\n                decimals = subFormats[1].length - subFormats[1].replace(new RegExp('[0|#]+', 'g'), '').length;\n                minDecimals = subFormats[1].length - subFormats[1].replace(new RegExp('0+', 'g'), '').length;\n                formatTXT = subFormats[0] + subFormats[1].replace(new RegExp('[0|#]+', 'g'), '');\n            } else {\n                decimals = 0;\n            }\n\n            var fixesTXT = formatTXT.split(new RegExp('[0|,|#]+', 'g'));\n            var preffix = fixesTXT[0].toString();\n            var suffix = (fixesTXT.length > 1) ? fixesTXT[1].toString() : '';\n\n            number = number * ((formatTXT.split('%').length > 1) ? 100 : 1);\n            //            if (formatTXT.indexOf('%') !== -1) number = number * 100;\n            number = roundTo(number, decimals);\n\n            sign = (number === 0) ? '' : sign;\n\n            var hasCommas = (formatTXT.substr(formatTXT.length - 4 - suffix.length, 1) === ',');\n            var formatted = sign + preffix + addDecimals(number, decimals, minDecimals, hasCommas) + suffix;\n\n            //  console.log(originalNumber, originalFormat, formatted)\n            return formatted;\n        }\n\n        return format;\n    }())\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/converters/numberformat-converter.js","'use strict';\n\nvar normalize = function (selector, handler) {\n    if (_.isFunction(handler)) {\n        handler = {\n            handle: handler\n        };\n    }\n    if (!selector) {\n        selector = '*';\n    }\n    handler.selector = selector;\n    return handler;\n};\n\nvar match = function (toMatch, node) {\n    if (_.isString(toMatch)) {\n        return toMatch === node.selector;\n    }\n    return $(toMatch).is(node.selector);\n};\n\nvar nodeManager = {\n    list: [],\n\n    /**\n     * Add a new node handler\n     * @param  {string} selector jQuery-compatible selector to use to match nodes\n     * @param  {function} handler  Handlers are new-able functions. They will be called with $el as context.? TODO: Think this through\n     * @returns {undefined}\n     */\n    register: function (selector, handler) {\n        this.list.unshift(normalize(selector, handler));\n    },\n\n    getHandler: function (selector) {\n        return _.find(this.list, function (node) {\n            return match(selector, node);\n        });\n    },\n\n    replace: function (selector, handler) {\n        var index;\n        _.each(this.list, function (currentHandler, i) {\n            if (selector === currentHandler.selector) {\n                index = i;\n                return false;\n            }\n        });\n        this.list.splice(index, 1, normalize(selector, handler));\n    }\n};\n\n//bootstraps\nvar defaultHandlers = [\n    require('./input-checkbox-node'),\n    require('./default-input-node'),\n    require('./default-node')\n];\n_.each(defaultHandlers.reverse(), function (handler) {\n    nodeManager.register(handler.selector, handler);\n});\n\nmodule.exports = nodeManager;\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/nodes/node-manager.js","'use strict';\nvar BaseView = require('./default-input-node');\n\nmodule.exports = BaseView.extend({\n\n    propertyHandlers: [\n\n    ],\n\n    getUIValue: function () {\n        var $el = this.$el;\n        var offVal = (typeof $el.data('f-off') !== 'undefined') ? $el.data('f-off') : false;\n        //attr = initial value, prop = current value\n        var onVal = (typeof $el.attr('value') !== 'undefined') ? $el.prop('value') : true;\n\n        var val = ($el.is(':checked')) ? onVal : offVal;\n        return val;\n    },\n    initialize: function () {\n        BaseView.prototype.initialize.apply(this, arguments);\n    }\n}, { selector: ':checkbox,:radio' });\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/nodes/input-checkbox-node.js","/**\n * ## Attribute Manager\n *\n * Flow.js provides a set of custom DOM attributes that serve as a data binding between variables and operations in your project's model and HTML elements in your project's user interface. Under the hood, Flow.js is doing automatic conversion of these custom attributes, like `data-f-bind`, into HTML specific to the attribute's assigned value, like the current value of `myModelVar`.\n *\n * If you are looking for examples of using particular attributes, see the [specific attributes subpages](../../../../attributes-overview/).\n *\n * If you would like to extend Flow.js with your own custom attributes, you can add them to Flow.js using the Attribute Manager.\n *\n * The Attribute Manager is specific to adding custom attributes and describing their implementation (handlers). (The [Dom Manager](../../) contains the general implementation.)\n *\n *\n * **Examples**\n *\n * Built-in attribute handlers like `data-f-value` and `data-f-foreach` automatically bind variables in your project's model to particular HTML elements. However, your UI may sometimes require displaying only part of the variable (e.g. if it's an object), or \"doing something\" with the value of the variable, rather than simply displaying it.\n *\n * One example of when custom attribute handlers are useful is when your model variable is a complex object and you want to display the fields in a particular way, or you only want to display some of the fields. While the combination of the [`data-f-foreach` attribute](../foreach/default-foreach-attr/) and [templating](../../../../#templates) can help with this, sometimes it's easier to write your own attribute handler. (This is especially true if you will be reusing the attribute handler -- you won't have to copy your templating code over and over.)\n *\n *      Flow.dom.attributes.register('showSched', '*', function (sched) {\n *            // display all the schedule milestones\n *            // sched is an object, each element is an array\n *            // of ['Formal Milestone Name', milestoneMonth, completionPercentage]\n *\n *            var schedStr = '<ul>';\n *            var sortedSched = _.sortBy(sched, function(el) { return el[1]; });\n *\n *            for (var i = 0; i < sortedSched.length; i++) {\n *                  schedStr += '<li><strong>' + sortedSched[i][0]\n *                        + '</strong> currently scheduled for <strong>Month '\n *                        + sortedSched[i][1] + '</strong></li>';\n *            }\n *            schedStr += '</ul>';\n *\n *            this.html(schedStr);\n *      });\n *\n * Then, you can use the attribute handler in your HTML just like other Flow.js attributes:\n *\n *      <div data-f-showSched=\"schedule\"></div>\n *\n */\n\n'use strict';\n\nvar defaultHandlers = [\n    require('./no-op-attr'),\n    // require('./events/init-event-attr'),\n    require('./events/default-event-attr'),\n    require('./foreach/default-foreach-attr'),\n    require('./binds/checkbox-radio-bind-attr'),\n    require('./binds/input-bind-attr'),\n    require('./class-attr'),\n    require('./repeat-attr'),\n    require('./positive-boolean-attr'),\n    require('./negative-boolean-attr'),\n    require('./binds/default-bind-attr'),\n    require('./default-attr')\n];\n\nvar handlersList = [];\n\nvar normalize = function (attributeMatcher, nodeMatcher, handler) {\n    if (!nodeMatcher) {\n        nodeMatcher = '*';\n    }\n    if (_.isFunction(handler)) {\n        handler = {\n            handle: handler\n        };\n    }\n    return $.extend(handler, { test: attributeMatcher, target: nodeMatcher });\n};\n\n$.each(defaultHandlers, function (index, handler) {\n    handlersList.push(normalize(handler.test, handler.target, handler));\n});\n\n\nvar matchAttr = function (matchExpr, attr, $el) {\n    var attrMatch;\n\n    if (_.isString(matchExpr)) {\n        attrMatch = (matchExpr === '*' || (matchExpr.toLowerCase() === attr.toLowerCase()));\n    } else if (_.isFunction(matchExpr)) {\n        //TODO: remove element selectors from attributes\n        attrMatch = matchExpr(attr, $el);\n    } else if (_.isRegExp(matchExpr)) {\n        attrMatch = attr.match(matchExpr);\n    }\n    return attrMatch;\n};\n\nvar matchNode = function (target, nodeFilter) {\n    return (_.isString(nodeFilter)) ? (nodeFilter === target) : nodeFilter.is(target);\n};\n\nmodule.exports = {\n    list: handlersList,\n    /**\n     * Add a new attribute handler.\n     *\n     * @param  {String|Function|Regex} attributeMatcher Description of which attributes to match.\n     * @param  {String} nodeMatcher Which nodes to add attributes to. Use [jquery Selector syntax](https://api.jquery.com/category/selectors/).\n     * @param  {Function|Object} handler If `handler` is a function, the function is called with `$element` as context, and attribute value + name. If `handler` is an object, it should include two functions, and have the form: `{ init: fn,  handle: fn }`. The `init` function is called when the page loads; use this to define event handlers. The `handle` function is called with `$element` as context, and attribute value + name.\n     * @returns {undefined}\n     */\n    register: function (attributeMatcher, nodeMatcher, handler) {\n        handlersList.unshift(normalize.apply(null, arguments));\n    },\n\n    /**\n     * Find an attribute matcher matching some criteria.\n     *\n     * @param  {String} attrFilter Attribute to match.\n     * @param  {String|$el} nodeFilter Node to match.\n     *\n     * @return {Array|Null} An array of matching attribute handlers, or null if no matches found.\n     */\n    filter: function (attrFilter, nodeFilter) {\n        var filtered = _.filter(handlersList, function (handler) {\n            return matchAttr(handler.test, attrFilter);\n        });\n        if (nodeFilter) {\n            filtered = _.filter(filtered, function (handler) {\n                return matchNode(handler.target, nodeFilter);\n            });\n        }\n        return filtered;\n    },\n\n    /**\n     * Replace an existing attribute handler.\n     *\n     * @param  {String} attrFilter Attribute to match.\n     * @param  {String | $el} nodeFilter Node to match.\n     * @param  {Function|Object} handler The updated attribute handler. If `handler` is a function, the function is called with `$element` as context, and attribute value + name. If `handler` is an object, it should include two functions, and have the form: `{ init: fn,  handle: fn }`. The `init` function is called when the page loads; use this to define event handlers. The `handle` function is called with `$element` as context, and attribute value + name.\n     * @returns {undefined}\n     */\n    replace: function (attrFilter, nodeFilter, handler) {\n        var index;\n        _.each(handlersList, function (currentHandler, i) {\n            if (matchAttr(currentHandler.test, attrFilter) && matchNode(currentHandler.target, nodeFilter)) {\n                index = i;\n                return false;\n            }\n        });\n        handlersList.splice(index, 1, normalize(attrFilter, nodeFilter, handler));\n    },\n\n    /**\n     *  Retrieve the appropriate handler for a particular attribute. There may be multiple matching handlers, but the first (most exact) match is always used.\n     *\n     * @param {String} property The attribute.\n     * @param {$el} $el The DOM element.\n     *\n     * @return {Object} The attribute handler.\n     */\n    getHandler: function (property, $el) {\n        var filtered = this.filter(property, $el);\n        //There could be multiple matches, but the top first has the most priority\n        return filtered[0];\n    }\n};\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attributes/attribute-manager.js","/**\n * ## No-op Attributes\n *\n * Flow.js provides special handling for both `data-f-model` (described [here](../../../../#using_in_project)) and `data-f-convert` (described [here](../../../../converter-overview/)). For these attributes, the default behavior is to do nothing, so that this additional special handling can take precendence.\n *\n */\n\n'use strict';\n\n// Attributes which are just parameters to others and can just be ignored\nmodule.exports = {\n\n    target: '*',\n\n    test: /^(?:model|convert|channel)/i,\n\n    handle: $.noop,\n\n    init: function () {\n        return false;\n    }\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attributes/no-op-attr.js","/**\n * ## Call Operation in Response to User Action\n *\n * Many models call particular operations in response to end user actions, such as clicking a button or submitting a form.\n *\n * #### data-f-on-event\n *\n * For any HTML attribute using `on` -- typically on click or on submit -- you can add the attribute `data-f-on-XXX`, and set the value to the name of the operation. To call multiple operations, use the `|` (pipe) character to chain operations. Operations are called serially, in the order listed.\n *\n * **Example**\n *\n *      <button data-f-on-click=\"reset\">Reset</button>\n *\n *      <button data-f-on-click=\"step(1)\">Advance One Step</button>\n *\n */\n\n'use strict';\nvar config = require('config');\nvar toOperationFormat = require('utils/parse-utils').toOperationFormat;\n\nmodule.exports = {\n\n    target: '*',\n\n    test: function (attr, $node) {\n        return (attr.indexOf('on-') === 0);\n    },\n\n    unbind: function (attr) {\n        attr = attr.replace('on-', '');\n        this.off(attr);\n    },\n\n    init: function (attr, value) {\n        attr = attr.replace('on-', '');\n        var me = this;\n        this.off(attr).on(attr, function () {\n            var listOfOperations = toOperationFormat(value);\n            me.trigger(config.events.operate, { operations: listOfOperations });\n        });\n        return false; //Don't bother binding on this attr. NOTE: Do readonly, true instead?;\n    }\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attributes/events/default-event-attr.js","/**\n * ## Display Array and Object Variables: data-f-foreach\n *\n * If your model variable is an array, you can reference specific elements of the array using `data-f-bind`: `data-f-bind=\"sales[3]\"` or `data-f-bind=\"sales[<currentRegion>]\"`, as described under [data-f-bind](../../binds/default-bind-attr/).\n *\n * However, sometimes you want to loop over *all* of the children of the referenced variable. The `data-f-foreach` attribute allows you to automatically loop over all the 'children' of a referenced variable &mdash; that is, all the elements of an array, or all the fields of an object.\n *\n * You can use the `data-f-foreach` attribute to name the variable, then use a combination of templates and aliases to access the index and value of each child for display. (Templates are available as part of Flow.js's lodash dependency. See more background on [working with templates](../../../../../#templates).)\n *\n * **To display a DOM element based on an array variable from your model:**\n *\n * 1. Add the `data-f-foreach` attribute to any HTML element that has repeated sub-elements. The two most common examples are lists and tables. The `data-f-foreach` goes on the enclosing element. For a list, this is the `<ul>`, and for a table, it's the `<tbody>`.\n * 2. Set the value of the `data-f-foreach` attribute in your top-level HTML element to reference the model array variable. You can do this either with or without introducing an alias to reference the array elements: `<ul data-f-foreach=\"Time\"></ul>` or `<ul data-f-foreach=\"t in Time\"></ul>`.\n * 3. Add the HTML in which the value of your model array variable should appear. Optionally, inside this inner HTML element, you can use templates (`<%= %>`) to reference the `index` (for arrays) or `key` (for objects) and `value` to display, or to reference the alias you introduced. The `index`, `key`, and `value` are special variables that Flow.js populates for you. \n *\n *\n * **Examples:**\n *\n * **Basic use of data-f-foreach.** Start with an HTML element that has repeated sub-elements. Add the model variable to this HTML element. Then, add the HTML sub-element where your model variable should appear. \n *\n * By default, the `value` of the array element or object field is automatically added to the generated HTML:\n *\n *      <!-- the model variable Time is an array of years\n *          create a list that shows which year -->\n *\n *      <ul data-f-foreach=\"Time\">\n *          <li></li>\n *      </ul>\n *\n * In the third step of the model, this example generates the HTML:\n *\n *      <ul data-f-foreach=\"Time\">\n *            <li>2015</li>\n *            <li>2016</li>\n *            <li>2017</li>\n *      </ul>\n *\n * which appears as:\n *\n *      * 2015\n *      * 2016\n *      * 2017\n *\n * **Add templates to reference the index and value.** Optionally, you can use templates (`<%= %>`) to reference the `index` and `value` of the array element to display.\n *\n *      <!-- the model variable Time is an array of years\n *          create a list that shows which year -->\n *\n *      <ul data-f-foreach=\"Time\">\n *          <li> Year <%= index %>: <%= value %> </li>\n *      </ul>\n *\n * In the third step of the model, this example generates:\n *\n *      <ul data-f-foreach=\"Time\">\n *          <li>Year 1: 2015</li>\n *          <li>Year 2: 2016</li>\n *          <li>Year 3: 2017</li>\n *      </ul>\n *\n * which appears as:\n *\n *      * Year 1: 2015\n *      * Year 2: 2016\n *      * Year 3: 2017\n *\n *\n * **Add an alias for the value.** Alternatively, you can add an alias when you initially introduce your model array variable, then reference that alias within templates (`<%= %>`). For example:\n *\n *      <ul data-f-foreach=\"f in Fruits\">\n *          <li> <%= f %> </li>\n *      </ul>\n *\n * which generates:\n *\n *      <ul data-f-foreach=\"f in Fruits\">\n *          <li> apples </li>\n *          <li> bananas </li>\n *          <li> cherries </li>\n *          <li> oranges </li>\n * \n * **Nesting with aliases.** An advantage to introducing aliases is that you can nest HTML elements that have repeated sub-elements. For example:\n *\n *      <!-- given Sales, an array whose elements are themselves arrays of the sales for each Region -->\n *      <ul data-f-foreach=\"r in Regions\">\n *          <li>Region <%= r %>: \n *              <ul data-f-foreach=\"s in Sales[<%= r %>]\">\n *                  <li>Sales <%= s %></li>\n *              </ul>\n *          </li>\n *      </ul>\n *\n * **Logic, data processing.** Finally, note that you can add logic to the display of your data by combining templating with either the `value` or an alias. For example, suppose you only want to display the sales total if it is greater than 250:\n *\n *      <table>\n *          <tbody data-f-foreach=\"r in regions\">\n *              <tr data-f-foreach=\"s in sales\">\n *                  <td><%= r + \": \" %> <%= (s > 250) ? s : \"sales below threshold\" %></td>\n *              </tr>\n *          </tbody>\n *      </table>\n *\n * (However, if you want to completely hide the table cell for the region if the sales total is too low, you still need to [write your own converter](../../../../../converter-overview).)\n *\n * **Notes:**\n *\n * * You can use the `data-f-foreach` attribute with both arrays and objects. If the model variable is an object, reference the `key` instead of the `index` in your templates.\n * * You can use nested `data-f-foreach` attributes to created nested loops of your data. \n * * The `data-f-foreach`, whether using aliases or not, goes on the enclosing element. For a list, this is the `<ul>`, and for a table, it's the `<tbody>`.\n * * The template syntax is to enclose each code fragment (including `index`, `key`, `variable`, or alias) in `<%=` and `%>`. Templates are available as part of Flow.js's lodash dependency. See more background on [working with templates](../../../../../#templates).\n * * The `key`, `index`, and `value` are special variables that Flow.js populates for you. However, they are *no longer available* if you use aliases.\n * * As with other `data-f-` attributes, you can specify [converters](../../../../../converter-overview) to convert data from one form to another:\n *\n *          <ul data-f-foreach=\"Sales | $x,xxx\">\n *              <li> Year <%= index %>: Sales of <%= value %> </li>\n *          </ul>\n *\n * * The `data-f-foreach` attribute is [similar to the `data-f-repeat` attribute](../../repeat-attr/), so you may want to review the examples there as well.\n */\n\n'use strict';\nvar parseUtils = require('../../../utils/parse-utils');\nvar config = require('../../../config');\n\nfunction refToMarkup(refKey) {\n    return '<!--' + refKey + '-->';\n}\n\nmodule.exports = {\n\n    test: 'foreach',\n\n    target: '*',\n\n    unbind: function (attr) {\n        var template = this.data(config.attrs.foreachTemplate);\n        if (template) {\n            this.html(template);\n            this.removeData(config.attrs.foreachTemplate);\n            this.removeData(config.attrs.keyAs);\n            this.removeData(config.attrs.valueAs);\n        }\n    },\n\n    parse: function (attrVal) {\n        var inMatch = attrVal.match(/(.*) (?:in|of) (.*)/);\n        if (inMatch) {\n            var itMatch = inMatch[1].match(/\\((.*),(.*)\\)/);\n            if (itMatch) {\n                this.data(config.attrs.keyAs, itMatch[1].trim());\n                this.data(config.attrs.valueAs, itMatch[2].trim());\n            } else {\n                this.data(config.attrs.valueAs, inMatch[1].trim());\n            }\n            attrVal = inMatch[2];\n        }\n        return attrVal;\n    },\n\n    handle: function (value, prop) {\n        value = ($.isPlainObject(value) ? value : [].concat(value));\n        var loopTemplate = this.data(config.attrs.foreachTemplate);\n        if (!loopTemplate) {\n            loopTemplate = this.html();\n            this.data(config.attrs.foreachTemplate, loopTemplate);\n        }\n        var $me = this.empty();\n        var cloop = loopTemplate.replace(/&lt;/g, '<').replace(/&gt;/g, '>');\n\n        var defaultKey = $.isPlainObject(value) ? 'key' : 'index';\n        var keyAttr = $me.data(config.attrs.keyAs) || defaultKey;\n        var valueAttr = $me.data(config.attrs.valueAs) || 'value';\n        \n        var keyRegex = new RegExp('\\\\b' + keyAttr + '\\\\b');\n        var valueRegex = new RegExp('\\\\b' + valueAttr + '\\\\b');\n\n\n        var closestKnownDataEl = this.closest('[data-current-index]');\n        var knownData = {};\n        if (closestKnownDataEl.length) {\n            knownData = closestKnownDataEl.data('current-index');\n        }\n        var closestParentWithMissing = this.closest('[data-missing-references]');\n        if (closestParentWithMissing.length) { //(grand)parent already stubbed out missing references\n            var missing = closestParentWithMissing.data('missing-references');\n            _.each(missing, function (replacement, template) {\n                if (keyRegex.test(template) || valueRegex.test(template)) {\n                    cloop = cloop.replace(refToMarkup(replacement), template);\n                }\n            });\n        } else {\n            var missingReferences = {};\n            var templateTagsUsed = cloop.match(/<%[=-]?([\\s\\S]+?)%>/g);\n            if (templateTagsUsed) {\n                templateTagsUsed.forEach(function (tag) {\n                    if (tag.match(/\\w+/) && !keyRegex.test(tag) && !valueRegex.test(tag)) {\n                        var refKey = missingReferences[tag];\n                        if (!refKey) {\n                            refKey = _.uniqueId('no-ref');\n                            missingReferences[tag] = refKey;\n                        }\n                        var r = new RegExp(tag, 'g');\n                        cloop = cloop.replace(r, refToMarkup(refKey));\n                    }\n                });\n            }\n            if (_.size(missingReferences)) {\n                //Attr, not data, to make jQ selector easy. No f- prefix to keep this from flow.\n                this.attr('data-missing-references', JSON.stringify(missingReferences));\n            }\n        }\n\n        var templateFn = _.template(cloop);\n        _.each(value, function (dataval, datakey) {\n            if (!dataval) {\n                dataval = dataval + '';\n            }\n            var templateData = {};\n            templateData[keyAttr] = datakey;\n            templateData[valueAttr] = dataval;\n            \n            $.extend(templateData, knownData);\n\n            var nodes;\n            var isTemplated;\n            try {\n                var templatedLoop = templateFn(templateData);\n                isTemplated = templatedLoop !== cloop;\n                nodes = $(templatedLoop);\n            } catch (e) { //you don't have all the references you need;\n                nodes = $(cloop);\n                isTemplated = true;\n                $(nodes).attr('data-current-index', JSON.stringify(templateData));\n            }\n\n            nodes.each(function (i, newNode) {\n                newNode = $(newNode);\n                _.each(newNode.data(), function (val, key) {\n                    newNode.data(key, parseUtils.toImplicitType(val));\n                });\n                if (!isTemplated && !newNode.html().trim()) {\n                    newNode.html(dataval);\n                }\n            });\n            $me.append(nodes);\n            \n        });\n    }\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attributes/foreach/default-foreach-attr.js","/**\n * ## Checkboxes and Radio Buttons\n *\n * In the [default case](../default-bind-attr/), the `data-f-bind` attribute creates a bi-directional binding between the DOM element and the model variable. This binding is **bi-directional**, meaning that as the model changes, the interface is automatically updated; and when end users change values in the interface, the model is automatically updated.\n *\n * Flow.js provides special handling for DOM elements with `type=\"checkbox\"` and `type=\"radio\"`.\n *\n * In particular, if you add the `data-f-bind` attribute to an `input` with `type=\"checkbox\"` and `type=\"radio\"`, the checkbox or radio button is automatically selected if the `value` matches the value of the model variable referenced, or if the model variable is `true`.\n *\n * **Example**\n *\n *      <!-- radio button, selected if sampleInt is 8 -->\n *      <input type=\"radio\" data-f-bind=\"sampleInt\" value=\"8\" />\n *\n *      <!-- checkbox, checked if sampleBool is true -->\n *      <input type=\"checkbox\" data-f-bind=\"sampleBool\" />\n *\n */\n\n'use strict';\n\nmodule.exports = {\n\n    target: ':checkbox,:radio',\n\n    test: 'bind',\n\n    handle: function (value) {\n        if (_.isArray(value)) {\n            value = value[value.length - 1];\n        }\n        var settableValue = this.attr('value'); //initial value\n        var isChecked = (typeof settableValue !== 'undefined') ? (settableValue == value) : !!value; //eslint-disable-line eqeqeq\n        this.prop('checked', isChecked);\n    }\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attributes/binds/checkbox-radio-bind-attr.js","/**\n * ## Inputs and Selects\n *\n * In the [default case](../default-bind-attr/), the `data-f-bind` attribute creates a bi-directional binding between the DOM element and the model variable. This binding is **bi-directional**, meaning that as the model changes, the interface is automatically updated; and when end users change values in the interface, the model is automatically updated.\n *\n * Flow.js provides special handling for DOM elements `input` and `select`.\n *\n * In particular, if you add the `data-f-bind` attribute to a `select` or `input` element, the option matching the value of the model variable is automatically selected.\n *\n * **Example**\n *\n * \t\t<!-- option selected if sample_int is 8, 10, or 12 -->\n * \t\t<select data-f-bind=\"sample_int\">\n * \t\t\t<option value=\"8\"> 8 </option>\n * \t\t\t<option value=\"10\"> 10 </option>\n * \t\t\t<option value=\"12\"> 12 </option>\n * \t\t</select>\n *\n */\n\n'use strict';\n\nmodule.exports = {\n    target: 'input, select',\n\n    test: 'bind',\n\n    handle: function (value) {\n        if (_.isArray(value)) {\n            value = value[value.length - 1];\n        }\n        this.val(value);\n    }\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attributes/binds/input-bind-attr.js","/**\n * ## Class Attribute: data-f-class\n *\n * You can bind model variables to names of CSS classes, so that you can easily change the styling of HTML elements based on the values of model variables.\n *\n * **To bind model variables to CSS classes:**\n *\n * 1. Add the `data-f-class` attribute to an HTML element.\n * 2. Set the value to the name of the model variable.\n * 3. Optionally, add an additional `class` attribute to the HTML element.\n *      * If you only use the `data-f-class` attribute, the value of `data-f-class` is the class name.\n *      * If you *also* add a `class` attribute, the value of `data-f-class` is *appended* to the class name.\n * 4. Add classes to your CSS code whose names include possible values of that model variable.\n *\n * **Example**\n *\n *      <style type=\"text/css\">\n *          .North { color: grey }\n *          .South { color: purple }\n *          .East { color: blue }\n *          .West { color: orange }\n *          .sales.good { color: green }\n *          .sales.bad { color: red }\n *          .sales.value-100 { color: yellow }\n *       </style>\n *\n *       <div data-f-class=\"salesMgr.region\">\n *           Content colored by region\n *       </div>\n *\n *       <div data-f-class=\"salesMgr.performance\" class=\"sales\">\n *           Content green if salesMgr.performance is good, red if bad\n *       </div>\n *\n *       <div data-f-class=\"salesMgr.numRegions\" class=\"sales\">\n *           Content yellow if salesMgr.numRegions is 100\n *       </div>\n *\n */\n\n'use strict';\nvar config = require('../../config');\n\nmodule.exports = {\n\n    test: 'class',\n\n    target: '*',\n\n    handle: function (value, prop) {\n        if (_.isArray(value)) {\n            value = value[value.length - 1];\n        }\n\n        var addedClasses = this.data(config.classesAdded);\n        if (!addedClasses) {\n            addedClasses = {};\n        }\n        if (addedClasses[prop]) {\n            this.removeClass(addedClasses[prop]);\n        }\n\n        if (_.isNumber(value)) {\n            value = 'value-' + value;\n        }\n        addedClasses[prop] = value;\n        //Fixme: prop is always \"class\"\n        this.addClass(value);\n        this.data(config.classesAdded, addedClasses);\n    }\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attributes/class-attr.js","/**\n * ## Display Array Variables: data-f-repeat\n *\n * The `data-f-repeat` attribute allows you to automatically loop over a referenced variable. The most common use case is in time-based models, like those written in [SimLang](../../../../../model_code/forio_simlang/) or [Vensim](../../../../../model_code/vensim/), when you want to report the value of the variable at every time step so far. The `data-f-repeat` attribute automatically repeats the DOM element it's attached to, filling in the value.\n *\n * **To display a DOM element repeatedly based on an array variable from the model:**\n *\n * 1. Add the `data-f-repeat` attribute to any HTML element that has repeated sub-elements. The two most common examples are lists and tables.\n * 2. Set the value of the `data-f-repeat` attribute in the HTML element you want to repeat to the name of the array variable.\n * 3. Optionally, you can use templates (`<%= %>`) to reference the `index` (for arrays) or `key` (for objects) and `value` to display. The `index`, `key`, and `value` are special variables that Flow.js populates for you.\n *\n *\n * **Examples:**\n *\n * For example, to create a table that displays the year and cost for every step of the model that has occurred so far:\n *\n *      <table>\n *          <tr>\n *              <td>Year</td>\n *              <td data-f-repeat=\"Cost[Products]\"><%= index + 1 %></td>\n *          </tr>\n *          <tr>\n *              <td>Cost of Products</td>\n *              <td data-f-repeat=\"Cost[Products]\"></td>\n *          </tr>\n *      </table>\n *\n * In the third step of the model, this example generates the HTML:\n *\n *      <table>\n *          <tr>\n *              <td>Year</td>\n *              <td data-f-repeat=\"Cost[Products]\">1</td>\n *              <td>2</td>\n *              <td>3</td>\n *          </tr>\n *          <tr>\n *              <td>Cost of Products</td>\n *              <td data-f-repeat=\"Cost[Products]\">100</td>\n *              <td>102</td>\n *              <td>105</td>\n *          </tr>\n *      </table>\n *\n * You can also use this with a `<div>` and have the `<div>` itself repeated. For example:\n *\n *      <div data-f-repeat=\"sample_array\"></div>\n *\n * generates:\n *\n *      <div data-f-repeat=\"sample_array\">2</div>\n *      <div>4</div>\n *      <div>6</div>\n *\n * **Notes:**\n *\n * * You can use the `data-f-repeat` attribute with both arrays and objects. If the model variable is an object, reference the `key` instead of the `index` in your templates.\n * * The `key`, `index`, and `value` are special variables that Flow.js populates for you.\n * * The template syntax is to enclose each keyword (`index`, `key`, `variable`) in `<%=` and `%>`. Templates are available as part of Flow.js's lodash dependency. See more background on [working with templates](../../../../#templates).\n * * In most cases the same effect can be achieved with the [`data-f-foreach` attribute](../../attributes/foreach/default-foreach-attr/), which is similar. In the common use case of a table of data displayed over time, the `data-f-repeat` can be more concise and easier to read. However, the `data-f-foreach` allows aliasing, and so can be more useful especially if you are nesting HTML elements or want to introduce logic about how to display the values.\n *\n */\n\n'use strict';\nvar parseUtils = require('../../utils/parse-utils');\nvar gutils = require('../../utils/general');\nvar config = require('../../config').attrs;\nmodule.exports = {\n\n    test: 'repeat',\n\n    target: '*',\n\n    unbind: function (attr) {\n        var id = this.data(config.repeat.templateId);\n        if (id) {\n            this.nextUntil(':not([data-' + id + '])').remove();\n            // this.removeAttr('data-' + config.repeat.templateId); //FIXME: Something about calling rebind multiple times in IB makes this happen without the removal\n        }\n        var loopTemplate = this.data(config.repeat.template);\n        if (loopTemplate) {\n            this.removeData(config.repeat.template);\n            this.replaceWith(loopTemplate);\n        }\n    },\n\n    handle: function (value, prop) {\n        value = ($.isPlainObject(value) ? value : [].concat(value));\n        var loopTemplate = this.data(config.repeat.template);\n        var id = this.data(config.repeat.templateId);\n\n        if (!loopTemplate) {\n            loopTemplate = this.get(0).outerHTML;\n            this.data(config.repeat.template, loopTemplate);\n        }\n\n        if (id) {\n            this.nextUntil(':not([data-' + id + '])').remove();\n        } else {\n            id = gutils.random('repeat-');\n            this.attr('data-' + config.repeat.templateId, id);\n        }\n  \n        var last;\n        var me = this;\n        _.each(value, function (dataval, datakey) {\n            var cloop = loopTemplate.replace(/&lt;/g, '<').replace(/&gt;/g, '>');\n            var templatedLoop = _.template(cloop)({ value: dataval, key: datakey, index: datakey });\n            var isTemplated = templatedLoop !== cloop;\n            var nodes = $(templatedLoop);\n            var hasData = (dataval !== null && dataval !== undefined);\n\n            nodes.each(function (i, newNode) {\n                newNode = $(newNode).removeAttr('data-f-repeat').removeAttr('data-' + config.repeat.templateId);\n                _.each(newNode.data(), function (val, key) {\n                    if (!last) {\n                        me.data(key, parseUtils.toImplicitType(val));\n                    } else {\n                        newNode.data(key, parseUtils.toImplicitType(val));\n                    }\n                });\n                newNode.attr('data-' + id, true);\n                if (!isTemplated && !newNode.children().length && hasData) {\n                    newNode.html(dataval + '');\n                }\n            });\n            if (!last) {\n                last = me.html(nodes.html());\n            } else {\n                last = nodes.insertAfter(last);\n            }\n        });\n    }\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attributes/repeat-attr.js","/**\n * ## Binding for data-f-[boolean]\n *\n * Flow.js provides special handling for HTML attributes that take Boolean values.\n *\n * In particular, for most HTML attributes that expect Boolean values, the attribute is directly set to the value of the model variable. This is true for `checked`, `selected`, `async`, `autofocus`, `autoplay`, `controls`, `defer`, `ismap`, `loop`, `multiple`, `open`, `required`, and `scoped`.\n *\n * However, there are a few notable exceptions. For the HTML attributes `disabled`, `hidden`, and `readonly`, the attribute is set to the *opposite* of the value of the model variable. This makes the resulting HTML easier to read.\n *\n * **Example**\n *\n *      <!-- this checkbox is CHECKED when sampleBool is TRUE,\n *           and UNCHECKED when sampleBool is FALSE -->\n *      <input type=\"checkbox\" data-f-checked=\"sampleBool\" />\n *\n *      <!-- this button is ENABLED when sampleBool is TRUE,\n *           and DISABLED when sampleBool is FALSE -->\n *      <button data-f-disabled=\"sampleBool\">Click Me</button>\n *\n */\n\n'use strict';\n\nmodule.exports = {\n    target: '*',\n\n    test: /^(?:checked|selected|async|autofocus|autoplay|controls|defer|ismap|loop|multiple|open|required|scoped)$/i,\n\n    handle: function (value, prop) {\n        if (_.isArray(value)) {\n            value = value[value.length - 1];\n        }\n        var val = (this.attr('value')) ? (value == this.prop('value')) : !!value; //eslint-disable-line eqeqeq\n        this.prop(prop, val);\n    }\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attributes/positive-boolean-attr.js","/**\n * ## Binding for data-f-[boolean]\n *\n * Flow.js provides special handling for HTML attributes that take Boolean values.\n *\n * In particular, for most HTML attributes that expect Boolean values, the attribute is directly set to the value of the model variable. This is true for `checked`, `selected`, `async`, `autofocus`, `autoplay`, `controls`, `defer`, `ismap`, `loop`, `multiple`, `open`, `required`, and `scoped`.\n *\n * However, there are a few notable exceptions. For the HTML attributes `disabled`, `hidden`, and `readonly`, the attribute is set to the *opposite* of the value of the model variable. This makes the resulting HTML easier to read.\n *\n * **Example**\n *\n *      <!-- this checkbox is CHECKED when sampleBool is TRUE,\n *           and UNCHECKED when sampleBool is FALSE -->\n *      <input type=\"checkbox\" data-f-checked=\"sampleBool\" />\n *\n *      <!-- this button is ENABLED when sampleBool is TRUE,\n *           and DISABLED when sampleBool is FALSE -->\n *      <button data-f-disabled=\"sampleBool\">Click Me</button>\n *\n */\n\n'use strict';\n\nmodule.exports = {\n\n    target: '*',\n\n    test: /^(?:disabled|hidden|readonly)$/i,\n\n    handle: function (value, prop) {\n        if (_.isArray(value)) {\n            value = value[value.length - 1];\n        }\n        this.prop(prop, !value);\n    }\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attributes/negative-boolean-attr.js","/**\n * ## Default Bi-directional Binding: data-f-bind\n *\n * The most commonly used attribute provided by Flow.js is the `data-f-bind` attribute.\n *\n * #### data-f-bind with a single value\n *\n * You can bind variables from the model in your interface by setting the `data-f-bind` attribute. This attribute binding is bi-directional, meaning that as the model changes, the interface is automatically updated; and when users change values in the interface, the model is automatically updated. Specifically:\n *\n * * The binding from the model to the interface ensures that the current value of the variable is displayed in the HTML element. This includes automatic updates to the displayed value if something else changes in the model.\n *\n * * The binding from the interface to the model ensures that if the HTML element is editable, changes are sent to the model.\n *\n * Once you set `data-f-bind`, Flow.js figures out the appropriate action to take based on the element type and the data response from your model.\n *\n * **To display and automatically update a variable in the interface:**\n *\n * 1. Add the `data-f-bind` attribute to any HTML element that normally takes a value.\n * 2. Set the value of the `data-f-bind` attribute to the name of the variable.\n *\n * **Example**\n *\n *      <span data-f-bind=\"salesManager.name\" />\n *\n *      <input type=\"text\" data-f-bind=\"sampleString\" />\n *\n * **Notes:**\n *\n * * Use square brackets, `[]`, to reference arrayed variables: `sales[West]`.\n * * Use angle brackets, `<>`, to reference other variables in your array index: `sales[<currentRegion>]`.\n * * Remember that if your model is in Vensim, the time step is the last array index.\n * * By default, all HTML elements update for any change for each variable. However, you can prevent the user interface from updating &mdash; either for all variables or for particular variables &mdash; by setting the `silent` property when you initialize Flow.js. See more on [additional options for the Flow.initialize() method](../../../../../#custom-initialize).\n *\n * #### data-f-bind with multiple values and templates\n *\n * If you have multiple variables, you can use the shortcut of listing multiple variables in an enclosing HTML element and then referencing each variable using templates. (Templates are available as part of Flow.js's lodash dependency. See more background on [working with templates](../../../../../#templates).)\n *\n * **To display and automatically update multiple variables in the interface:**\n *\n * 1. Add the `data-f-bind` attribute to any HTML element from which you want to reference model variables, such as a `div` or `table`.\n * 2. Set the value of the `data-f-bind` attribute in your top-level HTML element to a comma-separated list of the variables. (The variables may or may not be case-sensitive, depending on your modeling language.)\n *\n * 3. Inside the HTML element, use templates (`<%= %>`) to reference the specific variable names. These variable names are case-sensitive: they should match the case you used in the `data-f-bind` in step 2.\n *\n * **Example**\n *\n *      <!-- make these three model variables available throughout div -->\n *\n *      <div data-f-bind=\"CurrentYear, Revenue, Profit\">\n *          In <%= CurrentYear %>,\n *          our company earned <%= Revenue %>,\n *          resulting in <%= Profit %> profit.\n *      </div>\n *\n * This example is shorthand for repeatedly using data-f-bind. For instance, this code also generates the same output:\n *\n *      <div>\n *          In <span data-f-bind=\"CurrentYear\"></span>,\n *          our company earned <span data-f-bind=\"Revenue\"></span>,\n *          resulting in <span data-f-bind=\"Profit\"> profit</span>.\n *      </div>\n *\n * **Notes:**\n *\n * * Adding `data-f-bind` to the enclosing HTML element rather than repeatedly using it within the element is a code style preference. In many cases, adding `data-f-bind` at the top level, as in the first example, can make your code easier to read and maintain.\n * * However, you might choose to repeatedly use `data-f-bind` in some cases, for example if you want different [formatting](../../../../../converter-overview/) for different variables:\n *\n *          <div>\n *              In <span data-f-bind=\"CurrentYear | #\"></span>,\n *              our company earned <span data-f-bind=\"Revenue | $#,###\"></span>\n *          </div>\n *\n * * Because everything within your template (`<%= %>`) is evaluated as JavaScript, you can use templates to pass expressions to other Flow.js attributes. For example,\n *\n *          <div data-f-bind=\"myCurrentTimeStep\">\n *              <div data-f-bind=\"Revenue[<%= value + 1%>]\"></div>\n *          </div>\n *\n * will display the value of `Revenue[myCurrentTimeStep + 1]` (for example an estimate of future revenue in your model).\n *\n */\n\n'use strict';\nvar config = require('../../../config');\n\nmodule.exports = {\n\n    target: '*',\n\n    test: 'bind',\n\n    unbind: function (attr) {\n        var template = this.data(config.attrs.bindTemplate);\n        if (template) {\n            this.html(template);\n        }\n    },\n\n    handle: function (value) {\n        var templated;\n        var valueToTemplate = $.extend({}, value);\n        if (!$.isPlainObject(value)) {\n            var variableName = this.data('f-bind');//Hack because i don't have access to variable name here otherwise\n            valueToTemplate = { value: value };\n            valueToTemplate[variableName] = value;\n        } else {\n            valueToTemplate.value = value; //If the key has 'weird' characters like '<>' hard to get at with a template otherwise\n        }\n        var bindTemplate = this.data(config.attrs.bindTemplate);\n        if (bindTemplate) {\n            templated = _.template(bindTemplate)(valueToTemplate);\n            this.html(templated);\n        } else {\n            var oldHTML = this.html();\n            var cleanedHTML = oldHTML.replace(/&lt;/g, '<').replace(/&gt;/g, '>');\n            templated = _.template(cleanedHTML)(valueToTemplate);\n            if (cleanedHTML === templated) { //templating did nothing\n                if (_.isArray(value)) {\n                    value = value[value.length - 1];\n                }\n                value = ($.isPlainObject(value)) ? JSON.stringify(value) : value + '';\n                this.html(value);\n            } else {\n                this.data(config.attrs.bindTemplate, cleanedHTML);\n                this.html(templated);\n            }\n        }\n    }\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attributes/binds/default-bind-attr.js","/**\n * ## Default Attribute Handling: Read-only Binding\n *\n * Flow.js uses the HTML5 convention of prepending data- to any custom HTML attribute. Flow.js also adds `f` for easy identification of Flow.js. For example, Flow.js provides several custom attributes and attribute handlers -- including [data-f-bind](../binds/default-bind-attr), [data-f-foreach](../foreach/default-foreach-attr/), [data-f-on-init](../events/init-event-attr/), etc. You can also [add your own attribute handlers](../attribute-manager/).\n *\n * The default behavior for handling a known attribute is to use the value of the model variable as the value of the attribute. (There are exceptions for some [boolean attributes](../boolean-attr/).)\n *\n * This means you can bind variables from the model in your interface by adding the `data-f-` prefix to any standard DOM attribute. This attribute binding is **read-only**, so as the model changes, the interface is automatically updated; but when users change values in the interface, no action occurs.\n *\n * **To display a DOM element based on a variable from the model:**\n *\n * 1. Add the prefix `data-f-` to any attribute in any HTML element that normally takes a value.\n * 2. Set the value of the attribute to the name of the model variable.\n *\n * **Example**\n *\n * \t\t<!-- input element displays value of sample_int, however,\n * \t\t\tno call to the model is made if user changes sample_int\n *\n *\t\t\tif sample_int is 8, this is the equivalent of <input value=\"8\"></input> -->\n *\n *\t\t<input data-f-value=\"sample_int\"></input>\n *\n */\n\n'use strict';\n\nmodule.exports = {\n\n    test: '*',\n\n    target: '*',\n\n    handle: function (value, prop) {\n        this.prop(prop, value);\n    }\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attributes/default-attr.js","'use strict';\n\nmodule.exports = function (target, domManager) {\n    if (!window.MutationObserver) {\n        return false;\n    }\n\n    // Create an observer instance\n    var observer = new MutationObserver(function (mutations) {\n        mutations.forEach(function (mutation) {\n            var added = $(mutation.addedNodes).find(':f');\n            added = added.add($(mutation.addedNodes).filter(':f'));\n\n            var removed = $(mutation.removedNodes).find(':f');\n            removed = removed.add($(mutation.removedNodes).filter(':f'));\n\n            if (added && added.length) {\n                domManager.bindAll(added);\n            }\n            if (removed && removed.length) {\n                domManager.unbindAll(removed);\n            }\n            if (mutation.attributeName === 'data-f-channel') {\n                domManager.unbindAll(mutation.target);\n                domManager.bindAll(mutation.target);\n            }\n        });\n    });\n\n\n    var mutconfig = {\n        attributes: true,\n        attributeFilter: ['data-f-channel'], //FIXME: Make this a config param\n        childList: true,\n        subtree: true,\n        characterData: false\n    };\n    observer.observe(target, mutconfig);\n    // Later, you can stop observing\n    // observer.disconnect();\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/plugins/auto-update-bindings.js","import JSONParseMiddleware from './middleware/json-parse-middleware';\nimport EpicenterMiddleware from './middleware/epicenter-middleware';\nimport DefaultChannelManager from './channel-manager';\n\nimport { interpolatable, withMiddleware } from './channel-manager-enhancements';\n\n//Moving  epicenter-centric glue here so channel-manager can be tested in isolation\nvar InterpolatableChannelManagerWithMiddleware = interpolatable(withMiddleware(DefaultChannelManager));\nexport default function ChannelManager(opts) {\n    var cm = new InterpolatableChannelManagerWithMiddleware($.extend(true, {}, {\n        middlewares: [JSONParseMiddleware, EpicenterMiddleware]\n    }, opts));\n    return cm;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/configured-channel-manager.js","import { toImplicitType } from 'utils/parse-utils';\n\nexport default function JSONMiddleware(config, notifier) {\n    return {\n        /**\n         * Subscribe to string literals\n         * @param  {string[]} topics\n         * @return {string[]}        topics excluding parsed\n         */\n        subscribeHandler: function (topics) {\n            var sorted = ([].concat(topics)).reduce(function (acc, topic) {\n                var parsed = toImplicitType(topic);\n                if (typeof parsed === 'string') {\n                    acc.rest.push(topic);\n                } else {\n                    acc.claimed.push({\n                        name: topic,\n                        value: parsed\n                    });\n                }\n                return acc;\n            }, { claimed: [], rest: [] });\n        \n            if (sorted.claimed.length) {\n                notifier(sorted.claimed);\n            }\n           \n            return sorted.rest;\n        }\n    };\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/middleware/json-parse-middleware/index.js","import RunManagerRouter from './run-manager-router';\nimport ScenarioRouter from './scenario-manager-router';\nimport CustomRunRouter from './custom-run-router';\n\nimport RunsRouter from './runs-router';\n\nimport { regex, withPrefix, prefix as prefixMatch, defaultPrefix } from 'channels/middleware/utils';\n\nimport Router from 'channels/channel-router';\n\nfunction getOptions(opts, key) {\n    var serviceOptions = $.extend(true, {}, opts.defaults, opts[key]);\n    var channelOptions = $.extend(true, {}, serviceOptions.channelOptions);\n    delete serviceOptions.channelOptions;\n\n    return { serviceOptions: serviceOptions, channelOptions: channelOptions };\n}\n\nvar SCENARIO_PREFIX = 'sm:';\nvar RUN_PREFIX = 'rm:';\n\nvar sampleRunidLength = '000001593dd81950d4ee4f3df14841769a0b'.length;\nvar runidRegex = '(?:.{' + sampleRunidLength + '})';\n\nexport default function (config, notifier, channelManagerContext) {\n    var opts = $.extend(true, {}, config);\n\n    var customRunChannelOpts = getOptions(opts, 'runid');\n    var customRunChannel = new CustomRunRouter(customRunChannelOpts, notifier);\n    var runsChannel = new RunsRouter(customRunChannelOpts, withPrefix(notifier, 'runs'), channelManagerContext);\n\n    /** @type {Handler[]} **/\n    var handlers = [$.extend({}, customRunChannel, { \n        name: 'customRun',\n        match: regex(runidRegex),\n        options: customRunChannelOpts.channelOptions,\n    }), $.extend({}, runsChannel, {\n        name: 'archiveRuns',\n        match: prefixMatch('runs'),\n        options: customRunChannelOpts.channelOptions,\n    })];\n    var exposable = {};\n\n    var runManagerOpts = getOptions(opts, 'runManager');\n    if (opts.runManager || (!opts.scenarioManager && runManagerOpts.serviceOptions.run)) {\n        var rm;\n        if (opts.scenarioManager) {\n            rm = new RunManagerRouter(runManagerOpts, withPrefix(notifier, RUN_PREFIX));\n            handlers.push($.extend({}, rm, { \n                name: 'run',\n                match: prefixMatch(RUN_PREFIX),\n                options: runManagerOpts.channelOptions,\n            }));\n        } else {\n            rm = new RunManagerRouter(runManagerOpts, withPrefix(notifier, [RUN_PREFIX, '']));\n            handlers.push($.extend({}, rm, { \n                name: 'run',\n                match: defaultPrefix(RUN_PREFIX),\n                isDefault: true,\n                options: runManagerOpts.channelOptions,\n            }));\n        }\n\n        $.extend(exposable, rm.expose);\n    }\n\n    if (opts.scenarioManager) {\n        var scenarioManagerOpts = getOptions(opts, 'scenarioManager');\n        var sm = new ScenarioRouter(scenarioManagerOpts, withPrefix(notifier, [SCENARIO_PREFIX, '']));\n        handlers.push($.extend({}, sm, { \n            name: 'scenario',\n            match: defaultPrefix(SCENARIO_PREFIX),\n            options: scenarioManagerOpts.channelOptions,\n            isDefault: true,\n        }));\n\n        $.extend(exposable, sm.expose);\n    }\n\n    var router = new Router(handlers, notifier);\n    router.expose = exposable;\n    \n    return router;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/middleware/epicenter-middleware/index.js","import RunChannel from './run-router';\n\nimport { withPrefix, defaultPrefix } from 'channels/middleware/utils';\nimport Router from 'channels/channel-router';\n\nexport default function (config, notifier) {\n    var defaults = {\n        serviceOptions: {},\n        channelOptions: {}\n    };\n    var opts = $.extend(true, {}, defaults, config);\n\n    var rm = new window.F.manager.RunManager(opts.serviceOptions);\n    var $creationPromise = rm.getRun().then(()=> rm.run);\n    var currentChannelOpts = $.extend(true, \n        { serviceOptions: $creationPromise }, opts.defaults, opts.current);\n    var currentRunChannel = new RunChannel(currentChannelOpts, withPrefix(notifier, ['current:', '']));\n\n    var handlers = [\n        $.extend(currentRunChannel, { \n            match: defaultPrefix('current:'),\n            isDefault: true,\n            options: currentChannelOpts.channelOptions,\n        })\n    ];\n\n    var router = new Router(handlers, notifier);\n    router.expose = { runManager: rm };\n    return router;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/middleware/epicenter-middleware/run-manager-router.js","import { objectToArray, arrayToObject } from 'channels/channel-utils';\n\nvar { intersection } = _;\n\nexport default function RunMetaChannel($runServicePromise, notifier) {\n\n    function mergeAndSend(runMeta, requestedTopics) {\n        var toSend = ([].concat(requestedTopics)).reduce(function (accum, meta) {\n            if (runMeta[meta] !== undefined) {\n                accum.push({ name: meta, value: runMeta[meta] });\n            }\n            return accum;\n        }, []);\n        return notifier(toSend);\n    }\n    return {\n        subscribeHandler: function (topics, options) {\n            topics = [].concat(topics);\n            return $runServicePromise.then(function (runService) {\n                var cachedValues = intersection(Object.keys(runService.runMeta || {}), topics);\n                if (options.autoFetch === false) {\n                    return $.Deferred().resolve({}).promise();\n                } else if (cachedValues.length === topics.length) {\n                    //FIXME: Add 'updated time' to meta, and fetch if that's < debounce interval -- use the custom debounce fn with the custom merge (debounce save as well?)\n                    //Make run service factory return patched run-service?\n                    return $.Deferred().resolve(mergeAndSend(runService.runMeta, topics)).promise();\n                } if (!runService.loadPromise) {\n                    runService.loadPromise = runService.load().then(function (data) {\n                        runService.runMeta = data;\n                        return data;\n                    });\n                } \n                return runService.loadPromise.then(function (data) {\n                    mergeAndSend(data, topics);\n                });\n            });\n        },\n        publishHandler: function (topics, options) {\n            return $runServicePromise.then(function (runService) {\n                var toSave = arrayToObject(topics);\n                return runService.save(toSave).then(function (res) {\n                    runService.runMeta = $.extend({}, true, runService.runMeta, res);\n                    return objectToArray(res);\n                });\n            });\n        }\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/middleware/epicenter-middleware/run-router/run-meta-channel.js","import { debounceAndMerge } from 'utils/general';\nimport { objectToArray, arrayToObject } from 'channels/channel-utils';\n\nexport default function RunVariablesChannel($runServicePromise, notifier) {\n\n    var id = _.uniqueId('variable-channel');\n\n    var fetchFn = function (runService, debounceInterval) {\n        if (!runService.debouncedFetchers) {\n            runService.debouncedFetchers = {};\n        }\n        if (!runService.debouncedFetchers[id]) {\n            runService.debouncedFetchers[id] = debounceAndMerge(function (variables) {\n                if (!variables || !variables.length) {\n                    return $.Deferred().resolve([]).promise();\n                }\n                return runService.variables().query(variables).then(objectToArray);\n            }, debounceInterval, [function mergeVariables(accum, newval) {\n                if (!accum) {\n                    accum = [];\n                }\n                return _.uniq(accum.concat(newval)).filter((v)=> !!(v && v.trim()));\n            }]);\n        }\n        return runService.debouncedFetchers[id];\n    };\n     \n\n    var knownTopics = [];\n    return { \n        fetch: function () {\n            return $runServicePromise.then(function (runService) {\n                return fetchFn(runService, 0)(knownTopics).then(notifier);\n            });\n        },\n\n        unsubscribeHandler: function (unsubscribedTopics, remainingTopics) {\n            knownTopics = remainingTopics;\n        },\n        subscribeHandler: function (topics, options) {\n            var isAutoFetchEnabled = options.autoFetch;\n            var debounceInterval = options.debounce;\n\n            return $runServicePromise.then(function (runService) {\n                knownTopics = _.uniq(knownTopics.concat(topics));\n                if (!knownTopics.length) {\n                    return $.Deferred().resolve([]).promise();\n                } else if (!isAutoFetchEnabled) {\n                    return $.Deferred().resolve(topics).promise();\n                }\n                return fetchFn(runService, debounceInterval)(topics).then(notifier);\n            });\n        },\n        publishHandler: function (topics, options) {\n            return $runServicePromise.then(function (runService) {\n                var toSave = arrayToObject(topics);\n                return runService.variables().save(toSave).then(function (response) {\n                    return objectToArray(response);\n                });\n            });\n        }\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/middleware/epicenter-middleware/run-router/run-variables-channel.js","export default function RunOperationsChannel($runServicePromise) {\n    return {\n        publishHandler: function (topics, options) {\n            return $runServicePromise.then(function (runService) {\n                var toSave = topics.map(function (topic) {\n                    return { name: topic.name, params: topic.value };\n                });\n                return runService.serial(toSave).then(function (result) {\n                    var toReturn = result.map(function (response, index) {\n                        return { name: topics[index].name, value: response };\n                    });\n                    return toReturn;\n                });\n            });\n        }\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/middleware/epicenter-middleware/run-router/run-operations-channel.js","var { isArray, includes } = _;\n\n/**\n * @param {Publishable[]} published \n * @param {boolean|String[]|{except: String[]}} [silentOptions]\n * @return {Publishable[]} filtered list\n */\nexport default function silencable(published, silentOptions) {\n    if (silentOptions === true || !published) {\n        return [];\n    } else if (isArray(silentOptions)) {\n        return published.filter((data) => !includes(silentOptions, data.name));\n    } else if (silentOptions && silentOptions.except) {\n        return published.filter((data) => includes(silentOptions.except || [], data.name));\n    }\n    return published;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/middleware/utils/silencable.js","var { isArray, includes, isFunction } = _;\n\n/**\n * \n * @param {Publishable[]} publishable \n * @param {boolean|string[]|Function} readOnlyOptions \n * @return {Publishable[]} filtered list\n */\nexport default function excludeReadOnly(publishable, readOnlyOptions) {\n    if (isFunction(readOnlyOptions)) {\n        readOnlyOptions = readOnlyOptions();\n    }\n    if (readOnlyOptions === true) {\n        console.error('Tried to publish to a readonly channel', publishable);\n        return [];\n    } else if (isArray(readOnlyOptions)) {\n        var split = publishable.reduce((accum, data)=> {\n            var isReadonly = includes(readOnlyOptions, data.name);\n            if (isReadonly) {\n                accum.readOnly.push(data);\n            } else {\n                accum.remaining.push(data);\n            }\n            return accum;\n        }, { readOnly: [], remaining: [] });\n        \n        if (split.readOnly.length) {\n            console.error('Ignoring readonly publishes', split.readOnly);\n        }\n        return split.remaining;\n    }\n    return publishable;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/middleware/utils/exclude-read-only.js","import RunRouter from './run-router';\nimport { prefix, withPrefix, defaultPrefix } from 'channels/middleware/utils';\nimport Router from 'channels/channel-router';\n\nexport default function (config, notifier) {\n    var defaults = {\n        serviceOptions: {},\n        channelOptions: {},\n    };\n    var opts = $.extend(true, {}, defaults, config);\n\n    var sm = new window.F.manager.ScenarioManager(opts.serviceOptions);\n\n    var baselinePromise = sm.baseline.getRun().then(()=> sm.baseline.run);\n    var baselineOptions = $.extend(true, {\n        serviceOptions: baselinePromise,\n        channelOptions: {\n            meta: {\n                readOnly: true\n            },\n            variables: {\n                readOnly: true\n            }\n        }\n    }, opts.defaults, opts.baseline);\n    var currentRunPromise = sm.current.getRun().then(()=> sm.current.run);\n\n    var runOptions = $.extend(true, {\n        serviceOptions: currentRunPromise,\n    }, opts.defaults, opts.current);\n\n    var baselineChannel = new RunRouter(baselineOptions, withPrefix(notifier, 'baseline:'));\n    var currentRunChannel = new RunRouter(runOptions, withPrefix(notifier, ['current:', '']));\n    var handlers = [\n        $.extend(baselineChannel, {\n            name: 'baseline',\n            match: prefix('baseline:'),\n            options: baselineOptions.channelOptions,\n        }),\n        $.extend(currentRunChannel, { \n            isDefault: true, \n            name: 'current',\n            match: defaultPrefix('current:'),\n            options: runOptions.channelOptions,\n        }),\n\n    ];\n    \n    var router = new Router(handlers, notifier);\n    router.expose = { scenarioManager: sm };\n    return router;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/middleware/epicenter-middleware/scenario-manager-router.js","import runChannelFactory from './run-router-factory';\nimport { withPrefix, stripSuffixDelimiter } from 'channels/middleware/utils';\n\nexport default function (options, notifier) {\n    if (!options) options = {};\n\n    var opts = {};\n    opts.serviceOptions = options.serviceOptions && options.serviceOptions.run ? options.serviceOptions.run : {};\n    opts.channelOptions = options.channelOptions;\n\n    return {\n        subscribeHandler: function (topics, options, prefix) {\n            var runid = stripSuffixDelimiter(prefix);\n            //FIXME: Should i merge options here?\n            var channel = runChannelFactory(runid, opts, withPrefix(notifier, prefix));\n            return channel.subscribeHandler(topics, options, prefix);\n        },\n        publishHandler: function (topics, options, prefix) {\n            var runid = stripSuffixDelimiter(prefix);\n            var channel = runChannelFactory(runid, opts, withPrefix(notifier, prefix));\n            return channel.publishHandler(topics);\n        }\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/middleware/epicenter-middleware/custom-run-router.js","import RunChannel from './run-router';\nvar knownRunIDServiceChannels = {};\n\nexport default function (runid, options, notifier) {\n    var runChannel = knownRunIDServiceChannels[runid];\n    if (!runChannel) {\n        var runOptions = $.extend(true, {}, options, { serviceOptions: { id: runid } });\n        runChannel = new RunChannel(runOptions, notifier);\n        knownRunIDServiceChannels[runid] = runChannel;\n    }\n    return runChannel;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/middleware/epicenter-middleware/run-router-factory.js","import { debounceAndMerge } from 'utils/general';\nvar { F } = window;\n\nexport default function RunsRouter(options, notifier, channelManagerContext) {\n    var runService = new F.service.Run(options.serviceOptions.run);\n\n    var topicParamMap = {};\n\n    function extractFiltersFromTopic(topicString) {\n        var filters = topicString.replace('(', '').replace(')', '');\n        var filterParam = filters.split(';').reduce((accum, filter)=> {\n            var [key, val] = filter.split('=');\n            if (val) {\n                val = true;\n            }\n            accum[key] = val;\n            return accum;\n        }, {});\n        return filterParam;\n    }\n\n    function fetch(topic, variables) {\n        var filters = extractFiltersFromTopic(topic);\n        return runService.query(filters, { include: variables }).then((runs)=> {\n            notifier([{ name: topic, value: runs }]);\n\n            // if (topicParamMap[topic]) {\n            //     Object.keys(topicParamMap[topic]).forEach((runid)=> {\n            //         channelManagerContext.unsubscribe(topicParamMap[topic][runid]);\n            //     });\n            // }\n\n            return runs;\n        });\n    }\n\n    return {\n        fetch: fetch,\n\n        unsubscribeHandler: function (unsubscribedTopics, remainingTopics) {\n            console.log('unsubs');\n            // knownTopics = remainingTopics;\n        },\n        subscribeHandler: function (topics, options) {\n            var topic = ([].concat(topics))[0];\n\n            var filters = extractFiltersFromTopic(topic);\n            var variables = options && options.include;\n\n            var debounceInterval = 300;\n            var debouncedFetch = debounceAndMerge(fetch, debounceInterval, (accum, newval)=> newval);\n            return fetch(topic, variables).then(function (runs) {\n                var subsMap = {};\n                //TODO: Provide this meta information to runs-factory so it doesn't trigger a fetch to get meta for each run\n                runs.forEach((run)=> {\n                    var subscriptions = Object.keys(filters).map((filter)=> run.id + ':meta:' + filter);\n                    var subsid = channelManagerContext.subscribe(subscriptions, function () {\n                        debouncedFetch(topic, variables);\n                    }, { batch: false, autoFetch: false, cache: false });\n                    subsMap[run.id] = subsid;\n                });\n\n                topicParamMap[topic] = subsMap;\n                return runs;\n            });\n        }\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/middleware/epicenter-middleware/runs-router/index.js","'use strict';\n\nimport { normalizeParamOptions } from './channel-utils';\nvar { uniqueId, isFunction, intersection, includes, uniq } = _;\n/**\n * \n * @param {String[]|String} topics \n * @param {Function} callback \n * @param {Object} options\n * @return {Subscription}\n */\nfunction makeSubs(topics, callback, options) {\n    var id = uniqueId('subs-');\n    var defaults = {\n        batch: false,\n\n        /**\n         * Determines if the last published data should be cached for future notifications. For e.g.,\n         *\n         * channel.subscribe(['price', 'cost'], callback1, { batch: true, cache: false });\n         * channel.subscribe(['price', 'cost'], callback2, { batch: true, cache: true });\n         *\n         * channel.publish({ price: 1 });\n         * channel.publish({ cost: 1 });\n         *\n         * callback1 will have been called once, and callback2 will not have been called. i.e., the channel caches the first publish value and notifies after all dependent topics have data\n         * If we'd done channel.publish({ price: 1, cost: 1 }) would have called both callback1 and callback2\n         *\n         * `cache: true` is useful if you know if your topics will can published individually, but you still want to handle them together.\n         * `cache: false` is useful if you know if your topics will *always* be published together and they'll be called at the same time.\n         *\n         * Note this has no discernible effect if batch is false\n         * @type {Boolean}\n         */\n        cache: true,\n    };\n    var opts = $.extend({}, defaults, options);\n    if (!callback || !isFunction(callback)) {\n        throw new Error('subscribe callback should be a function');\n    }\n    return $.extend(true, {\n        id: id,\n        topics: [].concat(topics),\n        callback: callback,\n    }, opts);\n}\n\nvar cacheBySubsId = {};\nvar sentDataBySubsId = {};\n\n/**\n* @param {Subscription} subscription \n* @param {*} data\n*/\nfunction callbackIfChanged(subscription, data) {\n    var id = subscription.id;\n    if (!_.isEqual(sentDataBySubsId[id], data)) {\n        sentDataBySubsId[id] = data;\n        subscription.callback(data, { id: id });\n    }\n}\n\n/**\n* @param {Publishable[]} topics\n* @param {Subscription} subscription \n*/\nfunction checkAndNotifyBatch(topics, subscription) {\n    var cached = cacheBySubsId[subscription.id] || {};\n    var merged = topics.reduce(function (accum, topic) {\n        accum[topic.name] = topic.value;\n        return accum;\n    }, $.extend({}, true, cached));\n    var matchingTopics = intersection(Object.keys(merged), subscription.topics);\n    if (matchingTopics.length > 0) {\n        var toSend = subscription.topics.reduce(function (accum, topic) {\n            accum[topic] = merged[topic];\n            return accum;\n        }, {});\n\n        if (subscription.cache) {\n            cacheBySubsId[subscription.id] = toSend;\n        }\n        if (matchingTopics.length === subscription.topics.length) {\n            callbackIfChanged(subscription, toSend);\n        }\n    }\n}\n\n\n/**\n * @param {Publishable[]} topics\n * @param {Subscription} subscription \n */\nfunction checkAndNotify(topics, subscription) {\n    topics.forEach(function (topic) {\n        if (includes(subscription.topics, topic.name) || includes(subscription.topics, '*')) {\n            var toSend = {};\n            toSend[topic.name] = topic.value;\n            callbackIfChanged(subscription, toSend);\n        }\n    });\n}\n\n/**\n* @param {Subscription[]} subcriptionList\n* @return {String[]}\n*/\nfunction getTopicsFromSubsList(subcriptionList) {\n    return subcriptionList.reduce(function (accum, subs) {\n        accum = accum.concat(subs.topics);\n        return accum;\n    }, []);\n}\n\n/**\n * @implements {ChannelManager}\n */\nclass ChannelManager {\n    constructor(options) {\n        this.subscriptions = [];\n    }\n\n    /**\n     * @param {String | Publishable } topic\n     * @param {any} [value] item to publish\n     * @param {Object} [options]\n     * @return {Promise}\n     */\n    publish(topic, value, options) {\n        var normalized = normalizeParamOptions(topic, value, options);\n        var prom = $.Deferred().resolve(normalized.params).promise();\n        prom = prom.then(this.notify.bind(this));\n        return prom;\n    }\n\n    notify(topic, value, options) {\n        var normalized = normalizeParamOptions(topic, value, options);\n        // console.log('notify', normalized);\n        return this.subscriptions.forEach(function (subs) {\n            var fn = subs.batch ? checkAndNotifyBatch : checkAndNotify;\n            fn(normalized.params, subs);\n        });\n    }\n\n    //TODO: Allow subscribing to regex? Will solve problem of listening only to variables etc\n    /**\n     * @param {String[] | String} topics\n     * @param {Function} cb\n     * @param {Object} [options]\n     * @return {String}\n     */\n    subscribe(topics, cb, options) {\n        var subs = makeSubs(topics, cb, options);\n        this.subscriptions = this.subscriptions.concat(subs);\n        return subs.id;\n    }\n        \n\n    /**\n     * @param {String} token\n     */\n    unsubscribe(token) {\n        var olderLength = this.subscriptions.length;\n        if (!olderLength) {\n            throw new Error('No subscriptions found to unsubscribe from');\n        }\n    \n        var remaining = this.subscriptions.filter(function (subs) {\n            return subs.id !== token;\n        });\n        if (!remaining.length === olderLength) {\n            throw new Error('No subscription found for token ' + token);\n        }\n        delete cacheBySubsId[token];\n        delete sentDataBySubsId[token];\n        this.subscriptions = remaining;\n    }\n    unsubscribeAll() {\n        this.subscriptions = [];\n    }\n\n    /**\n     * @return {String[]}\n     */\n    getSubscribedTopics() {\n        var list = uniq(getTopicsFromSubsList(this.subscriptions));\n        return list;\n    }\n\n    /**\n     * @param {String} [topic] optional topic to filter by\n     * @return {Subscription[]}\n     */\n    getSubscribers(topic) {\n        if (topic) {\n            return this.subscriptions.filter(function (subs) {\n                return includes(subs.topics, topic);\n            });\n        }\n        return this.subscriptions;\n    }\n}\n\nexport default ChannelManager;\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/channel-manager.js","import subscribeInterpolator from './subscribe-interpolator';\nimport publishInterpolator from './publish-interpolator';\n\n/**\n * Decorates passed channel manager with interpolation functionality\n * @param  {ChannelManager} ChannelManager\n * @return {ChannelManager}                wrapped channel manager\n */\nexport default function interpolatable(ChannelManager) {\n    var subsidMap = {};\n\n    /**\n     * @implements {ChannelManager}\n     */\n    return class InterpolatedChannelManager extends ChannelManager {\n        constructor(options) {\n            super(options);\n            this.subscribe = subscribeInterpolator(this.subscribe.bind(this), (dependencySubsId, newDependentId)=> {\n                var existing = subsidMap[dependencySubsId];\n                if (existing) {\n                    this.unsubscribe(existing);\n                }\n                subsidMap[dependencySubsId] = newDependentId;\n            });\n\n            this.publish = publishInterpolator(this.publish.bind(this), (variables, cb)=> {\n                super.subscribe(variables, (response, meta)=> {\n                    this.unsubscribe(meta.id);\n                    cb(response);\n                }, { autoFetch: true, batch: true });\n            });\n        }\n        unsubscribe(token) {\n            var existing = subsidMap[token];\n            if (existing) {\n                super.unsubscribe(existing);\n            }\n            super.unsubscribe(token);\n            delete subsidMap[token];\n        }\n        unsubscribeAll() {\n            subsidMap = {};\n            super.unsubscribeAll();\n        }\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/channel-manager-enhancements/interpolatable/index.js","import { extractDependencies, interpolateWithValues } from './interpolatable-utils';\nvar { uniq } = _;\n\n/**\n * @param {String[]} topics\n * @return {String[]} interpolated\n */\nexport function getDependencies(topics) {\n    var deps = topics.reduce((accum, topic)=> {\n        var inner = extractDependencies(topic);\n        accum = accum.concat(inner);\n        return accum;\n    }, []);\n    return uniq(deps);\n}\n\n/**\n * @param {String[]} topics\n * @param {Object} data\n * @return {String[]}\n */\nexport function interpolateWithDependencies(topics, data) {\n    return topics.map((topic) => {\n        return interpolateWithValues(topic, data);\n    });\n}\n\n/**\n * @param  {String[]} originalTopics     \n * @param  {String[]} interpolatedTopics \n * @param  {Object} data               \n * @return {Object}                    Interpolated\n */\nexport function mergeInterpolatedTopicsWithData(originalTopics, interpolatedTopics, data) {\n    return interpolatedTopics.reduce((accum, interpolatedTopic, index)=> {\n        var original = originalTopics[index];\n        var val = data[interpolatedTopic];\n        if (val !== undefined) {\n            accum[original] = data[interpolatedTopic];\n        }\n        return accum;\n    }, {});\n}\n\n/**\n * Takes a subscribe function and resolves any interpolated inputs\n * @param  {Function} subscribeFn        function to wrap\n * @param  {Function} onDependencyChange callback function when any dependencies change\n * @return {Function}                    wrapped function\n */\nexport default function subscribeInterpolator(subscribeFn, onDependencyChange) {\n    return function interpolatedSubscribe(topics, cb, options) {\n        topics = [].concat(topics);\n        var dependencies = getDependencies(topics);\n        if (!dependencies.length) {\n            return subscribeFn(topics, cb, options);\n        }\n        var innerSubsId = subscribeFn(dependencies, function handleDependencyValueChange(data, dependenciesMeta) {\n            var interpolatedTopics = interpolateWithDependencies(topics, data);\n\n            var outerSubsId = subscribeFn(interpolatedTopics, function handleInterpolatedValueChange(actualData, actualMeta) {\n                var toSendback = mergeInterpolatedTopicsWithData(topics, interpolatedTopics, actualData);\n\n                cb(toSendback, actualMeta);\n            }, options);\n\n            (onDependencyChange || $.noop)(dependenciesMeta.id, outerSubsId);\n            return outerSubsId;\n        }, { autoFetch: true, batch: true });\n\n        return innerSubsId;\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/channel-manager-enhancements/interpolatable/subscribe-interpolator.js","import { extractDependencies, interpolateWithValues } from './interpolatable-utils';\nimport { normalizeParamOptions } from 'channels/channel-utils';\n\nvar { uniq } = _;\n/**\n * @param {Publishable[]} publishInputs\n * @returns {String[]} dependencies for inputs\n */\nexport function getDependencies(publishInputs) {\n    var deps = publishInputs.reduce((accum, input)=> {\n        var inner = extractDependencies(input.name);\n        accum = accum.concat(inner);\n        return accum;\n    }, []);\n    return uniq(deps);\n}\n\n/**\n * @param {Publishable[]} publishInputs\n * @param {Object} valuesToInterpolate\n * @returns {Publishable[]} inputs with resolved dependencies\n */\nexport function interpolateWithDependencies(publishInputs, valuesToInterpolate) {\n    return publishInputs.map((ip) => {\n        return {\n            name: interpolateWithValues(ip.name, valuesToInterpolate),\n            value: ip.value,\n        };\n    });\n}\n\n/**\n * Publish function to wrap\n * @param  {Function} publishFunction\n * @param  {Function} fetchFn         function to get interpolated values from\n * @return {Function}                 wrapped function\n */\nexport default function publishInterpolator(publishFunction, fetchFn) {\n    return function interpolatedPublishfunction(topic, value, options) {\n        var normalizedPublishInputs = normalizeParamOptions(topic, value, options);\n        var dependencies = getDependencies(normalizedPublishInputs.params);\n        if (!dependencies.length) {\n            return publishFunction(topic, value, options);\n        }\n        \n        var prom = $.Deferred();\n        fetchFn(dependencies, function handleDependencyChange(resolvedDependencies) {\n            var interpolated = interpolateWithDependencies(normalizedPublishInputs.params, resolvedDependencies);\n            var newPublishProm = publishFunction(interpolated, normalizedPublishInputs.options);\n            prom.resolve(newPublishProm);\n        });\n        return prom.promise();\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/channel-manager-enhancements/interpolatable/publish-interpolator.js","import MiddlewareManager from './middleware-manager';\nimport { normalizeParamOptions } from '../../channel-utils';\n\nfunction getTopicsFromSubsList(subcriptionList) {\n    return subcriptionList.reduce(function (accum, subs) {\n        accum = accum.concat(subs.topics);\n        return accum;\n    }, []);\n}\n\n/**\n * Decorates passed channel manager with middleware functionality\n * @param  {ChannelManager} ChannelManager\n * @return {ChannelManager}                wrapped channel manager\n */\nexport default function withMiddleware(ChannelManager) {\n    /**\n     * @implements {ChannelManager}\n     */\n    return class ChannelWithMiddleware extends ChannelManager {\n        constructor(options) {\n            super(options);\n            var defaults = {\n                middlewares: []\n            };\n            var opts = $.extend(true, {}, defaults, options);\n            this.middlewares = new MiddlewareManager(opts, this.notify.bind(this), this);\n        }\n\n        /**\n         * Allow intercepting and handling/suppressing data to publish calls.\n         * @param {string | Publishable } topic\n         * @param {any} [value] item to publish\n         * @param {Object} [options]\n         * @return {Promise}\n         */\n        publish(topic, value, options) {\n            var normalized = normalizeParamOptions(topic, value, options);\n            var prom = $.Deferred().resolve(normalized.params).promise();\n            var lastAvailableData = normalized.params;\n            var middlewares = this.middlewares.filter('publish');\n            middlewares.forEach(function (middleware) {\n                prom = prom.then(function (publishResponse) {\n                    return middleware(publishResponse, normalized.options);\n                }).then(function (response) {\n                    lastAvailableData = response || lastAvailableData;\n                    return lastAvailableData;\n                });\n            });\n            prom = prom.then((published)=> {\n                return super.publish(published, normalized.options);\n            });\n            return prom;\n        }\n        /**\n         * Allow intercepting and excluding topics from subscription\n         * @param  {string | string[]}   topics\n         * @param  {Function} cb\n         * @param  {Object}   options\n         * @return {string}           subscription id\n         */\n        subscribe(topics, cb, options) {\n            var subscribeMiddlewares = this.middlewares.filter('subscribe');\n            var newTopics = [].concat(topics);\n            subscribeMiddlewares.forEach(function (middleware) {\n                newTopics = middleware(newTopics, options) || newTopics;\n            });\n            return super.subscribe(newTopics, cb, options);\n        }\n\n        /**\n         * Calls unsubscribe middleware *after* unsubscription with a list of recently unsubscribed topics\n         * @param  {string} token\n         * @return {void}\n         */\n        unsubscribe(token) {\n            var currentTopics = getTopicsFromSubsList(this.subscriptions);\n            super.unsubscribe(token);\n            var remainingTopics = getTopicsFromSubsList(this.subscriptions);\n\n            var unsubscribedTopics = _.difference(currentTopics, remainingTopics);\n            var middlewares = this.middlewares.filter('unsubscribe');\n            middlewares.forEach(function (middleware) {\n                return middleware(unsubscribedTopics, remainingTopics);\n            });\n        }\n\n        /**\n         * Calls unsubscribe middleware after unsubscribeAll on the channel\n         * @return {void}\n         */\n        unsubscribeAll() {\n            var currentlySubscribed = this.getSubscribedTopics();\n            super.unsubscribeAll();\n            var middlewares = this.middlewares.filter('unsubscribe');\n            middlewares.forEach((middleware)=> middleware(currentlySubscribed, []));\n        }\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/channel-manager-enhancements/with-middleware/index.js","export default function MiddlewareManager(options, notifier, channelManagerContext) {\n    var defaults = {\n        middlewares: []\n    };\n    var opts = $.extend(true, {}, defaults, options);\n    var optsToPassOn = _.omit(opts, Object.keys(defaults));\n\n    var list = [];\n    var publicAPI = {\n        list: list,\n\n        add: function (middleware, index) {\n            if (_.isFunction(middleware)) {\n                //FIXME: move channelManagerContext functionality to router\n                middleware = new middleware(optsToPassOn, notifier, channelManagerContext);\n            }\n            $.extend(channelManagerContext, middleware.expose); //add any public props middleware wants to expose\n            list.push(middleware);\n        },\n\n        filter: function (type) {\n            type = type + 'Handler';\n            return list.reduce(function (accum, m) {\n                if (m[type]) {\n                    accum.push(m[type]);\n                }\n                return accum;\n            }, []);\n        }\n    };\n\n    $.extend(this, publicAPI);\n    opts.middlewares.forEach(this.add);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/channel-manager-enhancements/with-middleware/middleware-manager.js"],"sourceRoot":""}