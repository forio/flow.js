{"version":3,"sources":["webpack:///flow.min.js","webpack:///webpack/bootstrap 04f51160a6aa9a0653be","webpack:///external \"_\"","webpack:///./src/config.js","webpack:///./src/channels/channel-router/utils/index.js","webpack:///./src/utils/parse-utils.js","webpack:///./src/channels/channel-router/index.js","webpack:///./src/channels/channel-utils.js","webpack:///./src/channels/route-handlers/route-matchers.js","webpack:///./src/utils/general/index.js","webpack:///./src/channels/route-handlers/epicenter-router/run-router/index.js","webpack:///./src/utils/animation.js","webpack:///./src/dom/attributes/attr-template-utils.js","webpack:///./src/dom/nodes/default-input-node.js","webpack:///./src/dom/nodes/default-node.js","webpack:///./src/utils/base-view.js","webpack:///./src/dom/attributes/loop-attrs/loop-attr-utils.js","webpack:///./src/channels/channel-manager-enhancements/interpolatable/interpolatable-utils.js","webpack:///./src/flow.js","webpack:///./src/dom/dom-manager.js","webpack:///./src/dom/dom-manager-utils/dom-parse-helpers/parse-converters.js","webpack:///./src/dom/dom-manager-utils/dom-parse-helpers/parse-channel.js","webpack:///./src/dom/dom-manager-utils/dom-parse-helpers/parse-topics.js","webpack:///./src/dom/dom-manager-utils/dom-channel-prefix-helpers/index.js","webpack:///./src/converters/converter-manager.js","webpack:///./src/converters/number-converter.js","webpack:///./src/converters/string-converter.js","webpack:///./src/converters/array-converter.js","webpack:///./src/converters/general-util-converters.js","webpack:///./src/converters/numberformat-converter.js","webpack:///./src/converters/number-compare-converters.js","webpack:///./src/converters/bool-conditional-converters.js","webpack:///./src/converters/collection-converters.js","webpack:///./src/dom/nodes/node-manager.js","webpack:///./src/dom/nodes/input-checkbox-node.js","webpack:///./src/dom/attributes/attribute-manager.js","webpack:///./src/dom/attributes/no-op-attr/index.js","webpack:///./src/dom/attributes/events/default-event-attr/index.js","webpack:///./src/dom/attributes/loop-attrs/foreach-attr/index.js","webpack:///./src/dom/attributes/loop-attrs/repeat-attr/index.js","webpack:///./src/utils/general/make-promise.js","webpack:///./src/utils/general/debounce-and-merge.js","webpack:///./src/dom/attributes/class-attr/index.js","webpack:///./src/dom/attributes/boolean-attr/index.js","webpack:///./src/dom/attributes/toggles/show-if-attr/index.js","webpack:///./src/dom/attributes/toggles/hide-if-attr/index.js","webpack:///./src/dom/attributes/binds/checkbox-radio-bind-attr/index.js","webpack:///./src/dom/attributes/binds/input-bind-attr/index.js","webpack:///./src/dom/attributes/binds/default-bind-attr/index.js","webpack:///./src/dom/attributes/binds/bind-utils/index.js","webpack:///./src/dom/attributes/default-attr/index.js","webpack:///./src/dom/plugins/auto-update-bindings.js","webpack:///./src/channels/configured-channel-manager.js","webpack:///./src/channels/channel-manager.js","webpack:///external \"jQuery\"","webpack:///./src/channels/channel-router/utils/handler-utils.js","webpack:///./src/channels/channel-router/utils/silencable.js","webpack:///./src/channels/channel-router/utils/exclude-read-only.js","webpack:///./src/channels/route-handlers/json-router/index.js","webpack:///./src/channels/route-handlers/epicenter-router/index.js","webpack:///./src/channels/route-handlers/epicenter-router/run-manager-router.js","webpack:///./src/channels/route-handlers/epicenter-router/run-router/run-meta-channel.js","webpack:///./src/channels/route-handlers/epicenter-router/run-router/run-variables-channel.js","webpack:///./src/channels/route-handlers/epicenter-router/run-router/retriable-variable-fetch.js","webpack:///./src/channels/route-handlers/epicenter-router/run-router/run-operations-channel.js","webpack:///./src/channels/route-handlers/epicenter-router/scenario-manager-router.js","webpack:///./src/channels/route-handlers/epicenter-router/custom-run-router.js","webpack:///./src/channels/route-handlers/epicenter-router/run-router-factory.js","webpack:///./src/channels/route-handlers/epicenter-router/world-manager-router/index.js","webpack:///./src/channels/route-handlers/epicenter-router/world-manager-router/world-users-channel/index.js","webpack:///./src/channels/route-handlers/epicenter-router/world-manager-router/world-current-user-channel.js","webpack:///./src/channels/route-handlers/epicenter-router/runs-router/index.js","webpack:///./src/channels/channel-manager-enhancements/interpolatable/index.js","webpack:///./src/channels/channel-manager-enhancements/interpolatable/subscribe-interpolator.js","webpack:///./src/channels/channel-manager-enhancements/interpolatable/publish-interpolator.js","webpack:///./src/channels/channel-manager-enhancements/routable/index.js"],"names":["Flow","modules","__webpack_require__","moduleId","installedModules","exports","module","i","l","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","_","prefix","binderAttr","events","trigger","convert","attrs","checkboxOffValue","repeat","templateId","errorAttr","animation","addAttr","changeAttr","initialAttr","__webpack_exports__","stripSuffixDelimiter","text","indexOf","CHANNEL_DELIMITER","length","replace","mapWithPrefix","dataArray","map","datapt","$","extend","withPrefix","callback","prefixList","arr","concat","data","forEach","mapped","unprefixTopics","list","item","unprefix","__WEBPACK_IMPORTED_MODULE_0__silencable__","__WEBPACK_IMPORTED_MODULE_1__exclude_read_only__","toImplicitType","objRegex","arrRegex","converted","trim","charAt","substring","isNumeric","test","bracketReplaced","parsed","split","val","JSON","parse","e","console","error","splitUnescapedCommas","str","regex","op","exec","index","lastIndex","match","groupIndex","push","splitNameArgs","value","args","toPublishableFormat","notifySubscribeHandlers","handlers","topics","options","grouped","__WEBPACK_IMPORTED_MODULE_0__utils_handler_utils__","promises","filter","handler","subscribeHandler","mergedOptions","unprefixed","__WEBPACK_IMPORTED_MODULE_1__utils__","matched","promise","__WEBPACK_IMPORTED_MODULE_2_utils_general__","then","topicsWithData","normalized","when","apply","arguments","notifyUnsubscribeHandlers","recentlyUnsubscribedTopics","remainingTopics","h","unsubsKey","unsubsGrouped","remainingGrouped","unsubscribeHandler","unprefixedUnsubs","matchingRemainingHandler","__WEBPACK_IMPORTED_MODULE_3_lodash___default","a","find","remainingHandler","matchingTopicsRemaining","unprefixedRemaining","passthroughPublishInterceptors","publishData","$initialProm","Deferred","resolve","dataSoFar","publishableData","readOnly","result","publishHandler","published","silent","isDefault","router","notifier","_this","this","myHandlers","Handler","isFunction","expose","matchString","t","topic","reduce","addRoute","Error","id","uniqueId","unshift","removeRoute","routeid","__WEBPACK_IMPORTED_MODULE_3_lodash__","objectToPublishable","obj","keys","publishableToObject","mergeWith","accum","normalizeParamOptions","publishValue","isPlainObject","params","Array","isArray","matchPrefix","matchDefaultPrefix","forcePrefix","matchRegex","toMatch","RegExp","random","min","max","parseInt","__WEBPACK_IMPORTED_MODULE_0_lodash__","rnd","__WEBPACK_IMPORTED_MODULE_1__make_promise__","__WEBPACK_IMPORTED_MODULE_2__debounce_and_merge__","_shouldFetch","ignoreOperations","r","isIgnored","OPERATIONS_PREFIX","isVariable","VARIABLES_PREFIX","isOperation","RunRouter","config","defaults","serviceOptions","channelOptions","variables","autoFetch","debounce","operations","meta","opts","__WEBPACK_IMPORTED_MODULE_6_lodash___default","window","F","service","Run","rs","operationNotifier","__WEBPACK_IMPORTED_MODULE_4_channels_channel_router_utils__","variableNotifier","metaChannel","__WEBPACK_IMPORTED_MODULE_0__run_meta_channel__","META_PREFIX","operationsChannel","__WEBPACK_IMPORTED_MODULE_2__run_operations_channel__","variableschannel","__WEBPACK_IMPORTED_MODULE_1__run_variables_channel__","subscribed","channel","TOPICS","subscribeOpts","includeMine","subscribe","RUN_VARIABLES","log","notify","fetch","RUN_OPERATIONS","RUN_RESET","__WEBPACK_IMPORTED_MODULE_5_channels_route_handlers_route_matchers__","runRouter","__WEBPACK_IMPORTED_MODULE_3_channels_channel_router__","oldhandler","__WEBPACK_IMPORTED_MODULE_6_lodash__","_defineProperty","key","writable","_findMostConsequtive","prev","count","maxCount","Math","buildDiffArray","currentcontents","newContents","contents","fill","elToContents","el","outerHTML","elementsToContents","$els","child","addChangeClassesToList","$currentEls","$newEls","isInitial","reversedContents","diffFromEnd","diffFromBeginning","slice","reverse","endMatches","beginningMatches","placeHoldersCount","placeHolders","undefined","$el","eq","curr","removeAttr","_$el$attr","attr","_$el$attr2","addContentAndAnimate","newValue","current","html","setTimeout","_$el$attr3","getKnownDataForEl","closestKnownDataEl","closest","CURRENT_INDEX_ATTR","knownData","CURRENT_INDEX_KEY","updateKnownDataForEl","stringify","removeKnownData","getTemplateTags","template","isTemplated","findMissingReferences","knownDataKeys","isKnownTag","tag","knownTags","missingReferences","templateTagsUsed","refKey","refToMarkup","stubMissingReferences","refId","addBackMissingReferences","originalTemplateVal","commentRef","getOriginalContents","resolver","originalHTML","elTemplateMap","set","clearOriginalContents","delete","WeakMap","BaseView","propertyHandlers","uiChangeEvent","getUIValue","removeEvents","off","initialize","me","propName","on","payload","source","selector","_require","has","extendView","protoProps","staticProps","constructor","Surrogate","__super__","View","extractVariableName","attrVal","inMatch","IN_OF_REGEX","parseKeyAlias","itMatch","KEY_VALUE_REGEX","parseValueAlias","aliasesFromTopics","relevantTopic","defaultKey","keyAlias","valueAlias","parseTopics","extractDependencies","interpolationRegex","interpolateWithValues","dependency","domManager","ChannelManager","default","dom","utils","model","run","root","autoBind","prom","unbindAll","bindAll","constants","version","getConvertersForEl","getChannelForAttribute","getChannelConfigForElement","parseTopicsFromAttributeValue","_require2","addPrefixToTopics","addDefaultPrefix","_require3","_require4","pick","converterManager","nodeManager","attrManager","autoUpdatePlugin","getMatchingElements","$root","matchedElements","is","add","getElementOrError","element","context","nodeName","removeAllSubscriptions","subscriptions","subs","unsubscribe","unbindAllAttributes","domEl","attributes","each","nodeMap","getHandler","unbind","unbindAllNodeHandlers","handle","expr","pseudos","publicAPI","nodes","converters","Map","unbindElement","existingData","subsid","subscriptionId","animAttrs","join","removeData","bindElement","filterPrefix","attrList","init","channelPrefix","channelConfig","attrsWithSubscriptions","subsOptions","batch","onError","msg","message","subscribableTopics","toConvert","dataForAttr","toReplace","assign","elementsToBind","elementsToUnbind","plugins","attachUIListeners","parseValue","evt","elMeta","target","sourceMeta","action","parsedValue","actualName","publish","last","attachConversionListner","prop","_elMeta$prop","convertedValue","deferred","__WEBPACK_IMPORTED_MODULE_0__parse_converters__","__WEBPACK_IMPORTED_MODULE_1__parse_channel__","__WEBPACK_IMPORTED_MODULE_2__parse_topics__","convertersToArray","conv","v","getConvertersFromAttr","attribute","withConv","getFConvertAttrVal","suffix","suffixAttr","convertersAsPipes","$parentEl","parents","resolvedConverters","parentConv","attrib","specified","commaRegex","topicsPart","currentName","isUnprefixed","defaultPrefix","DEFAULT_OPERATIONS_PREFIX","DEFAULT_VARIABLES_PREFIX","needsDefaultPrefix","hasDefaultPrefix","__WEBPACK_IMPORTED_MODULE_1__utils_parse_utils__","normalize","alias","converter","acceptList","ret","matchConverter","private","register","currentConverter","splice","getConverter","norm","Function","bind","currentValue","convertArray","converterName","convertObject","parseFloat","upperCase","toUpperCase","lowerCase","toLowerCase","titleCase","txt","substr","parseLimitArgs","starting","limit","toRet","input","stripped","first","previous","size","src","pickEvery","startIndex","fn","toArray","indexOfActualValue","newArgs","parseArgs","toCompare","trueVal","falseVal","valueToCompare","toReturn","isAllowedLeading","isString","isNumber","checkValMatch","validStandalone","validFirstChars","validLastChars","isValidFirstChar","isValidLastChar","validRemainingChars","areRemainingCharactersValid","char","parts","isNegative","floatMatcher","results","number","roundTo","digits","round","pow","getDigits","ceil","LN10","TXT","numberTXT","toString","decimalSet","iTXT","addDecimals","decimals","minDecimals","hasCommas","hasDecimals","iDec","iChar","toADD","getSuffix","formatTXT","fixesTXT","format","isNaN","entityCodeMapping","&euro;","&dollar;","&cent;","&pound;","&yen;","code","formats","abs","sign","leftOfDecimal","lastIndexOf","isShortFormat","leadingText","rightOfPrefix","shortFormatTest","shortFormatTestResult","valScale","floor","Number","SUFFIX","valWithoutLeading","scales","limitDigits","subFormats","preffix","greaterThan","greaterThanEqual","equalsNumber","lessThan","lessThanEqual","toBool","not","ifTrue","ifFalse","valueToFilterBy","except","valueToReject","reject","any","some","every","node","currentHandler","__WEBPACK_IMPORTED_MODULE_0__default_input_node__","__WEBPACK_IMPORTED_MODULE_0__default_input_node___default","__WEBPACK_IMPORTED_MODULE_1_config__","__WEBPACK_IMPORTED_MODULE_1_config___default","offAttr","offAttrVal","offVal","onAttrVal","onVal","defaultHandlers","handlersList","attributeMatcher","nodeMatcher","matchAttr","matchExpr","attrMatch","matchNode","nodeFilter","attributeManager","attrFilter","filtered","noopAttr","__WEBPACK_IMPORTED_MODULE_0_config__","__WEBPACK_IMPORTED_MODULE_1_utils_parse_utils__","defaultEventAttr","eventName","matching","preventDefault","listOfOperations","__WEBPACK_IMPORTED_MODULE_0_utils_parse_utils__","__WEBPACK_IMPORTED_MODULE_1__config__","__WEBPACK_IMPORTED_MODULE_2__loop_attr_utils__","__WEBPACK_IMPORTED_MODULE_3_utils_animation__","__WEBPACK_IMPORTED_MODULE_4_lodash__","__WEBPACK_IMPORTED_MODULE_5__attr_template_utils__","elAnimatedMap","foreachAttr","_aliasesFromTopics","stubbedTemplate","templateFn","$dummyEl","dataval","datakey","_$$extend","templateData","templated","templatedWithReferences","newNode","$newNode","append","isInitialAnim","$withAnimAttrs","children","empty","__WEBPACK_IMPORTED_MODULE_3__config__","__WEBPACK_IMPORTED_MODULE_4_utils_animation__","__WEBPACK_IMPORTED_MODULE_6__loop_attr_utils__","templateIdAttr","loopAttrHandler","nextUntil","remove","replaceWith","$dummyOldDiv","$removed","hasData","insertAfter","makePromise","$def","catch","debounceAndMerge","debounceInterval","argumentsReducers","timer","argsToPass","newVal","arg","reducer","clearTimeout","res","err","deleteAddedClasses","addedClasses","elClassesMap","removeClass","classAttr","addClass","booleanAttrHandler","showifHandler","hide","show","hideifHandler","checkboxAttrHandler","settableValue","isChecked","inputBindAttr","toAliasMap","getNewContent","currentContents","__WEBPACK_IMPORTED_MODULE_4__attr_template_utils__","__WEBPACK_IMPORTED_MODULE_3__bind_utils__","templatedHTML","__WEBPACK_IMPORTED_MODULE_1_utils_animation__","__WEBPACK_IMPORTED_MODULE_2_config__","bindAttrHandler","bindTemplate","originalContents","translateDataToInsertable","translateDataToTemplatable","aliasMap","originalName","asMatch","AS_REGEX","extractAlias","defaultAttr","isEnabled","MutationObserver","observer","mutations","mutation","added","addedNodes","removed","removedNodes","attributeName","mutconfig","attributeFilter","childList","subtree","characterData","publicApi","enable","observe","disable","disconnect","defaultRouteHandlers","__WEBPACK_IMPORTED_MODULE_2__route_handlers__","routes","InterpolatableRoutableChannelManager","__WEBPACK_IMPORTED_MODULE_0__channel_manager__","__WEBPACK_IMPORTED_MODULE_1_channels_channel_router__","__WEBPACK_IMPORTED_MODULE_3__channel_manager_enhancements__","_classCallCheck","instance","Constructor","TypeError","makeSubs","__WEBPACK_IMPORTED_MODULE_2_lodash__","cache","__WEBPACK_IMPORTED_MODULE_0_jquery___default","callbackIfChanged","subscription","checkAndNotifyBatch","__WEBPACK_IMPORTED_MODULE_1__channel_utils__","matchingTopics","relevantDataFromPublish","cachedDataForSubs","cacheBySubsId","knownDataForSubs","checkAndNotify","toSend","getTopicsFromSubsList","subcriptionList","__WEBPACK_IMPORTED_MODULE_0_jquery__","_createClass","defineProperties","props","descriptor","sentDataBySubsId","publishResponses","cb","token","olderLength","remaining","jQuery","findBestHandler","matchOptions","thishandler","groupByHandlers","topicMapping","bestHandler","__WEBPACK_IMPORTED_MODULE_0_lodash___default","values","groupSequentiallyByHandlers","dataPt","lastHandler","normalizeSubscribeResponse","response","silencable","silentOptions","excludeReadOnly","publishable","readOnlyOptions","warn","__WEBPACK_IMPORTED_MODULE_0__json_router__","__WEBPACK_IMPORTED_MODULE_1__epicenter_router__","getOptions","__WEBPACK_IMPORTED_MODULE_0__run_manager_router__","__WEBPACK_IMPORTED_MODULE_1__scenario_manager_router__","__WEBPACK_IMPORTED_MODULE_2__custom_run_router__","__WEBPACK_IMPORTED_MODULE_3__world_manager_router__","__WEBPACK_IMPORTED_MODULE_4__runs_router__","__WEBPACK_IMPORTED_MODULE_5_channels_channel_router_utils__","__WEBPACK_IMPORTED_MODULE_6_channels_route_handlers_route_matchers__","__WEBPACK_IMPORTED_MODULE_7_channels_channel_router__","sampleRunidLength","runidRegex","channelManagerContext","customRunChannelOpts","customRunChannel","runsChannel","exposable","runManagerOpts","runManager","scenarioManager","rm","isMultiplayer","strategy","scenarioManagerOpts","sm","epicenterRouter","__WEBPACK_IMPORTED_MODULE_0__run_router__","__WEBPACK_IMPORTED_MODULE_1_channels_channel_router_utils__","__WEBPACK_IMPORTED_MODULE_2_channels_channel_router__","__WEBPACK_IMPORTED_MODULE_3_channels_route_handlers_route_matchers__","_window","rmOptions","manager","RunManager","$creationPromise","getRun","currentChannelOpts","currentRunChannel","runRouteHandler","runMangerRouter","RunMetaChannel","$runServicePromise","mergeAndSend","runMeta","requestedTopics","runService","cachedValues","__WEBPACK_IMPORTED_MODULE_1_lodash__","loadPromise","load","toSave","__WEBPACK_IMPORTED_MODULE_0_channels_channel_utils__","save","RunVariablesChannel","debouncedVariableQuery","debouncedFetchers","__WEBPACK_IMPORTED_MODULE_0_utils_general__","__WEBPACK_IMPORTED_MODULE_3__retriable_variable_fetch__","newval","knownTopics","__WEBPACK_IMPORTED_MODULE_1_channels_channel_utils__","unsubscribedTopics","isAutoFetchEnabled","missingVariables","variableObj","retriableFetch","query","responseJSON","info","information","goodVariables","names","RunOperationsChannel","operationsResponse","serial","ScenarioManager","baselinePromise","baseline","baselineOptions","currentRunPromise","runOptions","baselineChannel","scenarioManagerRouter","__WEBPACK_IMPORTED_MODULE_0__run_router_factory__","runid","knownRunIDServiceChannels","runChannel","__WEBPACK_IMPORTED_MODULE_0__world_users_channel__","__WEBPACK_IMPORTED_MODULE_1__world_current_user_channel__","__WEBPACK_IMPORTED_MODULE_2_channels_channel_router_utils__","__WEBPACK_IMPORTED_MODULE_4__run_router__","__WEBPACK_IMPORTED_MODULE_5_channels_channel_router__","getRunPromise","world","$runPromise","channelManager","worldChannel","getWorldChannel","updateConfig","currentRunChannelOpts","worldPromise","multiUserChannel","multiUserHandler","userChannel","userHandler","WorldUsersChanngel","presenceSubsId","store","users","mark","userid","isOnline","u","userId","parsedUsersPromise","am","AuthManager","session","getCurrentUserSessionInfo","lastName","isMe","userids","PRESENCE","user","ps","Presence","markOnline","markOffline","userFields","myUser","toNotify","field","ROLES","role","RunsRouter","extractFiltersFromTopic","topicString","_filter$split","_filter$split2","_slicedToArray","filters","include","runs","topicParamMap","debouncedFetch","subsMap","sliceIterator","_arr","_n","_d","_e","_s","_i","Symbol","iterator","next","done","__WEBPACK_IMPORTED_MODULE_0__interpolatable__","__WEBPACK_IMPORTED_MODULE_1__routable__","_possibleConstructorReturn","self","ReferenceError","_inherits","subClass","superClass","create","setPrototypeOf","__proto__","interpolatable","subsidMap","_ChannelManager","InterpolatedChannelManager","getPrototypeOf","__WEBPACK_IMPORTED_MODULE_0__subscribe_interpolator__","dependencySubsId","newDependentId","existing","__WEBPACK_IMPORTED_MODULE_1__publish_interpolator__","_get","receiver","desc","getOwnPropertyDescriptor","parent","getDependencies","deps","inner","__WEBPACK_IMPORTED_MODULE_0__interpolatable_utils__","interpolateWithDependencies","mergeInterpolatedTopicsWithData","originalTopics","interpolatedTopics","interpolatedTopic","original","subscribeInterpolator","subscribeFn","onDependencyChange","dependencies","dependenciesMeta","outerSubsId","actualData","actualMeta","toSendback","noop","publishInputs","valuesToInterpolate","ip","publishInterpolator","publishFunction","fetchFn","normalizedPublishInputs","resolvedDependencies","interpolated","allTopics","withRouter","ChannelWithRouter","optsToPassOn","_this2","_this3","__WEBPACK_IMPORTED_MODULE_0__channel_utils__"],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAsBA,GAAIA,MACK,SAAUC,SCnBnB,QAAAC,qBAAAC,UAGA,GAAAC,iBAAAD,UACA,MAAAC,kBAAAD,UAAAE,OAGA,IAAAC,QAAAF,iBAAAD,WACAI,EAAAJ,SACAK,GAAA,EACAH,WAUA,OANAJ,SAAAE,UAAAM,KAAAH,OAAAD,QAAAC,cAAAD,QAAAH,qBAGAI,OAAAE,GAAA,EAGAF,OAAAD,QAvBA,GAAAD,oBA4DA,OAhCAF,qBAAAQ,EAAAT,QAGAC,oBAAAS,EAAAP,iBAGAF,oBAAAU,EAAA,SAAAP,QAAAQ,KAAAC,QACAZ,oBAAAa,EAAAV,QAAAQ,OACAG,OAAAC,eAAAZ,QAAAQ,MACAK,cAAA,EACAC,YAAA,EACAC,IAAAN,UAMAZ,oBAAAmB,EAAA,SAAAf,QACA,GAAAQ,QAAAR,eAAAgB,WACA,WAA2B,MAAAhB,QAAA,SAC3B,WAAiC,MAAAA,QAEjC,OADAJ,qBAAAU,EAAAE,OAAA,IAAAA,QACAA,QAIAZ,oBAAAa,EAAA,SAAAQ,OAAAC,UAAsD,MAAAR,QAAAS,UAAAC,eAAAjB,KAAAc,OAAAC,WAGtDtB,oBAAAyB,EAAA,GAGAzB,wCAAA0B,EAAA,MD6BM,SAAUtB,OAAQD,SE1FxBC,OAAAD,QAAAwB,GFgGM,SAAUvB,OAAQD,SGhGxBC,OAAOD,SACHyB,OAAQ,IACRC,WAAY,SAEZC,QAEIC,QAAS,cAGTC,QAAS,aAGbC,OACIC,iBAAkB,iBAElBC,QACIC,WAAY,uBAIpBC,UAAW,kBACXC,WACIC,QAAS,WACTC,WAAY,cACZC,YAAa,kBHwGf,SAAUrC,OAAQsC,oBAAqB1C,qBAE7C,YIxHO,SAAS2C,sBAAqBC,MAIjC,MAHIA,OAAQA,KAAKC,QAAQC,qBAAwBF,KAAKG,OAAS,IAC3DH,KAAOA,KAAKI,QAAQF,kBAAmB,KAEpCF,KASJ,QAASK,eAAcC,UAAWtB,QACrC,MAAKA,SACGsB,eAAiBC,IAAI,SAAUC,QACnC,GAAMzC,OAAQiB,OAASwB,OAAOzC,MAAMqC,QAAQ,KAAM,GAClD,OAAOK,GAAEC,QAAO,KAAUF,QAAUzC,KAAMA,SAH1BuC,UAajB,QAASK,YAAWC,SAAUC,YACjC,GAAMC,QAASC,OAAOF,WAKtB,OAAO,UAAUG,MACbF,IAAIG,QAAQ,SAAUjC,QAClB,GAAMkC,QAASb,cAAcW,KAAMhC,OACnC4B,UAASM,WAWd,QAASC,gBAAeC,KAAMpC,QACjC,MAAKA,QACcoC,KAAKb,IAAI,SAAUc,MAClC,MAAOA,MAAKjB,QAAQpB,OAAQ,MAFZoC,KAajB,QAASE,UAASF,KAAMpC,QAC3B,MAAKA,QACcoC,KAAKb,IAAI,SAAUc,MAClC,MAAIA,MAAKtD,KACE0C,EAAEC,QAAO,KAAUW,MAAQtD,KAAMsD,KAAKtD,KAAKqC,QAAQpB,OAAQ,MAE/DqC,KAAKjB,QAAQpB,OAAQ,MALZoC,KJ2DStB,oBAAuB,EAAIC,qBAC3BD,oBAAuB,EAAIO,cAC3BP,oBAAuB,EAAIa,WAC3Bb,oBAAuB,EAAIqB,eAC3BrB,oBAAuB,EAAIwB,QACvC,IAAIC,2CAA4CnE,oBAAoB,GACxDA,qBAAoBU,EAAEgC,oBAAqB,IAAK,WAAa,MAAOyB,2CAA6C,GAC7H,IAAIC,kDAAmDpE,oBAAoB,GI1IhGA,qBAAAU,EAAAgC,oBAAA,qBAAA0B,kDAAA,OAAMtB,mBAAoB,KJgOpB,SAAU1C,OAAQsC,oBAAqB1C,qBAE7C,YKjOA,SAASqE,gBAAeT,MACpB,GAAMU,UAAW,cACjB,IAAMC,UAAW,aAEjB,IAAIC,WAAYZ,IAChB,IAAoB,gBAATA,MAGP,GAAkB,UAFlBY,UAAYZ,KAAKa,QAGbD,WAAY,MACT,IAAkB,UAAdA,UACPA,WAAY,MACT,IAAkB,SAAdA,UACPA,UAAY,SACT,IAAkB,cAAdA,UACPA,UAAY,OACT,IAA4B,MAAxBA,UAAUE,OAAO,IAAuC,MAAxBF,UAAUE,OAAO,GACxDF,UAAYA,UAAUG,UAAU,EAAGH,UAAUzB,OAAS,OACnD,IAAIM,EAAEuB,UAAUJ,WACnBA,WAAaA,cACV,IAAID,SAASM,KAAKL,WAAY,CACjC,GAAMM,iBAAkBN,UAAUxB,QAAQ,SAAU,GACpD,KAAK8B,gBAAiB,QACtB,IAAMC,QAASD,gBAAgBE,MAAM,eAAe7B,IAAI,SAAC8B,KACrD,MAAOZ,gBAAeY,MAE1B,OAAOF,QACJ,GAAIT,SAASO,KAAKL,WACrB,IACIA,UAAYU,KAAKC,MAAMX,WACzB,MAAOY,GACLC,QAAQC,MAAM,mCAAqCd,YAI/D,MAAOA,WAGX,QAASe,sBAAqBC,KAC1B,GAAMC,OAAQ,cACd,IAAIjF,SAEJ,IAAMkF,MACN,MAAiC,QAAzBlF,EAAIiF,MAAME,KAAKH,OAEfhF,EAAEoF,QAAUH,MAAMI,WAClBJ,MAAMI,YAEVrF,EAAEqD,QAAQ,SAAUiC,MAAOC,YACJ,IAAfA,YACAL,GAAGM,KAAKF,MAAM9C,QAAQ,KAAM,MAIxC,OAAO0C,IAGX,QAASO,eAAcC,OAKnB,MAJAA,OAAQA,MAAMzB,QAIL9D,KAHMuF,MAAMlB,MAAM,KAAK,GAGTmB,KADVZ,qBADEW,MAAMvB,UAAUuB,MAAMrD,QAAQ,KAAO,EAAGqD,MAAMrD,QAAQ,OAC3BM,IAAI,SAAC1B,GAAD,MAAMA,GAAEgD,UAQ1D,QAAS2B,qBAAoBF,OAWzB,OATeA,OAAS,IAAIlB,MADC,MAEE7B,IAAI,SAAU+C,OACzC,GAAIA,QAAiC,IAAxBA,MAAMrD,QAAQ,KAAa,CACpC,GAAMmC,QAAQkB,MAAMlB,MAAM,IAC1B,QAASrE,KAAMqE,OAAM,GAAGP,OAAQyB,MAAOlB,OAAM,GAAGP,QAEpD,GAAMM,QAASkB,cAAcC,MAC7B,QAASvF,KAAMoE,OAAOpE,KAAMuF,MAAOnB,OAAOoB,QLoJlDrF,OAAOC,eAAe2B,oBAAqB,cAAgBwD,OAAO,IACnClG,oBAAoBU,EAAEgC,oBAAqB,iBAAkB,WAAa,MAAO2B,kBACjFrE,oBAAoBU,EAAEgC,oBAAqB,sBAAuB,WAAa,MAAO0D,uBKrOrHpG,oBAAAU,EAAAgC,oBAAA,iCAAAuD,kBLkUM,SAAU7F,OAAQsC,oBAAqB1C,qBAE7C,YMvTO,SAASqG,yBAAwBC,SAAUC,OAAQC,SACtD,GAAMC,SAAU3F,OAAA4F,mDAAA,GAAgBH,OAAQD,SACxC,IAAMK,YAcN,OAbAF,SAAQG,OAAO,SAACC,SAAD,MAAYA,SAAQC,mBAAkBjD,QAAQ,SAAUgD,SACnE,GAAME,eAAgB1D,EAAEC,QAAO,KAAUuD,QAAQL,QAASA,QAC1D,IAAMQ,YAAalG,OAAAmG,qCAAA,GAAeJ,QAAQjD,KAAMiD,QAAQK,QACxD,IAAMC,SAAUrG,OAAAsG,4CAAA,GAAY,WAExB,MADqBP,SAAQC,iBAAiBE,WAAYD,cAAeF,QAAQK,WAElFG,KAAK,SAACC,gBACL,GAAMC,YAAazG,OAAA4F,mDAAA,GAA2BY,eAAgBN,WAE9D,OADiBlG,QAAAmG,qCAAA,GAAcM,WAAYV,QAAQK,UAGvDP,UAASX,KAAKmB,WAEX9D,EAAEmE,KAAKC,MAAM,KAAMd,UAAUU,KAAK,WAErC,SADe1D,OAAO8D,SAAUC,aAWjC,QAASC,2BAA0BrB,SAAUsB,2BAA4BC,iBAC5EvB,SAAWA,SAASnD,IAAI,SAAU2E,EAAGlC,OAEjC,MADAkC,GAAEC,UAAYnC,MACPkC,GAGX,IAAME,eAAgBlH,OAAA4F,mDAAA,GAAgBkB,2BAA4BtB,SAClE,IAAM2B,kBAAmBnH,OAAA4F,mDAAA,GAAgBmB,gBAAiBvB,SAE1D0B,eAAcpB,OAAO,SAACkB,GAAD,MAAMA,GAAEI,qBAAoBrE,QAAQ,SAAUgD,SAC/D,GAAMsB,kBAAmBrH,OAAAmG,qCAAA,GAAeJ,QAAQjD,KAAMiD,QAAQK,QAC9D,IAAMkB,0BAA2BC,6CAAAC,EAAEC,KAAKN,iBAAkB,SAAUO,kBAChE,MAAOA,kBAAiBT,YAAclB,QAAQkB,WAElD,IAAMU,yBAA0BL,yBAA2BA,yBAAyBxE,OACpF,IAAM8E,qBAAsB5H,OAAAmG,qCAAA,GAAewB,4BAA+B5B,QAAQK,QAClFL,SAAQqB,mBAAmBC,iBAAkBO,uBAW9C,QAASC,gCAA+BrC,SAAUsC,YAAapC,SAClE,GAAMC,SAAU3F,OAAA4F,mDAAA,GAA4BkC,YAAatC,SACzD,IAAIuC,cAAexF,EAAEyF,WAAWC,YAAY5B,SA0B5C,OAzBAV,SAAQ5C,QAAQ,SAAUgD,SACtBgC,aAAeA,aAAaxB,KAAK,SAAU2B,WACvC,GAAMjC,eAAgB1D,EAAEC,QAAO,KAAUuD,QAAQL,QAASA,QAC1D,IAAMQ,YAAalG,OAAAmG,qCAAA,GAASJ,QAAQjD,KAAMiD,QAAQK,QAElD,IAAM+B,iBAAkBnI,OAAAmG,qCAAA,GAAgBD,WAAYD,cAAcmC,SAClE,KAAKD,gBAAgBlG,OACjB,MAAOiG,UAGX,IAAMG,QAAStC,QAAQuC,eAAiBvC,QAAQuC,eAAeH,gBAAiBlC,cAAeF,QAAQK,SAAW+B,eAElH,OADoB5F,GAAEyF,WAAWC,QAAQI,QAAQhC,UAC9BE,KAAK,SAAUgC,WAC9B,MAAOvI,QAAAmG,qCAAA,GAAWoC,UAAWtC,cAAcuC,UAC5CjC,KAAK,SAAUgC,WACd,GAAIvF,QAAShD,OAAAmG,qCAAA,GAAcoC,UAAWxC,QAAQK,QAI9C,OAHIL,SAAQ0C,WAAa1C,QAAQK,UAC7BpD,OAASA,OAAOH,OAAO0F,YAEpBvF,SACRuD,KAAK,SAAUvD,QACd,SAAUH,OAAOqF,UAAWlF,cAIjC+E,aAUI,QAASW,QAAOlD,SAAUE,QAASiD,UAAU,GAAAC,OAAAC,IACxD,IAAIC,aAActD,cAAgBnD,IAAI,SAAC0G,SACnC,GAAIhD,SAAUgD,OAKd,IAJIxB,6CAAAC,EAAEwB,WAAWD,WACbhD,QAAU,GAAIgD,SAAQrD,QAASiD,UAC/BpG,EAAEC,OAAFoG,MAAe7C,QAAQkD,SAEE,gBAAlBlD,SAAQf,MAAoB,CACnC,GAAMkE,aAAcnD,QAAQf,KAC5Be,SAAQlG,KAAOqJ,YACfnD,QAAQf,MAAQ,SAACmE,GAAD,MAAMA,KAAMD,aAAc,IAE9C,MAAOnD,UAGX,QACIf,MAAO,SAACoE,OACJ,MAAON,YAAWO,OAAO,SAACrE,MAAOe,SAC7B,GAAMK,SAAUL,QAAQf,MAAMoE,MAC9B,QAAc,IAAVpE,QAA+B,IAAZoB,QACZ,GAEJpB,QACR,IAQPgB,iBAAkB,SAAUP,OAAQC,SAChC,MAAOH,yBAAwBuD,WAAYrD,OAAQC,UAOvD0B,mBAAoB,SAAUN,2BAA4BC,iBACtD,MAAOF,2BAA0BiC,WAAYhC,2BAA4BC,kBAQ7EuB,eAAgB,SAAUxF,KAAM4C,SAC5B,MAAOmC,gCAA+BiB,WAAYhG,KAAM4C,UAG5D4D,SAAU,SAAUvD,SAChB,IAAKA,UAAYA,QAAQf,MACrB,KAAMuE,OAAM,iDAIhB,OAFAxD,SAAQyD,GAAKjC,6CAAAC,EAAEiC,SAAS,iBACxBX,WAAWY,QAAQ3D,SACZA,QAAQyD,IAEnBG,YAAa,SAAUC,SACnBd,WAAaA,WAAWhD,OAAO,SAACC,SAC5B,MAAOA,SAAQyD,KAAOI,YNgKLhI,oBAAuB,EAAI8G,MACvC,IAAI9C,oDAAqD1G,oBAAoB,GAC7E,IAAIiH,sCAAuCjH,oBAAoB,EAC/D,IAAIoH,6CAA8CpH,oBAAoB,EACtE,IAAI2K,sCAAuC3K,oBAAoB,EAC/D,IAAIqI,8CAA+CrI,oBAAoBmB,EAAEwJ,uCAwLxF,SAAUvK,OAAQsC,oBAAqB1C,qBAE7C,YOlgBO,SAAS4K,qBAAoBC,KAIhC,MAHa/J,QAAOgK,KAAKD,SAAW1H,IAAI,SAAU8G,GAC9C,OAAStJ,KAAMsJ,EAAG/D,MAAO2E,IAAIZ,MAW9B,QAASc,qBAAoBrH,IAAKsH,WAKrC,OAJctH,SAAWyG,OAAO,SAAUc,MAAOf,OAE7C,MADAe,OAAMf,MAAMvJ,MAAQuJ,MAAMhE,MACnB+E,OACR5H,EAAEC,QAAO,KAAU0H,YAiBnB,QAASE,uBAAsBhB,MAAOiB,aAAc3E,SACvD,MAAK0D,OAGD7G,EAAE+H,cAAclB,QACPmB,OAAQT,oBAAoBV,OAAQ1D,QAAS2E,cAEtDG,MAAMC,QAAQrB,QACLmB,OAAQnB,MAAO1D,QAAS2E,eAE5BE,SAAW1K,KAAMuJ,MAAOhE,MAAOiF,eAAiB3E,QAASA,UARrD6E,UAAY7E,YP+dI9D,oBAAuB,EAAIkI,oBAC3BlI,oBAAuB,EAAIqI,oBOzgB5DrI,oBAAA,EAAAwI,uBPikBM,SAAU9K,OAAQsC,oBAAqB1C,qBAE7C,YQ5jBO,SAASwL,aAAY5J,QACxB,MAAO,UAAuBsI,OAE1B,MAD4C,KAA1BA,MAAMrH,QAAQjB,QACVA,SAEDA,OAAOoB,QAAQ,KAAM,MAAQkH,QACzBA,OAW1B,QAASuB,oBAAmB7J,QAC/B,MAAO,UAA8BsI,MAAOwB,aAExC,MAD4C,KAA1BxB,MAAMrH,QAAQjB,SACX8J,YAAe9J,OAAS,IAS9C,QAAS+J,YAAWlG,OACvB,GAAImG,SAAU,GAAIC,QAAO,IAAMpG,MAAQ3C,kBACvC,OAAO,UAAsBoH,OACzB,GAAIpE,OAAQoE,MAAMpE,MAAM8F,QACxB,UAAI9F,QAASA,MAAM/C,SACR+C,MAAM,IR2hBQpD,oBAAuB,EAAI8I,YAC3B9I,oBAAuB,EAAI+I,mBQrkB5D/I,oBAAA,EAAAiJ,UAAA,IAAI7I,mBAAoB,KRwnBlB,SAAU1C,OAAQsC,oBAAqB1C,qBAE7C,YSrnBO,SAAS8L,QAAOlK,OAAQmK,IAAKC,KAC3BD,MACDA,IAAME,SAASnL,OAAAoL,qCAAA,YAAY,KAE1BF,MACDA,IAAM,IAEV,IAAIG,KAAMrL,OAAAoL,qCAAA,QAAQH,IAAKC,KAAK,GAAS,EAIrC,OAHIpK,UACAuK,IAAMvK,OAASuK,KAEZA,IT2mBsBzJ,oBAAuB,EAAIoJ,MACvC,IAAII,sCAAuClM,oBAAoB,EACZA,qBAAoBmB,EAAE+K,qCACzE,IAAIE,6CAA8CpM,oBAAoB,GAC1DA,qBAAoBU,EAAEgC,oBAAqB,IAAK,WAAa,MAAO0J,6CAA+C,GAC/H,IAAIC,mDAAoDrM,oBAAoB,GAChEA,qBAAoBU,EAAEgC,oBAAqB,IAAK,WAAa,MAAO2J,mDAAqD,KAsBpJ,SAAUjM,OAAQsC,oBAAqB1C,qBAE7C,YUroBO,SAASsM,cAAanD,OAAQoD,kBASjC,OARkBpD,YAAcvC,OAAO,SAAC4F,GACpC,GAAM7L,MAAO6L,EAAE7L,MAAQ,EACvB,IAAM8L,YAAuF,KAA1EF,sBAAwB1J,QAAQlC,KAAKqC,QAAQ0J,kBAAmB,IACnF,IAAMC,YAAgD,IAAnChM,KAAKkC,QAAQ+J,iBAChC,IAAMC,aAAkD,IAApClM,KAAKkC,QAAQ6J,kBAEjC,OAAOC,aAAeE,cAAgBJ,YAE1B1J,OAAS,EAGd,QAAS+J,WAAUC,OAAQtD,UAAU,GAAAC,OAAAC,IAChD,IAAMqD,WACFC,kBACAC,gBACIC,WACIC,WAAW,EACXC,SAAU,IACV/D,QAAQ,EACRJ,UAAU,GAEdoE,YACIpE,UAAU,EACVI,QAAQ,GAEZiE,MACIjE,QAAQ,EACR8D,WAAW,EACXlE,UAAW,KAAM,UAAW,UAAW,UAAW,QAAS,kBAIvE,IAAMsE,MAAOnK,EAAEC,QAAO,KAAU0J,SAAUD,OAE1C,IAAME,gBAAiBQ,6CAAAnF,EAAEa,OAAOqE,KAAM,iBAEtC,IAAI3E,cAAe,IACnB,IAAIoE,yBAA0BS,QAAOC,EAAEC,QAAQC,IAC3ChF,aAAexF,EAAEyF,WAAWC,QAAQkE,gBAAgB9F,cACjD,IAAI8F,eAAe5F,KACtBwB,aAAeoE,mBACZ,CACH,GAAMa,IAAK,GAAIJ,QAAOC,EAAEC,QAAQC,IAAIZ,eACpCpE,cAAexF,EAAEyF,WAAWC,QAAQ+E,IAAI3G,UAG5C,GAAM4G,mBAAoBjN,OAAAkN,4DAAA,GAAWvE,SAAUiD,kBAC/C,IAAMuB,kBAAmBnN,OAAAkN,4DAAA,GAAWvE,UAAWmD,iBAAkB,IAEjE,IAAMsB,aAAc,GAAIC,iDAAA,EAAYtF,aAAc/H,OAAAkN,4DAAA,GAAWvE,SAAU2E,aACvE,IAAMC,mBAAoB,GAAIC,uDAAA,EAAkBzF,aAAckF,kBAC9D,IAAMQ,kBAAmB,GAAIC,sDAAA,EAAiB3F,aAAcoF,iBAE5D,IAAIQ,aAAa,CACjB5F,cAAaxB,KAAK,SAACyG,IACf,GAAIA,GAAGY,UAAYD,WAAY,CAC3BA,YAAa,CADc,IAEnBE,QAAWb,GAAGY,QAAdC,MACR,IAAMC,gBAAkBC,aAAa,EAGrCf,IAAGY,QAAQI,UAAUH,OAAOI,cAAe,SAACnL,KAAM2J,MAC9ClI,QAAQ2J,IAAI,YAAapL,KAAM2J,MAC/BgB,iBAAiBU,OAAOrL,KAAM2J,MAC9BgB,iBAAiBW,SAHrBxF,MAISkF,eACTd,GAAGY,QAAQI,UAAUH,OAAOQ,eAAgB,SAACvL,KAAM2J,MAC/Cc,kBAAkBY,OAAOrL,KAAM2J,MAC/BgB,iBAAiBW,SAFrBxF,MAGSkF,eACTd,GAAGY,QAAQI,UAAUH,OAAOS,UAAW,SAACxL,KAAM2J,MAC1Cc,kBAAkBY,QAAStO,KAAM,QAASwI,OAAQvF,MAAQ2J,OAD9D7D,MAESkF,iBAQjB,IAAMtI,WACFjD,EAAEC,UAAW4K,aACTvN,KAAM,OACNmF,MAAOhF,OAAAuO,qEAAA,GAAYjB,aACnB5H,QAASgH,KAAKN,eAAeK,OAEjClK,EAAEC,UAAW+K,mBACT1N,KAAM,aACNmF,MAAOhF,OAAAuO,qEAAA,GAAY3C,mBACnBlG,QAASgH,KAAKN,eAAeI,aAEjCjK,EAAEC,UAAWiL,kBACThF,WAAW,EACX5I,KAAM,YACNmF,MAAOhF,OAAAuO,qEAAA,GAAmBzC,kBAC1BpG,QAASgH,KAAKN,eAAeC,YAMrC,IAAMmC,WAAYxO,OAAAyO,sDAAA,GAAOjJ,SACzB,IAAMkJ,YAAaF,UAAUlG,cAW7B,OAVAkG,WAAUlG,eAAiB,WAEvB,MADaoG,YAAW/H,MAAM8H,sDAAA,EAAQ7H,WAC1BL,KAAK,SAAU8B,QAKvB,MAJoBmD,cAAanD,QAAS,WAEtCoF,iBAAiBW,QAEd/F,UAGRmG,UVwhBsB5M,oBAAuB,EAAIoK,SACvC,IAAIqB,iDAAkDnO,oBAAoB,GAC1E,IAAIwO,sDAAuDxO,oBAAoB,GAC/E,IAAIsO,uDAAwDtO,oBAAoB,GAChF,IAAIuP,uDAAwDvP,oBAAoB,EAChF,IAAIgO,6DAA8DhO,oBAAoB,EACtF,IAAIqP,sEAAuErP,oBAAoB,EAC/F,IAAIyP,sCAAuCzP,oBAAoB,EAC/D,IAAIyN,8CAA+CzN,oBAAoBmB,EAAEsO,qCU5pBvF,IAAM7C,kBAAmB,YACzB,IAAMwB,aAAc,OACpB,IAAM1B,mBAAoB,eVsyB3B,SAAUtM,OAAQsC,oBAAqB1C,qBAE7C,YAIA,SAAS0P,iBAAgB7E,IAAK8E,IAAKzJ,OAAiK,MAApJyJ,OAAO9E,KAAO/J,OAAOC,eAAe8J,IAAK8E,KAAOzJ,MAAOA,MAAOjF,YAAY,EAAMD,cAAc,EAAM4O,UAAU,IAAkB/E,IAAI8E,KAAOzJ,MAAgB2E,IWxzBpM,QAASgF,sBAAqBnM,IAAKoC,OAatC,MAZgBpC,KAAIyG,OAAO,SAACc,MAAOhG,KAU/B,MATIA,OAAQa,QACJmF,MAAM6E,OAAShK,MACfmF,MAAM8E,MAAQ9E,MAAM8E,MAAQ,EAE5B9E,MAAM8E,MAAQ,GAGtB9E,MAAM+E,SAAWC,KAAKjE,IAAIf,MAAM+E,SAAU/E,MAAM8E,OAChD9E,MAAM6E,KAAO7K,IACNgG,QACN6E,KAAM,KAAMC,MAAO,EAAGC,SAAU,IACtBA,SAGnB,QAASE,gBAAeC,gBAAiBC,aACrC,MAAOA,aAAYjN,IAAI,SAACkN,SAAUzK,OAE9B,MADeyK,YAAaF,gBAAgBvK,SAKpD,QAAS0K,MAAKP,MAAO9K,KACjB,GAAMqD,KACN,KAAK,GAAIjI,GAAI,EAAGA,EAAI0P,MAAO1P,IACvBiI,EAAEtC,KAAKf,IAEX,OAAOqD,GAGX,QAASiI,cAAaC,IAElB,MAAOA,IAAGC,UACLzN,QAAQ,0CAA2C,IACnDA,QAAQ,QAAS,KAAKyB,OAG/B,QAASiM,oBAAmBC,MACxB,MAAOA,MAAKxN,IAAI,SAACyC,MAAOgL,OACpB,MAAOL,cAAaK,SACrB1P,MAiBA,QAAS2P,wBAAuBC,YAAaC,QAASC,UAAWxK,SACpE,GAAMgH,MAAOnK,EAAEC,UAAW0J,SAAUxG,QAEpC,IAAI2J,iBAAkBO,mBAAmBI,YACzC,IAAMV,aAAcM,mBAAmBK,QACvC,IAAME,kBAAmBd,eAGzB,IAAMe,aAAchB,eAAeC,gBAAiBC,YACpD,IAAMe,mBAAoBjB,eAAee,iBAAiBG,QAAQC,UAAWjB,YAAYgB,QAAQC,UAEjG,IAAMC,YAAazB,qBAAqBqB,aAAa,EACrD,IAAMK,kBAAmB1B,qBAAqBsB,mBAAmB,EAEjE,IAAMK,mBAAoBpB,YAAYrN,OAASoN,gBAAgBpN,MAC/D,IAAM0O,cAAenB,KAAKkB,sBAAmBE,GAGzCvB,iBADAoB,kBAAoBD,WACFnB,gBAAgBxM,OAAO8N,cAEvBA,aAAa9N,OAAOwM,gBAG1C,KAAK,GAAI9P,GAAI,EAAGA,EAAI+P,YAAYrN,OAAQ1C,IAAK,CACzC,GAAMsR,KAAMZ,QAAQa,GAAGvR,EACvB,IAAMwR,MAAO1B,gBAAgB9P,EAC7BsR,KAAIG,WAAWtE,KAAK/K,YAEpB,IAAM4N,UAAWE,aAAaoB,IAAIzQ,IAAI,GACtC,QAAawQ,KAATG,KAAoB,IAAAE,UACpBJ,KAAIK,MAAJD,aAAArC,gBAAAqC,UACKvE,KAAKjL,SAAU,GADpBmN,gBAAAqC,UAEKvE,KAAK/K,YAAcuO,WAAa,MAFrCe,YAIAJ,IAAIG,WAAWtE,KAAKhL,gBACjB,IAAIqP,OAASxB,SAAU,IAAA4B,WAC1BN,KAAIK,MAAJC,cAAAvC,gBAAAuC,WACKzE,KAAKhL,YAAa,GADvBkN,gBAAAuC,WAEKzE,KAAK/K,YAAcuO,WAAa,MAFrCiB,aAIAN,IAAIG,WAAWtE,KAAKjL,aAEpBoP,KAAIG,WAActE,KAAKjL,QAAvB,IAAkCiL,KAAKhL,YAI/C,MAAOuO,SAGJ,QAASmB,sBAAqBP,IAAKQ,SAAUnB,UAAWxK,SAC3D,GAAMgH,MAAOnK,EAAEC,UAAW0J,SAAUxG,QACpC,IAAM4L,SAAUT,IAAIU,OAAO5N,MAG3B,IADAkN,IAAIG,WAActE,KAAKhL,WAAvB,IAAqCgL,KAAK/K,aACtC2P,WAAY,GAAGD,UAAW1N,OAC1B,MAAOkN,IAGXA,KAAIU,KAAKF,UACTG,WAAW,WAAY,GAAAC,WACnBZ,KAAIK,MAAJO,cAAA7C,gBAAA6C,WACK/E,KAAKhL,YAAa,GADvBkN,gBAAA6C,WAEK/E,KAAK/K,YAAcuO,WAAa,MAFrCuB,cAID,GX4rB0B7P,oBAAuB,EAAImO,uBAC3BnO,oBAAuB,EAAIwP,oBW3wB5D,IAAMlF,WACFzK,QAAS,WACTC,WAAY,cACZC,YAAa,iBXq4BX,SAAUrC,OAAQsC,oBAAqB1C,qBAE7C,YYj7BO,SAASwS,mBAAkBb,KAC9B,GAAMc,oBAAqBd,IAAIe,QAAJ,IAAgBC,mBAAhB,IAC3B,IAAIC,aAIJ,OAHIH,oBAAmB1P,SACnB6P,UAAYH,mBAAmB7O,KAAKiP,oBAEjCD,UAEJ,QAASE,sBAAqBnB,IAAK/N,MACtC+N,IAAIK,KAAKW,mBAAoBzN,KAAK6N,UAAUnP,OAEzC,QAASoP,iBAAgBrB,KAC5BA,IAAIG,WAAWa,oBAGZ,QAASM,iBAAgBC,UAG5B,MAFAA,UAAWA,SAASlQ,QAAQ,QAAS,KAAKA,QAAQ,QAAS,KAClCkQ,SAASpN,MAAM,4BAGrC,QAASqN,aAAYD,UACxB,MAAOD,iBAAgBC,UAAUnQ,OAAS,EAIvC,QAASqQ,uBAAsBF,SAAUG,eAC5C,QAASC,YAAWC,IAAKC,WAKrB,MAJcH,eAAc9K,KAAK,SAACoH,KAE9B,MADc,IAAI9D,QAAO,MAAQ8D,IAAM,OAC1B9K,KAAK0O,OAK1BL,SAAWA,SAASlQ,QAAQ,QAAS,KAAKA,QAAQ,QAAS,IAC3D,IAAMyQ,qBACN,IAAMC,kBAAmBT,gBAAgBC,SAYzC,OAXIQ,mBACAA,iBAAiB7P,QAAQ,SAAU0P,KAC/B,GAAIA,IAAIzN,MAAM,SAAWwN,WAAWC,IAAKF,eAAgB,CACrD,GAAIM,QAASF,kBAAkBF,IAC1BI,UACDA,OAAS7S,OAAAoL,qCAAA,UAAS,UAClBuH,kBAAkBF,KAAOI,WAKlCF,kBAGX,QAASG,aAAYD,QACjB,MAAO,UAASA,OAAS,SAGtB,QAASE,uBAAsBX,SAAUO,mBAQ5C,MAPAP,UAAWA,SAASlQ,QAAQ,QAAS,KAAKA,QAAQ,QAAS,KAE3DlC,OAAOgK,KAAK2I,mBAAmB5P,QAAQ,SAAC0P,KACpC,GAAMO,OAAQL,kBAAkBF,IAChC,IAAM/G,GAAI,GAAIX,QAAO0H,IAAK,IAC1BL,UAAWA,SAASlQ,QAAQwJ,EAAGoH,YAAYE,UAExCZ,SAGJ,QAASa,0BAAyBb,SAAUO,mBAO/C,MANA3S,QAAOgK,KAAK2I,mBAAmB5P,QAAQ,SAACmQ,qBACpC,GAAMC,YAAaR,kBAAkBO,oBACrC,IAAMxH,GAAI,GAAIX,QAAO+H,YAAYK,YAAa,IAC9Cf,UAAWA,SAASlQ,QAAQwJ,EAAGwH,uBAG5Bd,SAKJ,QAASgB,qBAAoBvC,IAAKwC,UACrC,GAAM3D,IAAKmB,IAAIzQ,IAAI,EACnB,IAAIkT,cAAeC,cAAcnT,IAAIsP,GAKrC,QAJK4D,cAAgBD,WACjBC,aAAeD,SAASxC,KAAK3O,QAAQ,QAAS,KAAKA,QAAQ,QAAS,KACpEqR,cAAcC,IAAI9D,GAAI4D,eAEnBA,aAEJ,QAASG,uBAAsB5C,KAClC,GAAMnB,IAAKmB,IAAIzQ,IAAI,EACnBmT,eAAcG,OAAOhE,IZy1BQ9N,oBAAuB,EAAI8P,kBAC3B9P,oBAAuB,EAAIoQ,qBAC3BpQ,oBAAuB,EAAIsQ,gBAE3BtQ,oBAAuB,EAAIyQ,YAC3BzQ,oBAAuB,EAAI0Q,sBAC3B1Q,oBAAuB,EAAImR,sBAC3BnR,oBAAuB,EAAIqR,yBAC3BrR,oBAAuB,EAAIwR,oBAC3BxR,oBAAuB,EAAI6R,qBACvC,IAAIrI,sCAAuClM,oBAAoB,EACZA,qBAAoBmB,EAAE+K,qCYh8B9F,IAAM2G,mBAAoB,eAC1B,IAAMF,4BAA6BE,iBA+EnC,IAAMwB,eAAgB,GAAII,UZk9BpB,SAAUrU,OAAQD,QAASH,qBAEjC,YariCA,IAAM+M,QAAS/M,oBAAQ,EACvB,IAAM0U,UAAW1U,oBAAQ,GAEzBI,QAAOD,QAAUuU,SAASpR,QACtBqR,oBAEAC,cAAe,SACfC,WAAY,WACR,MAAOlL,MAAKgI,IAAI1M,OAGpB6P,aAAc,WACVnL,KAAKgI,IAAIoD,IAAIpL,KAAKiL,gBAGtBI,WAAY,WACR,GAAMC,IAAKtL,IACX,IAAMuL,UAAWvL,KAAKgI,IAAI/N,KAAKmJ,OAAOlL,WAElCqT,WACAvL,KAAKgI,IAAIoD,IAAIpL,KAAKiL,eAAeO,GAAGxL,KAAKiL,cAAe,WACpD,GAAM3P,KAAMgQ,GAAGJ,YAEf,IAAMO,WAAazU,KAAMuU,SAAUhP,MAAOjB,KAC1CgQ,IAAGtD,IAAI5P,QAAQgL,OAAOjL,OAAOC,SAAW6B,KAAMwR,QAASC,OAAQ,WAGvEX,SAASnT,UAAUyT,WAAWvN,MAAMkC,KAAMjC,cAE7C4N,SAAU,6Bb4iCT,SAAUlV,OAAQD,QAASH,qBAEjC,Yc1kCA,IAAI0U,UAAW1U,oBAAQ,GAEvBI,QAAOD,QAAUuU,SAASpR,QACtBqR,oBAIAK,WAAY,eAEXM,SAAU,Od8kCT,SAAUlV,OAAQD,QAASH,qBAEjC,GAAIuV,Ue3lCoBvV,oBAAQ,GAAxBsD,Of4lCKiS,Se5lCLjS,OAAQkS,If6lCND,Se7lCMC,GAEhB,IAAIC,YAAa,SAAUC,WAAYC,aACnC,GAAIV,IAAKtL,IACT,IAAIiH,MAMAA,OADA8E,YAAcF,IAAIE,WAAY,eACtBA,WAAWE,YAEX,WAAc,MAAOX,IAAGxN,MAAMkC,KAAMjC,YAIhDpE,OAAOsN,MAAOqE,GAAIU,YAIlB,IAAIE,WAAY,WAAclM,KAAKiM,YAAchF,MAcjD,OAbAiF,WAAUtU,UAAY0T,GAAG1T,UACzBqP,MAAMrP,UAAY,GAAIsU,WAIlBH,YACApS,OAAOsN,MAAMrP,UAAWmU,YAK5B9E,MAAMkF,UAAYb,GAAG1T,UAEdqP,MAGX,IAAImF,MAAO,SAAUvP,SACjBmD,KAAKgI,IAAOnL,QAAQmL,KAAQtO,EAAEmD,QAAQgK,IACtC7G,KAAK6G,GAAKhK,QAAQgK,GAClB7G,KAAKqL,WAAWvN,MAAMkC,KAAMjC,WAGhCpE,QAAOyS,KAAKxU,WACRyT,WAAY,eAGhBe,KAAKzS,OAASmS,WAEdrV,OAAOD,QAAU4V,MfomCX,SAAU3V,OAAQsC,oBAAqB1C,qBAE7C,YgBhpCO,SAASgW,qBAAoBC,SAChC,GAAMC,SAAUD,QAAQxR,OAAOqB,MAAMqQ,YAErC,QADgBD,QAAUA,QAAQ,GAAKD,SACxBxR,OAOZ,QAAS2R,eAAcH,SAC1B,GAAMC,SAAUD,QAAQnQ,MAAMqQ,YAC9B,IAAKD,QAAL,CAGA,GAAMG,SAAUH,QAAQ,GAAGpQ,MAAMwQ,gBAEjC,OADcD,SAAUA,QAAQ,GAAG5R,WAASiN,IAQzC,QAAS6E,iBAAgBN,SAC5B,GAAMC,SAAUD,QAAQnQ,MAAMqQ,YAC9B,IAAKD,QAAL,CAGA,GAAMG,SAAUH,QAAQ,GAAGpQ,MAAMwQ,gBAEjC,QADcD,QAAUA,QAAQ,GAAKH,QAAQ,IAChCzR,QAMV,QAAS+R,mBAAkBjQ,OAAQL,OACtC,GAAMuQ,eAAgBlQ,OAAO,EAE7B,IAAMmQ,YAAarT,EAAE+H,cAAclF,OAAS,MAAQ,OAIpD,QAASyQ,SAHQF,cAAcE,UAAYD,WAGdE,WAFVH,cAAcG,YAAc,SAI5C,QAASC,aAAYtQ,QACxB,GAAM0P,SAAU1P,OAAO,GAAG5F,IAC1B,SACIA,KAAMqV,oBAAoBC,SAC1BU,SAAUP,cAAcH,SACxBW,WAAYL,gBAAgBN,WhBimCHvT,oBAAuB,EAAI8T,kBgB3pC5D9T,oBAAA,EAAAmU,WAAA,IAAMV,aAAc,2BACpB,IAAMG,iBAAkB,ahB2tClB,SAAUlW,OAAQsC,oBAAqB1C,qBAE7C,YiBxtCO,SAAS8W,qBAAoB5M,OAIhC,OAHYA,MAAMpE,MAAMiR,yBAA2B5T,IAAI,SAAC8B,KACpD,MAAOA,KAAIN,UAAU,EAAGM,IAAIlC,OAAS,KAUtC,QAASiU,uBAAsB9M,MAAOtG,MAMzC,MALwBsG,OAAMlH,QAAQ+T,mBAAoB,SAACjR,MAAOmR,YAC9D,GAAIhS,KAAMrB,KAAKqT,WAEf,OADgB3L,OAAMC,QAAQtG,KAAOA,IAAIA,IAAIlC,OAAS,GAAKkC,MjB0sClCvC,oBAAuB,EAAIoU,oBiB/tC5DpU,oBAAA,EAAAsU,qBAAA,IAAID,oBAAqB,YjB8vCnB,SAAU3W,OAAQD,QAASH,qBkB7rCjC,GAAMkX,YAAalX,oBAAQ,GAC3B,IAAM0U,UAAW1U,oBAAQ,GAEzB,IAAMmX,gBAAiBnX,oBAAQ,IAAuCoX,OACtE,IAAMrK,QAAS/M,oBAAQ,EAEvB,IAAIF,OACAuX,IAAKH,WACLI,OACI5C,SAAUA,UAEdM,WAAY,SAAUjI,QAClB,GAAIwK,OAAQlU,EAAE,QAAQO,KAAK,UAE3B,IAAIoJ,WACA0B,SAEI1B,UACIwK,KACID,MAAOA,SAInBF,KACII,KAAM,OACNC,UAAU,GAIlB,IAAIlR,SAAUnD,EAAEC,QAAO,KAAU0J,SAAUD,OAEvCA,SAAUA,OAAO2B,SAAY3B,OAAO2B,kBAAmByI,gBACvDxN,KAAK+E,QAAU3B,OAAO2B,QAEtB/E,KAAK+E,QAAU,GAAIyI,gBAAe3Q,QAAQkI,QAG9C,IAAIiJ,MAAOT,WAAWlC,WAAW3R,EAAEC,QAAO,GACtCoL,QAAS/E,KAAK+E,SACflI,QAAQ6Q,KAOX,OALA1N,MAAK+E,QAAQI,UAAU,mBAAoB,WACvCoI,WAAWU,YACXV,WAAWW,YAGRF,MAGf7X,MAAKqX,eAAiBA,eACtBrX,KAAKgY,UAAY/K,OAEIjN,KAAKiY,QAAU,SACpC3X,OAAOD,QAAUL,MlBowCX,SAAUM,OAAQD,QAASH,qBAEjC,QAAS0P,iBAAgB7E,IAAK8E,IAAKzJ,OAAiK,MAApJyJ,OAAO9E,KAAO/J,OAAOC,eAAe8J,IAAK8E,KAAOzJ,MAAOA,MAAOjF,YAAY,EAAMD,cAAc,EAAM4O,UAAU,IAAkB/E,IAAI8E,KAAOzJ,MAAgB2E,IAW3M,GAAI0K,UmB33CAvV,oBAAQ,IADRgY,mBnB63CqBzC,SmB73CrByC,mBAAoBC,uBnB83CK1C,SmB93CL0C,uBAAwBC,2BnB+3Cf3C,SmB/3Ce2C,2BAA4BC,8BnBg4CxC5C,SmBh4CwC4C,6BnBk4C5E,IAAIC,WmB/3C4CpY,oBAAQ,IAAhDqY,kBnBg4CgBD,UmBh4ChBC,kBAAmBC,iBnBi4CJF,UmBj4CIE,gBnBm4C3B,IAAIC,WmBl4CuBvY,oBAAQ,GAA3BqE,enBm4CakU,UmBn4CblU,cnBq4CR,IAAImU,WmBn4CaxY,oBAAQ,GAAjByY,KnBo4CGD,UmBp4CHC,IAER,IAAM1L,QAAS/M,oBAAQ,EAEvB,IAAM0Y,kBAAmB1Y,oBAAQ,IAAgCoX,OACjE,IAAMuB,aAAc3Y,oBAAQ,IAAwBoX,OACpD,IAAMwB,aAAc5Y,oBAAQ,IAAkCoX,OAC9D,IAAMyB,kBAAmB7Y,oBAAQ,IAAkCoX,OAEnEhX,QAAOD,QAAW,WAmBd,QAAS2Y,qBAAoBrB,MACzB,GAAMsB,OAAQ1V,EAAEoU,KAChB,IAAIuB,iBAAkBD,MAAMxQ,KAAK,IAAMwE,OAAOnL,OAI9C,OAHImX,OAAME,GAAG,IAAMlM,OAAOnL,UACtBoX,gBAAkBA,gBAAgBE,IAAIH,QAEnCC,gBAQX,QAASG,mBAAkBC,QAASC,SAChC,GAAM7I,IAAM4I,kBAAmB/V,GAAK+V,QAAQlY,IAAI,GAAKkY,OACrD,KAAK5I,KAAOA,GAAG8I,SAEX,KADAjU,SAAQC,MAAM+T,QAAS,oCAAqCD,SACtD,GAAI/O,OAAMgP,QAAU,2CAA+CD,SAE7E,OAAO5I,IAIX,QAAS+I,wBAAuBC,cAAe9K,YACxC/K,OAAO6V,eAAe3V,QAAQ,SAAU4V,MACvC/K,QAAQgL,YAAYD,QAG5B,QAASE,qBAAoBC,OACzB,GAAMjI,KAAMtO,EAAEuW,MACdvW,GAAEuW,MAAMC,YAAYC,KAAK,SAAUlU,MAAOmU,SACtC,GAAI/H,MAAO+H,QAAQT,QAEnB,IAAmC,IAA/BtH,KAAKnP,QADY,WACiB,CAClCmP,KAAOA,KAAKhP,QAFK,UAEiB,GAClC,IAAM6D,SAAU+R,YAAYoB,WAAWhI,KAAML,IACzC9K,SAAQoT,QACRpT,QAAQoT,OAAOjI,KAAML,QAKrC,QAASuI,uBAAsBN,OAC3B,GAAMjI,KAAMtO,EAAEuW,MAEd,IAAM/P,SAAU8O,YAAYqB,WAAWrI,IACvC,IAAM7J,GAAI,GAAI+B,SAAQsQ,QAClB3J,GAAIoJ,OAEJ9R,GAAEgN,cACFhN,EAAEgN,eApEVzR,EAAE+W,KAAKC,QAAQtN,OAAOnL,QAAU,SAAU4O,IACtC,IAAKA,KAAOA,GAAGqJ,WACX,OAAO,CAEX,KAAK,GAAIxZ,GAAI,EAAGA,EAAImQ,GAAGqJ,WAAW9W,OAAQ1C,IAAK,CAE3C,GAA8C,IADjCmQ,GAAGqJ,WAAWxZ,GAAGiZ,SACrBzW,QAAQ,QAAUkK,OAAOnL,QAC9B,OAAO,EAGf,OAAO,EA8DX,IAAM0Y,YAEFC,MAAO5B,YACPkB,WAAYjB,YACZ4B,WAAY9B,iBAEZM,gBAAiB,GAAIyB,KASrBC,cAAe,SAAUtB,QAAS1K,SACzBA,UACDA,QAAU/E,KAAKnD,QAAQkI,QAE3B,IAAMkL,OAAQT,kBAAkBC,QAChC,IAAMzH,KAAMtO,EAAE+V,QACd,IAAMuB,cAAehR,KAAKqP,gBAAgB9X,IAAI0Y,MAC9C,IAAKjI,IAAIsH,GAAG,IAAMlM,OAAOnL,SAAY+Y,aAArC,CAGAhR,KAAKqP,gBAAgBxE,OAAO4E,QAC5B,IAAMI,eAAgB1Y,OAAOgK,KAAK6P,cAAcxQ,OAAO,SAACc,MAAO3C,GAC3D,GAAMsS,QAASD,aAAarS,GAAGuS,cAE/B,OADID,SAAQ3P,MAAMjF,KAAK4U,QAChB3P,UAGXiP,uBAAsBN,OACtBD,oBAAoBC,OACpBL,uBAAuBC,cAAe9K,QAEtC,IAAMoM,WAAYha,OAAOgK,KAAKiC,OAAOzK,WAAWyY,KAAK,IACrDpJ,KAAIG,WAAWgJ,WAEfha,OAAOgK,KAAK6G,IAAI/N,QAAQC,QAAQ,SAAU8L,MACZ,IAAtBA,IAAI9M,QAAQ,OAAe8M,IAAI7J,MAAM,aACrC6L,IAAIqJ,WAAWrL,SAY3BsL,YAAa,SAAU7B,QAAS1K,SACvBA,UACDA,QAAU/E,KAAKnD,QAAQkI,QAG3B,IAAMkL,OAAQT,kBAAkBC,QAChC,IAAMzH,KAAMtO,EAAEuW,MACd,IAAKjI,IAAIsH,GAAJ,IAAWlM,OAAOnL,QAAvB,CAMA,IADgB+W,YAAYqB,WAAWrI,KAC3BwI,SACR3J,GAAIoJ,OAGR,IAAMsB,sBAAuBnO,OAAOnL,OAA9B,GACN,IAAMuZ,YACN9X,GAAEuW,MAAMC,YAAYC,KAAK,SAAUlU,MAAOmU,SACtC,GAAI/H,MAAO+H,QAAQT,QACnB,IAAmC,IAA/BtH,KAAKnP,QAAQqY,cAAjB,CAGAlJ,KAAOA,KAAKhP,QAAQkY,aAAc,GAElC,IAAMjF,SAAU8D,QAAQ7T,KACxB,IAAIK,QAAS4R,8BAA8BlC,QAE3C,IAAMpP,SAAU+R,YAAYoB,WAAWhI,KAAML,IACzC9K,UAAWA,QAAQuU,MACnBvU,QAAQuU,KAAKpJ,KAAMzL,OAAQoL,KAE3BpL,OAAOxD,QAAU8D,SAAWA,QAAQ1B,QACpCoB,UAAY5C,OAAOkD,QAAQ1B,MAAMoB,SAGrC,IAAM8U,eAAgBpD,uBAAuBtG,IAAKK,KAClDzL,QAAS8R,kBAAkB9R,OAAQ8U,cAEnC,IAAMb,YAAaxC,mBAAmBrG,IAAKK,KAC3CmJ,UAASnJ,OACLqJ,cAAeA,cACf9U,OAAQA,OACRiU,WAAYA,eAIpB7Q,KAAKqP,gBAAgB1E,IAAIsF,MAAOuB,SAEhC,IAAMG,eAAgBpD,2BAA2B0B,MACjD,IAAM2B,wBAAyBza,OAAOgK,KAAKqQ,UAAUhR,OAAO,SAACc,MAAOtK,MAChE,GAAMqR,MAAOmJ,SAASxa,KADkD,IAEhE4F,QAA0ByL,KAA1BzL,OAAQ8U,cAAkBrJ,KAAlBqJ,aAChB,KAAK9U,OAAOxD,OAER,MADAkI,OAAMtK,MAAQqR,KACP/G,KAGX,IAAMuQ,aAAcnY,EAAEC,QAClBmY,OAAO,EACPC,QAAS,SAACtW,GACNC,QAAQC,MAAM,qCAAsCsU,MAAOxU,EAC3D,IAAIuW,KAAMvW,EAAEwW,SAAWxW,CACnB/B,GAAE+H,cAAcuQ,OAChBA,IAAMzW,KAAK6N,UAAU4I,MAEzBhK,IAAIK,KAAKjF,OAAO1K,UAAWsZ,OAEhCL,cACH,IAAMO,oBAAqBtV,OAAOpD,IAAI,SAAC8G,GAAD,MAAMA,GAAEtJ,MAC9C,IAAMia,QAASlM,QAAQI,UAAU+M,mBAAoB,SAACjY,MAClD,GAAMkY,aACN,IAAkC,IAA9BD,mBAAmB9Y,OACnB+Y,UAAUnb,MAAQiD,KAAKiY,mBAAmB,QACvC,CACH,GAAME,aAActD,KAAK7U,KAAMiY,uBAC/BC,WAAUnb,MAAQG,OAAOgK,KAAKiR,aAAa5R,OAAO,SAACc,MAAO0E,KAEtD,GAAMqM,WAAY,GAAInQ,QAAJ,IAAewP,cAAf,IAGlB,OADApQ,OADUoQ,cAAgB1L,IAAI3M,QAAQgZ,UAAW,IAAMrM,KAC5CoM,YAAYpM,KAChB1E,WAGf0G,IAAIG,WAAW/E,OAAO1K,WAAWN,QAAQgL,OAAOjL,OAAOE,QAAS8Z,YACjEN,YAGH,OADAvQ,OAAMtK,MAAQG,OAAOmb,UAAWjK,MAAQ6I,eAAgBD,SACjD3P,UAGXtB,MAAKqP,gBAAgB1E,IAAIsF,MAAO2B,0BASpC1D,QAAS,SAAUqE,gBAAgB,GAAAxS,OAAAC,IAC1BuS,gBAEO5Q,MAAMC,QAAQ2Q,kBACtBA,eAAiBpD,oBAAoBoD,iBAFrCA,eAAiBpD,oBAAoBnP,KAAKnD,QAAQiR,MAMtDpU,EAAEyW,KAAKoC,eAAgB,SAACtW,MAAOwT,SAC3B1P,MAAKuR,YAAY7B,QAAS1P,MAAKlD,QAAQkI,YAS/CkJ,UAAW,SAAUuE,kBACjB,GAAMlH,IAAKtL,IACNwS,kBAKO7Q,MAAMC,QAAQ4Q,oBACtBA,iBAAmBrD,oBAAoBqD,oBALvCA,oBACAxS,KAAKqP,gBAAgBnV,QAAQ,SAACoB,IAAK0K,KAC/BwM,iBAAiBnW,KAAK2J,QAK9BtM,EAAEyW,KAAKqC,iBAAkB,SAAUvW,MAAOwT,SACtCnE,GAAGyF,cAActB,QAASnE,GAAGzO,QAAQkI,YAI7C0N,WAWApH,WAAY,SAAUxO,SAwBlB,QAAS6V,mBAAkBtD,OACvB,QAASuD,YAAWpW,MAAOsU,YACvB,GAAIlP,MAAMC,QAAQrF,OAAQ,CACtB,GAAMnB,QAASmB,MAAM/C,IAAI,SAAU8B,KAC/B,MAAOZ,gBAAeY,MAE1B,OAAOyT,kBAAiBvT,MAAMJ,OAAQyV,YAE1C,MAAO9B,kBAAiBvT,MAAMd,eAAe6B,OAAQsU,YAGzDzB,MAAMhE,IAAIhI,OAAOjL,OAAOC,SAASoT,GAAGpI,OAAOjL,OAAOC,QAAS,SAAUwa,IAAKlR,QACtE,GAAMmR,QAASvH,GAAG+D,gBAAgB9X,IAAIqb,IAAIE,OADoC,IAEtE7Y,MAA0ByH,OAA1BzH,KAAMyR,OAAoBhK,OAApBgK,OAAQ7O,QAAY6E,OAAZ7E,OACtB,IAAKgW,QAAW5Y,KAAhB,CAGA,GAAM8Y,YAAaF,OAAOnH,WANoD,IAOtEgG,eAA8BqB,WAA9BrB,cAAeb,WAAekC,WAAflC,UACvB,IAAM7I,KAAMtO,EAAEkZ,IAAIE,OAElB,IAAM1X,WAAapB,OAAOC,MAAOT,IAAI,SAAUwZ,QAAQ,GAC3Chc,MAAgBgc,OAAhBhc,KAAMuF,MAAUyW,OAAVzW,KACd,IAAM0W,aAAcN,WAAWpW,MAAOsU,WACtC,IAAMqC,YAAalc,KAAKqE,MAAM,KAAK,GAAGP,MAEtC,QAAS9D,KADY2X,iBAAiBuE,WAAYxH,OAAQgG,eAC7BnV,MAAO0W,iBAGxClO,SAAQoO,QAAQ/X,OAAQyB,SAASa,KAAK,SAAC8B,QACnC,GAAKA,QAAWA,OAAOpG,OAAvB,CAGA,GAAMga,MAAO5T,OAAOA,OAAOpG,OAAS,EACpC4O,KAAI5P,QAAQgL,OAAOjL,OAAOE,QAA1B0N,mBAAsC2F,OAAS0H,KAAK7W,cAKhE,QAAS8W,yBAAwBjE,OAE7BA,MAAMhE,IAAIhI,OAAOjL,OAAOE,SAASmT,GAAGpI,OAAOjL,OAAOE,QAAS,SAAUua,IAAK3Y,MACtE,GAAM+N,KAAMtO,EAAEkZ,IAAIE,OAElB,IAAMD,QAASvH,GAAG+D,gBAAgB9X,IAAIqb,IAAIE,OACrCD,SAIL1b,OAAOgK,KAAKlH,MAAMC,QAAQ,SAACoZ,MACvB,GAAMhY,KAAMrB,KAAKqZ,KADc,IAAAC,cAEAV,OAAOS,MAA9BzC,WAFuB0C,aAEvB1C,WAAYjU,OAFW2W,aAEX3W,MACpB,IAAM4W,gBAAiBzE,iBAAiB1W,QAAQiD,IAAKuV,WAErC5B,aAAYoB,WAAWiD,KAAMtL,KACrCwI,OAAOgD,eAAgBF,KAAMtL,IAAKpL,YA9EtD,GAAMyG,WAKFyK,KAAM,OACN/I,QAAS,KAMTgJ,UAAU,EAEdrU,GAAEC,OAAO0J,SAAUxG,QAEnB,IAAMkI,SAAU1B,SAAS0B,OAEzB/E,MAAKnD,QAAUwG,QAEf,IAAMiI,IAAKtL,IACX,IAAMoP,OAAQ1V,EAAE2J,SAASyK,KA8DzB,IAAM2F,UAAW/Z,EAAEyF,UAanB,OAZAzF,GAAE,WACE4R,GAAG4C,UAEHwE,kBAAkBtD,OAClBiE,wBAAwBjE,OAExB9D,GAAGmH,QAAQ1E,SAAWmB,iBAAiBE,MAAM7X,IAAI,GAAI+T,GAAIA,GAAGzO,QAAQkR,UAEpE0F,SAASrU,QAAQgQ,OACjBA,MAAMhX,QAAQ,gBAGXqb,SAASjW,WAIxB,OAAO9D,GAAEC,OAAOqG,KAAM2Q,enB05CpB,SAAUla,OAAQsC,oBAAqB1C,qBAE7C,YACAc,QAAOC,eAAe2B,oBAAqB,cAAgBwD,OAAO,GAC7C,IAAImX,iDAAkDrd,oBAAoB,GAC1E,IAAIsd,8CAA+Ctd,oBAAoB,GACvE,IAAIud,6CAA8Cvd,oBAAoB,GAC1DA,qBAAoBU,EAAEgC,oBAAqB,qBAAsB,WAAa,MAAO2a,iDAAmD,IACxIrd,oBAAoBU,EAAEgC,oBAAqB,yBAA0B,WAAa,MAAO4a,8CAAgD,IACzItd,oBAAoBU,EAAEgC,oBAAqB,6BAA8B,WAAa,MAAO4a,8CAAgD,IAC7Itd,oBAAoBU,EAAEgC,oBAAqB,gCAAiC,WAAa,MAAO6a,6CAA+C,KAS1K,SAAUnd,OAAQsC,oBAAqB1C,qBAE7C,YoB1zDA,SAASwd,mBAAkBC,MACvB,MAAKA,OAASA,KAAKhZ,OACZgZ,KAAKzY,MAAM,KAAK7B,IAAI,SAACua,GAAD,MAAMA,GAAEjZ,YAQvC,QAASkZ,uBAAsBhM,IAAKiM,WAChC,GAAM3H,SAAUtE,IAAIK,KAAJ,UAAmB4L,UACnC,IAAMC,UAAWL,kBAAkBvH,QACnC,OAAI4H,UAAS9a,OAAS,EACX8a,SAASzM,MAAM,MAI9B,QAAS0M,oBAAmBnM,IAAKoM,QAE7B,GAAMC,YAAaD,WAAaA,OAAW,EAE3C,OAAOP,mBADM7L,IAAIK,KAFA,iBAEmBgM,aASjC,QAAShG,oBAAmBrG,IAAKiM,WAepC,GAAMpD,YAdN,SAA0B7I,IAAKiM,WAC3B,GAAMK,mBAAoBN,sBAAsBhM,IAAKiM,UACrD,OAAIK,mBAAkBlb,OACXkb,mBAIiE,KADtC,OAAQ,UAAW,UACLpb,QAAQ+a,WAEjDE,mBAAmBnM,IAAK,IAE5BmM,mBAAmBnM,IAAKiM,YAGCjM,IAAKiM,UACzC,IAAMM,WAAYvM,IAAIwM,QAAQ,oBAAoBvM,GAAG,EACrD,IAAMwM,oBAAqB5D,WAAWrQ,OAAO,SAACc,MAAOhG,KACjD,GAAY,YAARA,IAAmB,CACnB,GAAMoZ,YAAarG,mBAAmBkG,UAAWN,UACjD3S,OAAQA,MAAMtH,OAAO0a,gBAErBpT,OAAQA,MAAMtH,OAAOsB,IAEzB,OAAOgG,WAGX,QAAKmT,mBAAmBrb,QAAUmb,UAAUnb,OACjCiV,mBAAmBkG,UAAWN,WAElCQ,mBAhEX1b,oBAAA,EAAAsV,oBpBu4DM,SAAU5X,OAAQsC,oBAAqB1C,qBAE7C,YqBn4DO,SAASiY,wBAAuBtG,IAAKK,MACxCA,KAAOA,KAAKhP,QAAQ,UAAW,GAC/B,IAAI0L,SAAUiD,IAAI/N,KAAK,aAAeoO,KAItC,QAHgBN,KAAZhD,UACAA,QAAUiD,IAAIK,KAAK,uBAEPN,KAAZhD,QAAuB,CACvB,GAAMwP,WAAYvM,IAAIe,QAAQ,mBAC1BwL,aACAxP,QAAUwP,UAAUlM,KAAK,mBAGjC,MAAOtD,SAOJ,QAASwJ,4BAA2B1H,IAEvC,GAAMvO,OAAQuO,GAAGqJ,UACjB,IAAM9M,UACN,KAAK,GAAI1M,GAAI,EAAGA,EAAI4B,MAAMc,OAAQ1C,IAAK,CACnC,GAAMie,QAAS9N,GAAGqJ,WAAWxZ,EAC7B,IAAIie,OAAOC,WAAwD,IAA3CD,OAAO3d,KAAKkC,QAAQ,mBAA0B,CAElEkK,OADYuR,OAAO3d,KAAKqC,QAAQ,kBAAmB,KACrCsb,OAAOpY,OAG7B,MAAO6G,QrBs2DsBrK,oBAAuB,EAAIuV,uBqB14D5DvV,oBAAA,EAAAwV,4BrBq7DM,SAAU9X,OAAQsC,oBAAqB1C,qBAE7C,YsBn7DO,SAASmY,+BAA8BlC,SAC1C,GAAMuI,YAAa,kBACnB,IAAMC,YAAaxI,QAAQjR,MAAM,KAAK,EACtC,KAAkC,IAA9ByZ,WAAW5b,QAAQ,MACnB,QAEJ,IAAMmC,OAAQyZ,WAAWzZ,MAAMwZ,WAC/B,OAAIxZ,OAAMjC,OAAS,EACRiC,MAAM7B,IAAI,SAACua,GAAD,OAAS/c,KAAM+c,EAAEjZ,YAE5B9D,KAAM8d,WAAWha,SAd/B/B,oBAAA,EAAAyV,+BtB+8DM,SAAU/X,OAAQsC,oBAAqB1C,qBAE7C,YuB38DO,SAASqY,mBAAkB9R,OAAQ3E,QACtC,MAAKA,QAGgB2E,OAAOpD,IAAI,SAAC+G,OAC7B,GAAMwU,aAAcxU,MAAMvJ,IAK1B,QAJwD,IAA9B+d,YAAY7b,QAAQ,OAE1CqH,MAAMvJ,KAAUiB,OAAhB,IAA0B8c,aAEvBxU,QARA3D,OAgBR,QAAS+R,kBAAiB3X,KAAM0U,OAAQgG,eAC3C,GAAMsD,eAAsC,IAAvBhe,KAAKkC,QAAQ,IAElC,IAAM+b,eAA0C,IAA1BvJ,OAAOxS,QAAQ,OAAegc,0BAA4BC,wBAChF,IAAMC,oBAAqBH,gBAAkBE,wBAEzCH,eAAgBI,qBAChBpe,QAAUie,cAAgBje,KAE9B,IAAMqe,kBAAmD,IAAhCre,KAAKkC,QAAQ+b,cAItC,QAHKD,cAAgBK,mBAAqB3D,gBACtC1a,KAAU0a,cAAV,IAA2B1a,MAExBA,KvB66DXG,OAAOC,eAAe2B,oBAAqB,cAAgBwD,OAAO,IACjCxD,oBAAuC,kBAAI2V,kBuBn9D5E3V,oBAAA,iBAAA4V,gBAqBA,IAAMuG,2BAA4B,aAClC,IAAMC,0BAA2B,cvBy+D3B,SAAU1e,OAAQsC,oBAAqB1C,qBAE7C,YACAc,QAAOC,eAAe2B,oBAAqB,cAAgBwD,OAAO,GAC7C,IAAIgG,sCAAuClM,oBAAoB,EACZA,qBAAoBmB,EAAE+K,qCACzE,IAAI+S,kDAAmDjf,oBAAoB,EwBlgEhG,IAAIkf,WAAY,SAAUC,MAAOC,UAAWC,YACxC,GAAIC,OA2BJ,OAzBIxe,QAAAoL,qCAAA,YAAWkT,WACXE,IAAItZ,MACAmZ,MAAOA,MACPnd,QAASod,UACTC,WAAYA,aAEThc,EAAE+H,cAAcgU,YAAcA,UAAUpd,SAC/Cod,UAAUD,MAAQA,MAClBC,UAAUC,WAAaA,WACvBC,IAAItZ,KAAKoZ,YACF/b,EAAE+H,cAAc+T,SAEnBA,MAAMnd,QACNsd,IAAItZ,KAAKmZ,OAGT9b,EAAEyW,KAAKqF,MAAO,SAAUxP,IAAK1K,KACzBqa,IAAItZ,MACAmZ,MAAOxP,IACP3N,QAASiD,IACToa,WAAYA,gBAKrBC,IAGX,IAAIC,gBAAiB,SAAUJ,MAAOC,WAClC,MAAIte,QAAAoL,qCAAA,UAASkT,UAAUD,OACZA,QAAUC,UAAUD,MACpBre,OAAAoL,qCAAA,YAAWkT,UAAUD,OACrBC,UAAUD,MAAMA,SAChBre,OAAAoL,qCAAA,UAASkT,UAAUD,QACnBC,UAAUD,MAAMrZ,MAAMqZ,OAKrC,IAAIzG,mBACA8G,SACID,eAAgBA,gBAGpBvb,QA2BAyb,SAAU,SAAUN,MAAOC,UAAWC,YAClC,GAAI9X,YAAa2X,UAAUC,MAAOC,UAAWC,WAC7C1V,MAAK3F,KAAOuD,WAAW5D,OAAOgG,KAAK3F,OAUvChB,QAAS,SAAUmc,MAAOC,WACtB,GAAIxZ,MACJ+D,MAAK3F,KAAKH,QAAQ,SAAU6b,iBAAkBrf,GAC1C,GAAIkf,eAAeJ,MAAOO,kBAEtB,MADA9Z,OAAQvF,GACD,IAGfsJ,KAAK3F,KAAK2b,OAAO/Z,MAAO,EAAGsZ,UAAUC,MAAOC,WAAW,KAG3DQ,aAAc,SAAUT,OACpB,GAAIU,MAAO/e,OAAAme,iDAAA,eAAcE,MACzBU,MAAK1Z,KAAO0Z,KAAK1Z,KAAKhD,IAAI8b,iDAAA,eAE1B,IAAIxB,MAAO3c,OAAAoL,qCAAA,MAAKvC,KAAK3F,KAAM,SAAUob,WACjC,MAAOG,gBAAeM,KAAKlf,KAAMye,YAErC,OAAI3B,OAAQoC,KAAK1Z,KACN9C,EAAEC,UAAWma,MAAQzb,QAAS8d,SAASC,KAAKtY,MAAMgW,KAAKzb,SAAU,MAAM2B,OAAOkc,KAAK1Z,SAEvFsX,MAWXzb,QAAS,SAAUkE,MAAOlC,MACtB,IAAKA,OAASA,KAAKjB,OACf,MAAOmD,MAEXlC,SAAWL,OAAOK,MAAOb,IAAI,SAACua,GAAD,MAAMA,GAAEjZ,QAErC,IAAIub,cAAe9Z,KACnB,IAAI+O,IAAKtL,IAET,IAAIsW,cAAe,SAAUb,UAAWna,IAAKib,eACzC,MAAOjb,KAAI9B,IAAI,SAAUua,GACrB,MAAO0B,WAAUpd,QAAQ0b,EAAGwC,iBAGpC,IAAIle,SAAU,SAAUod,UAAWlZ,MAAOga,eAOtC,MALI5U,OAAMC,QAAQrF,SAAmC,IAAzBkZ,UAAUC,WACtBY,aAAab,UAAWlZ,MAAOga,eAE/Bd,UAAUpd,QAAQkE,MAAOga,eAI7C,IAAIC,eAAgB,SAAUf,UAAWlZ,MAAOga,eAC5C,MAAOpf,QAAAoL,qCAAA,WAAUhG,MAAO,SAAUjB,KAC9B,MAAOjD,SAAQod,UAAWna,IAAKib,iBAcvC,OAXAlc,MAAKH,QAAQ,SAAUqc,eACnB,GAAId,WAAYnK,GAAG2K,aAAaM,cAChC,KAAKd,UACD,KAAM,IAAI/U,OAAM,gCAAkC6V,cAGlDF,cADA3c,EAAE+H,cAAc4U,gBAA0C,IAAzBZ,UAAUC,WAC5Bc,cAAcf,UAAWY,aAAcE,eAEvCle,QAAQod,UAAWY,aAAcE,iBAGjDF,cAUX7a,MAAO,SAAUe,MAAOlC,MACpB,IAAKA,OAASA,KAAKjB,OACf,MAAOmD,MAEXlC,SAAUL,OAAOK,MAAMqN,UAAUlO,IAAI,SAACua,GAAD,MAAMA,GAAEjZ,QAE7C,IAAIub,cAAe9Z,KACnB,IAAI+O,IAAKtL,IAUT,OATA3F,MAAKH,QAAQ,SAAUqc,eACnB,GAAId,WAAYnK,GAAG2K,aAAaM,cAChC,KAAKd,UACD,KAAM,IAAI/U,OAAM,mCAAqC6V,cAErDd,WAAUja,QACV6a,aAAeZ,UAAUja,MAAM6a,aAAcE,kBAG9CF,gBAOXhgB,oBAAQ,IACRA,oBAAQ,IACRA,oBAAQ,IACRA,oBAAQ,IACRA,oBAAQ,IACRA,oBAAQ,IACRA,oBAAQ,IACRA,oBAAQ,KAGMqR,UAAUxN,QAAQ,SAAUub,WACtC9T,MAAMC,QAAQ6T,WACdA,UAAUvb,QAAQ,SAAUpD,GACxBiY,iBAAiB+G,SAAShf,KAG9BiY,iBAAiB+G,SAASL,aAIlC1c,oBAAA,0BxBogEM,SAAUtC,OAAQD,QAASH,qBAEjC,YyB/sEAI,QAAOD,SACHgf,MAAO,IAcPnd,QAAS,SAAUkE,OACf,MAAOka,YAAWla,UzBouEpB,SAAU9F,OAAQD,QAASH,qBAEjC,Y0BrvEAI,QAAOD,SAeHuB,EAAG,SAAUuD,KACT,MAAOA,KAAM,IAgBjBob,UAAW,SAAUpb,KACjB,OAAQA,IAAM,IAAIqb,eAgBtBC,UAAW,SAAUtb,KACjB,OAAQA,IAAM,IAAIub,eAgBtBC,UAAW,SAAUxb,KAEjB,MADAA,MAAY,GACLA,IAAIjC,QAAQ,SAAU,SAAU0d,KACnC,MAAOA,KAAIhc,OAAO,GAAG4b,cAAgBI,IAAIC,OAAO,GAAGH,mB1B4wEzD,SAAUpgB,OAAQD,QAASH,qB2B/0EjC,QAAS4gB,gBAAeC,SAAUC,MAAO7b,KACrC,GAAI8b,SACJ,IAAyB,IAArBrZ,UAAU3E,OACVge,OACIC,MAAOF,MACPA,MAAOD,cAER,IAAyB,IAArBnZ,UAAU3E,OAMjB,KADAsC,SAAQC,MAAM,oCAAqCoC,WAC7C,GAAI2C,OAAM,oCALhB0W,QACIC,MAAOH,UAQf,MADAE,OAAMC,SAAWrd,OAAOod,MAAMC,OACvBD,MAnBX,GAAMpf,GAAI3B,oBAAQ,EAsBlB,IAAMgE,OAOFA,KAAM,SAACiB,KAAD,SAAWtB,OAAOsB,MAexBoM,QAAS,SAACpM,KAAD,SAAYtB,OAAOsB,KAAMoM,WAelC0L,KAAM,SAAU5b,EAAG8D,KACf,GAAMF,QAAS6b,eAAenZ,MAAM,KAAMC,UAC1C,IAAMuZ,UAAWlc,OAAOic,MAAM5P,QAAQrM,OAAO+b,OAAS,GACtD,OAAIG,UAASle,QAAU,EACZke,SAAS,GAEbA,UAgBXC,MAAO,SAAU/f,EAAG8D,KAChB,GAAMF,QAAS6b,eAAenZ,MAAM,KAAMC,UAC1C,IAAMuZ,UAAWlc,OAAOic,MAAM5P,MAAM,EAAIrM,OAAO+b,OAAS,EACxD,OAAIG,UAASle,QAAU,EACZke,SAAS,GAEbA,UAeXE,SAAU,SAAClc,KAEP,MADAA,QAAStB,OAAOsB,KACRA,IAAIlC,QAAU,EAAKkC,IAAI,GAAKA,IAAIA,IAAIlC,OAAS,IAYzDqe,KAAM,SAACC,KAAD,SAAW1d,OAAO0d,KAAKte,QAgB7Bue,UAAW,SAAUngB,EAAGogB,WAAYtc,KAQhC,MAPyB,KAArByC,UAAU3E,SAEVkC,IAAMsc,WACNA,WAAapgB,EAAI,GAErB8D,OAAStB,OAAOsB,KAChBA,IAAMA,IAAImM,MAAMmQ,YACTtc,IAAI2B,OAAO,SAAC3C,KAAM2B,OACrB,MAAQA,OAAQzE,GAAO,KAKnC,IAAM2C,QAAShD,OAAOgK,KAAK9G,MAAMb,IAAI,SAAUgc,OAC3C,GAAMqC,IAAKxd,KAAKmb,MAgBhB,QACIA,MAAOA,MACPE,YAAY,EACZrd,QAlBU,WACV,GAAMmE,MAAOxE,EAAE8f,QAAQ/Z,UACvB,IAAMga,oBAAqBvb,KAAKpD,OAAS,CACzC,IAAMkC,KAAMkB,KAAKub,mBACjB,OAAIre,GAAE+H,cAAcnG,KACTnE,OAAOgK,KAAK7F,KAAKkF,OAAO,SAACc,MAAO0E,KACnC,GAAMjM,KAAMuB,IAAI0K,IAChB,IAAMgS,SAAUxb,KAAKiL,OAGrB,OAFAuQ,SAAQD,oBAAsBhe,IAC9BuH,MAAM0E,KAAO6R,GAAG/Z,MAAM+Z,GAAIG,SACnB1W,WAGRuW,GAAG/Z,MAAM+Z,GAAI9Z,cAQ5BtH,QAAOD,QAAU2D,Q3B62EX,SAAU1D,OAAQD,S4BpiFxB,QAASyhB,WAAUC,UAAWC,QAASC,SAAUC,eAAgBhY,aAC7D,GAAMiY,WAAaH,SAAS,EAAMC,UAAU,EAC5C,QAAQra,UAAU3E,QACd,IAAK,GACD,MAAOM,GAAEC,OAAO2e,UAAYH,QAASA,QAASC,SAAUA,SAAUf,MAAOgB,gBAC7E,KAAK,GACD,MAAO3e,GAAEC,OAAO2e,UAAYH,QAASA,QAASC,SAAUA,SAAUf,MAAOe,UAC7E,KAAK,GACD,MAAO1e,GAAEC,OAAO2e,UAAYjB,MAAOc,QAASC,SAAUD,SAC1D,SACI,MAAOG,WAInB7hB,OAAOD,UAECgf,MAAO,KACPE,YAAY,EACZrd,QAAS,SAAU6f,WACf,GAAM1b,MAAOyb,UAAUna,MAAM,KAAMC,UACnC,OAAOvB,MAAK6a,QAAUa,UAAY1b,KAAK2b,QAAU3b,KAAK4b,a5B8iF5D,SAAU3hB,OAAQD,QAASH,qB6BhgFjC,QAASkiB,kBAAiB1c,KAEtB,OAA8C,KADvB,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,KACrC3C,QAAQ2C,IAAIf,Q7BgkFrC,GAAI8Q,U6BpkF2BvV,oBAAQ,GAA/BmiB,S7BqkFO5M,S6BrkFP4M,SAAUC,S7BskFH7M,S6BtkFG6M,QAOlBhiB,QAAOD,SAKHgf,MAAO,SAAUxe,MAKb,QAAS0hB,eAAc3E,GACnB,GAAM4E,kBAAmB,IAAK,IAAK,IACnC,IAAiB,IAAb5E,EAAE3a,OACF,OAAuC,IAAhCuf,gBAAgBzf,QAAQ6a,EAGnC,IAAM6E,kBAAmB,IAAK,IAAK,IAAK,IACxC,IAAMC,iBAAkB,IAAK,IAAK,IAE9BN,kBAAiBxE,EAAEhZ,OAAO,MAC1BgZ,EAAIA,EAAEtM,MAAM,GAEhB,IAAMqR,mBAA6D,IAA1CF,gBAAgB1f,QAAQ6a,EAAEhZ,OAAO,GAC1D,IAAMge,kBAAsE,IAApDF,eAAe3f,QAAQ6a,EAAEhZ,OAAOgZ,EAAE3a,OAAS,GAEnE,IAAiB,IAAb2a,EAAE3a,OACF,MAAO0f,mBAAoBC,eAG/B,IAAMC,sBAAuB,IAAK,IAAK,IAAK,IAC5C,IAAMC,6BAA8BlF,EAAEiD,OAAO,EAAGjD,EAAE3a,OAAS,GAAGiC,MAAM,IAAImF,OAAO,SAACc,MAAO4X,MAKnF,OAJuD,IAAvCF,oBAAoB9f,QAAQggB,QAExC5X,OAAQ,GAELA,QACR,EAEH,OAAOwX,mBAAoBC,iBAAmBE,4BAGlD,GAAME,OAAQniB,KAAKqE,MAAM,IACzB,OAAqB,KAAjB8d,MAAM/f,OACCsf,cAAcS,MAAM,IACH,IAAjBA,MAAM/f,OACNsf,cAAcS,MAAM,IACH,IAAjBA,MAAM/f,SACNsf,cAAcS,MAAM,KAAOT,cAAcS,MAAM,MAS9D3d,MAAO,SAAUF,KACbA,KAAO,EACP,IAAI8d,YAA+B,MAAlB9d,IAAIP,OAAO,EAE5BO,KAAMA,IAAIjC,QAAQ,KAAM,GACxB,IAAIggB,cAAe,mCACnB,IAAIC,SAAUD,aAAard,KAAKV,IAChC,IAAIie,OACJ,IAAInF,QAAS,EASb,QARIkF,SAAWA,QAAQ,KACnBC,OAASD,QAAQ,IAEjBA,SAAWA,QAAQ,KACnBlF,OAASkF,QAAQ,GAAGzC,eAIhBzC,QACJ,IAAK,IACDmF,QAAkB,GAClB,MACJ,KAAK,IACDA,QAAkB,GAClB,MACJ,KAAK,IACDA,QAAkB,GAClB,MACJ,KAAK,IACDA,QAAkB,IAQ1B,MAJAA,QAAS9C,WAAW8C,QAChBH,YAAcG,OAAS,IACvBA,SAAmB,GAEhBA,QAGXlhB,QAAU,SAAUkE,OAEhB,QAASid,SAAQjd,MAAOkd,QACpB,MAAOnT,MAAKoT,MAAMnd,MAAQ+J,KAAKqT,IAAI,GAAIF,SAAWnT,KAAKqT,IAAI,GAAIF,QAGnE,QAASG,WAAUrd,MAAOkd,QACtBld,MAAkB,IAAVA,MAAc,EAAIid,QAAQjd,MAAO+J,KAAKjE,IAAI,EAAGoX,OAASnT,KAAKuT,KAAKvT,KAAKjB,IAAI9I,OAAS+J,KAAKwT,OAE/F,IAAIC,KAAM,EACV,IAAIC,WAAYzd,MAAM0d,UACtB,IAAIC,aAAa,CAEjB,KAAK,GAAIC,MAAO,EAAGA,KAAOH,UAAU5gB,OAAQ+gB,OAQxC,GAPAJ,KAAOC,UAAUjf,OAAOof,MACO,MAA3BH,UAAUjf,OAAOof,MACjBD,YAAa,EAEbT,SAGAA,QAAU,EACV,MAAOM,IAOf,KAHKG,aACDH,KAAO,KAEJN,OAAS,GACZM,KAAO,IACPN,QAEJ,OAAOM,KAGX,QAASK,aAAY7d,MAAO8d,SAAUC,YAAaC,WAC/CA,YAAcA,SACd,IAAIP,WAAYzd,MAAM0d,UACtB,IAAIO,aAAeR,UAAU3e,MAAM,KAAKjC,OAAS,CACjD,IAAIqhB,MAAO,CAEX,IAAIF,UACA,IAAK,GAAIG,OAAQV,UAAU5gB,OAAS,EAAGshB,MAAQ,EAAGA,QAC1CF,YACAA,YAA2C,MAA5BR,UAAUjf,OAAO2f,OAGnB,KADbD,MAAQA,KAAO,GAAK,KAEhBT,UAAYA,UAAUhD,OAAO,EAAG0D,OAAS,IAAMV,UAAUhD,OAAO0D,OAMhF,IAAIL,SAAW,EAAG,CACd,GAAIM,MAUJ,KATIX,UAAU3e,MAAM,KAAKjC,QAAU,GAC/BuhB,MAAQL,aACI,IACRN,WAAa,KAGjBW,MAAQL,YAAcN,UAAU3e,MAAM,KAAK,GAAGjC,OAG3CuhB,MAAQ,GACXX,WAAa,IACbW,QAGR,MAAOX,WAGX,QAASY,WAAUC,WACfA,UAAYA,UAAUxhB,QAAQ,IAAK,GACnC,IAAIyhB,UAAWD,UAAUxf,MAAM,GAAI6G,QAAO,WAAY,KACtD,OAAQ4Y,UAAS1hB,OAAS,EAAK0hB,SAAS,GAAGb,WAAa,GAG5D,QAASc,QAAQxB,OAAQsB,WAIrB,GAHIlZ,MAAMC,QAAQ2X,UACdA,OAASA,OAAOA,OAAOngB,OAAS,KAE/Bof,SAASe,UAAYd,SAASc,QAC/B,MAAOA,OAGX,KAAKsB,WAAyC,YAA5BA,UAAUhE,cACxB,MAAO0C,QAAOU,UAGlB,IAAIe,MAAMzB,QACN,MAAO,GAIX,IAAM0B,oBACFC,SAAU,IACVC,WAAY,IACZC,SAAU,IACVC,UAAW,IACXC,QAAS,IAEbnkB,QAAOgK,KAAK8Z,mBAAmB/gB,QAAQ,SAACqhB,MACpCV,UAAYA,UAAUxhB,QAAQkiB,KAAMN,kBAAkBM,QAI1D,IAAIC,SAAUX,UAAUxf,MAAM,IAC9B,IAAImgB,QAAQpiB,OAAS,EACjB,MAAO2hB,QAAOzU,KAAKmV,IAAIlC,QAASiC,QAAUjC,QAAU,EAAK,EAAI,GAIjE,IAAImC,MAAQnC,QAAU,EAAK,GAAK,GAChCA,QAASjT,KAAKmV,IAAIlC,OAGlB,IAAIoC,eAAgBd,SACpB,IAAI9jB,GAAI4kB,cAAcziB,QAAQ,IAC1BnC,IAAK,IACL4kB,cAAgBA,cAAc3gB,UAAU,EAAGjE,GAG/C,IAAI6G,YAAa+d,cAAc9E,aAC/B,IAAI5a,OAAQ2B,WAAWge,YAAY,IACnC,IAAIC,eAAgB5f,OAAS,CAE7B,IAAI4f,cAAe,CAEE,MADFF,cAAc5gB,OAAOkB,MAAQ,KAExC4f,eAAgB,GAIxB,GAAIC,aAAcD,cAAgBhB,UAAU7f,UAAU,EAAGiB,OAAS,EAClE,IAAI8f,eAAgBF,cAAgBhB,UAAU7D,OAAO/a,MAAQ,GAAK4e,UAAU7D,OAAO/a,MAGnF,IAAI4f,cAAe,CACf,GAAIG,iBAAkB,SACtB,IAAIC,uBAAwBF,cAAc5f,MAAM6f,gBAC3CC,wBAA0D,IAAjCA,sBAAsB7iB,SAEhDyiB,eAAgB,EAChBC,YAAc,IAKtB,GAAID,cAAe,CACf,GAAIK,UAAsB,IAAX3C,OAAe,EAAIjT,KAAK6V,MAAM7V,KAAKjB,IAAIiB,KAAKmV,IAAIlC,UAAY,EAAIjT,KAAKwT,MAOpF,IANAoC,SAAa3C,OAASjT,KAAKqT,IAAI,GAAI,EAAIuC,UAAa,IAAQA,SAAYA,SAAW,EACnFA,SAAW5V,KAAKjE,IAAI6Z,SAAU,GAC9BA,SAAW5V,KAAKlE,IAAI8Z,SAAU,GAC9B3C,QAAkBjT,KAAKqT,IAAI,GAAI,EAAIuC,UAG9BlB,MAAMoB,OAAOL,kBAAmD,IAAhCA,cAAc7iB,QAAQ,KAapD,CAEH2hB,UAAYA,UAAU7D,OAAO/a,MAAQ,EACrC,IAAIogB,QAASzB,UAAUC,UACvBA,WAAYA,UAAU7D,OAAO,EAAG6D,UAAUzhB,OAASijB,OAAOjjB,OAE1D,IAAIkjB,mBAAoBvB,QAAkB,KAATW,KAAe,GAAK,GAAKnC,OAAQsB,WAAa0B,OAAOL,UAAYG,MAClG,OAAI9D,kBAAiBuD,cAAyB,KAATJ,MACjCY,kBAAoBA,kBAAkBtF,OAAO0E,KAAKtiB,QAC3CsiB,KAAOI,YAAcQ,mBAGzBR,YAAcQ,kBAxBrB,GAAIE,aAAcJ,OAAOL,cACzB,OAAIxC,QAASjT,KAAKqT,IAAI,GAAI6C,aAClBjE,iBAAiBuD,aACVJ,KAAOI,YAAclC,UAAUL,OAAQ6C,OAAOL,gBAAkBQ,OAAOL,UAEvEJ,YAAcJ,KAAO9B,UAAUL,OAAQ6C,OAAOL,gBAAkBQ,OAAOL,UAE3E3D,iBAAiBuD,aACjBJ,KAAOI,YAAcxV,KAAKoT,MAAMH,QAAUgD,OAAOL,UAEjDJ,YAAcJ,KAAOpV,KAAKoT,MAAMH,QAAUgD,OAAOL,UAkBpE,GAAIO,YAAa5B,UAAUxf,MAAM,IACjC,IAAIgf,SACJ,IAAIC,YACAmC,YAAWrjB,OAAS,GACpBihB,SAAWoC,WAAW,GAAGrjB,OAASqjB,WAAW,GAAGpjB,QAAQ,GAAI6I,QAAO,SAAU,KAAM,IAAI9I,OACvFkhB,YAAcmC,WAAW,GAAGrjB,OAASqjB,WAAW,GAAGpjB,QAAQ,GAAI6I,QAAO,KAAM,KAAM,IAAI9I,OACtFyhB,UAAY4B,WAAW,GAAKA,WAAW,GAAGpjB,QAAQ,GAAI6I,QAAO,SAAU,KAAM,KAE7EmY,SAAW,CAGf,IAAIS,UAAWD,UAAUxf,MAAM,GAAI6G,QAAO,WAAY,KACtD,IAAIwa,SAAU5B,SAAS,GAAGb,UAC1B,IAAI7F,QAAU0G,SAAS1hB,OAAS,EAAK0hB,SAAS,GAAGb,WAAa,EAY9D,OAVAV,SAAoBsB,UAAUxf,MAAM,KAAKjC,OAAS,EAAK,IAAM,EAE7DmgB,OAASC,QAAQD,OAAQc,WAEzBqB,KAAmB,IAAXnC,OAAgB,GAAKmC,MAGNgB,QAAUtC,YAAYb,OAAQc,SAAUC,YADgB,MAA9DO,UAAU7D,OAAO6D,UAAUzhB,OAAS,EAAIgb,OAAOhb,OAAQ,IACiBgb,OAjN7F,GAAImI,SAAU,GAAI,IAAK,IAAK,IAAK,IAuNjC,OAAOxB,a7B2kFT,SAAUtkB,OAAQD,QAASH,qBAEjC,Y8Bp6FA,SAAS4hB,WAAUd,MAAOgB,QAASC,SAAUC,eAAgBhY,aACzD,GAAIiY,WAAaH,SAAS,EAAMC,UAAU,EAC1C,QAAQra,UAAU3E,QACd,IAAK,GACD,MAAOM,GAAEC,OAAO2e,UAAYH,QAASA,QAASC,SAAUA,SAAUf,MAAOgB,gBAC7E,KAAK,GACD,MAAO3e,GAAEC,OAAO2e,UAAYH,QAASA,QAASC,SAAUA,SAAUf,MAAOe,UAC7E,KAAK,GACD,MAAO1e,GAAEC,OAAO2e,UAAYjB,MAAOc,QAASC,SAAUD,SAC1D,SACI,MAAOG,WAGnB7hB,OAAOD,SAmBHmmB,YAAa,SAAUxF,OACnB,GAAI3a,MAAOyb,UAAUna,MAAM,KAAMC,UACjC,OAAOqe,QAAO5f,KAAK6a,OAAS+E,OAAOjF,OAAS3a,KAAK2b,QAAU3b,KAAK4b,UAqBpEwE,iBAAkB,SAAUzF,OACxB,GAAI3a,MAAOyb,UAAUna,MAAM,KAAMC,UACjC,OAAOqe,QAAO5f,KAAK6a,QAAU+E,OAAOjF,OAAS3a,KAAK2b,QAAU3b,KAAK4b,UAsBrEyE,aAAc,SAAU1F,OACpB,GAAI3a,MAAOyb,UAAUna,MAAM,KAAMC,UACjC,OAAOqe,QAAO5f,KAAK6a,SAAW+E,OAAOjF,OAAS3a,KAAK2b,QAAU3b,KAAK4b,UAqBtE0E,SAAU,SAAU3F,OAChB,GAAI3a,MAAOyb,UAAUna,MAAM,KAAMC,UACjC,OAAOqe,QAAO5f,KAAK6a,OAAS+E,OAAOjF,OAAS3a,KAAK2b,QAAU3b,KAAK4b,UAqBpE2E,cAAe,SAAU5F,OACrB,GAAI3a,MAAOyb,UAAUna,MAAM,KAAMC,UACjC,OAAOqe,QAAO5f,KAAK6a,QAAU+E,OAAOjF,OAAS3a,KAAK2b,QAAU3b,KAAK4b,Y9Bq9FnE,SAAU3hB,OAAQD,S+BtmGxB,QAASyhB,WAAUE,QAASC,SAAUf,MAAOhX,aACzC,GAAIiY,WAAaH,SAAS,EAAMC,UAAU,EAC1C,QAAQra,UAAU3E,QACd,IAAK,GACD,MAAOM,GAAEC,OAAO2e,UAAYH,QAASA,QAASC,SAAUA,SAAUf,MAAOA,OAC7E,KAAK,GACD,MAAO3d,GAAEC,OAAO2e,UAAYH,QAASA,QAASC,SAAUA,SAAUf,MAAOe,UAC7E,SACI,MAAOE,WAInB7hB,OAAOD,SAcHwmB,OAAQ,SAACzgB,OAAD,QAAYA,OAapB0gB,IAAK,SAAC1gB,OAAD,OAAWA,OAiBhB2gB,OAAQ,WACJ,GAAI1gB,MAAOyb,UAAUna,MAAM,KAAMC,UACjC,OAAOvB,MAAK6a,MAAQ7a,KAAK2b,QAAU3b,KAAK4b,UAiB5C+E,QAAS,WACL,GAAI3gB,MAAOyb,UAAUna,MAAM,KAAMC,UACjC,OAAQvB,MAAK6a,MAAuB7a,KAAK4b,SAApB5b,KAAK2b,W/ByoG5B,SAAU1hB,OAAQD,QAASH,qBgC3uGjC,GAAM2B,GAAI3B,oBAAQ,EAElB,IAAMgE,OAYF4C,OAAQ,SAAUmgB,gBAAiB1R,QAE/B,MADAA,WAAY1R,OAAO0R,QACfhS,EAAE+H,cAAciK,OAAO,IAChB1T,EAAEiF,OAAOyO,OAAQ0R,iBAErB1R,OAAOzO,OAAO,SAAC8W,GAAD,MAAMA,KAAMqJ,mBAcrCC,OAAQ,SAAUC,cAAe5R,QAE7B,MADAA,WAAY1R,OAAO0R,QACfhS,EAAE+H,cAAciK,OAAO,IAChB1T,EAAEulB,OAAO7R,OAAQ4R,eAErB5R,OAAOzO,OAAO,SAAC8W,GAAD,MAAMA,KAAMuJ,iBAerCE,IAAK,SAAUjhB,MAAOmP,QAElB,MADAA,WAAY1R,OAAO0R,QACfhS,EAAE+H,cAAciK,OAAO,IAChB1T,EAAEylB,KAAK/R,OAAQnP,QAEQ,IAA3BmP,OAAOxS,QAAQqD,QAc1BmhB,MAAO,SAAUnhB,MAAOmP,QAEpB,MADAA,WAAY1R,OAAO0R,QACfhS,EAAE+H,cAAciK,OAAO,IAChB1T,EAAE0lB,MAAMhS,OAAQnP,OAEpBmP,OAAOzO,OAAO,SAAC8W,GAAD,MAAMA,KAAMxX,QAAOnD,SAAWsS,OAAOtS,QAGlE,IAAMyX,YAAa1Z,OAAOgK,KAAK9G,MAAMb,IAAI,SAACxC,MACtC,OACIwe,MAAOxe,KACP0e,YAAY,EACZrd,QAASgC,KAAKrD,QAItBP,QAAOD,QAAUqa,YhCuvGX,SAAUpa,OAAQsC,oBAAqB1C,qBAE7C,YACAc,QAAOC,eAAe2B,oBAAqB,cAAgBwD,OAAO,GAC7C,IAAIgG,sCAAuClM,oBAAoB,EACZA,qBAAoBmB,EAAE+K,qCiCv0G9F,IAAMgT,WAAY,SAAU5J,SAAUzO,SAYlC,MAXKyO,YACDA,SAAW,KAEXxU,OAAAoL,qCAAA,YAAWrF,WACXA,SACIyO,SAAUA,SACV6E,OAAQtT,UAIhBA,QAAQyO,SAAWA,SACZzO,QAQX,IAAMf,OAAQ,SAAU8F,QAAS0b,MAC7B,MAAIxmB,QAAAoL,qCAAA,UAASN,SACFA,UAAY0b,KAAKhS,SAErBjS,EAAEuI,SAASqN,GAAGqO,KAAKhS,UAG9B,IAAMqD,cACF3U,QAQAyb,SAAU,SAAUnK,SAAUzO,SAC1B8C,KAAK3F,KAAKwG,QAAQ0U,UAAU5J,SAAUzO,WAO1CmT,WAAY,SAAU1E,UAClB,MAAO3L,MAAK3F,KAAKuE,KAAK,SAAU+e,MAC5B,MAAOxhB,OAAMwP,SAAUgS,SAI/BtkB,QAAS,SAAUsS,SAAUzO,SACzB,GAAIjB,aACJ+D,MAAK3F,KAAKH,QAAQ,SAAU0jB,eAAgBlnB,GACxC,GAAIiV,WAAaiS,eAAejS,SAE5B,MADA1P,OAAQvF,GACD,IAGfsJ,KAAK3F,KAAK2b,OAAO/Z,MAAO,EAAGsZ,UAAU5J,SAAUzO,aAMnD7G,oBAAQ,IAAyBoX,QACjCpX,oBAAQ,IACRA,oBAAQ,KAEIqR,UAAUxN,QAAQ,SAAUgD,SACxC8R,YAAY8G,SAAS5Y,QAAQyO,SAAUzO,WAG3CnE,oBAAA,qBjCo1GM,SAAUtC,OAAQsC,oBAAqB1C,qBAE7C,YACAc,QAAOC,eAAe2B,oBAAqB,cAAgBwD,OAAO,GAC7C,IAAIshB,mDAAoDxnB,oBAAoB,GAC5E,IAAIynB,2DAA4DznB,oBAAoBmB,EAAEqmB,kDACtF,IAAIE,sCAAuC1nB,oBAAoB,EAC/D,IAAI2nB,8CAA+C3nB,oBAAoBmB,EAAEumB,qCkC76G9F,IAAME,SAAUD,6CAAArf,EAAOrG,MAAMC,gBAE7BQ,qBAAA,QAAe+kB,0DAAAnf,EAAShF,QACpBqR,oBAIAE,WAAY,WACR,GAAMlD,KAAMhI,KAAKgI,GACjB,IAAMkW,YAAalW,IAAIK,KAAK4V,QAC5B,IAAME,WAAUD,gBAAoC,KAAfA,aAA8BA,UAEnE,IAAME,WAAYpW,IAAIK,KAAK,QAE3B,IAAMgW,QAASD,eAAkC,KAAdA,WAA6BpW,IAAIsL,KAAK,QAGzE,OADatL,KAAIsH,GAAG,YAAe+O,MAAQF,QAG/C9S,WAAY,WACRyS,0DAAAnf,EAAS/G,UAAUyT,WAAWvN,MAAMkC,KAAMjC,cAE7C4N,SAAU,sBlCm7GT,SAAUlV,OAAQsC,oBAAqB1C,qBAE7C,YACAc,QAAOC,eAAe2B,oBAAqB,cAAgBwD,OAAO,GmC/8GlE,IAAAgG,sCAAAlM,oBAAA,EAAAA,qBAAAmB,EAAA+K,qCA4CA,IAAM+b,kBACFjoB,oBAAQ,IAAgBoX,QACxBpX,oBAAQ,IAA+BoX,QACvCpX,oBAAQ,IAA6BoX,QACrCpX,oBAAQ,IAA4BoX,QACpCpX,oBAAQ,IAAgBoX,QACxBpX,oBAAQ,IAAkBoX,QAC1BpX,oBAAQ,IAA0BoX,QAClCpX,oBAAQ,IAA0BoX,QAClCpX,oBAAQ,IAAoCoX,QAC5CpX,oBAAQ,IAA2BoX,QACnCpX,oBAAQ,IAA6BoX,QACrCpX,oBAAQ,IAAkBoX,QAG9B,IAAM8Q,gBAEN,IAAMhJ,WAAY,SAAUiJ,iBAAkBC,YAAavhB,SASvD,MARKuhB,eACDA,YAAc,KAEdtnB,OAAAoL,qCAAA,YAAWrF,WACXA,SACIsT,OAAQtT,UAGTxD,EAAEC,OAAOuD,SAAWhC,KAAMsjB,iBAAkB1L,OAAQ2L,cAG/DH,iBAAgBpkB,QAAQ,SAAUgD,SAC9BqhB,aAAaliB,KAAKkZ,UAAUrY,QAAQhC,KAAMgC,QAAQ4V,OAAQ5V,WAI9D,IAAMwhB,WAAY,SAAUC,UAAWtW,KAAML,KACzC,GAAI4W,iBAUJ,OARIznB,QAAAoL,qCAAA,UAASoc,WACTC,UAA2B,MAAdD,WAAsBA,UAAU9H,gBAAkBxO,KAAKwO,cAC7D1f,OAAAoL,qCAAA,YAAWoc,WAElBC,UAAYD,UAAUtW,KAAML,KACrB7Q,OAAAoL,qCAAA,UAASoc,aAChBC,UAAYvW,KAAKlM,MAAMwiB,YAEpBC,UAGX,IAAMC,WAAY,SAAU/L,OAAQgM,YAChC,MAAQ3nB,QAAAoL,qCAAA,UAASuc,YAAgBA,aAAehM,OAAUgM,WAAWxP,GAAGwD,QAG5E,IAAMiM,mBACF1kB,KAAMkkB,aASNzI,SAAU,SAAU0I,iBAAkBC,YAAavhB,SAC/CqhB,aAAa1d,QAAQ0U,UAAUzX,MAAM,KAAMC,aAW/Cd,OAAQ,SAAU+hB,WAAYF,YAC1B,GAAIG,UAAWV,aAAathB,OAAO,SAAUC,SACzC,MAAOwhB,WAAUxhB,QAAQhC,KAAM8jB,aAOnC,OALIF,cACAG,SAAWA,SAAShiB,OAAO,SAAUC,SACjC,MAAO2hB,WAAU3hB,QAAQ4V,OAAQgM,eAGlCG,UAWX5lB,QAAS,SAAU2lB,WAAYF,WAAY5hB,SACvC,GAAIjB,aACJ9E,QAAAoL,qCAAA,MAAKgc,aAAc,SAAUX,eAAgBlnB,GACzC,GAAIgoB,UAAUd,eAAe1iB,KAAM8jB,aAAeH,UAAUjB,eAAe9K,OAAQgM,YAE/E,MADA7iB,OAAQvF,GACD,IAGf6nB,aAAavI,OAAO/Z,MAAO,EAAGsZ,UAAUyJ,WAAYF,WAAY5hB,WAWpEmT,WAAY,SAAU1Y,SAAUqQ,KAG5B,MAFiBhI,MAAK/C,OAAOtF,SAAUqQ,KAEvB,IAIxBjP,qBAAA,0BnCw8GM,SAAUtC,OAAQsC,oBAAqB1C,qBAE7C,YoC9mHAc,QAAAC,eAAA2B,oBAAA,cAAAwD,OAAA,GAUA,IAAM2iB,WAEFpM,OAAQ,IAER5X,KAAM,sCAENsV,OAAQ,aACRhV,MAAO,qBAGXzC,qBAAA,kBpCsnHM,SAAUtC,OAAQsC,oBAAqB1C,qBAE7C,YACAc,QAAOC,eAAe2B,oBAAqB,cAAgBwD,OAAO,GAC7C,IAAI4iB,sCAAuC9oB,oBAAoB,EACZA,qBAAoBmB,EAAE2nB,qCACzE,IAAIC,iDAAkD/oB,oBAAoB,EqC1oH/F,IAAMgpB,mBAEFvM,OAAQ,IAER5X,KAAM,SAAUmN,MACZ,MAAgC,KAAxBA,KAAKnP,QAAQ,QAGzBoX,OAAQ,SAAUjI,KAAML,KACpB,GAAMsX,WAAYjX,KAAKhP,QAAQ,MAAO,GACtC2O,KAAIoD,IAAIkU,YAGZ9jB,MAAO,qBACPgV,OAAQ,aAERiB,KAAM,SAAUpJ,KAAMzL,OAAQoL,KAC1B,GAAMsX,WAAYjX,KAAKhP,QAAQ,MAAO,GACtC,IAAMkmB,UAAW3iB,OAAO,IAAMA,OAAO,GAAG5F,IACxCgR,KAAIoD,IAAIkU,WAAW9T,GAAG8T,UAAW,SAAU1M,KACvCA,IAAI4M,gBACJ,IAAIC,kBAAmBtoB,OAAAioB,gDAAA,qBAAoBG,SAC3CvX,KAAI5P,QAAQ+mB,qCAAA,OAAO/mB,SAAW6B,KAAMwlB,iBAAkB/T,OAAQrD,UAK1EtP,qBAAA,0BrCupHM,SAAUtC,OAAQsC,oBAAqB1C,qBAE7C,YAUA,SAAS0P,iBAAgB7E,IAAK8E,IAAKzJ,OAAiK,MAApJyJ,OAAO9E,KAAO/J,OAAOC,eAAe8J,IAAK8E,KAAOzJ,MAAOA,MAAOjF,YAAY,EAAMD,cAAc,EAAM4O,UAAU,IAAkB/E,IAAI8E,KAAOzJ,MAAgB2E,IAT3M/J,OAAOC,eAAe2B,oBAAqB,cAAgBwD,OAAO,GAC7C,IAAImjB,iDAAkDrpB,oBAAoB,EAC1E,IAAIspB,uCAAwCtpB,oBAAoB,EACZA,qBAAoBmB,EAAEmoB,sCAC1E,IAAIC,gDAAiDvpB,oBAAoB,GACzE,IAAIwpB,+CAAgDxpB,oBAAoB,EACxE,IAAIypB,sCAAuCzpB,oBAAoB,EACZA,qBAAoBmB,EAAEsoB,qCACzE,IAAIC,oDAAqD1pB,oBAAoB,GsC1rHlG,IAAM2pB,eAAgB,GAAIlV,QAK1B,IAAMmV,cAEF/kB,KAAM,UAEN4X,OAAQ,IAERxC,OAAQ,SAAUjI,KAAML,KACpB,GAAMnB,IAAKmB,IAAIzQ,IAAI,EACnByoB,eAAcnV,OAAOhE,GAErB,IAAM0C,UAAWpS,OAAA4oB,mDAAA,GAAoB/X,IACrC,IAAMS,SAAUT,IAAIU,MAChBa,WAAYd,UAAYc,UACxBvB,IAAIU,KAAKa,UAEbpS,OAAA4oB,mDAAA,GAAsB/X,KACtB7Q,OAAA4oB,mDAAA,GAAgB/X,MAGpBxM,MAAO,SAAUoB,QACb,MAAOzF,QAAAyoB,+CAAA,GAAYhjB,SAGvB4T,OAAQ,SAAUjU,MAAO+W,KAAMtL,IAAKpL,QAChCL,MAAS7C,EAAE+H,cAAclF,OAASA,SAAWvC,OAAOuC,MADZ,IAAA2jB,oBAGP/oB,OAAAyoB,+CAAA,GAAkBhjB,OAAQL,OAAnDyQ,SAHgCkT,mBAGhClT,SAAUC,WAHsBiT,mBAGtBjT,UAElB,IAAMxC,cAAetT,OAAA4oB,mDAAA,GAAoB/X,IAAK,SAACA,KAAD,MAAQA,KAAIU,QAC1D,IAAMO,WAAY9R,OAAA4oB,mDAAA,GAAkB/X,IACpC,IAAM8B,mBAAoB3S,OAAA4oB,mDAAA,GAAsBtV,cAAeuC,SAAUC,YAAYjT,OAAO7C,OAAOgK,KAAK8H,YACxG,IAAMkX,iBAAkBhpB,OAAA4oB,mDAAA,GAAsBtV,aAAcX,kBAE5D,IAAMsW,YAAajpB,OAAA2oB,qCAAA,UAASK,gBAC5B,IAAME,UAAW3mB,EAAE,cACnBvC,QAAA2oB,qCAAA,MAAKvjB,MAAO,SAAU+jB,QAASC,SAAS,GAAAC,eACpBzY,KAAZuY,SAAqC,OAAZA,UACzBA,SAAoB,GAExB,IAAMG,cAAe/mB,EAAEC,QAAO,KAAUsP,WAAnBuX,aAAAza,gBAAAya,UAChBxT,SAAWuT,SADKxa,gBAAAya,UAEhBvT,WAAaqT,SAFGE,WAKrB,IAAI5P,aACJ,IAAIpH,mBACJ,KACI,GAAMkX,WAAYN,WAAWK,aAC7B,IAAME,yBAA0BxpB,OAAA4oB,mDAAA,GAAyBW,UAAW5W,kBACpEN,aAAcmX,0BAA4BR,gBAC1CvP,MAAQlX,EAAEinB,yBACZ,MAAOllB,GACLmV,MAAQlX,EAAEymB,iBACV3W,aAAc,EACdrS,OAAA4oB,mDAAA,GAAqBrmB,EAAEkX,OAAQ6P,cAGnC7P,MAAMT,KAAK,SAAUzZ,EAAGkqB,SACpB,GAAMC,UAAWnnB,EAAEknB,QACnBzpB,QAAA2oB,qCAAA,MAAKe,SAAS5mB,OAAQ,SAAUqB,IAAK0K,KACjC6a,SAAS5mB,KAAK+L,IAAK7O,OAAAuoB,gDAAA,gBAAepkB,QAEjCkO,aAAgBqX,SAASnY,OAAO5N,QACjC+lB,SAASnY,KAAK4X,WAGtBD,SAASS,OAAOlQ,QAGpB,IAAM/J,IAAKmB,IAAIzQ,IAAI,EACnB,IAAMwpB,gBAAiBf,cAAczoB,IAAIsP,GACzC,IAAMma,gBAAiB7pB,OAAA0oB,8CAAA,GAAuB7X,IAAIiZ,WAAYZ,SAASY,WAAYF,cAAepB,sCAAA,UAClG3X,KAAIkZ,QAAQJ,OAAOE,gBAEnBhB,cAAcrV,IAAI9D,IAAI,IAI9B9N,qBAAA,qBtC8sHM,SAAUtC,OAAQsC,oBAAqB1C,qBAE7C,YAWA,SAAS0P,iBAAgB7E,IAAK8E,IAAKzJ,OAAiK,MAApJyJ,OAAO9E,KAAO/J,OAAOC,eAAe8J,IAAK8E,KAAOzJ,MAAOA,MAAOjF,YAAY,EAAMD,cAAc,EAAM4O,UAAU,IAAkB/E,IAAI8E,KAAOzJ,MAAgB2E,IAV3M/J,OAAOC,eAAe2B,oBAAqB,cAAgBwD,OAAO,GAC7C,IAAIgG,sCAAuClM,oBAAoB,EACZA,qBAAoBmB,EAAE+K,qCACzE,IAAI6c,iDAAkD/oB,oBAAoB,EAC1E,IAAIoH,6CAA8CpH,oBAAoB,EACtE,IAAI8qB,uCAAwC9qB,oBAAoB,EACZA,qBAAoBmB,EAAE2pB,sCAC1E,IAAIC,+CAAgD/qB,oBAAoB,EACxE,IAAI0pB,oDAAqD1pB,oBAAoB,GAC7E,IAAIgrB,gDAAiDhrB,oBAAoB,GuCjzH9F,IAAMirB,gBAAiBH,sCAAA,MAAM3oB,OAAOC,UAIpC,IAAMunB,eAAgB,GAAIlV,QAS1B,IAAMyW,kBACFrmB,KAAM,SAEN4X,OAAQ,IAERxC,OAAQ,SAAUjI,KAAML,KACpB,GAAIrH,IAAKqH,IAAI/N,KAAKqnB,eACd3gB,KACAqH,IAAIwZ,UAAU,cAAgB7gB,GAAK,MAAM8gB,QAI7C,IAAM5a,IAAKmB,IAAIzQ,IAAI,EACnByoB,eAAcnV,OAAOhE,GAErB,IAAM4D,cAAetT,OAAA4oB,mDAAA,GAAoB/X,IACzC,IAAMS,SAAUT,IAAIzQ,IAAI,GAAGuP,SACvB2D,eAAgBhC,UAAYgC,cAC5BzC,IAAI0Z,YAAYjX,cAEpBtT,OAAA4oB,mDAAA,GAAsB/X,KACtB7Q,OAAA4oB,mDAAA,GAAgB/X,MAGpBxM,MAAO,SAAUoB,QACb,MAAOzF,QAAAkqB,+CAAA,GAAYzkB,SAGvB4T,OAAQ,SAAUjU,MAAO+W,KAAMtL,IAAKpL,QAChCL,MAAS7C,EAAE+H,cAAclF,OAASA,SAAWvC,OAAOuC,MACpD,IAAIoE,IAAKqH,IAAI/N,KAAKqnB,eAElB,IAAM7W,cAAetT,OAAA4oB,mDAAA,GAAoB/X,IAAK,SAACA,KAAD,MAAQA,KAAIzQ,IAAI,GAAGuP,WAEjE,IAAM6a,cAAejoB,EAAE,cACvB,IAAIiH,GAAI,CACJ,GAAMihB,UAAW5Z,IAAIwZ,UAAU,cAAgB7gB,GAAK,MAAM8gB,QAC1DE,cAAab,OAAOc,cAEpBjhB,IAAKxJ,OAAAsG,4CAAA,GAAO,WACZuK,IAAIK,KAAK,QAAUiZ,eAAgB3gB,GAZC,IAAAuf,oBAeP/oB,OAAAkqB,+CAAA,GAAkBzkB,OAAQL,OAAnDyQ,SAfgCkT,mBAehClT,SAAUC,WAfsBiT,mBAetBjT,UAElB,IAAMhE,WAAY9R,OAAA4oB,mDAAA,GAAkB/X,IACpC,IAAM8B,mBAAoB3S,OAAA4oB,mDAAA,GAAsBtV,cAAeuC,SAAUC,YAAYjT,OAAO7C,OAAOgK,KAAK8H,YACxG,IAAMkX,iBAAkBhpB,OAAA4oB,mDAAA,GAAsBtV,aAAcX,kBAE5D,IAAMsW,YAAajpB,OAAAoL,qCAAA,UAAS4d,gBAC5B,IAAI/M,KACJjc,QAAAoL,qCAAA,MAAKhG,MAAO,SAAU+jB,QAASC,SAAS,GAAAC,eACpBzY,KAAZuY,SAAqC,OAAZA,UACzBA,SAAoB,GAExB,IAAMG,cAAe/mB,EAAEC,QAAO,KAAUsP,WAAnBuX,aAAAza,gBAAAya,UAChBxT,SAAWuT,SADKxa,gBAAAya,UAEhBvT,WAAaqT,SAFGE,WAKrB,IAAI5P,aACJ,IAAIpH,mBACJ,KACI,GAAMkX,WAAYN,WAAWK,aAC7B,IAAME,yBAA0BxpB,OAAA4oB,mDAAA,GAAyBW,UAAW5W,kBACpEN,aAAcmX,0BAA4BR,gBAC1CvP,MAAQlX,EAAEinB,yBACZ,MAAOllB,GACLmV,MAAQlX,EAAEymB,iBACV3W,aAAc,EACdrS,OAAA4oB,mDAAA,GAAqBrmB,EAAEkX,OAAQ6P,cAGnC,GAAIoB,SAAuB,OAAZvB,aAAgCvY,KAAZuY,OACnC1P,OAAMT,KAAK,SAAUzZ,EAAGkqB,SACpB,GAAMC,UAAWnnB,EAAEknB,QACnBC,UAAS1Y,WAAW,iBAAiBA,WAAW,QAAUmZ,gBAC1DnqB,OAAAoL,qCAAA,MAAKse,SAAS5mB,OAAQ,SAAUqB,IAAK0K,KAC5BoN,KAGDyN,SAAS5mB,KAAK+L,IAAK7O,OAAAioB,gDAAA,gBAAe9jB,MAFlC0M,IAAI/N,KAAK+L,IAAK7O,OAAAioB,gDAAA,gBAAe9jB,QAKrCulB,SAASxY,KAAK,QAAU1H,IAAI,GACvB6I,aAAgBqX,SAASI,WAAW7nB,SAAUyoB,SAC/ChB,SAASnY,KAAK4X,QAAU,MAM5BlN,KAHCA,KAGMxC,MAAMkR,YAAY1O,MAFlBpL,IAAIU,KAAKkI,MAAMlI,SAM9B,IAAMtB,SAAUY,IAAIwZ,UAAJ,eAA6B7gB,GAA7B,MAEhB,IAAMkG,IAAKmB,IAAIzQ,IAAI,EACnB,IAAMwpB,gBAAiBf,cAAczoB,IAAIsP,GACzC1P,QAAAiqB,8CAAA,GAAuBO,aAAaV,WAAY7Z,QAAS2Z,cAAeI,sCAAA,WAExEnB,cAAcrV,IAAI9D,IAAI,IAI9B9N,qBAAA,yBvCi0HM,SAAUtC,OAAQsC,oBAAqB1C,qBAE7C,YwCz7He,SAAS0rB,aAAYzmB,KAMhC,GAAIA,IAAIoC,KACJ,MAAOpC,IAEX,IAAM0mB,MAAOtoB,EAAEyF,UACf,IAAIhI,OAAAoL,qCAAA,YAAWjH,KACX,IACI,GAAMgd,UAAWhd,KACjB,IAAIgd,UAAYA,SAAS5a,KACrB,MAAO4a,UAAS5a,KAAK,SAACmF,GAAD,MAAMmf,MAAK5iB,QAAQyD,KAAIof,MAAO,SAACxmB,GAAD,MAAMumB,MAAKzE,OAAO9hB,IAEzEumB,MAAK5iB,QAAQkZ,UACf,MAAO7c,GACLumB,KAAKzE,OAAO9hB,OAGhBumB,MAAK5iB,QAAQ9D,IAEjB,OAAO0mB,MAAKxkB,UxCm6HiBzE,oBAAuB,EAAIgpB,WACvC,IAAIxf,sCAAuClM,oBAAoB,EACZA,qBAAoBmB,EAAE+K,uCAuCxF,SAAU9L,OAAQsC,oBAAqB1C,qBAE7C,YyCj+He,SAAS6rB,kBAAiBrK,GAAIsK,iBAAkBC,mBAC3D,GAAIC,OAAQ,IACZ,IAAIL,MAAO,IACX,IAAIhU,MAAO,IAEX,IAAIsU,cACJ,KAAKF,kBAAmB,CAOpBA,mBANmB,SAAU9gB,MAAOihB,QAIhC,MAHKjhB,SACDA,UAEGA,MAAMtH,OAAOuoB,UAU5B,MAAO,YACH,GAAIvK,SAAU7gB,OAAAoL,qCAAA,SAAQxE,UA8CtB,OA7CAukB,YAAatK,QAAQxe,IAAI,SAAUgpB,IAAKvmB,OACpC,GAAIwmB,SAAUL,kBAAkBnmB,MAChC,OAAIwmB,SACOA,QAAQH,WAAWrmB,OAAQumB,KAE3BA,MAGXH,OACAK,aAAaL,OAGZL,OACDA,KAAOtoB,EAAEyF,WACT6O,KAAOgU,KAAKxkB,WAEhB6kB,MAAQ1Z,WAAW,WACf0Z,MAAQ,IACR,IAAIM,IACJ,KACIA,IAAM9K,GAAG/Z,MAAM+Z,GAAIyK,YACrB,MAAO7mB,GACL6mB,cACAN,KAAKzE,OAAO9hB,GAEhB,GAAIknB,KAAOA,IAAIjlB,KACX,MAAOilB,KAAIjlB,KAAK,SAAU8kB,KACtBF,cACAN,KAAK5iB,QAAQojB,MACd,SAAC/mB,GACA6mB,cACAN,KAAKzE,OAAO9hB,IAGhB6mB,eACAN,KAAK5iB,QAAQujB,MAElBR,kBACHnU,KAAKtQ,KAAK,SAACmF,GAEP,MADAmf,MAAOhU,KAAO,KACPnL,GACR,SAAC+f,KAEA,KADAZ,MAAOhU,KAAO,KACR4U,MAEH5U,MzC85HkBjV,oBAAuB,EAAImpB,gBACvC,IAAI3f,sCAAuClM,oBAAoB,EACZA,qBAAoBmB,EAAE+K,uCAmFxF,SAAU9L,OAAQsC,oBAAqB1C,qBAE7C,Y0ChkIA,SAASwsB,oBAAmB7a,KACxB,GAAMnB,IAAKmB,IAAIzQ,IAAI,EACnB,IAAMurB,cAAeC,aAAaxrB,IAAIsP,GAClCic,eACA9a,IAAIgb,YAAYF,c1C6jIxB3rB,OAAOC,eAAe2B,oBAAqB,cAAgBwD,OAAO,GAC7C,IAAIgG,sCAAuClM,oBAAoB,EACZA,qBAAoBmB,EAAE+K,qC0CpkI9F,IAAMwgB,cAAe,GAAIjY,QAWzB,IAAMmY,YACF/nB,KAAM,QAEN4X,OAAQ,IAGRxC,OAAQ,SAAUjI,KAAML,KACpB,GAAMnB,IAAKmB,IAAIzQ,IAAI,EACnBsrB,oBAAmB7a,KACnB+a,aAAalY,OAAOhE,KAGxB2J,OAAQ,SAAUjU,MAAO+W,KAAMtL,KACvBrG,MAAMC,QAAQrF,SACdA,MAAQA,MAAMA,MAAMnD,OAAS,GAGjC,IAAMyN,IAAKmB,IAAIzQ,IAAI,EACnBsrB,oBAAmB7a,KAEf7Q,OAAAoL,qCAAA,UAAShG,SACTA,MAAQ,SAAWA,OAEvBoM,WAAW,WACPX,IAAIkb,SAAS3mB,QACd,GACHwmB,aAAapY,IAAI9D,GAAItK,QAI7BxD,qBAAA,mB1C0kIM,SAAUtC,OAAQsC,oBAAqB1C,qBAE7C,Y2CvnIAc,QAAAC,eAAA2B,oBAAA,cAAAwD,OAAA,GAGA,IAAM4mB,qBACFrQ,OAAQ,IAER5X,KAAM,oIAENsV,OAAQ,SAAUjU,MAAO+W,KAAMtL,KACvBrG,MAAMC,QAAQrF,SACdA,MAAQA,MAAMA,MAAMnD,OAAS,GAEjC,IAAMkC,KAAO0M,IAAIK,KAAK,SAAa9L,OAASyL,IAAIsL,KAAK,WAAc/W,KACnEyL,KAAIsL,KAAKA,KAAMhY,MAIvBvC,qBAAA,4B3C6nIM,SAAUtC,OAAQsC,oBAAqB1C,qBAE7C,Y4ChpIAc,QAAAC,eAAA2B,oBAAA,cAAAwD,OAAA,GAGA,IAAM6mB,gBACFloB,KAAM,SAEN4X,OAAQ,IAERrB,KAAM,SAAUpJ,KAAM9L,MAAOyL,KACzBA,IAAIqb,QAGR7S,OAAQ,SAAUjU,MAAO+W,KAAMtL,KAI3B,MAHIrG,OAAMC,QAAQrF,SACdA,MAAQA,MAAMA,MAAMnD,OAAS,IAEzBmD,QAAS,GAAGA,OAAQzB,OAAUkN,IAAIsb,OAAStb,IAAIqb,QAI/DtqB,qBAAA,uB5CspIM,SAAUtC,OAAQsC,oBAAqB1C,qBAE7C,Y6C5qIAc,QAAAC,eAAA2B,oBAAA,cAAAwD,OAAA,GAGA,IAAMgnB,gBACFroB,KAAM,SAEN4X,OAAQ,IAERrB,KAAM,SAAUpJ,KAAM9L,MAAOyL,KACzBA,IAAIqb,QAER7S,OAAQ,SAAUjU,MAAO+W,KAAMtL,KACvBrG,MAAMC,QAAQrF,SACdA,MAAQA,MAAMA,MAAMnD,OAAS,IAE7BmD,QAAS,GAAGA,OAAQzB,OACpBkN,IAAIqb,OAEJrb,IAAIsb,QAKhBvqB,qBAAA,uB7CkrIM,SAAUtC,OAAQsC,oBAAqB1C,qBAE7C,Y8C3sIAc,QAAAC,eAAA2B,oBAAA,cAAAwD,OAAA,GAGA,IAAMinB,sBAEF1Q,OAAQ,mBAER5X,KAAM,OAENsV,OAAQ,SAAUjU,MAAO+W,KAAMtL,KACvBrG,MAAMC,QAAQrF,SACdA,MAAQA,MAAMA,MAAMnD,OAAS,GAEjC,IAAMqqB,eAAgBzb,IAAIK,KAAK,QAC/B,IAAMqb,eAAsC,KAAlBD,cAAkCA,eAAiBlnB,QAAWA,KACxFyL,KAAIsL,KAAK,UAAWoQ,YAI5B3qB,qBAAA,6B9CitIM,SAAUtC,OAAQsC,oBAAqB1C,qBAE7C,Y+CtuIAc,QAAAC,eAAA2B,oBAAA,cAAAwD,OAAA,GAGA,IAAMonB,gBACF7Q,OAAQ,0BAER5X,KAAM,OAENsV,OAAQ,SAAUjU,MAAO+W,KAAMtL,SACbD,KAAVxL,MACAA,MAAQ,GACDoF,MAAMC,QAAQrF,SACrBA,MAAQA,MAAMA,MAAMnD,OAAS,IAEjC4O,IAAI1M,IAAIiB,MAAQ,KAIxBxD,qBAAA,uB/C4uIM,SAAUtC,OAAQsC,oBAAqB1C,qBAE7C,YgDtvIA,SAASutB,YAAWhnB,QAChB,OAAQA,YAAc4D,OAAO,SAACc,MAAOf,OAEjC,MADAe,OAAMf,MAAMvJ,MAAQuJ,MAAMiV,MACnBlU,WAIf,QAASuiB,eAAcC,gBAAiBvnB,MAAOyL,IAAKpL,QAChD,IAAKzF,OAAA4sB,mDAAA,GAAYD,iBACb,MAAO3sB,QAAA6sB,0CAAA,GAA0BznB,MAGrC,IAAMkkB,cAAetpB,OAAA6sB,0CAAA,GAA2BznB,MAAOqnB,WAAWhnB,QAClE,IAAMqM,WAAY9R,OAAA4sB,mDAAA,GAAkB/b,IACpCtO,GAAEC,OAAO8mB,aAAcxX,UAEvB,IAAMa,mBAAoB3S,OAAA4sB,mDAAA,GAAsBD,gBAAiB3sB,OAAOgK,KAAKsf,cAC7E,IAAMN,iBAAkBhpB,OAAA4sB,mDAAA,GAAsBD,gBAAiBha,kBAE/D,IAAMsW,YAAajpB,OAAAoL,qCAAA,UAAS4d,gBAC5B,KACI,GAAM8D,eAAgB7D,WAAWK,aAEjC,OADgCtpB,QAAA4sB,mDAAA,GAAyBE,cAAena,mBAE1E,MAAOrO,GAEL,MADAtE,QAAA4sB,mDAAA,GAAqB/b,IAAKyY,cACnBqD,iBhD6tIf3sB,OAAOC,eAAe2B,oBAAqB,cAAgBwD,OAAO,GAC7C,IAAIgG,sCAAuClM,oBAAoB,EACZA,qBAAoBmB,EAAE+K,qCACzE,IAAI2hB,+CAAgD7tB,oBAAoB,EACxE,IAAI8tB,sCAAuC9tB,oBAAoB,EACZA,qBAAoBmB,EAAE2sB,qCACzE,IAAIH,2CAA4C3tB,oBAAoB,GACpE,IAAI0tB,oDAAqD1tB,oBAAoB,GgDhwIlG,IAAM2pB,eAAgB,GAAIlV,QAmC1B,IAAMsZ,kBAEFtR,OAAQ,IAER5X,KAAM,OAENM,MAAO,SAAUoB,QACb,MAAOA,QAAOpD,IAAI,SAAC+G,OACf,GAAM+L,SAAU/L,MAAMvJ,IACtB,QACIA,KAAMG,OAAA6sB,0CAAA,GAAoB1X,SAC1BkJ,MAAOre,OAAA6sB,0CAAA,GAAa1X,aAchCgE,OAAQ,SAAUjI,KAAML,KACpB,GAAMnB,IAAKmB,IAAIzQ,IAAI,EACnByoB,eAAcnV,OAAOhE,GAErB,IAAMwd,cAAeltB,OAAA4sB,mDAAA,GAAoB/b,IACzC,IAAMS,SAAUT,IAAIU,MAChB2b,eAAgB5b,UAAY4b,cAC5Brc,IAAIU,KAAK2b,cAEbltB,OAAA4sB,mDAAA,GAAsB/b,KACtB7Q,OAAA4sB,mDAAA,GAAgB/b,MAGpBwI,OAAQ,SAAUjU,MAAO+W,KAAMtL,IAAKpL,QAChC,GAAMiK,IAAKmB,IAAIzQ,IAAI,EACnB,IAAM+sB,kBAAmBntB,OAAA4sB,mDAAA,GAAoB/b,IAAK,SAACA,KAAD,MAAQA,KAAIU,QAC9D,IAAMhC,UAAWmd,cAAcS,iBAAkB/nB,MAAOyL,IAAKpL,OAE7DzF,QAAA+sB,8CAAA,GAAqBlc,IAAKtB,UAAWsZ,cAAcnU,IAAIhF,IAAKsd,qCAAA,WAC5DnE,cAAcrV,IAAI9D,IAAI,IAI9B9N,qBAAA,yBhDgxIM,SAAUtC,OAAQsC,oBAAqB1C,qBAE7C,YiD72IO,SAASkuB,2BAA0BhoB,OAKtC,MAJIoF,OAAMC,QAAQrF,SACdA,MAAQA,MAAMA,MAAMnD,OAAS,IAEjCmD,MAAS7C,EAAE+H,cAAclF,OAAUhB,KAAK6N,UAAU7M,OAASA,MAAQ,GAShE,QAASioB,4BAA2BjoB,MAAOkoB,UAC9C,GAAMhE,eAAiBlkB,MAAOA,MAa9B,OAZI7C,GAAE+H,cAAclF,OAChBpF,OAAOgK,KAAK5E,OAAOrC,QAAQ,SAACwqB,cACxB,GAAMlP,OAAQiP,SAASC,eAAiBA,YACxCjE,cAAajL,OAASjZ,MAAMmoB,gBAGhCvtB,OAAOgK,KAAKsjB,UAAUvqB,QAAQ,SAACwqB,cAC3B,GAAMlP,OAAQiP,SAASC,eAAiBA,YACxCjE,cAAajL,OAASjZ,QAIvBkkB,aASJ,QAASpU,qBAAoBC,SAChC,GAAMqY,SAAUrY,QAAQxR,OAAOqB,MAAMyoB,SAErC,QADgBD,SAAWA,QAAQ,GAAKA,QAAQ,GAAKrY,SACtCxR,OAOZ,QAAS+pB,cAAavY,SACzB,GAAMqY,SAAUrY,QAAQxR,OAAOqB,MAAMyoB,SAErC,QADcD,SAAWA,QAAQ,GAAKA,QAAQ,GAAKrY,SACtCxR,OjD6zIgB/B,oBAAuB,EAAIwrB,0BAC3BxrB,oBAAuB,EAAIyrB,2BAC3BzrB,oBAAuB,EAAIsT,oBAC3BtT,oBAAuB,EAAI8rB,YiDn1I5D,IAAMD,UAAW,0BjD04IX,SAAUnuB,OAAQsC,oBAAqB1C,qBAE7C,YkD16IAc,QAAAC,eAAA2B,oBAAA,cAAAwD,OAAA,GAGA,IAAMuoB,cACF5pB,KAAM,IAEN4X,OAAQ,IAERtC,OAAQ,SAAUjU,MAAO+W,KAAMtL,KAK3BA,IAAIsL,KAAKA,KAAM/W,QAIvBxD,qBAAA,qBlDg7IM,SAAUtC,OAAQsC,oBAAqB1C,qBAE7C,YmDn8IAc,QAAAC,eAAA2B,oBAAA,cAAAwD,OAAA,IAOAxD,oBAAA,iBAAyB+Z,OAAQvF,WAAYwX,WACzC,GAAgC,mBAArBC,kBAAX,CAIA,GAAIC,UAAW,GAAID,kBAAiB,SAAUE,WAC1CA,UAAUhrB,QAAQ,SAAUirB,UACxB,GAAIC,OAAQ1rB,EAAEyrB,SAASE,YAAYzmB,KAAK,KACxCwmB,OAAQA,MAAM7V,IAAI7V,EAAEyrB,SAASE,YAAYpoB,OAAO,MAChD,IAAIqoB,SAAU5rB,EAAEyrB,SAASI,cAAc3mB,KAAK,KAC5C0mB,SAAUA,QAAQ/V,IAAI7V,EAAEyrB,SAASI,cAActoB,OAAO,OAClDmoB,OAASA,MAAMhsB,QACfmU,WAAWW,QAAQkX,OAEnBE,SAAWA,QAAQlsB,QACnBmU,WAAWU,UAAUqX,SAEM,mBAA3BH,SAASK,gBACTjY,WAAWU,UAAUkX,SAASrS,QAC9BvF,WAAWW,QAAQiX,SAASrS,YAIxC,IAAI2S,YACAvV,YAAY,EACZwV,iBAAkB,kBAClBC,WAAW,EACXC,SAAS,EACTC,eAAe,EAEnB,IAAIC,YACAC,OAAQ,WACJd,SAASe,QAAQlT,OAAQ2S,YAE7BQ,QAAS,WACLhB,SAASiB,cAMjB,OAHInB,YACAe,UAAUC,SAEPD,anD08IL,SAAUrvB,OAAQsC,oBAAqB1C,qBAE7C,YoDp/Ie,SAASmX,gBAAe3J,MACnC,GAAMsiB,uBAAwBC,8CAAA,EAAkBA,8CAAA,EAChD,IAAMC,QAASxiB,MAAQA,KAAKwiB,OAASxiB,KAAKwiB,SAI1C,OAHW,IAAIC,sCAAqC5sB,EAAEC,QAAO,MACzD0sB,UAAWrsB,OAAOqsB,OAAQF,uBAC3BtiB,OpDg/IP1M,OAAOC,eAAe2B,oBAAqB,cAAgBwD,OAAO,IACjCxD,oBAA6B,QAAIyU,cAC7C,IAAI+Y,gDAAiDlwB,oBAAoB,GACzE,IAAImwB,uDAAwDnwB,oBAAoB,EAChF,IAAI+vB,+CAAgD/vB,oBAAoB,GACxE,IAAIowB,6DAA8DpwB,oBAAoB,GoD3/I3G,IAAMiwB,sCAAuCnvB,OAAAsvB,4DAAA,GAAetvB,OAAAsvB,4DAAA,GAASF,+CAAA,EAAuBC,sDAAA,KpD+gJtF,SAAU/vB,OAAQsC,oBAAqB1C,qBAE7C,YAQA,SAASqwB,iBAAgBC,SAAUC,aAAe,KAAMD,mBAAoBC,cAAgB,KAAM,IAAIC,WAAU,qCqDthJhH,QAASC,UAASlqB,OAAQ/C,SAAUgD,SAChC,GAAI8D,IAAKxJ,OAAA4vB,qCAAA,UAAS,QAClB,IAAI1jB,WACAyO,OAAO,EAoBPkV,OAAO,EAEX,IAAInjB,MAAOojB,6CAAAtoB,EAAEhF,UAAW0J,SAAUxG,QAClC,KAAKhD,WAAa1C,OAAA4vB,qCAAA,YAAWltB,UACzB,KAAM,IAAI6G,OAAM,0CAEpB,OAAOumB,8CAAAtoB,EAAEhF,QAAO,GACZgH,GAAIA,GACJ/D,UAAW5C,OAAO4C,QAClB/C,SAAUA,UACXgK,MAqBP,QAASqjB,mBAAkBC,aAAcltB,MACrC,GAAI0G,IAAKwmB,aAAaxmB,EAGtBwmB,cAAattB,SAASI,MAAQ0G,GAAIA,KAQtC,QAASymB,qBAAoBxqB,OAAQuqB,cACjC,GAAMloB,aAAc9H,OAAAkwB,6CAAA,GAAoBzqB,OACxC,IAAM0qB,gBAAiBnwB,OAAA4vB,qCAAA,cAAa5vB,OAAOgK,KAAKlC,aAAckoB,aAAavqB,OAC3E,IAAK0qB,eAAeluB,OAApB,CAGA,GAAMmuB,yBAA0BD,eAAe9mB,OAAO,SAACc,MAAOf,OAE1D,MADAe,OAAMf,OAAStB,YAAYsB,OACpBe,UAGX,IAAMkmB,mBAAoBC,cAAcN,aAAaxmB,OACrD,IAAM+mB,kBAAmBT,6CAAAtoB,EAAEhF,QAAO,KAAU6tB,kBAAmBD,wBAE3DJ,cAAaH,QACbS,cAAcN,aAAaxmB,IAAM+mB,iBAETvwB,QAAA4vB,qCAAA,cAAa5vB,OAAOgK,KAAKumB,kBAAmBP,aAAavqB,QAAQxD,SAAW+tB,aAAavqB,OAAOxD,QAExH8tB,kBAAkBC,aAAcO,mBASxC,QAASC,gBAAe/qB,OAAQuqB,cAC5BvqB,OAAO1C,QAAQ,SAAUqG,OACrB,GAAIpJ,OAAA4vB,qCAAA,UAASI,aAAavqB,OAAQ2D,MAAMvJ,OAASG,OAAA4vB,qCAAA,UAASI,aAAavqB,OAAQ,KAAM,CACjF,GAAIgrB,UACJA,QAAOrnB,MAAMvJ,MAAQuJ,MAAMhE,MAC3B2qB,kBAAkBC,aAAcS,WAS5C,QAASC,uBAAsBC,iBAC3B,MAAOA,iBAAgBtnB,OAAO,SAAUc,MAAOwO,MAE3C,MADAxO,OAAQA,MAAMtH,OAAO8V,KAAKlT,arDi6Ib,GAAImrB,sCAAuC1xB,oBAAoB,GAC/D,IAAI4wB,8CAA+C5wB,oBAAoBmB,EAAEuwB,qCACzE,IAAIV,8CAA+ChxB,oBAAoB,EACvE,IAAI0wB,sCAAuC1wB,oBAAoB,EACZA,qBAAoBmB,EAAEuvB,qCAC9F,IAAIiB,cAAe,WAAc,QAASC,kBAAiBnV,OAAQoV,OAAS,IAAK,GAAIxxB,GAAI,EAAGA,EAAIwxB,MAAM9uB,OAAQ1C,IAAK,CAAE,GAAIyxB,YAAaD,MAAMxxB,EAAIyxB,YAAW7wB,WAAa6wB,WAAW7wB,aAAc,EAAO6wB,WAAW9wB,cAAe,EAAU,SAAW8wB,cAAYA,WAAWliB,UAAW,GAAM9O,OAAOC,eAAe0b,OAAQqV,WAAWniB,IAAKmiB,aAAiB,MAAO,UAAUvB,YAAa7a,WAAYC,aAAiJ,MAA9HD,aAAYkc,iBAAiBrB,YAAYhvB,UAAWmU,YAAiBC,aAAaic,iBAAiBrB,YAAa5a,aAAqB4a,eqDh/IhiB,IAAIa,iBACJ,IAAIW,oBrDqnJJ,IqDpiJM5a,gBrDoiJe,WqDniJjB,QAAAA,gBAAY3Q,SAAS6pB,gBAAA1mB,KAAAwN,gBACjBxN,KAAK6P,iBrDgpJT,MA/FAmY,cAAaxa,iBACTxH,IAAK,UACLzJ,MAAO,SqD1iJHgE,MAAOhE,MAAOM,SAAS,GAAAkD,OAAAC,IAC3B,IAAIpC,YAAazG,OAAAkwB,6CAAA,GAAsB9mB,MAAOhE,MAAOM,QACrD,IAAImR,MAAOiZ,6CAAAtoB,EAAEQ,WAAWC,QAAQxB,WAAW8D,QAAQlE,SAKnD,OAJAwQ,MAAOA,KAAKtQ,KAAK,SAAC2qB,kBAEd,MADAtoB,OAAKuF,OAAO+iB,iBAAkBxrB,SACvBwrB,sBrDijJXriB,IAAK,SACLzJ,MAAO,SqD7iJJgE,MAAOhE,MAAOM,SACjB,GAAIe,YAAazG,OAAAkwB,6CAAA,GAAsB9mB,MAAOhE,MAAOM,QAErD,OAAOmD,MAAK6P,cAAc3V,QAAQ,SAAU4V,OAC/BA,KAAKgC,MAAQsV,oBAAsBO,gBACzC/pB,WAAW8D,OAAQoO,WrDyjJ1B9J,IAAK,YACLzJ,MAAO,SqDhjJDK,OAAQ0rB,GAAIzrB,SAClB,GAAIiT,MAAOgX,SAASlqB,OAAQ0rB,GAAIzrB,QAIhC,cAHO4qB,eAAc3X,KAAKnP,UACnBynB,kBAAiBtY,KAAKnP,IAC7BX,KAAK6P,cAAgB7P,KAAK6P,cAAc7V,OAAO8V,MACxCA,KAAKnP,MrDwjJZqF,IAAK,cACLzJ,MAAO,SqDljJCgsB,OACR,GAAIC,aAAcxoB,KAAK6P,cAAczW,MACrC,IAAIqvB,WAAYzoB,KAAK6P,cAAc5S,OAAO,SAAU6S,MAChD,MAAOA,MAAKnP,KAAO4nB,OAEvB,IAAIE,UAAUrvB,SAAWovB,YACrB,KAAM,IAAI9nB,OAAM,mCAAqC6nB,aAElDd,eAAcc,aACdH,kBAAiBG,OACxBvoB,KAAK6P,cAAgB4Y,arDqjJrBziB,IAAK,iBACLzJ,MAAO,WqDnjJPkrB,iBACAW,oBACApoB,KAAK6P,oBrD4jJL7J,IAAK,sBACLzJ,MAAO,WqDrjJP,MADWpF,QAAA4vB,qCAAA,MAAKc,sBAAsB7nB,KAAK6P,mBrDikJ3C7J,IAAK,iBACLzJ,MAAO,SqD1jJIgE,OACX,MAAIA,OACOP,KAAK6P,cAAc5S,OAAO,SAAU6S,MACvC,MAAO3Y,QAAA4vB,qCAAA,UAASjX,KAAKlT,OAAQ2D,SAG9BP,KAAK6P,kBrD8jJTrC,iBqD1jJXzU,qBAAA,kBrDikJM,SAAUtC,OAAQD,SsDzxJxBC,OAAAD,QAAAkyB,QtD+xJM,SAAUjyB,OAAQsC,oBAAqB1C,qBAE7C,YuDzxJO,SAASsyB,iBAAgBpoB,MAAO5D,SAAUisB,cAC7C,IAAK,GAAIlyB,GAAI,EAAGA,EAAIiG,SAASvD,OAAQ1C,IAAK,CACtC,GAAImyB,aAAclsB,SAASjG,EAC3B,IAAIyF,OAAQ0sB,YAAY1sB,MAAMoE,MAAOqoB,aACrC,KAAc,IAAVzsB,MACA,MAAOzC,GAAEC,QAAO,KAAUkvB,aAAetrB,QAASpB,SAYvD,QAAS2sB,iBAAgBlsB,OAAQD,UACpCA,SAAWA,SAASnD,IAAI,SAAU2E,EAAGlC,OAEjC,MADAkC,GAAE6H,IAAM/J,MACDkC,GAEX,IAAI4qB,iBAAmB/uB,OAAO4C,QAAS4D,OAAO,SAAUc,MAAOf,OAC3D,GAAIyoB,aAAcL,gBAAgBpoB,MAAO5D,SACzC,IAAIqsB,YAAa,CAEb,GAAIhjB,KAAMgjB,YAAYhjB,IAAMgjB,YAAYzrB,OACnC+D,OAAM0E,OACPgjB,YAAY/uB,QACZqH,MAAM0E,KAAOgjB,aAEjB1nB,MAAM0E,KAAK/L,KAAKoC,KAAKkE,OAEzB,MAAOe,WAEX,OAAO2nB,8CAAAtqB,EAAEuqB,OAAOH,cASb,QAASI,6BAA4BlvB,KAAM0C,UAmB9C,MAlBAA,UAAWA,SAASnD,IAAI,SAAU2E,EAAGlC,OAEjC,MADAkC,GAAE6H,IAAM/J,MACDkC,IAEGlE,KAAKuG,OAAO,SAAUc,MAAO8nB,QACvC,GAAIC,aAAc/nB,MAAMA,MAAMlI,OAAS,EACvC,IAAI4vB,aAAcL,gBAAgBS,OAAOpyB,KAAM2F,UAAU,EAUzD,OATIqsB,aACIK,aAAeL,YAAYhjB,MAAQqjB,YAAYrjB,IAC/CqjB,YAAYpvB,KAAKoC,KAAK+sB,QAEtB9nB,MAAMjF,KAAK3C,EAAEC,UAAWqvB,aAAe/uB,MAAOmvB,WAGlD9nB,MAAMjF,MAAOpC,MAAOmvB,QAAS7rB,SAAS,IAEnC+D,WAWR,QAASgoB,4BAA2BC,SAAU3sB,QAEjD,OAAiBmL,KAAbwhB,SACA,QAGJ,IADqC5nB,MAAMC,QAAQ2nB,aAAeA,SAASnwB,YAA+B2O,KAArBwhB,SAAS,GAAGvyB,MAE7F,MAAOuyB,SAEX,IAAwB,gBAAbA,YAA0B5nB,MAAMC,QAAQ2nB,UAC/C,MAAO3sB,QAAO4D,OAAO,SAACc,MAAOhB,GAEzB,MADAgB,OAAMjF,MAAOrF,KAAMsJ,EAAG/D,MAAOgtB,SAASjpB,KAC/BgB,UAGf,IAAsB,IAAlB1E,OAAOxD,OAAc,CAErB,QAAUpC,KADG4F,OAAO,GACEL,MAAOgtB,WAEjC,KAAM,IAAI7oB,OAAM,0CvDgsJa3H,oBAAuB,EAAI+vB,gBAC3B/vB,oBAAuB,EAAIowB,4BAC3BpwB,oBAAuB,EAAIuwB,0BACvC,IAAI/mB,sCAAuClM,oBAAoB,EAC/D,IAAI4yB,8CAA+C5yB,oBAAoBmB,EAAE+K,uCAyGxF,SAAU9L,OAAQsC,oBAAqB1C,qBAE7C,YwD74Je,SAASmzB,YAAW9pB,UAAW+pB,eAC1C,OAAsB,IAAlBA,eAA2B/pB,UAEpBiC,MAAMC,QAAQ6nB,eACd/pB,UAAUzC,OAAO,SAAChD,MAErB,SADoD,IAAtCwvB,cAAcvwB,QAAQe,KAAKjD,SAGtCyyB,eAAiBA,cAAcpM,OAC/B3d,UAAUzC,OAAO,SAAChD,MAErB,OADmE,KAApDwvB,cAAcpM,YAAcnkB,QAAQe,KAAKjD,QAIzD0I,aAnBX3G,oBAAA,EAAAywB,YxD46JM,SAAU/yB,OAAQsC,oBAAqB1C,qBAE7C,YyDt6Je,SAASqzB,iBAAgBC,YAAaC,iBAIjD,GAHIzyB,OAAAoL,qCAAA,YAAWqnB,mBACXA,gBAAkBA,oBAEE,IAApBA,gBAEA,MADAluB,SAAQC,MAAM,yCAA0CguB,eAG5D,IAAIhoB,MAAMC,QAAQgoB,iBAAkB,CAChC,GAAMvuB,OAAQsuB,YAAYnpB,OAAO,SAACc,MAAOrH,MAOrC,OAN2D,IAAxC2vB,gBAAgB1wB,QAAQe,KAAKjD,MAE5CsK,MAAM/B,SAASlD,KAAKpC,MAEpBqH,MAAMmnB,UAAUpsB,KAAKpC,MAElBqH,QACN/B,YAAckpB,cAKnB,OAHIptB,OAAMkE,SAASnG,QACfsC,QAAQmuB,KAAK,8BAA+BxuB,MAAMkE,UAE/ClE,MAAMotB,UAEjB,MAAOkB,azD+4JsB5wB,oBAAuB,EAAI2wB,eACvC,IAAInnB,sCAAuClM,oBAAoB,EACZA,qBAAoBmB,EAAE+K,uCAsCxF,SAAU9L,OAAQsC,oBAAqB1C,qBAE7C,YACqB,IAAIyzB,4CAA6CzzB,oBAAoB,GACzDA,qBAAoBU,EAAEgC,oBAAqB,IAAK,WAAa,MAAO+wB,4CAA8C,GAC9H,IAAIC,iDAAkD1zB,oBAAoB,GAC9DA,qBAAoBU,EAAEgC,oBAAqB,IAAK,WAAa,MAAOgxB,iDAAmD,KAMlJ,SAAUtzB,OAAQsC,oBAAqB1C,qBAE7C,Y0Dn+JO,SAAS8F,OAAMoE,OAElB,MAAyB,gBADZpJ,QAAAuoB,gDAAA,gBAAenf,QACQ,G1Dm+JnB,GAAImf,iDAAkDrpB,oBAAoB,E0Dh+J/F0C,qBAAA,GACIoD,MAAOA,MACPnF,KAAM,aACNmG,iBAAkB,SAAUP,QAOxB,MANeA,QAAOpD,IAAI,SAAC8G,GACvB,OACItJ,KAAMsJ,EACN/D,MAAOpF,OAAAuoB,gDAAA,gBAAepf,S1Di/JhC,SAAU7J,OAAQsC,oBAAqB1C,qBAE7C,Y2Dn/JA,SAAS2zB,YAAWnmB,KAAMmC,KACtB,GAAI1C,gBAAiB5J,EAAEC,QAAO,KAAUkK,KAAKR,SAAUQ,KAAKmC,KAC5D,IAAIzC,gBAAiB7J,EAAEC,QAAO,KAAU2J,eAAeC,eAGvD,cAFOD,gBAAeC,gBAEbD,eAAgBA,eAAgBC,eAAgBA,gB3D++JxC,GAAI0mB,mDAAoD5zB,oBAAoB,GAC5E,IAAI6zB,wDAAyD7zB,oBAAoB,GACjF,IAAI8zB,kDAAmD9zB,oBAAoB,GAC3E,IAAI+zB,qDAAsD/zB,oBAAoB,GAC9E,IAAIg0B,4CAA6Ch0B,oBAAoB,GACrE,IAAIi0B,6DAA8Dj0B,oBAAoB,EACtF,IAAIk0B,sEAAuEl0B,oBAAoB,EAC/F,IAAIm0B,uDAAwDn0B,oBAAoB,E2D/+JrG,IAAIo0B,mBAAoB,uCAAuCrxB,MAC/D,IAAIsxB,YAAa,QAAUD,kBAAoB,IAE/C1xB,qBAAA,WAAyBqK,OAAQtD,SAAU6qB,uBACvC,GAAI9mB,MAAOnK,EAAEC,QAAO,KAAUyJ,OAE9B,IAAIwnB,sBAAuBZ,WAAWnmB,KAAM,QAC5C,IAAIgnB,kBAAmB,GAAIV,kDAAA,EAAgBS,qBAAsB9qB,SACjE,IAAIgrB,aAAc,GAAIT,4CAAA,EAAWO,qBAAsBzzB,OAAAmzB,4DAAA,GAAWxqB,SAAU,QAAS6qB,sBAIrF,IAAIhuB,WACAjD,EAAEC,UAAWkxB,kBACT7zB,KAAM,YACNmF,MAAOhF,OAAAozB,qEAAA,GAAWG,YAClB7tB,QAAS+tB,qBAAqBrnB,iBAElC7J,EAAEC,UAAWmxB,aACT9zB,KAAM,cACNmF,MAAOhF,OAAAozB,qEAAA,GAAY,SACnB1tB,QAAS+tB,qBAAqBrnB,iBAOtC,IAAIwnB,aAEJ,IAAIC,gBAAiBhB,WAAWnmB,KAAM,aACtC,IAAIA,KAAKonB,aAAgBpnB,KAAKqnB,iBAAmBF,eAAe1nB,eAAeuK,IAAM,CACjF,GAAIsd,GACJ,IAAMC,eAA2D,gBAA3CJ,eAAe1nB,eAAe+nB,QAChDxnB,MAAKqnB,iBACLC,GAAK,GAAIlB,mDAAA,EAAiBe,eAAgB7zB,OAAAmzB,4DAAA,GAAWxqB,SAtChD,QAuCLnD,SAASN,KAAK3C,EAAEC,UAAWwxB,IACvBn0B,KAAM,MACNmF,MAAOhF,OAAAozB,qEAAA,GAzCN,OA0CD1tB,QAASmuB,eAAeznB,mBAErB6nB,eAEPD,GAAK,GAAIf,qDAAA,EAAmBY,eAAgB7zB,OAAAmzB,4DAAA,GAAWxqB,UA7C9C,SA6CuE,MAChFnD,SAASN,KAAK3C,EAAEC,UAAWwxB,IACvBn0B,KAAM,YACNmF,MAAOhF,OAAAozB,qEAAA,GAhDF,UAiDL3qB,WAAW,EACX/C,QAASmuB,eAAeznB,oBAG5B4nB,GAAK,GAAIlB,mDAAA,EAAiBe,eAAgB7zB,OAAAmzB,4DAAA,GAAWxqB,UAtDhD,MAsDuE,MAC5EnD,SAASN,KAAK3C,EAAEC,UAAWwxB,IACvBn0B,KAAM,MACNmF,MAAOhF,OAAAozB,qEAAA,GAzDN,OA0DD3qB,WAAW,EACX/C,QAASmuB,eAAeznB,mBAIhC7J,EAAEC,OAAOoxB,UAAWI,GAAG/qB,QAG3B,GAAIyD,KAAKqnB,gBAAiB,CACtB,GAAII,qBAAsBtB,WAAWnmB,KAAM,kBAC3C,IAAI0nB,IAAK,GAAIrB,wDAAA,EAAeoB,oBAAqBn0B,OAAAmzB,4DAAA,GAAWxqB,UArE9C,MAqE0E,KACxFnD,UAASN,KAAK3C,EAAEC,UAAW4xB,IACvBv0B,KAAM,WACNmF,MAAOhF,OAAAozB,qEAAA,GAxEG,OAyEV1tB,QAASyuB,oBAAoB/nB,eAC7B3D,WAAW,KAGflG,EAAEC,OAAOoxB,UAAWQ,GAAGnrB,QAG3B,GAAIorB,iBAAkBr0B,OAAAqzB,sDAAA,GAAO7tB,SAAUmD,SAGvC,OAFA0rB,iBAAgBprB,OAAS2qB,UAElBS,kB3DwgKL,SAAU/0B,OAAQsC,oBAAqB1C,qBAE7C,YACqB,IAAIo1B,2CAA4Cp1B,oBAAoB,EACpE,IAAIq1B,6DAA8Dr1B,oBAAoB,EACtF,IAAIs1B,uDAAwDt1B,oBAAoB,EAChF,IAAIu1B,sEAAuEv1B,oBAAoB,EAOpH,IAAIw1B,S4DxnKU9nB,OAANC,E5DynKA6nB,Q4DznKA7nB,C5D8nKqBjL,qBAAuB,EAAI,S4D1nK/BqK,OAAQtD,UAC7B,GAAMuD,WACFC,kBACAC,kBAEJ,IAAMM,MAAOnK,EAAEC,QAAO,KAAU0J,SAAUD,OAE1C,IAAM0oB,WAAYjoB,KAAKP,cACvB,IAAM6nB,IAAK,GAAInnB,GAAE+nB,QAAQC,WAAWF,UAEpC,IAAMG,kBAAmBd,GAAGe,SAASxuB,KAAK,SAACmQ,KACvC,MAAOsd,IAAGtd,KAEd,IAAMse,oBAAqBzyB,EAAEC,QAAO,GAC9B2J,eAAgB2oB,kBAAoBpoB,KAAKR,SAAUQ,KAAK4E,QAC9D,IAAM2jB,mBAAoB,GAAIX,2CAAA,EAAWU,mBAAoBh1B,OAAAu0B,4DAAA,GAAW5rB,UAjBzD,WAiBgF,KAE/F,IAAMusB,iBAAkB3yB,EAAEC,OAAOyyB,mBAC7BjwB,MAAOhF,OAAAy0B,qEAAA,GApBI,YAqBX50B,KAAM,cACN4I,WAAW,EACX/C,QAASsvB,mBAAmB5oB,gBAEhC,IAAM5G,WACF0vB,gBAGJ,IAAMC,iBAAkBn1B,OAAAw0B,sDAAA,GAAOhvB,SAG/B,OAFA2vB,iBAAgBlsB,QAAW6qB,WAAYE,IAEhCmB,kB5D4nKL,SAAU71B,OAAQsC,oBAAqB1C,qBAE7C,Y6DnqKe,SAASk2B,gBAAeC,mBAAoB1sB,UAEvD,QAAS2sB,cAAaC,QAASC,iBAK3B,SAJiB3yB,OAAO2yB,iBAAkBnsB,OAAO,SAAUc,MAAOsC,MAE9D,MADAtC,OAAMjF,MAAOrF,KAAM4M,KAAMrH,MAAOmwB,QAAQ9oB,QACjCtC,WAKf,OACInE,iBAAkB,SAAUP,OAAQC,SAGhC,MAFAD,WAAY5C,OAAO4C,QAEZ4vB,mBAAmB9uB,KAAK,SAAUkvB,YACrC,GAAIC,cAAe11B,OAAA21B,qCAAA,cAAa31B,OAAOgK,KAAKyrB,WAAWF,aAAgB9vB,OACvE,QAA0B,IAAtBC,QAAQ4G,UACD/J,EAAEyF,WAAWC,YAAY5B,UACzBqvB,aAAazzB,SAAWwD,OAAOxD,OAG/BM,EAAEyF,WAAWC,QAAQqtB,aAAaG,WAAWF,QAAS9vB,SAASY,WACnEovB,WAAWG,cACdH,WAAWG,YAAcH,WAAWI,OAAOtvB,KAAK,SAAUzD,MAEtD,MADA2yB,YAAWF,QAAUzyB,KACdA,QAGR2yB,WAAWG,YAAYrvB,KAAK,SAAUzD,MACzC,MAAOwyB,cAAaxyB,KAAM2C,cAItC6C,eAAgB,SAAU7C,OAAQC,SAC9B,MAAO2vB,oBAAmB9uB,KAAK,SAAUkvB,YACrC,GAAIK,QAAS91B,OAAA+1B,qDAAA,GAAoBtwB,OACjC,OAAOgwB,YAAWO,KAAKF,QAAQvvB,KAAK,SAAUilB,KAE1C,MADAiK,YAAWF,QAAUhzB,EAAEC,WAAW,EAAMizB,WAAWF,QAAS/J,KACrDxrB,OAAA+1B,qDAAA,GAAoBvK,W7D8nKd5pB,oBAAuB,EAAIwzB,cACvC,IAAIW,sDAAuD72B,oBAAoB,EAC/E,IAAIy2B,sCAAuCz2B,oBAAoB,EACZA,qBAAoBmB,EAAEs1B,uCAmDxF,SAAUr2B,OAAQsC,oBAAqB1C,qBAE7C,Y8DztKe,SAAS+2B,qBAAoBZ,mBAAoB1sB,UAG5D,QAASutB,wBAAuBT,WAAYzK,kBAcxC,MAbKyK,YAAWU,oBACZV,WAAWU,sBAEVV,WAAWU,kBAAkB3sB,MAC9BisB,WAAWU,kBAAkB3sB,IAAMxJ,OAAAo2B,4CAAA,GAAiB,SAAU/pB,WAC1D,MAAOrM,QAAAq2B,wDAAA,GAAeZ,WAAYppB,YACnC2e,kBAAmB,SAAwB7gB,MAAOmsB,QAIjD,MAHKnsB,SACDA,UAEGnK,OAAA4vB,qCAAA,MAAKzlB,MAAMtH,OAAOyzB,SAASxwB,OAAO,SAAC8W,GAAD,SAASA,IAAKA,EAAEjZ,cAG1D8xB,WAAWU,kBAAkB3sB,IAhBxC,GAAMA,IAAKxJ,OAAA4vB,qCAAA,UAAS,mBAmBpB,IAAI2G,eACJ,QACInoB,MAAO,WACH,MAAOinB,oBAAmB9uB,KAAK,SAAUkvB,YACrC,MAAOz1B,QAAAq2B,wDAAA,GAAeZ,cAAe5yB,OAAO0zB,cAAchwB,KAAKiwB,qDAAA,GAAqBjwB,KAAKoC,aAIjGvB,mBAAoB,SAAUqvB,mBAAoB1vB,iBAC9CwvB,YAAcA,YAAYzwB,OAAO,SAACqD,GAAD,OAAyC,IAAnCstB,mBAAmB10B,QAAQoH,MAEtEnD,iBAAkB,SAAUP,OAAQC,SAChC,GAAMgxB,oBAAqBhxB,QAAQ4G,SACnC,IAAM0e,kBAAmBtlB,QAAQ6G,QAEjC,OAAO8oB,oBAAmB9uB,KAAK,SAAUkvB,YAErC,MADAc,aAAcv2B,OAAA4vB,qCAAA,MAAK2G,YAAY1zB,OAAO4C,SACjC8wB,YAAYt0B,OAELy0B,mBAGLR,uBAAuBT,WAAYzK,kBAAkBvlB,QAAQc,KAAK,SAAC6rB,UACtE,GAAMuE,kBAAmB32B,OAAA4vB,qCAAA,YAAWnqB,OAAQzF,OAAOgK,KAAKooB,UACxD,OAAIuE,kBAAiB10B,OACVM,EAAEyF,WAAWoe,QAChB7N,QAASoe,iBACT7b,8BAA+B6b,iBAAiB1c,KAAK,OACtD5T,UAEA+rB,WAVA7vB,EAAEyF,WAAWC,QAAQxC,QAAQY,UAF7B9D,EAAEyF,WAAWC,YAAY5B,aAgB5C8H,OAAQ,SAAUyoB,aACd,MAAOvB,oBAAmB9uB,KAAK,SAAUkvB,YACrC,GAAMppB,WAAYrM,OAAOgK,KAAK4sB,YAC9B,OAAO52B,QAAAq2B,wDAAA,GAAeZ,WAAYppB,WAAW9F,KAAKiwB,qDAAA,GAAqBjwB,KAAKoC,aAGpFL,eAAgB,SAAU7C,OAAQC,SAC9B,MAAO2vB,oBAAmB9uB,KAAK,SAAUkvB,YACrC,GAAMK,QAAS91B,OAAAw2B,qDAAA,GAAoB/wB,OACnC,OAAOgwB,YAAWppB,YAAY2pB,KAAKF,QAAQvvB,KAAK,SAAU6rB,UACtD,GAAM/lB,WAAYrM,OAAOgK,KAAK8rB,OAK9B,OAAO91B,QAAAq2B,wDAAA,GAAeZ,WAAYppB,WAAW9F,KAAKiwB,qDAAA,S9DqpKrC50B,oBAAuB,EAAIq0B,mBACvC,IAAIG,6CAA8Cl3B,oBAAoB,EACtE,IAAIs3B,sDAAuDt3B,oBAAoB,EAC/E,IAAI0wB,sCAAuC1wB,oBAAoB,EACZA,qBAAoBmB,EAAEuvB,qCACzE,IAAIyG,yDAA0Dn3B,oBAAoB,KAyFjG,SAAUI,OAAQsC,oBAAqB1C,qBAE7C,Y+D9zKO,SAAS23B,gBAAepB,WAAYppB,WACvC,MAAKA,YAAcA,UAAUpK,OAGtBwzB,WAAWppB,YAAYyqB,MAAMzqB,WAAWye,MAAM,SAACxmB,GAClD,GAAM8tB,UAAW9tB,EAAEyyB,YACnB,IAAMC,MAAO5E,SAAS6E,WACtB,IAAkB,uBAAdD,KAAK5S,KACL,KAAM9f,EAEV,IAAM4yB,eAAgBl3B,OAAAoL,qCAAA,YAAWiB,UAAW2qB,KAAKze,QAAQ4e,MACzD,OAAON,gBAAepB,WAAYyB,iBAT3B30B,EAAEyF,WAAWC,YAAY5B,U/D6zKPzE,oBAAuB,EAAIi1B,cACvC,IAAIzrB,sCAAuClM,oBAAoB,EACZA,qBAAoBmB,EAAE+K,uCAoBxF,SAAU9L,OAAQsC,oBAAqB1C,qBAE7C,YgEz1Ke,SAASk4B,sBAAqB/B,mBAAoB1sB,UAC7D,OACIwF,OAAQ,SAAUkpB,oBACd,GAAMpzB,UAAYpE,KAAMw3B,mBAAmBx3B,KAAMuF,MAAOiyB,mBAAmBhvB,QAC3E,OAAOM,UAAS1E,SAGpB+B,iBAAkB,WACd,UAEJsC,eAAgB,SAAU7C,OAAQC,SAC9B,MAAO2vB,oBAAmB9uB,KAAK,SAAUkvB,YACrC,GAAMK,QAASrwB,OAAOpD,IAAI,SAAU+G,OAChC,OAASvJ,KAAMuJ,MAAMvJ,KAAM0K,OAAQnB,MAAMhE,QAE7C,OAAOqwB,YAAW6B,OAAOxB,QAAQvvB,KAAK,SAAU8B,QAI5C,MAHiBA,QAAOhG,IAAI,SAAU+vB,SAAUttB,OAC5C,OAASjF,KAAM4F,OAAOX,OAAOjF,KAAMuF,MAAOgtB,SAAS/pB,gBhEy0K1CzG,oBAAuB,EAAIw1B,sBA6BtD,SAAU93B,OAAQsC,oBAAqB1C,qBAE7C,YACqB,IAAIo1B,2CAA4Cp1B,oBAAoB,EACpE,IAAIq1B,6DAA8Dr1B,oBAAoB,EACtF,IAAIs1B,uDAAwDt1B,oBAAoB,EAChF,IAAIu1B,sEAAuEv1B,oBAAoB,EiEv3KpH0C,qBAAA,WAAyBqK,OAAQtD,UAC7B,GAAIuD,WACAC,kBACAC,kBAEJ,IAAIM,MAAOnK,EAAEC,QAAO,KAAU0J,SAAUD,OAExC,IAAImoB,IAAK,GAAIxnB,QAAOC,EAAE+nB,QAAQ2C,gBAAgB7qB,KAAKP,eAEnD,IAAIqrB,iBAAkBpD,GAAGqD,SAAS1C,SAASxuB,KAAK,iBAAK6tB,IAAGqD,SAAS/gB,KACjE,IAAIghB,iBAAkBn1B,EAAEC,QAAO,GAC3B2J,eAAgBqrB,gBAChBprB,gBACIK,MACIrE,UAAU,GAEdiE,WACIjE,UAAU,KAGnBsE,KAAKR,SAAUQ,KAAK+qB,SACvB,IAAIE,mBAAoBvD,GAAG9iB,QAAQyjB,SAASxuB,KAAK,iBAAK6tB,IAAG9iB,QAAQoF,KAEjE,IAAIkhB,YAAar1B,EAAEC,QAAO,GACtB2J,eAAgBwrB,mBACjBjrB,KAAKR,SAAUQ,KAAK4E,QAEvB,IAAIumB,iBAAkB,GAAIvD,2CAAA,EAAUoD,gBAAiB13B,OAAAu0B,4DAAA,GAAW5rB,SAAU,aAC1E,IAAIssB,mBAAoB,GAAIX,2CAAA,EAAUsD,WAAY53B,OAAAu0B,4DAAA,GAAW5rB,UAAW,WAAY,KACpF,IAAInD,WACAjD,EAAEC,OAAOq1B,iBACLh4B,KAAM,WACNmF,MAAOhF,OAAAy0B,qEAAA,GAAY,aACnB/uB,QAASgyB,gBAAgBtrB,iBAE7B7J,EAAEC,OAAOyyB,mBACLxsB,WAAW,EACX5I,KAAM,UACNmF,MAAOhF,OAAAy0B,qEAAA,GAAmB,YAC1B/uB,QAASkyB,WAAWxrB,iBAK5B,IAAI0rB,uBAAwB93B,OAAAw0B,sDAAA,GAAOhvB,SAAUmD,SAE7C,OADAmvB,uBAAsB7uB,QAAW8qB,gBAAiBK,IAC3C0D,wBjEk4KL,SAAUx4B,OAAQsC,oBAAqB1C,qBAE7C,YACqB,IAAI64B,mDAAoD74B,oBAAoB,GAC5E,IAAIq1B,6DAA8Dr1B,oBAAoB,EkEv7K3G0C,qBAAA,WAAyB8D,QAASiD,UACzBjD,UAASA,WAEd,IAAIgH,QAIJ,OAHAA,MAAKP,eAAiBzG,QAAQyG,gBAAkBzG,QAAQyG,eAAeuK,IAAMhR,QAAQyG,eAAeuK,OACpGhK,KAAKN,eAAiB1G,QAAQ0G,gBAG1BpG,iBAAkB,SAAUP,OAAQC,QAAS5E,QACzC,GAAIk3B,OAAQh4B,OAAAu0B,4DAAA,GAAqBzzB,OAGjC,OADcd,QAAA+3B,kDAAA,GAAkBC,MAAOtrB,KAAM1M,OAAAu0B,4DAAA,GAAW5rB,SAAU7H,SACnDkF,iBAAiBP,OAAQC,QAAS5E,SAErDwH,eAAgB,SAAU7C,OAAQC,QAAS5E,QACvC,GAAIk3B,OAAQh4B,OAAAu0B,4DAAA,GAAqBzzB,OAEjC,OADcd,QAAA+3B,kDAAA,GAAkBC,MAAOtrB,KAAM1M,OAAAu0B,4DAAA,GAAW5rB,SAAU7H,SACnDwH,eAAe7C,YlEk8KpC,SAAUnG,OAAQsC,oBAAqB1C,qBAE7C,YACqB,IAAIo1B,2CAA4Cp1B,oBAAoB,EmEx9KzF,IAAI+4B,6BAEJr2B,qBAAA,WAAyBo2B,MAAOtyB,QAASiD,UACrC,GAAIuvB,YAAaD,0BAA0BD,MAC3C,KAAKE,WAAY,CACb,GAAIN,YAAar1B,EAAEC,QAAO,KAAUkD,SAAWyG,gBAAkB3C,GAAIwuB,QACrEE,YAAa,GAAI5D,2CAAA,EAAWsD,WAAYjvB,UACxCsvB,0BAA0BD,OAASE,WAEvC,MAAOA,cnE+9KL,SAAU54B,OAAQsC,oBAAqB1C,qBAE7C,YACqB,IAAIi5B,oDAAqDj5B,oBAAoB,GAC7E,IAAIk5B,2DAA4Dl5B,oBAAoB,GACpF,IAAIm5B,6DAA8Dn5B,oBAAoB,EACtF,IAAIu1B,sEAAuEv1B,oBAAoB,EAC/F,IAAIo5B,2CAA4Cp5B,oBAAoB,EACpE,IAAIq5B,uDAAwDr5B,oBAAoB,EAUrG,IAAIw1B,SoEl/KU9nB,OAANC,EpEm/KA6nB,QoEn/KA7nB,CAIRjL,qBAAA,WAAyBqK,OAAQtD,UAAU,GAAAC,OAAAC,IACvC,IAAMqD,WACFC,kBACAC,kBAEJ,IAAMM,MAAOnK,EAAEC,QAAO,KAAU0J,SAAUD,OAE1C,IAAM0oB,WAAYjoB,KAAKP,cACvB,IAAM6nB,IAAK,GAAInnB,GAAE+nB,QAAQC,WAAWF,UAEpC,IAAM6D,eAAgBxE,GAAGe,SAASxuB,KAAK,SAACmQ,KACpC,IAAKA,IAAI+hB,MAEL,KADAl0B,SAAQC,MAAM,2EACR,GAAI+E,OAAM,uBAEpB,OAAOmN,MACR,SAAC+U,KAEA,KADAlnB,SAAQC,MAAM,4BAA6BinB,KACrCA,KAEV,IAAMiN,aAAcF,cAAcjyB,KAAK,SAACmQ,KACpC,GAAIsd,GAAGtd,IAAI9I,QACP,MAAOomB,IAAGtd,GAEd,IAAMiiB,gBAAiB,GAAI9rB,GAAE+nB,QAAQve,cACrC,IAAMuiB,cAAeD,eAAeE,gBAAgBniB,IAAI+hB,MAMxD,OAJAG,cAAa5qB,UAAU4qB,aAAa/qB,OAAOS,UAAW,SAACoI,KACnDsd,GAAGtd,IAAIoiB,cAAehzB,OAAQ4Q,IAAIlN,MADtCZ,OAEWmF,aAAa,IACxBimB,GAAGtd,IAAI9I,QAAUgrB,aACV5E,GAAGtd,KAGd,IAAMqiB,uBAAwBx2B,EAAEC,QAAO,GAAQ2J,eAAgBusB,aAAehsB,KAAKR,SAAUQ,KAAK4E,QAClG,IAAM2jB,mBAAoB,GAAIqD,2CAAA,EAAWS,sBAAuB/4B,OAAAq4B,4DAAA,GAAW1vB,UAAW,OAAQ,KAE9F,IAAMnD,YAEN,IAAM0vB,iBAAkB3yB,EAAEC,OAAOyyB,mBAC7BjwB,MAAOhF,OAAAy0B,qEAAA,GAAmB,QAC1B50B,KAAM,YACN4I,WAAW,EACX/C,QAASqzB,sBAAsB3sB,gBAEnC5G,UAASkE,QAAQwrB,gBAEjB,IAAM8D,cAAeR,cAAcjyB,KAAK,SAACmQ,KACrC,MAAOA,KAAI+hB,OAEf,IAAMQ,kBAAmB,GAAId,oDAAA,EAAkBa,aAAch5B,OAAAq4B,4DAAA,GAAW1vB,SAAU,UAClF,IAAMuwB,kBAAmB32B,EAAEC,OAAOy2B,kBAC9Bj0B,MAAOhF,OAAAy0B,qEAAA,GAAY,UACnB50B,KAAM,eAEV2F,UAASkE,QAAQwvB,iBAEjB,IAAMC,aAAc,GAAIf,2DAAA,EAAwBY,aAAch5B,OAAAq4B,4DAAA,GAAW1vB,SAAU,SACnF,IAAMywB,aAAc72B,EAAEC,OAAO22B,aACzBn0B,MAAOhF,OAAAy0B,qEAAA,GAAY,SACnB50B,KAAM,gBAEV2F,UAASkE,QAAQ0vB,YAEjB,IAAMjE,iBAAkBn1B,OAAAu4B,sDAAA,GAAO/yB,SAG/B,OAFA2vB,iBAAgBlsB,QAAW6qB,WAAYE,IAEhCmB,kBpE2/KL,SAAU71B,OAAQsC,oBAAqB1C,qBAE7C,YqE3kLe,SAASm6B,oBAAmBL,aAAcrwB,UACrD,GAAI2wB,sBAEJ,IAAMC,QACFC,SACAC,KAAM,SAACC,OAAQC,UAOX,MANAJ,OAAMC,MAAQD,MAAMC,MAAMn3B,IAAI,SAACu3B,GAI3B,MAHIA,GAAEC,SAAWH,SACbE,EAAED,SAAWA,UAEVC,IAEJL,MAAMC,OAGrB,IAAMb,gBAAiB,GAAI9rB,GAAE+nB,QAAQve,cAErC,IAAMyjB,oBAAqBd,aAAazyB,KAAK,SAACkyB,OAC1C,GAAMsB,IAAK,GAAIltB,GAAE+nB,QAAQoF,WACzB,IAAMC,SAAUF,GAAGG,2BACnB,IAAMj2B,QAASw0B,MAAMe,MAAMn3B,IAAI,SAACu3B,GAI5B,MAHAA,GAAE/5B,KAAO+5B,EAAEO,SACXP,EAAEQ,KAAOR,EAAEC,SAAWI,QAAQJ,OAC9BD,EAAED,SAAWC,EAAEQ,KACRR,GAGX,OADAL,OAAMC,MAAQv1B,OACPA,QAGX,QACImD,mBAAoB,SAAUmvB,YAAaxvB,kBACnCA,gBAAgB9E,QAAWq3B,gBAG/BN,aAAazyB,KAAK,SAACkyB,OACME,eAAeE,gBAAgBJ,OACvC7f,YAAY0gB,gBACzBA,eAAiB,QAIzBtzB,iBAAkB,SAAUq0B,SAYxB,MAXKf,iBAEDN,aAAazyB,KAAK,SAACkyB,OACf,GAAMG,cAAeD,eAAeE,gBAAgBJ,MACpDa,gBAAiBV,aAAa5qB,UAAU4qB,aAAa/qB,OAAOysB,SAAU,SAACC,KAAM9tB,MACzE,GAAMitB,QAASa,KAAK/wB,EAEpB,OADA+vB,OAAME,KAAKC,OAAQa,KAAKZ,UACjBhxB,WAAY9I,KAAM,GAAIuF,MAAOm0B,MAAMC,WACzCzrB,aAAa,MAGnB+rB,mBAAmBvzB,KAAK,SAACizB,OAC5B,QAAU35B,KAAM,GAAIuF,MAAOo0B,WAGnClxB,eAAgB,SAAU7C,OAAQC,SAC9B,GAAM80B,IAAK,GAAI3tB,GAAEC,QAAQ2tB,QAWzB,OAVAh1B,QAAO1C,QAAQ,SAACqG,OACZ,GAAMlF,OAAQkF,MAAMvJ,KAAKqE,MAAM,IAC3BA,OAAM,KACW,eAAbA,MAAM,GACNs2B,GAAGE,WAAWx2B,MAAM,IACA,gBAAbA,MAAM,IACbs2B,GAAGG,YAAYz2B,MAAM,OAI1BuB,SAxEnB7D,oBAAA,EAAAy3B,kBAAA,IAAMxsB,GAAID,OAAOC,GrE6pLX,SAAUvN,OAAQsC,oBAAqB1C,qBAE7C,YsE7pLe,SAASm6B,oBAAmBL,aAAcrwB,UACrD,GAAImR,cAEJ,IAAMigB,IAAK,GAAIltB,GAAE+nB,QAAQoF,WACzB,IAAMT,OAAQh3B,EAAEC,QAAO,GACnB43B,MAAM,EACNT,UAAU,GACXI,GAAGG,4BACN,IAAMvB,gBAAiB,GAAI9rB,GAAE+nB,QAAQve,cAErC,QACIjP,mBAAoB,SAAUqvB,mBAAoB1vB,oBACc,IAArCA,gBAAgBhF,QAAQ,UACxB+X,SACnBkf,aAAazyB,KAAK,SAACkyB,OACME,eAAeE,gBAAgBJ,OACvC7f,YAAYkB,UAE7BA,OAAS,OAGjB9T,iBAAkB,SAAU40B,YACxB,MAAO5B,cAAazyB,KAAK,SAACkyB,OACtB,GAAMwB,SAAUF,GAAGG,2BACnB,IAAMW,QAASpC,MAAMe,MAAM/xB,KAAK,SAAC8yB,MAC7B,MAAOA,MAAKV,SAAWI,QAAQJ,QAEnCt3B,GAAEC,OAAO+2B,MAAOsB,OAEhB,IAAMC,UAAWF,WAAWvxB,OAAO,SAACc,MAAO4wB,OAMvC,MALc,KAAVA,MACA5wB,MAAMjF,MAAOrF,KAAMk7B,MAAO31B,MAAOm0B,YACT3oB,KAAjB2oB,MAAMwB,QACb5wB,MAAMjF,MAAOrF,KAAMk7B,MAAO31B,MAAOm0B,MAAMwB,SAEpC5wB,UAIX,KAD4D,IAAhCywB,WAAW74B,QAAQ,UACnB+X,OAAQ,CAChC,GAAM8e,cAAeD,eAAeE,gBAAgBJ,MACpD3e,QAAS8e,aAAa5qB,UAAU4qB,aAAa/qB,OAAOmtB,MAAO,SAACxB,MAAO/sB,MAC/D,GAAMouB,QAASrB,MAAM/xB,KAAK,SAACmyB,GACvB,MAAOA,GAAEC,SAAWI,QAAQJ,QAE5BgB,SAAUA,OAAOI,OAAS1B,MAAM0B,OAChC1B,MAAM0B,KAAOJ,OAAOI,KACpBtyB,WAAY9I,KAAM,OAAQuF,MAAOy1B,OAAOI,WAIpD,MAAOH,cArDvBl5B,oBAAA,EAAAy3B,kBAAA,IAAMxsB,GAAID,OAAOC,GtE+tLX,SAAUvN,OAAQsC,oBAAqB1C,qBAE7C,YuE9tLe,SAASg8B,YAAWx1B,QAASiD,SAAU6qB,uBAKlD,QAAS2H,yBAAwBC,aAU7B,MATcA,aAAYl5B,QAAQ,IAAK,IAAIA,QAAQ,IAAK,IAC9BgC,MAAM,KAAKmF,OAAO,SAACc,MAAOrE,QAAU,GAAAu1B,eACzCv1B,OAAO5B,MAAM,KAD4Bo3B,eAAAC,eAAAF,cAAA,GACrDxsB,IADqDysB,eAAA,GAChDn3B,IADgDm3B,eAAA,EAM1D,OAJIn3B,OACAA,KAAM,GAEVgG,MAAM0E,KAAO1K,IACNgG,WAKf,QAASiE,OAAMhF,MAAOiD,WAClB,GAAImvB,SAAUL,wBAAwB/xB,MACtC,OAAOqsB,YAAWqB,MAAM0E,SAAWC,QAASpvB,YAAa9F,KAAK,SAACm1B,MAS3D,MARA/yB,YAAY9I,KAAMuJ,MAAOhE,MAAOs2B,QAQzBA,OA5Bf,GAAIjG,YAAa,GAAI5oB,GAAEC,QAAQC,IAAIrH,QAAQyG,eAAeuK,IAE1D,IAAIilB,iBA8BJ,QACIvtB,MAAOA,MAEPhH,mBAAoB,SAAUqvB,mBAAoB1vB,iBAC9CxC,QAAQ2J,IAAI,WAGhBlI,iBAAkB,SAAUP,OAAQC,SAChC,GAAI0D,UAAYvG,OAAO4C,QAAS,EAEhC,IAAI+1B,SAAUL,wBAAwB/xB,MACtC,IAAIiD,WAAY3G,SAAWA,QAAQ+1B,OAGnC,IAAIG,gBAAiB57B,OAAAo2B,4CAAA,GAAiBhoB,MADf,IACwC,SAACjE,MAAOmsB,QAAR,MAAkBA,SACjF,OAAOloB,OAAMhF,MAAOiD,WAAW9F,KAAK,SAAUm1B,MAC1C,GAAIG,WAWJ,OATAH,MAAK34B,QAAQ,SAAC2T,KACV,GAAIgC,eAAgB1Y,OAAOgK,KAAKwxB,SAASn5B,IAAI,SAACyD,QAAD,MAAW4Q,KAAIlN,GAAK,SAAW1D,QAC5E,IAAIgU,QAAS0Z,sBAAsBxlB,UAAU0K,cAAe,WACxDkjB,eAAexyB,MAAOiD,aACrBsO,OAAO,EAAOrO,WAAW,EAAOujB,OAAO,GAC5CgM,SAAQnlB,IAAIlN,IAAMsQ,SAGtB6hB,cAAcvyB,OAASyyB,QAChBH,SvEmqLU95B,oBAAuB,EAAIs5B,UACvC,IAAI9E,6CAA8Cl3B,oBAAoB,EAC3F,IAAIq8B,gBAAiB,WAAc,QAASO,eAAcl5B,IAAKrD,GAAK,GAAIw8B,QAAW,IAAIC,KAAK,CAAM,IAAIC,KAAK,CAAO,IAAIC,QAAKtrB,EAAW,KAAM,IAAK,GAAiCurB,IAA7BC,GAAKx5B,IAAIy5B,OAAOC,cAAmBN,IAAMG,GAAKC,GAAGG,QAAQC,QAAoBT,KAAK72B,KAAKi3B,GAAG/2B,QAAY7F,GAAKw8B,KAAK95B,SAAW1C,GAA3Dy8B,IAAK,IAAoE,MAAOvQ,KAAOwQ,IAAK,EAAMC,GAAKzQ,IAAO,QAAU,KAAWuQ,IAAMI,GAAW,QAAGA,GAAW,SAAO,QAAU,GAAIH,GAAI,KAAMC,KAAQ,MAAOH,MAAQ,MAAO,UAAUn5B,IAAKrD,GAAK,GAAIiL,MAAMC,QAAQ7H,KAAQ,MAAOA,IAAY,IAAIy5B,OAAOC,WAAYt8B,QAAO4C,KAAQ,MAAOk5B,eAAcl5B,IAAKrD,EAAa,MAAM,IAAImwB,WAAU,2DAGtlB,IAAIgF,SuEtuLQ9nB,OAANC,EvEuuLE6nB,QuEvuLF7nB,GvEszLA,SAAUvN,OAAQsC,oBAAqB1C,qBAE7C,YACqB,IAAIu9B,+CAAgDv9B,oBAAoB,GAC5DA,qBAAoBU,EAAEgC,oBAAqB,IAAK,WAAa,MAAO66B,+CAAiD,GACjI,IAAIC,yCAA0Cx9B,oBAAoB,GACtDA,qBAAoBU,EAAEgC,oBAAqB,IAAK,WAAa,MAAO86B,yCAA2C,KAO1I,SAAUp9B,OAAQsC,oBAAqB1C,qBAE7C,YAQA,SAASqwB,iBAAgBC,SAAUC,aAAe,KAAMD,mBAAoBC,cAAgB,KAAM,IAAIC,WAAU,qCAEhH,QAASiN,4BAA2BC,KAAMn9B,MAAQ,IAAKm9B,KAAQ,KAAM,IAAIC,gBAAe,4DAAgE,QAAOp9B,MAAyB,gBAATA,OAAqC,kBAATA,MAA8Bm9B,KAAPn9B,KAElO,QAASq9B,WAAUC,SAAUC,YAAc,GAA0B,kBAAfA,aAA4C,OAAfA,WAAuB,KAAM,IAAItN,WAAU,iEAAoEsN,YAAeD,UAASt8B,UAAYT,OAAOi9B,OAAOD,YAAcA,WAAWv8B,WAAaqU,aAAe1P,MAAO23B,SAAU58B,YAAY,EAAO2O,UAAU,EAAM5O,cAAc,KAAe88B,aAAYh9B,OAAOk9B,eAAiBl9B,OAAOk9B,eAAeH,SAAUC,YAAcD,SAASI,UAAYH,YwE10Lld,QAASI,gBAAe/mB,gBACnC,GAAIgnB,aAKJ,iBAAAC,iBACI,QAAAC,4BAAY73B,SAAS6pB,gBAAA1mB,KAAA00B,2BAAA,IAAA30B,OAAA+zB,2BAAA9zB,MAAA00B,2BAAAJ,WAAAn9B,OAAAw9B,eAAAD,6BAAA99B,KAAAoJ,KACXnD,SADW,OAGjBkD,OAAKoF,UAAYhO,OAAAy9B,sDAAA,GAAsB70B,MAAKoF,UAAUiR,KAAfrW,OAA2B,SAAC80B,iBAAkBC,gBACjF,GAAIC,UAAWP,UAAUK,iBACrBE,WACAh1B,MAAKgQ,YAAYglB,UAErBP,UAAUK,kBAAoBC,iBAGlC/0B,MAAKoT,QAAUhc,OAAA69B,oDAAA,GAAoBj1B,MAAKoT,QAAQiD,KAAbrW,OAAyB,SAACyD,UAAW8kB,IACpE2M,KAAAP,2BAAA98B,UAAA08B,WAAAn9B,OAAAw9B,eAAAD,2BAAA98B,WAAA,YAAAmI,OAAAnJ,KAAAmJ,MAAgByD,UAAW,SAAC+lB,SAAU3lB,MAClC7D,MAAKgQ,YAAYnM,KAAKjD,IACtB2nB,GAAGiB,YACF9lB,WAAW,EAAMqO,OAAO,EAAMC,QAAS,SAACtW,GACzC,KAAMA,QAhBGsE,MADzB,MAAAk0B,WAAAS,2BAAAD,iBAAAzM,aAAA0M,6BAAA1uB,IAAA,cAAAzJ,MAAA,SAqBgBgsB,OACR,GAAIwM,UAAWP,UAAUjM,MACrBwM,WACAE,KAAAP,2BAAA98B,UAAA08B,WAAAn9B,OAAAw9B,eAAAD,2BAAA98B,WAAA,cAAAoI,MAAApJ,KAAAoJ,KAAkB+0B,UAEtBE,KAAAP,2BAAA98B,UAAA08B,WAAAn9B,OAAAw9B,eAAAD,2BAAA98B,WAAA,cAAAoI,MAAApJ,KAAAoJ,KAAkBuoB,aACXiM,WAAUjM,UA3BzBviB,IAAA,iBAAAzJ,MAAA,WA8BQi4B,aACAS,KAAAP,2BAAA98B,UAAA08B,WAAAn9B,OAAAw9B,eAAAD,2BAAA98B,WAAA,iBAAAoI,MAAApJ,KAAAoJ,UA/BR00B,4BAAgDlnB,gBxEyzLnBzU,oBAAuB,EAAIw7B,cACvC,IAAIK,uDAAwDv+B,oBAAoB,GAChF,IAAI2+B,qDAAsD3+B,oBAAoB,GACnG,IAAI2xB,cAAe,WAAc,QAASC,kBAAiBnV,OAAQoV,OAAS,IAAK,GAAIxxB,GAAI,EAAGA,EAAIwxB,MAAM9uB,OAAQ1C,IAAK,CAAE,GAAIyxB,YAAaD,MAAMxxB,EAAIyxB,YAAW7wB,WAAa6wB,WAAW7wB,aAAc,EAAO6wB,WAAW9wB,cAAe,EAAU,SAAW8wB,cAAYA,WAAWliB,UAAW,GAAM9O,OAAOC,eAAe0b,OAAQqV,WAAWniB,IAAKmiB,aAAiB,MAAO,UAAUvB,YAAa7a,WAAYC,aAAiJ,MAA9HD,aAAYkc,iBAAiBrB,YAAYhvB,UAAWmU,YAAiBC,aAAaic,iBAAiBrB,YAAa5a,aAAqB4a,eAEhiB,IAAIqO,MAAO,QAAS19B,KAAIG,OAAQC,SAAUu9B,UAA2B,OAAXx9B,SAAiBA,OAASye,SAASve,UAAW,IAAIu9B,MAAOh+B,OAAOi+B,yBAAyB19B,OAAQC,SAAW,QAAaoQ,KAATotB,KAAoB,CAAE,GAAIE,QAASl+B,OAAOw9B,eAAej9B,OAAS,OAAe,QAAX29B,WAAmB,GAAkC99B,IAAI89B,OAAQ19B,SAAUu9B,UAAoB,GAAI,SAAWC,MAAQ,MAAOA,MAAK54B,KAAgB,IAAItF,QAASk+B,KAAK59B,GAAK,QAAewQ,KAAX9Q,OAA4C,MAAOA,QAAOL,KAAKs+B,YA0Etd,SAAUz+B,OAAQsC,oBAAqB1C,qBAE7C,YyEj5LO,SAASi/B,iBAAgB14B,QAC5B,GAAI24B,MAAO34B,OAAO4D,OAAO,SAACc,MAAOf,OAC7B,GAAIi1B,OAAQr+B,OAAAs+B,oDAAA,GAAoBl1B,MAEhC,OADAe,OAAQA,MAAMtH,OAAOw7B,WAGzB,OAAOr+B,QAAA21B,qCAAA,MAAKyI,MAQT,QAASG,6BAA4B94B,OAAQ3C,MAChD,MAAO2C,QAAOpD,IAAI,SAAC+G,OACf,MAAOpJ,QAAAs+B,oDAAA,GAAsBl1B,MAAOtG,QAUrC,QAAS07B,iCAAgCC,eAAgBC,mBAAoB57B,MAChF,MAAO47B,oBAAmBr1B,OAAO,SAACc,MAAOw0B,kBAAmB75B,OACxD,GAAI85B,UAAWH,eAAe35B,MAK9B,YAHY8L,KADF9N,KAAK67B,qBAEXx0B,MAAMy0B,UAAY97B,KAAK67B,oBAEpBx0B,WAUA,QAAS00B,uBAAsBC,YAAaC,oBACvD,MAAO,UAA+Bt5B,OAAQ0rB,GAAIzrB,SAC9CD,UAAY5C,OAAO4C,OACnB,IAAIu5B,cAAeb,gBAAgB14B,OACnC,OAAKu5B,cAAa/8B,OAGA68B,YAAYE,aAAc,SAAqCl8B,KAAMm8B,kBACnF,GAAIP,oBAAqBH,4BAA4B94B,OAAQ3C,KAE7D,IAAIo8B,aAAcJ,YAAYJ,mBAAoB,SAAuCS,WAAYC,YACjG,GAAIC,YAAab,gCAAgC/4B,OAAQi5B,mBAAoBS,WAE7EhO,IAAGkO,WAAYD,aAChB15B,QAGH,QADCq5B,oBAAsBx8B,EAAE+8B,MAAML,iBAAiBz1B,GAAI01B,aAC7CA,aACR38B,EAAEC,OAAOkD,SAAW4G,WAAW,EAAMqO,OAAO,KAbpCmkB,YAAYr5B,OAAQ0rB,GAAIzrB,UzEq2LV9D,oBAAuB,EAAIi9B,qBACvC,IAAIP,qDAAsDp/B,oBAAoB,GAC9E,IAAIy2B,sCAAuCz2B,oBAAoB,EACZA,qBAAoBmB,EAAEs1B,uCA6ExF,SAAUr2B,OAAQsC,oBAAqB1C,qBAE7C,Y0Er+LO,SAASi/B,iBAAgBoB,eAC5B,GAAInB,MAAOmB,cAAcl2B,OAAO,SAACc,MAAO+V,OACpC,GAAIme,OAAQr+B,OAAAs+B,oDAAA,GAAoBpe,MAAMrgB,KAEtC,OADAsK,OAAQA,MAAMtH,OAAOw7B,WAGzB,OAAOr+B,QAAA4vB,qCAAA,MAAKwO,MAQT,QAASG,6BAA4BgB,cAAeC,qBACvD,MAAOD,eAAcl9B,IAAI,SAACo9B,IACtB,OACI5/B,KAAMG,OAAAs+B,oDAAA,GAAsBmB,GAAG5/B,KAAM2/B,qBACrCp6B,MAAOq6B,GAAGr6B,SAWP,QAASs6B,qBAAoBC,gBAAiBC,SACzD,MAAO,UAAqCx2B,MAAOhE,MAAOM,SACtD,GAAIm6B,yBAA0B7/B,OAAAw2B,qDAAA,GAAsBptB,MAAOhE,MAAOM,QAClE,IAAIs5B,cAAeb,gBAAgB0B,wBAAwBt1B,OAC3D,KAAKy0B,aAAa/8B,OACd,MAAO09B,iBAAgBv2B,MAAOhE,MAAOM,QAGzC,IAAImR,MAAOtU,EAAEyF,UAMb,OALA43B,SAAQZ,aAAc,SAAgCc,sBAClD,GAAIC,cAAexB,4BAA4BsB,wBAAwBt1B,OAAQu1B,qBAC1DH,iBAAgBI,aAAcF,wBAAwBn6B,SAC5Da,KAAKsQ,KAAK5O,QAAS4O,KAAKuP,UAEpCvP,KAAKxQ,W1E67LazE,oBAAuB,EAAI89B,mBACvC,IAAIpB,qDAAsDp/B,oBAAoB,GAC9E,IAAIs3B,sDAAuDt3B,oBAAoB,EAC/E,IAAI0wB,sCAAuC1wB,oBAAoB,EACZA,qBAAoBmB,EAAEuvB,uCA2DxF,SAAUtwB,OAAQsC,oBAAqB1C,qBAE7C,YASA,SAASqwB,iBAAgBC,SAAUC,aAAe,KAAMD,mBAAoBC,cAAgB,KAAM,IAAIC,WAAU,qCAEhH,QAASiN,4BAA2BC,KAAMn9B,MAAQ,IAAKm9B,KAAQ,KAAM,IAAIC,gBAAe,4DAAgE,QAAOp9B,MAAyB,gBAATA,OAAqC,kBAATA,MAA8Bm9B,KAAPn9B,KAElO,QAASq9B,WAAUC,SAAUC,YAAc,GAA0B,kBAAfA,aAA4C,OAAfA,WAAuB,KAAM,IAAItN,WAAU,iEAAoEsN,YAAeD,UAASt8B,UAAYT,OAAOi9B,OAAOD,YAAcA,WAAWv8B,WAAaqU,aAAe1P,MAAO23B,SAAU58B,YAAY,EAAO2O,UAAU,EAAM5O,cAAc,KAAe88B,aAAYh9B,OAAOk9B,eAAiBl9B,OAAOk9B,eAAeH,SAAUC,YAAcD,SAASI,UAAYH,Y2E5jMje,QAAStM,uBAAsBC,iBAC3B,GAAMqP,WAAYrP,gBAAgBtnB,OAAO,SAAUc,MAAOwO,MAEtD,MADAxO,OAAQA,MAAMtH,OAAO8V,KAAKlT,YAG9B,OAAOzF,QAAA21B,qCAAA,MAAKqK,WAQD,QAASC,YAAW5pB,eAAgB3N,QAI/C,gBAAA40B,iBACI,QAAA4C,mBAAYx6B,SAAS6pB,gBAAA1mB,KAAAq3B,kBAAA,IAAAt3B,OAAA+zB,2BAAA9zB,MAAAq3B,kBAAA/C,WAAAn9B,OAAAw9B,eAAA0C,oBAAAzgC,KAAAoJ,KACXnD,SACN,IAAMwG,WACFgjB,UAEJ,IAAMxiB,MAAOnK,EAAEC,QAAO,KAAU0J,SAAUxG,QAC1C,IAAMy6B,cAAengC,OAAA21B,qCAAA,MAAKjpB,KAAM1M,OAAOgK,KAAKkC,UAN3B,OAQjBtD,OAAKF,OAASA,OAAOgE,KAAKwiB,OAAQiR,aAAcv3B,MAAKuF,OAAO8Q,KAAZrW,QAR/BA,MADzB,MAAAk0B,WAAAoD,kBAAA5C,iBAAAzM,aAAAqP,oBAAArxB,IAAA,YAAAzJ,MAAA,SAmBcK,OAAQ0rB,GAAIzrB,SAAS,GAAA06B,QAAAv3B,IAC3B,IAAMiR,mIAAyBrU,OAAQ0rB,GAAIzrB,QAW3C,OAVAmD,MAAKH,OAAO1C,oBAAoBnD,OAAO4C,QAASC,SAASa,KAAK,SAACC,gBACvDA,eAAevE,QACfm+B,OAAKjyB,UAAUtL,OAAO2D,kBAE3B,SAACilB,KACA2U,OAAKxnB,YAAYkB,QACbpU,SAAWA,QAAQkV,SACnBlV,QAAQkV,QAAQ6Q,OAGjB3R,UA/BfjL,IAAA,UAAAzJ,MAAA,SAyCYgE,MAAOhE,MAAOM,SAAS,GAAA26B,QAAAx3B,IAC3B,IAAMf,aAAc9H,OAAAsgC,6CAAA,GAAsBl3B,MAAOhE,MAAOM,QACxD,OAAOmD,MAAKH,OAAOJ,eAAeR,YAAYyC,OAAQzC,YAAYpC,SAASa,KAAK,SAACgC,WAC7E,MAAAu1B,MAAAoC,kBAAAz/B,UAAA08B,WAAAn9B,OAAAw9B,eAAA0C,kBAAAz/B,WAAA,UAAA4/B,QAAA5gC,KAAA4gC,OAAqB93B,UAAWT,YAAYpC,cA5CxDmJ,IAAA,cAAAzJ,MAAA,SAsDgBgsB,OACR,GAAMqN,gBAAiB/N,sBAAsB7nB,KAAK6P,cAClDolB,MAAAoC,kBAAAz/B,UAAA08B,WAAAn9B,OAAAw9B,eAAA0C,kBAAAz/B,WAAA,cAAAoI,MAAApJ,KAAAoJ,KAAkBuoB,MAClB,IAAMrqB,iBAAkB2pB,sBAAsB7nB,KAAK6P,cACnD,IAAM+d,oBAAqBz2B,OAAA21B,qCAAA,YAAW8I,eAAgB13B,gBAEtD8B,MAAKH,OAAOtB,mBAAmBqvB,mBAAoB1vB,oBA5D3D8H,IAAA,iBAAAzJ,MAAA,WAoEQ,GAAMq5B,gBAAiB/N,sBAAsB7nB,KAAK6P,cAGlD,OAFAolB,MAAAoC,kBAAAz/B,UAAA08B,WAAAn9B,OAAAw9B,eAAA0C,kBAAAz/B,WAAA,iBAAAoI,MAAApJ,KAAAoJ,MAEOA,KAAKH,OAAOtB,mBAAmBq3B,uBAvE9CyB,mBAAuC7pB,gB3E+hMVzU,oBAAuB,EAAIq+B,UACvC,IAAIK,8CAA+CphC,oBAAoB,EACvE,IAAIy2B,sCAAuCz2B,oBAAoB,EACZA,qBAAoBmB,EAAEs1B,qCAC9F,IAAI9E,cAAe,WAAc,QAASC,kBAAiBnV,OAAQoV,OAAS,IAAK,GAAIxxB,GAAI,EAAGA,EAAIwxB,MAAM9uB,OAAQ1C,IAAK,CAAE,GAAIyxB,YAAaD,MAAMxxB,EAAIyxB,YAAW7wB,WAAa6wB,WAAW7wB,aAAc,EAAO6wB,WAAW9wB,cAAe,EAAU,SAAW8wB,cAAYA,WAAWliB,UAAW,GAAM9O,OAAOC,eAAe0b,OAAQqV,WAAWniB,IAAKmiB,aAAiB,MAAO,UAAUvB,YAAa7a,WAAYC,aAAiJ,MAA9HD,aAAYkc,iBAAiBrB,YAAYhvB,UAAWmU,YAAiBC,aAAaic,iBAAiBrB,YAAa5a,aAAqB4a,eAEhiB,IAAIqO,MAAO,QAAS19B,KAAIG,OAAQC,SAAUu9B,UAA2B,OAAXx9B,SAAiBA,OAASye,SAASve,UAAW,IAAIu9B,MAAOh+B,OAAOi+B,yBAAyB19B,OAAQC,SAAW,QAAaoQ,KAATotB,KAAoB,CAAE,GAAIE,QAASl+B,OAAOw9B,eAAej9B,OAAS,OAAe,QAAX29B,WAAmB,GAAkC99B,IAAI89B,OAAQ19B,SAAUu9B,UAAoB,GAAI,SAAWC,MAAQ,MAAOA,MAAK54B,KAAgB,IAAItF,QAASk+B,KAAK59B,GAAK,QAAewQ,KAAX9Q,OAA4C,MAAOA,QAAOL,KAAKs+B","file":"flow.min.js","sourcesContent":["/*!\n * \n * ++++++++   ++++++++   ++++++++         Flow.js\n * ++++++++   ,+++++++~   ++++++++        v0.11.0\n *  ++++++++   ++++++++   ++++++++\n *  ~+++++++~   ++++++++   ++++++++       Github: https://github.com/forio/flow.js\n *   ++++++++   ++++++++   ++++++++:\n *    :++++++++   ++++++++   ++++++++\n *      ++++++++   =+++++++   ,+++++++=\n *       ++++++++   ++++++++   ++++++++\n *       =+++++++    +++++++=   ++++++++\n *        ++++++++   ++++++++   ++++++++\n *        ,+++++++:   +++++++~   ++++++++\n *         +++++++=   +++++++=   ++++++++\n *        ++++++++   ++++++++   ++++++++\n *        ++++++++   ++++++++   ++++++++\n *        ++++++++   =+++++++   :+++++++,\n *         ++++++++   ++++++++   ++++++++\n *         ++++++++   ~+++++++    +++++++=\n *          ++++++++   ++++++++   ++++++++\n * \n */\nvar Flow =\n/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 16);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports) {\n\nmodule.exports = _;\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports) {\n\nmodule.exports = {\n    prefix: 'f',\n    binderAttr: 'f-bind',\n\n    events: {\n        //UI Change to publish to the channel.\n        trigger: 'update.f.ui',\n\n        //Trigger with payload '{attrToUpdate: value}', for e.g. { bind: 34 }. This will run this through all the converts and pass it to attr handler. Useful to by-pass getting this from the model directly.\n        convert: 'f.convert'\n    },\n\n    attrs: {\n        checkboxOffValue: 'data-off-value',\n        //Used by repeat attr handler to keep track of template after first evaluation\n        repeat: {\n            templateId: 'repeat-template-id' //don't prefix by f or dom-manager unbind will kill it\n        }\n    },\n\n    errorAttr: 'data-flow-error',\n    animation: {\n        addAttr: 'data-add',\n        changeAttr: 'data-update',\n        initialAttr: 'data-initial'\n    }\n};\n\n/***/ }),\n/* 2 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (immutable) */ __webpack_exports__[\"d\"] = stripSuffixDelimiter;\n/* harmony export (immutable) */ __webpack_exports__[\"b\"] = mapWithPrefix;\n/* harmony export (immutable) */ __webpack_exports__[\"g\"] = withPrefix;\n/* harmony export (immutable) */ __webpack_exports__[\"f\"] = unprefixTopics;\n/* harmony export (immutable) */ __webpack_exports__[\"e\"] = unprefix;\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__silencable__ = __webpack_require__(55);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"c\", function() { return __WEBPACK_IMPORTED_MODULE_0__silencable__[\"a\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__exclude_read_only__ = __webpack_require__(56);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return __WEBPACK_IMPORTED_MODULE_1__exclude_read_only__[\"a\"]; });\nvar CHANNEL_DELIMITER = ':';\n\n\n\n\n/**\n * \n * @param {string} text\n * @return {string}\n */\nfunction stripSuffixDelimiter(text) {\n    if (text && text.indexOf(CHANNEL_DELIMITER) === text.length - 1) {\n        text = text.replace(CHANNEL_DELIMITER, '');\n    }\n    return text;\n}\n\n/**\n * \n * @param {Publishable[]} dataArray \n * @param {string} prefix \n * @return {Publishable[]} array with name prefixed\n */\nfunction mapWithPrefix(dataArray, prefix) {\n    if (!prefix) return dataArray;\n    return (dataArray || []).map(function (datapt) {\n        var name = (prefix + datapt.name).replace(/:$/, ''); //replace trailing delimiters\n        return $.extend(true, {}, datapt, { name: name });\n    });\n}\n\n/**\n * \n * @param {Function} callback \n * @param {string|string[]} prefixList\n * @return {Function}\n */\nfunction withPrefix(callback, prefixList) {\n    var arr = [].concat(prefixList);\n\n    /**\n     * @param {Publishable[]} data\n     */\n    return function (data) {\n        arr.forEach(function (prefix) {\n            var mapped = mapWithPrefix(data, prefix);\n            callback(mapped);\n        });\n    };\n}\n\n/**\n * \n * @param {string[]} list \n * @param {string} prefix\n * @return {string[]} Item with prefix removed\n */\nfunction unprefixTopics(list, prefix) {\n    if (!prefix) return list;\n    var unprefixed = list.map(function (item) {\n        return item.replace(prefix, '');\n    });\n    return unprefixed;\n}\n\n/**\n * \n * @param {Publishable[]} list \n * @param {string} prefix\n * @return {Publishable[]} Item with prefix removed\n */\nfunction unprefix(list, prefix) {\n    if (!prefix) return list;\n    var unprefixed = list.map(function (item) {\n        if (item.name) {\n            return $.extend(true, {}, item, { name: item.name.replace(prefix, '') });\n        }\n        return item.replace(prefix, '');\n    });\n    return unprefixed;\n}\n\n/***/ }),\n/* 3 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"toImplicitType\", function() { return toImplicitType; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"toPublishableFormat\", function() { return toPublishableFormat; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"splitNameArgs\", function() { return splitNameArgs; });\n/* eslint-disable complexity */\nfunction toImplicitType(data) {\n    var objRegex = /^(?:\\{.*\\})$/;\n    var arrRegex = /^(?:\\[.*])$/;\n\n    var converted = data;\n    if (typeof data === 'string') {\n        converted = data.trim();\n\n        if (converted === 'true') {\n            converted = true;\n        } else if (converted === 'false') {\n            converted = false;\n        } else if (converted === 'null') {\n            converted = null;\n        } else if (converted === 'undefined') {\n            converted = '';\n        } else if (converted.charAt(0) === '\\'' || converted.charAt(0) === '\"') {\n            converted = converted.substring(1, converted.length - 1);\n        } else if ($.isNumeric(converted)) {\n            converted = +converted;\n        } else if (arrRegex.test(converted)) {\n            var bracketReplaced = converted.replace(/[[\\]]/g, '');\n            if (!bracketReplaced) return [];\n            var parsed = bracketReplaced.split(/,(?![^[]*])/).map(function (val) {\n                return toImplicitType(val);\n            });\n            return parsed;\n        } else if (objRegex.test(converted)) {\n            try {\n                converted = JSON.parse(converted);\n            } catch (e) {\n                console.error('toImplicitType: couldn\\'t convert', converted);\n            }\n        }\n    }\n    return converted;\n}\n\nfunction splitUnescapedCommas(str) {\n    var regex = /(\\\\.|[^,])+/g;\n    var m = void 0;\n\n    var op = [];\n    while ((m = regex.exec(str)) !== null) {\n        //eslint-disable-line\n        // This is necessary to avoid infinite loops with zero-width matches\n        if (m.index === regex.lastIndex) {\n            regex.lastIndex++;\n        }\n        m.forEach(function (match, groupIndex) {\n            if (groupIndex === 0) {\n                op.push(match.replace('\\\\', ''));\n            }\n        });\n    }\n    return op;\n}\n\nfunction splitNameArgs(value) {\n    value = value.trim();\n    var fnName = value.split('(')[0];\n    var params = value.substring(value.indexOf('(') + 1, value.indexOf(')'));\n    var args = splitUnescapedCommas(params).map(function (p) {\n        return p.trim();\n    });\n    return { name: fnName, args: args };\n}\n\n/**\n * @param  {string} value\n * @return {{ name: string, value: any}[]}       [description]\n */\nfunction toPublishableFormat(value) {\n    var OPERATIONS_SEPERATOR = '&&';\n    var split = (value || '').split(OPERATIONS_SEPERATOR);\n    var listOfOperations = split.map(function (value) {\n        if (value && value.indexOf('=') !== -1) {\n            var _split = value.split('=');\n            return { name: _split[0].trim(), value: _split[1].trim() };\n        }\n        var parsed = splitNameArgs(value);\n        return { name: parsed.name, value: parsed.args };\n    });\n    return listOfOperations;\n}\n\n\n\n/***/ }),\n/* 4 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* unused harmony export notifySubscribeHandlers */\n/* unused harmony export notifyUnsubscribeHandlers */\n/* unused harmony export passthroughPublishInterceptors */\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = router;\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__utils_handler_utils__ = __webpack_require__(54);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__utils__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_utils_general__ = __webpack_require__(7);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_lodash__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_lodash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_lodash__);\n\n\n\n\n\n/**\n * Handle subscriptions\n * @param  {Handler[]} handlers Array of the form [{ match: function (){}, }]\n * @param  {String[]} topics   Array of strings\n * @param  {SubscribeOptions} [options]\n * @return {Promise<Publishable[]>} Returns populated topics if available\n */\nfunction notifySubscribeHandlers(handlers, topics, options) {\n    var grouped = Object(__WEBPACK_IMPORTED_MODULE_0__utils_handler_utils__[\"a\" /* groupByHandlers */])(topics, handlers);\n    var promises = [];\n    grouped.filter(function (handler) {\n        return handler.subscribeHandler;\n    }).forEach(function (handler) {\n        var mergedOptions = $.extend(true, {}, handler.options, options);\n        var unprefixed = Object(__WEBPACK_IMPORTED_MODULE_1__utils__[\"f\" /* unprefixTopics */])(handler.data, handler.matched);\n        var promise = Object(__WEBPACK_IMPORTED_MODULE_2_utils_general__[\"b\" /* makePromise */])(function () {\n            var subsResponse = handler.subscribeHandler(unprefixed, mergedOptions, handler.matched);\n            return subsResponse;\n        }).then(function (topicsWithData) {\n            var normalized = Object(__WEBPACK_IMPORTED_MODULE_0__utils_handler_utils__[\"c\" /* normalizeSubscribeResponse */])(topicsWithData, unprefixed);\n            var prefixed = Object(__WEBPACK_IMPORTED_MODULE_1__utils__[\"b\" /* mapWithPrefix */])(normalized, handler.matched);\n            return prefixed;\n        });\n        promises.push(promise);\n    });\n    return $.when.apply(null, promises).then(function () {\n        var arr = [].concat.apply([], arguments);\n        return arr;\n    });\n}\n\n/**\n * \n * @param {Handler[]} handlers \n * @param {String[]} recentlyUnsubscribedTopics\n * @param {String[]} remainingTopics \n */\nfunction notifyUnsubscribeHandlers(handlers, recentlyUnsubscribedTopics, remainingTopics) {\n    handlers = handlers.map(function (h, index) {\n        h.unsubsKey = index;\n        return h;\n    });\n\n    var unsubsGrouped = Object(__WEBPACK_IMPORTED_MODULE_0__utils_handler_utils__[\"a\" /* groupByHandlers */])(recentlyUnsubscribedTopics, handlers);\n    var remainingGrouped = Object(__WEBPACK_IMPORTED_MODULE_0__utils_handler_utils__[\"a\" /* groupByHandlers */])(remainingTopics, handlers);\n\n    unsubsGrouped.filter(function (h) {\n        return h.unsubscribeHandler;\n    }).forEach(function (handler) {\n        var unprefixedUnsubs = Object(__WEBPACK_IMPORTED_MODULE_1__utils__[\"f\" /* unprefixTopics */])(handler.data, handler.matched);\n        var matchingRemainingHandler = __WEBPACK_IMPORTED_MODULE_3_lodash___default.a.find(remainingGrouped, function (remainingHandler) {\n            return remainingHandler.unsubsKey === handler.unsubsKey;\n        });\n        var matchingTopicsRemaining = matchingRemainingHandler ? matchingRemainingHandler.data : [];\n        var unprefixedRemaining = Object(__WEBPACK_IMPORTED_MODULE_1__utils__[\"f\" /* unprefixTopics */])(matchingTopicsRemaining || [], handler.matched);\n        handler.unsubscribeHandler(unprefixedUnsubs, unprefixedRemaining);\n    });\n}\n\n/**\n * \n * @param {Handler[]} handlers \n * @param {Publishable[]} publishData \n * @param {PublishOptions} [options]\n * @return {Promise}\n */\nfunction passthroughPublishInterceptors(handlers, publishData, options) {\n    var grouped = Object(__WEBPACK_IMPORTED_MODULE_0__utils_handler_utils__[\"b\" /* groupSequentiallyByHandlers */])(publishData, handlers);\n    var $initialProm = $.Deferred().resolve([]).promise();\n    grouped.forEach(function (handler) {\n        $initialProm = $initialProm.then(function (dataSoFar) {\n            var mergedOptions = $.extend(true, {}, handler.options, options);\n            var unprefixed = Object(__WEBPACK_IMPORTED_MODULE_1__utils__[\"e\" /* unprefix */])(handler.data, handler.matched);\n\n            var publishableData = Object(__WEBPACK_IMPORTED_MODULE_1__utils__[\"a\" /* excludeReadOnly */])(unprefixed, mergedOptions.readOnly);\n            if (!publishableData.length) {\n                return dataSoFar;\n            }\n\n            var result = handler.publishHandler ? handler.publishHandler(publishableData, mergedOptions, handler.matched) : publishableData;\n            var publishProm = $.Deferred().resolve(result).promise();\n            return publishProm.then(function (published) {\n                return Object(__WEBPACK_IMPORTED_MODULE_1__utils__[\"c\" /* silencable */])(published, mergedOptions.silent);\n            }).then(function (published) {\n                var mapped = Object(__WEBPACK_IMPORTED_MODULE_1__utils__[\"b\" /* mapWithPrefix */])(published, handler.matched);\n                if (handler.isDefault && handler.matched) {\n                    mapped = mapped.concat(published);\n                }\n                return mapped;\n            }).then(function (mapped) {\n                return [].concat(dataSoFar, mapped);\n            });\n        });\n    });\n    return $initialProm;\n}\n\n/**\n * Router\n * @param  {Handler[]} handlers\n * @param {object} [options]\n * @param {function} [notifier]\n * @return {Router}\n */\nfunction router(handlers, options, notifier) {\n    var _this = this;\n\n    var myHandlers = (handlers || []).map(function (Handler) {\n        var handler = Handler;\n        if (__WEBPACK_IMPORTED_MODULE_3_lodash___default.a.isFunction(Handler)) {\n            handler = new Handler(options, notifier);\n            $.extend(_this, handler.expose);\n        }\n        if (typeof handler.match === 'string') {\n            var matchString = handler.match;\n            handler.name = matchString;\n            handler.match = function (t) {\n                return t === matchString ? '' : false;\n            };\n        }\n        return handler;\n    });\n\n    return {\n        match: function (topic) {\n            return myHandlers.reduce(function (match, handler) {\n                var matched = handler.match(topic);\n                if (match === false && matched !== false) {\n                    return '';\n                }\n                return match;\n            }, false);\n        },\n\n        /**\n         * @param {String[]} topics\n         * @param {SubscribeOptions} [options]\n         * @return {Promise<Publishable[]>} Returns populated topics if available\n         */\n        subscribeHandler: function (topics, options) {\n            return notifySubscribeHandlers(myHandlers, topics, options);\n        },\n        /**\n         * @param {String[]} recentlyUnsubscribedTopics\n         * @param {String[]} remainingTopics\n         * @return {void}\n         */\n        unsubscribeHandler: function (recentlyUnsubscribedTopics, remainingTopics) {\n            return notifyUnsubscribeHandlers(myHandlers, recentlyUnsubscribedTopics, remainingTopics);\n        },\n\n        /**\n         * @param {Publishable[]} data\n         * @param {PublishOptions} [options]\n         * @return {Promise}\n         */\n        publishHandler: function (data, options) {\n            return passthroughPublishInterceptors(myHandlers, data, options);\n        },\n\n        addRoute: function (handler) {\n            if (!handler || !handler.match) {\n                throw Error('Handler does not have a valid `match` property');\n            }\n            handler.id = __WEBPACK_IMPORTED_MODULE_3_lodash___default.a.uniqueId('routehandler-');\n            myHandlers.unshift(handler);\n            return handler.id;\n        },\n        removeRoute: function (routeid) {\n            myHandlers = myHandlers.filter(function (handler) {\n                return handler.id !== routeid;\n            });\n        }\n    };\n}\n\n/***/ }),\n/* 5 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (immutable) */ __webpack_exports__[\"b\"] = objectToPublishable;\n/* harmony export (immutable) */ __webpack_exports__[\"c\"] = publishableToObject;\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = normalizeParamOptions;\n/**\n * \n * @param {object} obj\n * @return {Publishable[]}\n */\nfunction objectToPublishable(obj) {\n    var mapped = Object.keys(obj || {}).map(function (t) {\n        return { name: t, value: obj[t] };\n    });\n    return mapped;\n}\n\n/**\n * Converts arrays of the form [{ name: '', value: ''}] to {[name]: value}\n * @param {Publishable[]} arr\n * @param {object} [mergeWith]\n * @returns {object}\n */\nfunction publishableToObject(arr, mergeWith) {\n    var result = (arr || []).reduce(function (accum, topic) {\n        accum[topic.name] = topic.value;\n        return accum;\n    }, $.extend(true, {}, mergeWith));\n    return result;\n}\n\n/**\n * @typedef NormalizedParam\n * @property {Publishable[]} params\n * @property {Object} options\n */\n\n/**\n *\n * @param {String|Object|array} topic \n * @param {*} publishValue \n * @param {Object} [options]\n * @return {NormalizedParam}\n */\nfunction normalizeParamOptions(topic, publishValue, options) {\n    if (!topic) {\n        return { params: [], options: {} };\n    }\n    if ($.isPlainObject(topic)) {\n        return { params: objectToPublishable(topic), options: publishValue };\n    }\n    if (Array.isArray(topic)) {\n        return { params: topic, options: publishValue };\n    }\n    return { params: [{ name: topic, value: publishValue }], options: options };\n}\n\n/***/ }),\n/* 6 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (immutable) */ __webpack_exports__[\"b\"] = matchPrefix;\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = matchDefaultPrefix;\n/* harmony export (immutable) */ __webpack_exports__[\"c\"] = matchRegex;\nvar CHANNEL_DELIMITER = ':';\n\n/**\n * \n * @param {string} prefix\n * @returns {matchFunction}\n */\nfunction matchPrefix(prefix) {\n    return function prefixMatcher(topic) {\n        var hasPrefix = topic.indexOf(prefix) === 0;\n        if (hasPrefix) return prefix;\n\n        var isOnlyPrefix = prefix.replace(/:/g, '') === topic;\n        if (isOnlyPrefix) return topic;\n\n        return false;\n    };\n}\n\n/**\n* \n* @param {string} prefix\n* @returns {matchFunction}\n*/\nfunction matchDefaultPrefix(prefix) {\n    return function defaultPrefixMatcher(topic, forcePrefix) {\n        var hasPrefix = topic.indexOf(prefix) === 0;\n        return hasPrefix || forcePrefix ? prefix : '';\n    };\n}\n\n/**\n * \n * @param {string} regex\n * @returns {matchFunction}\n */\nfunction matchRegex(regex) {\n    var toMatch = new RegExp('^' + regex + CHANNEL_DELIMITER);\n    return function regexMatcher(topic) {\n        var match = topic.match(toMatch);\n        if (match && match.length) {\n            return match[0];\n        }\n        return false;\n    };\n}\n\n/***/ }),\n/* 7 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (immutable) */ __webpack_exports__[\"c\"] = random;\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_lodash__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_lodash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_lodash__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__make_promise__ = __webpack_require__(39);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"b\", function() { return __WEBPACK_IMPORTED_MODULE_1__make_promise__[\"a\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__debounce_and_merge__ = __webpack_require__(40);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return __WEBPACK_IMPORTED_MODULE_2__debounce_and_merge__[\"a\"]; });\n\n\n\n\n\nfunction random(prefix, min, max) {\n    if (!min) {\n        min = parseInt(Object(__WEBPACK_IMPORTED_MODULE_0_lodash__[\"uniqueId\"])(), 10);\n    }\n    if (!max) {\n        max = 100000; //eslint-disable-line no-magic-numbers\n    }\n    var rnd = Object(__WEBPACK_IMPORTED_MODULE_0_lodash__[\"random\"])(min, max, false) + '';\n    if (prefix) {\n        rnd = prefix + rnd;\n    }\n    return rnd;\n}\n\n/***/ }),\n/* 8 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* unused harmony export VARIABLES_PREFIX */\n/* unused harmony export META_PREFIX */\n/* unused harmony export OPERATIONS_PREFIX */\n/* unused harmony export _shouldFetch */\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = RunRouter;\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__run_meta_channel__ = __webpack_require__(61);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__run_variables_channel__ = __webpack_require__(62);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__run_operations_channel__ = __webpack_require__(64);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_channels_channel_router__ = __webpack_require__(4);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_channels_channel_router_utils__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_channels_route_handlers_route_matchers__ = __webpack_require__(6);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_lodash__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_lodash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_lodash__);\n\n\n\n\n\n\n\n\n\n\nvar VARIABLES_PREFIX = 'variables:';\nvar META_PREFIX = 'meta:';\nvar OPERATIONS_PREFIX = 'operations:';\n\n/**\n * \n * @param {Publishable[]} result \n * @param {string[]} ignoreOperations \n * @returns {boolean}\n */\nfunction _shouldFetch(result, ignoreOperations) {\n    var filtered = (result || []).filter(function (r) {\n        var name = r.name || '';\n        var isIgnored = (ignoreOperations || []).indexOf(name.replace(OPERATIONS_PREFIX, '')) !== -1;\n        var isVariable = name.indexOf(VARIABLES_PREFIX) === 0;\n        var isOperation = name.indexOf(OPERATIONS_PREFIX) === 0;\n\n        return isVariable || isOperation && !isIgnored;\n    });\n    return filtered.length > 0;\n}\n\nfunction RunRouter(config, notifier) {\n    var _this = this;\n\n    var defaults = {\n        serviceOptions: {},\n        channelOptions: {\n            variables: {\n                autoFetch: true,\n                debounce: 200,\n                silent: false,\n                readOnly: false\n            },\n            operations: {\n                readOnly: false,\n                silent: false\n            },\n            meta: {\n                silent: false,\n                autoFetch: true,\n                readOnly: ['id', 'created', 'account', 'project', 'model', 'lastModified']\n            }\n        }\n    };\n    var opts = $.extend(true, {}, defaults, config);\n\n    var serviceOptions = __WEBPACK_IMPORTED_MODULE_6_lodash___default.a.result(opts, 'serviceOptions');\n\n    var $initialProm = null;\n    if (serviceOptions instanceof window.F.service.Run) {\n        $initialProm = $.Deferred().resolve(serviceOptions).promise();\n    } else if (serviceOptions.then) {\n        $initialProm = serviceOptions;\n    } else {\n        var rs = new window.F.service.Run(serviceOptions);\n        $initialProm = $.Deferred().resolve(rs).promise();\n    }\n\n    var operationNotifier = Object(__WEBPACK_IMPORTED_MODULE_4_channels_channel_router_utils__[\"g\" /* withPrefix */])(notifier, OPERATIONS_PREFIX);\n    var variableNotifier = Object(__WEBPACK_IMPORTED_MODULE_4_channels_channel_router_utils__[\"g\" /* withPrefix */])(notifier, [VARIABLES_PREFIX, '']);\n\n    var metaChannel = new __WEBPACK_IMPORTED_MODULE_0__run_meta_channel__[\"a\" /* default */]($initialProm, Object(__WEBPACK_IMPORTED_MODULE_4_channels_channel_router_utils__[\"g\" /* withPrefix */])(notifier, META_PREFIX));\n    var operationsChannel = new __WEBPACK_IMPORTED_MODULE_2__run_operations_channel__[\"a\" /* default */]($initialProm, operationNotifier);\n    var variableschannel = new __WEBPACK_IMPORTED_MODULE_1__run_variables_channel__[\"a\" /* default */]($initialProm, variableNotifier);\n\n    var subscribed = false;\n    $initialProm.then(function (rs) {\n        if (rs.channel && !subscribed) {\n            subscribed = true;\n            var TOPICS = rs.channel.TOPICS;\n\n            var subscribeOpts = { includeMine: false };\n            //FIXME: Exclude silenced -- let notify take care of this?\n            //FIXME: Provide subscription fn to individual channels and let them handle it\n            rs.channel.subscribe(TOPICS.RUN_VARIABLES, function (data, meta) {\n                console.log('variables', data, meta);\n                variableschannel.notify(data, meta);\n                variableschannel.fetch();\n            }, _this, subscribeOpts);\n            rs.channel.subscribe(TOPICS.RUN_OPERATIONS, function (data, meta) {\n                operationsChannel.notify(data, meta);\n                variableschannel.fetch();\n            }, _this, subscribeOpts);\n            rs.channel.subscribe(TOPICS.RUN_RESET, function (data, meta) {\n                operationsChannel.notify({ name: 'reset', result: data }, meta);\n            }, _this, subscribeOpts);\n\n            // rs.channel.subscribe('', (data, meta)=> {\n            //     console.log('everything', data, meta);\n            // });\n        }\n    });\n\n    var handlers = [$.extend({}, metaChannel, {\n        name: 'meta',\n        match: Object(__WEBPACK_IMPORTED_MODULE_5_channels_route_handlers_route_matchers__[\"b\" /* matchPrefix */])(META_PREFIX),\n        options: opts.channelOptions.meta\n    }), $.extend({}, operationsChannel, {\n        name: 'operations',\n        match: Object(__WEBPACK_IMPORTED_MODULE_5_channels_route_handlers_route_matchers__[\"b\" /* matchPrefix */])(OPERATIONS_PREFIX),\n        options: opts.channelOptions.operations\n    }), $.extend({}, variableschannel, {\n        isDefault: true,\n        name: 'variables',\n        match: Object(__WEBPACK_IMPORTED_MODULE_5_channels_route_handlers_route_matchers__[\"a\" /* matchDefaultPrefix */])(VARIABLES_PREFIX),\n        options: opts.channelOptions.variables\n    })];\n\n    // router.addRoute(prefix('meta:'), metaChannel, opts.channelOptions.meta);\n\n    var runRouter = Object(__WEBPACK_IMPORTED_MODULE_3_channels_channel_router__[\"a\" /* default */])(handlers);\n    var oldhandler = runRouter.publishHandler;\n    runRouter.publishHandler = function () {\n        var prom = oldhandler.apply(__WEBPACK_IMPORTED_MODULE_3_channels_channel_router__[\"a\" /* default */], arguments);\n        return prom.then(function (result) {\n            //all the silencing will be taken care of by the router\n            var shouldFetch = _shouldFetch(result, ['reset']);\n            if (shouldFetch) {\n                variableschannel.fetch();\n            }\n            return result;\n        });\n    };\n    return runRouter;\n}\n\n/***/ }),\n/* 9 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* unused harmony export _findMostConsequtive */\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = addChangeClassesToList;\n/* harmony export (immutable) */ __webpack_exports__[\"b\"] = addContentAndAnimate;\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _findMostConsequtive(arr, match) {\n    var reduced = arr.reduce(function (accum, val) {\n        if (val === match) {\n            if (accum.prev === match) {\n                accum.count = accum.count + 1;\n            } else {\n                accum.count = 1;\n            }\n        }\n        accum.maxCount = Math.max(accum.maxCount, accum.count);\n        accum.prev = val;\n        return accum;\n    }, { prev: null, count: 0, maxCount: 0 });\n    return reduced.maxCount;\n}\n\nfunction buildDiffArray(currentcontents, newContents) {\n    return newContents.map(function (contents, index) {\n        var isSame = contents === currentcontents[index];\n        return isSame;\n    });\n}\n\nfunction fill(count, val) {\n    var a = [];\n    for (var i = 0; i < count; i++) {\n        a.push(val);\n    }\n    return a;\n}\n\nfunction elToContents(el) {\n    //ignore data attributes for comparison\n    return el.outerHTML.replace(/\\s?data-[a-zA-Z]*=['\"][a-zA-Z0-9]*['\"]/g, '').replace(/\\s\\s/g, ' ').trim();\n}\n\nfunction elementsToContents($els) {\n    return $els.map(function (index, child) {\n        return elToContents(child);\n    }).get();\n}\n\nvar defaults = {\n    addAttr: 'data-add',\n    changeAttr: 'data-update',\n    initialAttr: 'data-initial'\n};\n\n/**\n * Compares 2 lists and Adds add or update classes\n * @param {JQuery<HTMLElement>} $currentEls existing elements\n * @param {JQuery<HTMLElement>} $newEls   new elements\n * @param {Boolean} isInitial check if this is initial data or it's updating\n * @param {{ addAttr: string, changeAttr: string}} [options]\n * @returns {JQuery<HTMLElement>} elements with updated attributes\n */\nfunction addChangeClassesToList($currentEls, $newEls, isInitial, options) {\n    var opts = $.extend({}, defaults, options);\n\n    var currentcontents = elementsToContents($currentEls);\n    var newContents = elementsToContents($newEls);\n    var reversedContents = currentcontents;\n\n    //Guess if data was added to end or beginning of array\n    var diffFromEnd = buildDiffArray(currentcontents, newContents);\n    var diffFromBeginning = buildDiffArray(reversedContents.slice().reverse(), newContents.slice().reverse());\n\n    var endMatches = _findMostConsequtive(diffFromEnd, true);\n    var beginningMatches = _findMostConsequtive(diffFromBeginning, true);\n\n    var placeHoldersCount = newContents.length - currentcontents.length;\n    var placeHolders = fill(placeHoldersCount, undefined);\n\n    if (beginningMatches <= endMatches) {\n        currentcontents = currentcontents.concat(placeHolders);\n    } else {\n        currentcontents = placeHolders.concat(currentcontents);\n    }\n\n    for (var i = 0; i < newContents.length; i++) {\n        var $el = $newEls.eq(i);\n        var curr = currentcontents[i];\n        $el.removeAttr(opts.initialAttr);\n\n        var contents = elToContents($el.get(0));\n        if (curr === undefined) {\n            var _$el$attr;\n\n            $el.attr((_$el$attr = {}, _defineProperty(_$el$attr, opts.addAttr, true), _defineProperty(_$el$attr, opts.initialAttr, isInitial || null), _$el$attr));\n            $el.removeAttr(opts.changeAttr);\n        } else if (curr !== contents) {\n            var _$el$attr2;\n\n            $el.attr((_$el$attr2 = {}, _defineProperty(_$el$attr2, opts.changeAttr, true), _defineProperty(_$el$attr2, opts.initialAttr, isInitial || null), _$el$attr2));\n            $el.removeAttr(opts.addAttr);\n        } else {\n            $el.removeAttr(opts.addAttr + ' ' + opts.changeAttr);\n        }\n    }\n\n    return $newEls;\n}\n\nfunction addContentAndAnimate($el, newValue, isInitial, options) {\n    var opts = $.extend({}, defaults, options);\n    var current = $el.html().trim();\n\n    $el.removeAttr(opts.changeAttr + ' ' + opts.initialAttr);\n    if (current === ('' + newValue).trim()) {\n        return $el;\n    }\n\n    $el.html(newValue);\n    setTimeout(function () {\n        var _$el$attr3;\n\n        $el.attr((_$el$attr3 = {}, _defineProperty(_$el$attr3, opts.changeAttr, true), _defineProperty(_$el$attr3, opts.initialAttr, isInitial || null), _$el$attr3));\n    }, 0); //need this to trigger animation\n}\n\n/***/ }),\n/* 10 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (immutable) */ __webpack_exports__[\"d\"] = getKnownDataForEl;\n/* harmony export (immutable) */ __webpack_exports__[\"i\"] = updateKnownDataForEl;\n/* harmony export (immutable) */ __webpack_exports__[\"g\"] = removeKnownData;\n/* unused harmony export getTemplateTags */\n/* harmony export (immutable) */ __webpack_exports__[\"f\"] = isTemplated;\n/* harmony export (immutable) */ __webpack_exports__[\"c\"] = findMissingReferences;\n/* harmony export (immutable) */ __webpack_exports__[\"h\"] = stubMissingReferences;\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = addBackMissingReferences;\n/* harmony export (immutable) */ __webpack_exports__[\"e\"] = getOriginalContents;\n/* harmony export (immutable) */ __webpack_exports__[\"b\"] = clearOriginalContents;\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_lodash__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_lodash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_lodash__);\n\n\nvar CURRENT_INDEX_KEY = 'current-index';\nvar CURRENT_INDEX_ATTR = 'data-' + CURRENT_INDEX_KEY;\n\nfunction getKnownDataForEl($el) {\n    var closestKnownDataEl = $el.closest('[' + CURRENT_INDEX_ATTR + ']');\n    var knownData = {};\n    if (closestKnownDataEl.length) {\n        knownData = closestKnownDataEl.data(CURRENT_INDEX_KEY);\n    }\n    return knownData;\n}\nfunction updateKnownDataForEl($el, data) {\n    $el.attr(CURRENT_INDEX_ATTR, JSON.stringify(data));\n}\nfunction removeKnownData($el) {\n    $el.removeAttr(CURRENT_INDEX_ATTR);\n}\n\nfunction getTemplateTags(template) {\n    template = template.replace(/&lt;/g, '<').replace(/&gt;/g, '>');\n    var templateTagsUsed = template.match(/<%[=-]?([\\s\\S]+?)%>/g);\n    return templateTagsUsed || [];\n}\nfunction isTemplated(template) {\n    return getTemplateTags(template).length > 0;\n}\n\nfunction findMissingReferences(template, knownDataKeys) {\n    function isKnownTag(tag, knownTags) {\n        var match = knownDataKeys.find(function (key) {\n            var regex = new RegExp('\\\\b' + key + '\\\\b');\n            return regex.test(tag);\n        });\n        return match;\n    }\n\n    template = template.replace(/&lt;/g, '<').replace(/&gt;/g, '>');\n    var missingReferences = {};\n    var templateTagsUsed = getTemplateTags(template);\n    if (templateTagsUsed) {\n        templateTagsUsed.forEach(function (tag) {\n            if (tag.match(/\\w+/) && !isKnownTag(tag, knownDataKeys)) {\n                var refKey = missingReferences[tag];\n                if (!refKey) {\n                    refKey = Object(__WEBPACK_IMPORTED_MODULE_0_lodash__[\"uniqueId\"])('no-ref');\n                    missingReferences[tag] = refKey;\n                }\n            }\n        });\n    }\n    return missingReferences;\n}\n\nfunction refToMarkup(refKey) {\n    return '<!--' + refKey + '-->';\n}\n\nfunction stubMissingReferences(template, missingReferences) {\n    template = template.replace(/&lt;/g, '<').replace(/&gt;/g, '>');\n\n    Object.keys(missingReferences).forEach(function (tag) {\n        var refId = missingReferences[tag];\n        var r = new RegExp(tag, 'g');\n        template = template.replace(r, refToMarkup(refId));\n    });\n    return template;\n}\n\nfunction addBackMissingReferences(template, missingReferences) {\n    Object.keys(missingReferences).forEach(function (originalTemplateVal) {\n        var commentRef = missingReferences[originalTemplateVal];\n        var r = new RegExp(refToMarkup(commentRef), 'g');\n        template = template.replace(r, originalTemplateVal);\n    });\n\n    return template;\n}\n\nvar elTemplateMap = new WeakMap();\nfunction getOriginalContents($el, resolver) {\n    var el = $el.get(0);\n    var originalHTML = elTemplateMap.get(el);\n    if (!originalHTML && resolver) {\n        originalHTML = resolver($el).replace(/&lt;/g, '<').replace(/&gt;/g, '>');\n        elTemplateMap.set(el, originalHTML);\n    }\n    return originalHTML;\n}\nfunction clearOriginalContents($el) {\n    var el = $el.get(0);\n    elTemplateMap.delete(el);\n}\n\n/***/ }),\n/* 11 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar config = __webpack_require__(1);\nvar BaseView = __webpack_require__(12);\n\nmodule.exports = BaseView.extend({\n    propertyHandlers: [],\n\n    uiChangeEvent: 'change',\n    getUIValue: function () {\n        return this.$el.val();\n    },\n\n    removeEvents: function () {\n        this.$el.off(this.uiChangeEvent);\n    },\n\n    initialize: function () {\n        var me = this;\n        var propName = this.$el.data(config.binderAttr);\n\n        if (propName) {\n            this.$el.off(this.uiChangeEvent).on(this.uiChangeEvent, function () {\n                var val = me.getUIValue();\n\n                var payload = [{ name: propName, value: val }];\n                me.$el.trigger(config.events.trigger, { data: payload, source: 'bind' });\n            });\n        }\n        BaseView.prototype.initialize.apply(this, arguments);\n    }\n}, { selector: 'input, select, textarea' });\n\n/***/ }),\n/* 12 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar BaseView = __webpack_require__(13);\n\nmodule.exports = BaseView.extend({\n    propertyHandlers: [],\n\n    initialize: function () {}\n}, { selector: '*' });\n\n/***/ }),\n/* 13 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar _require = __webpack_require__(0),\n    extend = _require.extend,\n    has = _require.has;\n\nvar extendView = function (protoProps, staticProps) {\n    var me = this;\n    var child;\n\n    // The constructor function for the new subclass is either defined by you\n    // (the \"constructor\" property in your `extend` definition), or defaulted\n    // by us to simply call the parent's constructor.\n    if (protoProps && has(protoProps, 'constructor')) {\n        child = protoProps.constructor;\n    } else {\n        child = function () {\n            return me.apply(this, arguments);\n        };\n    }\n\n    // Add static properties to the constructor function, if supplied.\n    extend(child, me, staticProps);\n\n    // Set the prototype chain to inherit from `parent`, without calling\n    // `parent`'s constructor function.\n    var Surrogate = function () {\n        this.constructor = child;\n    };\n    Surrogate.prototype = me.prototype;\n    child.prototype = new Surrogate();\n\n    // Add prototype properties (instance properties) to the subclass,\n    // if supplied.\n    if (protoProps) {\n        extend(child.prototype, protoProps);\n    }\n\n    // Set a convenience property in case the parent's prototype is needed\n    // later.\n    child.__super__ = me.prototype; //eslint-disable-line no-underscore-dangle\n\n    return child;\n};\n\nvar View = function (options) {\n    this.$el = options.$el || $(options.el);\n    this.el = options.el;\n    this.initialize.apply(this, arguments);\n};\nextend(View.prototype, {\n    initialize: function () {}\n});\n\nView.extend = extendView;\n\nmodule.exports = View;\n\n/***/ }),\n/* 14 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* unused harmony export extractVariableName */\n/* unused harmony export parseKeyAlias */\n/* unused harmony export parseValueAlias */\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = aliasesFromTopics;\n/* harmony export (immutable) */ __webpack_exports__[\"b\"] = parseTopics;\nvar IN_OF_REGEX = /\\((.*)\\) (?:in|of)\\s+(.*)/;\nvar KEY_VALUE_REGEX = /(.*),(.*)/;\n\n/**\n * @param {string} attrVal \n * @return {string}\n */\nfunction extractVariableName(attrVal) {\n    var inMatch = attrVal.trim().match(IN_OF_REGEX);\n    var varName = inMatch ? inMatch[2] : attrVal;\n    return varName.trim();\n}\n\n/**\n * @param {string} attrVal \n * @return {string}\n */\nfunction parseKeyAlias(attrVal) {\n    var inMatch = attrVal.match(IN_OF_REGEX);\n    if (!inMatch) {\n        return undefined;\n    }\n    var itMatch = inMatch[1].match(KEY_VALUE_REGEX);\n    var alias = itMatch ? itMatch[1].trim() : undefined;\n    return alias;\n}\n\n/**\n * @param {string} attrVal \n * @return {string}\n */\nfunction parseValueAlias(attrVal) {\n    var inMatch = attrVal.match(IN_OF_REGEX);\n    if (!inMatch) {\n        return undefined;\n    }\n    var itMatch = inMatch[1].match(KEY_VALUE_REGEX);\n    var alias = itMatch ? itMatch[2] : inMatch[1];\n    return alias.trim();\n}\n\n//Public exports\n\nfunction aliasesFromTopics(topics, value) {\n    var relevantTopic = topics[0]; //doesn't support multiple topics\n\n    var defaultKey = $.isPlainObject(value) ? 'key' : 'index';\n    var keyAlias = relevantTopic.keyAlias || defaultKey;\n    var valueAlias = relevantTopic.valueAlias || 'value';\n\n    return { keyAlias: keyAlias, valueAlias: valueAlias };\n}\nfunction parseTopics(topics) {\n    var attrVal = topics[0].name; //doesn't support multiple topics\n    return [{\n        name: extractVariableName(attrVal),\n        keyAlias: parseKeyAlias(attrVal),\n        valueAlias: parseValueAlias(attrVal)\n    }];\n}\n\n/***/ }),\n/* 15 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = extractDependencies;\n/* harmony export (immutable) */ __webpack_exports__[\"b\"] = interpolateWithValues;\nvar interpolationRegex = /<(.*?)>/g;\n/**\n *  \n * @param {String} topic topic to extract dependencies from\n * @return {String[]} dependencies\n */\nfunction extractDependencies(topic) {\n    var deps = (topic.match(interpolationRegex) || []).map(function (val) {\n        return val.substring(1, val.length - 1);\n    });\n    return deps;\n}\n\n/**\n * @param {String} topic topic with dependencies\n * @param {Object} data object with values of dependencies\n * @return {String} interpolated string\n */\nfunction interpolateWithValues(topic, data) {\n    var interpolatedTopic = topic.replace(interpolationRegex, function (match, dependency) {\n        var val = data[dependency];\n        var toReplace = Array.isArray(val) ? val[val.length - 1] : val;\n        return toReplace;\n    });\n    return interpolatedTopic;\n}\n\n/***/ }),\n/* 16 */\n/***/ (function(module, exports, __webpack_require__) {\n\n/**\n * ## Flow.js Initialization\n *\n * To use Flow.js in your project, simply call `Flow.initialize()` in your user interface. In the basic case, `Flow.initialize()` can be called without any arguments. While Flow.js needs to know the account, project, and model you are using, by default these values are extracted from the URL of Epicenter project and by the use of `data-f-model` in your `<body>` tag. See more on the [basics of using Flow.js in your project.](../../#using_in_project).\n *\n * However, sometimes you want to be explicit in your initialization call, and there are also some additional parameters that let you customize your use of Flow.js.\n *\n * #### Parameters\n *\n * The parameters for initializing Flow.js include:\n *\n * * `channel` Configuration details for the channel Flow.js uses in connecting with underlying APIs.\n * * `channel.strategy` The run creation strategy describes when to create new runs when an end user visits this page. The default is `new-if-persisted`, which creates a new run when the end user is idle for longer than your project's **Model Session Timeout** (configured in your project's [Settings](../../../updating_your_settings/)), but otherwise uses the current run.. See more on [Run Strategies](../../../api_adapters/generated/strategies/).\n * * `channel.run` Configuration details for each run created.\n * * `channel.run.account` The **User ID** or **Team ID** for this project. By default, taken from the URL where the user interface is hosted, so you only need to supply this is you are running your project's user interface [on your own server](../../../how_to/self_hosting/).\n * * `channel.run.project` The **Project ID** for this project.\n * * `channel.run.model` Name of the primary model file for this project. By default, taken from `data-f-model` in your HTML `<body>` tag.\n * * `channel.run.variables` Configuration options for the variables being listened to on this channel.\n * * `channel.run.variables.silent` Provides granular control over when user interface updates happen for changes on this channel. See below for possible values.\n * * `channel.run.variables.autoFetch` Options for fetching variables from the API as they're being subscribed. See [Variables Channel](../channels/variables-channel/) for details.\n * * `channel.run.operations` Configuration options for the operations being listened to on this channel. Currently there is only one configuration option: `silent`.\n * * `channel.run.operations.silent` Provides granular control over when user interface updates happen for changes on this channel. See below for possible values.\n * * `channel.run.server` Object with additional server configuration, defaults to `host: 'api.forio.com'`.\n * * `channel.run.transport` An object which takes all of the jquery.ajax options at <a href=\"http://api.jquery.com/jQuery.ajax/\">http://api.jquery.com/jQuery.ajax/</a>.\n * * `dom` Configuration options for the DOM where this instance of Flow.js is created.\n * * `dom.root` The root HTML element being managed by the Flow.js DOM Manager. Defaults to `body`.\n * * `dom.autoBind` If `true` (default), automatically parse variables added to the DOM after this `Flow.initialize()` call. Note, this does not work in IE versions < 11.\n *\n * The `silent` configuration option for the `run.variables` and `run.operations` is a flag for providing more granular control over when user interface updates happen for changes on this channel. Values can be:\n *\n * * `false`: Always update the UI for any changes (variables updated, operations called) on this channel. This is the default behavior.\n * * `true`: Never update the UI for any on changes (variables updated, operations called) on this channel.\n * * Array of variables or operations for which the UI *should not* be updated. For example, `variables: { silent: [ 'price', 'sales' ] }` means this channel is silent (no updates for the UI) when the variables 'price' or 'sales' change, and the UI is always updated for any changes to other variables. This is useful if you know that changing 'price' or 'sales' does not impact anything else in the UI directly, for instance.\n * * `except`: With array of variables or operations for which the UI *should* be updated. For example, `variables { silent: { except: [ 'price', 'sales' ] } }` is the converse of the above. The UI is always updated when anything on this channel changes *except* when the variables 'price' or 'sales' are updated.\n *\n * Although Flow.js provides a bi-directional binding between the model and the user interface, the `silent` configuration option applies only for the binding from the model to the user interface; updates in the user interface (including calls to operations) are still sent to the model.\n *\n * The `Flow.initialize()` call is based on the Epicenter.js [Run Service](../../../api_adapters/generated/run-api-service/) from the [API Adapters](../../../api_adapters/). See those pages for additional information on parameters.\n *\n * The `Flow.initialize()` call returns a promise, which is resolved when initialization is complete.\n *\n * #### Example\n *\n *      Flow.initialize({\n *          channel: {\n *              strategy: 'new-if-persisted',\n *              run: {\n *                  model: 'supply-chain-game.py',\n *                  account: 'acme-simulations',\n *                  project: 'supply-chain-game',\n *                  server: { host: 'api.forio.com' },\n *                  variables: { silent: ['price', 'sales'] },\n *                  operations: { silent: false },\n *                  transport: {\n *                      beforeSend: function() { $('body').addClass('loading'); },\n *                      complete: function() { $('body').removeClass('loading'); }\n *                  }\n *              }\n *          }\n *      }).then(function() {\n *          // code that depends on initialization\n *      });\n *\n */\n\nvar domManager = __webpack_require__(17);\nvar BaseView = __webpack_require__(13);\n\nvar ChannelManager = __webpack_require__(51).default;\nvar config = __webpack_require__(1);\n\nvar Flow = {\n    dom: domManager,\n    utils: {\n        BaseView: BaseView\n    },\n    initialize: function (config) {\n        var model = $('body').data('f-model');\n\n        var defaults = {\n            channel: {\n                //FIXME: Defaults can't be here..\n                defaults: {\n                    run: {\n                        model: model\n                    }\n                }\n            },\n            dom: {\n                root: 'body',\n                autoBind: true\n            }\n        };\n\n        var options = $.extend(true, {}, defaults, config);\n\n        if (config && config.channel && config.channel instanceof ChannelManager) {\n            this.channel = config.channel;\n        } else {\n            this.channel = new ChannelManager(options.channel);\n        }\n\n        var prom = domManager.initialize($.extend(true, {\n            channel: this.channel\n        }, options.dom));\n\n        this.channel.subscribe('operations:reset', function () {\n            domManager.unbindAll();\n            domManager.bindAll();\n        });\n\n        return prom;\n    }\n};\nFlow.ChannelManager = ChannelManager;\nFlow.constants = config;\n//set by grunt\nif (true) Flow.version = \"0.11.0\"; //eslint-disable-line no-undef\nmodule.exports = Flow;\n\n/***/ }),\n/* 17 */\n/***/ (function(module, exports, __webpack_require__) {\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n/**\n * ## DOM Manager\n *\n * The Flow.js DOM Manager provides two-way data bindings from your project's user interface to the channel. The DOM Manager is the 'glue' through which HTML DOM elements -- including the attributes and attribute handlers provided by Flow.js for [variables](../../attributes-overview/), [operations](../../operations-overview/) and [conversion](../../converter-overview/), and those [you create](./attributes/attribute-manager/) -- are bound to the variable and operations [channels](../../channel-overview/) to link them with your project's model. See the [Epicenter architecture details](../../../creating_your_interface/arch_details/) for a visual description of how the DOM Manager relates to the [rest of the Epicenter stack](../../../creating_your_interface/).\n *\n * The DOM Manager is an integral part of the Flow.js architecture but, in keeping with our general philosophy of extensibility and configurability, it is also replaceable. For instance, if you want to manage your DOM state with [Backbone Views](http://backbonejs.org) or [Angular.js](https://angularjs.org), while still using the channels to handle the communication with your model, this is the piece you'd replace. [Contact us](http://forio.com/about/contact/) if you are interested in extending Flow.js in this way -- we'll be happy to talk about it in more detail.\n *\n */\n\nvar _require = __webpack_require__(18),\n    getConvertersForEl = _require.getConvertersForEl,\n    getChannelForAttribute = _require.getChannelForAttribute,\n    getChannelConfigForElement = _require.getChannelConfigForElement,\n    parseTopicsFromAttributeValue = _require.parseTopicsFromAttributeValue;\n\nvar _require2 = __webpack_require__(22),\n    addPrefixToTopics = _require2.addPrefixToTopics,\n    addDefaultPrefix = _require2.addDefaultPrefix;\n\nvar _require3 = __webpack_require__(3),\n    toImplicitType = _require3.toImplicitType;\n\nvar _require4 = __webpack_require__(0),\n    pick = _require4.pick;\n\nvar config = __webpack_require__(1);\n\nvar converterManager = __webpack_require__(23).default;\nvar nodeManager = __webpack_require__(32).default;\nvar attrManager = __webpack_require__(34).default;\nvar autoUpdatePlugin = __webpack_require__(50).default;\n\nmodule.exports = function () {\n    //Jquery selector to return everything which has a f- property set\n    $.expr.pseudos[config.prefix] = function (el) {\n        if (!el || !el.attributes) {\n            return false;\n        }\n        for (var i = 0; i < el.attributes.length; i++) {\n            var attr = el.attributes[i].nodeName;\n            if (attr.indexOf('data-' + config.prefix) === 0) {\n                return true;\n            }\n        }\n        return false;\n    };\n\n    /**\n     * @param {JQuery<HTMLElement>} root\n     * @return {JQuery<HTMLElement>}\n     */\n    function getMatchingElements(root) {\n        var $root = $(root);\n        var matchedElements = $root.find(':' + config.prefix);\n        if ($root.is(':' + config.prefix)) {\n            matchedElements = matchedElements.add($root);\n        }\n        return matchedElements;\n    }\n\n    /**\n     * @param {JQuery<HTMLElement> | HTMLElement} element\n     * @param {*} [context]\n     * @return {HTMLElement}\n     */\n    function getElementOrError(element, context) {\n        var el = element instanceof $ ? element.get(0) : element;\n        if (!el || !el.nodeName) {\n            console.error(context, 'Expected to get DOM Element, got ', element);\n            throw new Error(context + ': Expected to get DOM Element, got' + typeof element);\n        }\n        return el;\n    }\n\n    //Unbind utils\n    function removeAllSubscriptions(subscriptions, channel) {\n        [].concat(subscriptions).forEach(function (subs) {\n            channel.unsubscribe(subs);\n        });\n    }\n    function unbindAllAttributes(domEl) {\n        var $el = $(domEl);\n        $(domEl.attributes).each(function (index, nodeMap) {\n            var attr = nodeMap.nodeName;\n            var wantedPrefix = 'data-f-';\n            if (attr.indexOf(wantedPrefix) === 0) {\n                attr = attr.replace(wantedPrefix, '');\n                var handler = attrManager.getHandler(attr, $el);\n                if (handler.unbind) {\n                    handler.unbind(attr, $el);\n                }\n            }\n        });\n    }\n    function unbindAllNodeHandlers(domEl) {\n        var $el = $(domEl);\n        //FIXME: have to readd events to be able to remove them. Ugly\n        var Handler = nodeManager.getHandler($el);\n        var h = new Handler.handle({\n            el: domEl\n        });\n        if (h.removeEvents) {\n            h.removeEvents();\n        }\n    }\n\n    var publicAPI = {\n\n        nodes: nodeManager,\n        attributes: attrManager,\n        converters: converterManager,\n\n        matchedElements: new Map(),\n\n        /**\n         * Unbind the element; unsubscribe from all updates on the relevant channels.\n         *\n         * @param {JQuery<HTMLElement> | HTMLElement} element The element to remove from the data binding.\n         * @param {Channel} channel (Optional) The channel from which to unsubscribe. Defaults to the [variables channel](../channels/variables-channel/).\n         * @returns {void}\n         */\n        unbindElement: function (element, channel) {\n            if (!channel) {\n                channel = this.options.channel;\n            }\n            var domEl = getElementOrError(element);\n            var $el = $(element);\n            var existingData = this.matchedElements.get(domEl);\n            if (!$el.is(':' + config.prefix) || !existingData) {\n                return;\n            }\n            this.matchedElements.delete(element);\n            var subscriptions = Object.keys(existingData).reduce(function (accum, a) {\n                var subsid = existingData[a].subscriptionId;\n                if (subsid) accum.push(subsid);\n                return accum;\n            }, []);\n\n            unbindAllNodeHandlers(domEl);\n            unbindAllAttributes(domEl);\n            removeAllSubscriptions(subscriptions, channel);\n\n            var animAttrs = Object.keys(config.animation).join(' ');\n            $el.removeAttr(animAttrs);\n\n            Object.keys($el.data()).forEach(function (key) {\n                if (key.indexOf('f-') === 0 || key.match(/^f[A-Z]/)) {\n                    $el.removeData(key);\n                }\n            });\n        },\n\n        /**\n         * Bind the element: subscribe from updates on the relevant channels.\n         *\n         * @param {HTMLElement | JQuery<HTMLElement>} element The element to add to the data binding.\n         * @param {Channel} channel (Optional) The channel to subscribe to. Defaults to the [run channel](../channels/run-channel/).\n         * @returns {void}\n         */\n        bindElement: function (element, channel) {\n            if (!channel) {\n                channel = this.options.channel;\n            }\n            // this.unbindElement(element); //unbind actually removes the data,and jquery doesn't refetch when .data() is called..\n            var domEl = getElementOrError(element);\n            var $el = $(domEl);\n            if (!$el.is(':' + config.prefix)) {\n                return;\n            }\n\n            //Send to node manager to handle ui changes\n            var Handler = nodeManager.getHandler($el);\n            new Handler.handle({\n                el: domEl\n            });\n\n            var filterPrefix = 'data-' + config.prefix + '-';\n            var attrList = {};\n            $(domEl.attributes).each(function (index, nodeMap) {\n                var attr = nodeMap.nodeName;\n                if (attr.indexOf(filterPrefix) !== 0) {\n                    return;\n                }\n                attr = attr.replace(filterPrefix, '');\n\n                var attrVal = nodeMap.value;\n                var topics = parseTopicsFromAttributeValue(attrVal);\n\n                var handler = attrManager.getHandler(attr, $el);\n                if (handler && handler.init) {\n                    handler.init(attr, topics, $el);\n                }\n                if (topics.length && handler && handler.parse) {\n                    topics = [].concat(handler.parse(topics));\n                }\n\n                var channelPrefix = getChannelForAttribute($el, attr);\n                topics = addPrefixToTopics(topics, channelPrefix);\n\n                var converters = getConvertersForEl($el, attr);\n                attrList[attr] = {\n                    channelPrefix: channelPrefix,\n                    topics: topics,\n                    converters: converters //Store once instead of calculating on demand. Avoids having to parse through dom every time\n                };\n            });\n            //Need this to be set before subscribing or callback maybe called before it's set\n            this.matchedElements.set(domEl, attrList);\n\n            var channelConfig = getChannelConfigForElement(domEl);\n            var attrsWithSubscriptions = Object.keys(attrList).reduce(function (accum, name) {\n                var attr = attrList[name];\n                var topics = attr.topics,\n                    channelPrefix = attr.channelPrefix;\n\n                if (!topics.length) {\n                    accum[name] = attr;\n                    return accum;\n                }\n\n                var subsOptions = $.extend({\n                    batch: true,\n                    onError: function (e) {\n                        console.error('DomManager: Subscription error for', domEl, e);\n                        var msg = e.message || e;\n                        if ($.isPlainObject(msg)) {\n                            msg = JSON.stringify(msg);\n                        }\n                        $el.attr(config.errorAttr, msg);\n                    }\n                }, channelConfig);\n                var subscribableTopics = topics.map(function (t) {\n                    return t.name;\n                });\n                var subsid = channel.subscribe(subscribableTopics, function (data) {\n                    var toConvert = {};\n                    if (subscribableTopics.length === 1) {\n                        //If I'm only interested in 1 thing pass in value directly, else make a map;\n                        toConvert[name] = data[subscribableTopics[0]];\n                    } else {\n                        var dataForAttr = pick(data, subscribableTopics) || {};\n                        toConvert[name] = Object.keys(dataForAttr).reduce(function (accum, key) {\n                            //If this was through a auto-prefixed channel attr return what was bound\n                            var toReplace = new RegExp('^' + channelPrefix + ':');\n                            var k = channelPrefix ? key.replace(toReplace, '') : key;\n                            accum[k] = dataForAttr[key];\n                            return accum;\n                        }, {});\n                    }\n                    $el.removeAttr(config.errorAttr).trigger(config.events.convert, toConvert);\n                }, subsOptions);\n\n                accum[name] = Object.assign({}, attr, { subscriptionId: subsid });\n                return accum;\n            }, {});\n\n            this.matchedElements.set(domEl, attrsWithSubscriptions);\n        },\n\n        /**\n         * Bind all provided elements.\n         *\n         * @param  {JQuery<HTMLElement> | HTMLElement[]} [elementsToBind] (Optional) If not provided, binds all matching elements within default root provided at initialization.\n         * @returns {void}\n         */\n        bindAll: function (elementsToBind) {\n            var _this = this;\n\n            if (!elementsToBind) {\n                elementsToBind = getMatchingElements(this.options.root);\n            } else if (!Array.isArray(elementsToBind)) {\n                elementsToBind = getMatchingElements(elementsToBind);\n            }\n\n            //parse through dom and find everything with matching attributes\n            $.each(elementsToBind, function (index, element) {\n                _this.bindElement(element, _this.options.channel);\n            });\n        },\n        /**\n         * Unbind provided elements.\n         *\n         * @param  {JQuery<HTMLElement> | HTMLElement[]} [elementsToUnbind] (Optional) If not provided, unbinds everything.\n         * @returns {void}\n         */\n        unbindAll: function (elementsToUnbind) {\n            var me = this;\n            if (!elementsToUnbind) {\n                elementsToUnbind = [];\n                this.matchedElements.forEach(function (val, key) {\n                    elementsToUnbind.push(key);\n                });\n            } else if (!Array.isArray(elementsToUnbind)) {\n                elementsToUnbind = getMatchingElements(elementsToUnbind);\n            }\n            $.each(elementsToUnbind, function (index, element) {\n                me.unbindElement(element, me.options.channel);\n            });\n        },\n\n        plugins: {},\n\n        /**\n         * Initialize the DOM Manager to work with a particular HTML element and all elements within that root. Data bindings between individual HTML elements and the model variables specified in the attributes will happen via the channel.\n         *\n         * @param {Object} options (Optional) Overrides for the default options.\n         * @param {string} options.root The root HTML element being managed by this instance of the DOM Manager. Defaults to `body`.\n         * @param {Object} options.channel The channel to communicate with. Defaults to the Channel Manager from [Epicenter.js](../../../api_adapters/).\n         * @param {boolean} options.autoBind If `true` (default), any variables added to the DOM after `Flow.initialize()` has been called will be automatically parsed, and subscriptions added to channels. Note, this does not work in IE versions < 11.\n         * @returns {Promise}\n         */\n        initialize: function (options) {\n            var defaults = {\n                /**\n                 * Root of the element for flow.js to manage from.\n                 * @type {string} jQuery selector\n                 */\n                root: 'body',\n                channel: null,\n\n                /**\n                 * Any variables added to the DOM after `Flow.initialize()` has been called will be automatically parsed, and subscriptions added to channels. Note, this does not work in IE versions < 11.\n                 * @type {boolean}\n                 */\n                autoBind: true\n            };\n            $.extend(defaults, options);\n\n            var channel = defaults.channel;\n\n            this.options = defaults;\n\n            var me = this;\n            var $root = $(defaults.root);\n\n            function attachUIListeners($root) {\n                function parseValue(value, converters) {\n                    if (Array.isArray(value)) {\n                        var parsed = value.map(function (val) {\n                            return toImplicitType(val);\n                        });\n                        return converterManager.parse(parsed, converters);\n                    }\n                    return converterManager.parse(toImplicitType(value), converters);\n                }\n\n                $root.off(config.events.trigger).on(config.events.trigger, function (evt, params) {\n                    var elMeta = me.matchedElements.get(evt.target);\n                    var data = params.data,\n                        source = params.source,\n                        options = params.options;\n\n                    if (!elMeta || !data) {\n                        return;\n                    }\n                    var sourceMeta = elMeta[source] || {};\n                    var channelPrefix = sourceMeta.channelPrefix,\n                        converters = sourceMeta.converters;\n\n                    var $el = $(evt.target);\n\n                    var parsed = [].concat(data).map(function (action) {\n                        var name = action.name,\n                            value = action.value;\n\n                        var parsedValue = parseValue(value, converters);\n                        var actualName = name.split('|')[0].trim(); //FIXME: this shouldn't know about the pipe syntax\n                        var prefixedName = addDefaultPrefix(actualName, source, channelPrefix);\n                        return { name: prefixedName, value: parsedValue };\n                    }, []);\n\n                    channel.publish(parsed, options).then(function (result) {\n                        if (!result || !result.length) {\n                            return;\n                        }\n                        var last = result[result.length - 1];\n                        $el.trigger(config.events.convert, _defineProperty({}, source, last.value));\n                    });\n                });\n            }\n\n            function attachConversionListner($root) {\n                // data = {proptoupdate: value}\n                $root.off(config.events.convert).on(config.events.convert, function (evt, data) {\n                    var $el = $(evt.target);\n\n                    var elMeta = me.matchedElements.get(evt.target);\n                    if (!elMeta) {\n                        return;\n                    }\n\n                    Object.keys(data).forEach(function (prop) {\n                        var val = data[prop];\n                        var _elMeta$prop = elMeta[prop],\n                            converters = _elMeta$prop.converters,\n                            topics = _elMeta$prop.topics;\n\n                        var convertedValue = converterManager.convert(val, converters);\n\n                        var handler = attrManager.getHandler(prop, $el);\n                        handler.handle(convertedValue, prop, $el, topics);\n                    });\n                });\n            }\n\n            var deferred = $.Deferred();\n            $(function () {\n                me.bindAll();\n\n                attachUIListeners($root);\n                attachConversionListner($root);\n\n                me.plugins.autoBind = autoUpdatePlugin($root.get(0), me, me.options.autoBind);\n\n                deferred.resolve($root);\n                $root.trigger('f.domready');\n            });\n\n            return deferred.promise();\n        }\n    };\n\n    return $.extend(this, publicAPI);\n}();\n\n/***/ }),\n/* 18 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__parse_converters__ = __webpack_require__(19);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__parse_channel__ = __webpack_require__(20);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__parse_topics__ = __webpack_require__(21);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"getConvertersForEl\", function() { return __WEBPACK_IMPORTED_MODULE_0__parse_converters__[\"a\"]; });\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"getChannelForAttribute\", function() { return __WEBPACK_IMPORTED_MODULE_1__parse_channel__[\"b\"]; });\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"getChannelConfigForElement\", function() { return __WEBPACK_IMPORTED_MODULE_1__parse_channel__[\"a\"]; });\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"parseTopicsFromAttributeValue\", function() { return __WEBPACK_IMPORTED_MODULE_2__parse_topics__[\"a\"]; });\n\n\n\n\n\n\n/***/ }),\n/* 19 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = getConvertersForEl;\n/**\n * @param {string} conv \n * @returns {string[]}\n */\nfunction convertersToArray(conv) {\n    if (!conv || !conv.trim()) return [];\n    return conv.split('|').map(function (v) {\n        return v.trim();\n    });\n}\n\n/**\n * @param {JQuery<HTMLElement>} $el\n * @param {string} attribute \n * @returns {string[]}\n */\nfunction getConvertersFromAttr($el, attribute) {\n    var attrVal = $el.attr('data-f-' + attribute);\n    var withConv = convertersToArray(attrVal);\n    if (withConv.length > 1) {\n        return withConv.slice(1); //First item will be the topic\n    }\n    return [];\n}\nfunction getFConvertAttrVal($el, suffix) {\n    var baseAttr = 'data-f-convert';\n    var suffixAttr = suffix ? '-' + suffix : '';\n    var conv = $el.attr('' + baseAttr + suffixAttr); //.data shows value cached by jquery\n    return convertersToArray(conv);\n}\n\n/**\n * @param {JQuery<HTMLElement>} $el  \n * @param {string} attribute \n * @returns {string[]} converters\n */\nfunction getConvertersForEl($el, attribute) {\n    function getAllConverters($el, attribute) {\n        var convertersAsPipes = getConvertersFromAttr($el, attribute);\n        if (convertersAsPipes.length) {\n            return convertersAsPipes;\n        }\n\n        var whiteListedGenericAttributes = ['bind', 'foreach', 'repeat'];\n        var canUseFConvert = whiteListedGenericAttributes.indexOf(attribute) !== -1;\n        if (canUseFConvert) {\n            return getFConvertAttrVal($el, '');\n        }\n        return getFConvertAttrVal($el, attribute);\n    }\n\n    var converters = getAllConverters($el, attribute);\n    var $parentEl = $el.parents('[data-f-convert]').eq(0);\n    var resolvedConverters = converters.reduce(function (accum, val) {\n        if (val === 'inherit') {\n            var parentConv = getConvertersForEl($parentEl, attribute);\n            accum = accum.concat(parentConv);\n        } else {\n            accum = accum.concat(val);\n        }\n        return accum;\n    }, []);\n\n    if (!resolvedConverters.length && $parentEl.length) {\n        return getConvertersForEl($parentEl, attribute);\n    }\n    return resolvedConverters;\n}\n\n/***/ }),\n/* 20 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (immutable) */ __webpack_exports__[\"b\"] = getChannelForAttribute;\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = getChannelConfigForElement;\n/**\n * \n * @param {JQuery<HTMLElement>} $el  \n * @param {string} attr \n * @returns {string|undefined}\n */\nfunction getChannelForAttribute($el, attr) {\n    attr = attr.replace('data-f-', '');\n    var channel = $el.data('f-channel-' + attr);\n    if (channel === undefined) {\n        channel = $el.attr('data-f-channel'); //.data shows value cached by jquery\n    }\n    if (channel === undefined) {\n        var $parentEl = $el.closest('[data-f-channel]');\n        if ($parentEl) {\n            channel = $parentEl.attr('data-f-channel');\n        }\n    }\n    return channel;\n}\n\n/**\n * @param {HTMLElement} el\n * @return {object}\n */\nfunction getChannelConfigForElement(el) {\n    //TODO: Should this look at parents too?\n    var attrs = el.attributes;\n    var config = {};\n    for (var i = 0; i < attrs.length; i++) {\n        var attrib = el.attributes[i];\n        if (attrib.specified && attrib.name.indexOf('data-f-channel-') === 0) {\n            var key = attrib.name.replace('data-f-channel-', '');\n            config[key] = attrib.value;\n        }\n    }\n    return config;\n}\n\n/***/ }),\n/* 21 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = parseTopicsFromAttributeValue;\n/**\n * @param {string} attrVal \n * @returns {NormalizedTopic[]} variables\n */\nfunction parseTopicsFromAttributeValue(attrVal) {\n    var commaRegex = /,(?![^[(]*[\\])])/; //split except on a[b,c] or a(v,c)\n    var topicsPart = attrVal.split('|')[0];\n    if (topicsPart.indexOf('<%') !== -1) {\n        //Assume it's templated for later use\n        return [];\n    }\n    var split = topicsPart.split(commaRegex);\n    if (split.length > 1) {\n        return split.map(function (v) {\n            return { name: v.trim() };\n        });\n    }\n    return [{ name: topicsPart.trim() }];\n}\n\n/***/ }),\n/* 22 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony export (immutable) */ __webpack_exports__[\"addPrefixToTopics\"] = addPrefixToTopics;\n/* harmony export (immutable) */ __webpack_exports__[\"addDefaultPrefix\"] = addDefaultPrefix;\n/**\n * \n * @param {NormalizedTopic[]} topics \n * @param {string} prefix \n * @returns {NormalizedTopic[]}\n */\nfunction addPrefixToTopics(topics, prefix) {\n    if (!prefix) {\n        return topics;\n    }\n    var mappedTopics = topics.map(function (topic) {\n        var currentName = topic.name;\n        var hasChannelDefined = currentName.indexOf(':') !== -1;\n        if (!hasChannelDefined) {\n            topic.name = prefix + ':' + currentName;\n        }\n        return topic;\n    });\n    return mappedTopics;\n}\n\nvar DEFAULT_OPERATIONS_PREFIX = 'operations:';\nvar DEFAULT_VARIABLES_PREFIX = 'variables:';\n\nfunction addDefaultPrefix(name, source, channelPrefix) {\n    var isUnprefixed = name.indexOf(':') === -1;\n\n    var defaultPrefix = source.indexOf('on-') === 0 ? DEFAULT_OPERATIONS_PREFIX : DEFAULT_VARIABLES_PREFIX;\n    var needsDefaultPrefix = defaultPrefix !== DEFAULT_VARIABLES_PREFIX;\n\n    if (isUnprefixed && needsDefaultPrefix) {\n        name = '' + defaultPrefix + name;\n    }\n    var hasDefaultPrefix = name.indexOf(defaultPrefix) === 0;\n    if ((isUnprefixed || hasDefaultPrefix) && channelPrefix) {\n        name = channelPrefix + ':' + name;\n    }\n    return name;\n}\n\n/***/ }),\n/* 23 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_lodash__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_lodash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_lodash__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__utils_parse_utils__ = __webpack_require__(3);\n\n\n\nvar normalize = function (alias, converter, acceptList) {\n    var ret = [];\n    //nomalize('flip', fn)\n    if (Object(__WEBPACK_IMPORTED_MODULE_0_lodash__[\"isFunction\"])(converter)) {\n        ret.push({\n            alias: alias,\n            convert: converter,\n            acceptList: acceptList\n        });\n    } else if ($.isPlainObject(converter) && converter.convert) {\n        converter.alias = alias;\n        converter.acceptList = acceptList;\n        ret.push(converter);\n    } else if ($.isPlainObject(alias)) {\n        //normalize({alias: 'flip', convert: function})\n        if (alias.convert) {\n            ret.push(alias);\n        } else {\n            // normalize({flip: fun})\n            $.each(alias, function (key, val) {\n                ret.push({\n                    alias: key,\n                    convert: val,\n                    acceptList: acceptList\n                });\n            });\n        }\n    }\n    return ret;\n};\n\nvar matchConverter = function (alias, converter) {\n    if (Object(__WEBPACK_IMPORTED_MODULE_0_lodash__[\"isString\"])(converter.alias)) {\n        return alias === converter.alias;\n    } else if (Object(__WEBPACK_IMPORTED_MODULE_0_lodash__[\"isFunction\"])(converter.alias)) {\n        return converter.alias(alias);\n    } else if (Object(__WEBPACK_IMPORTED_MODULE_0_lodash__[\"isRegExp\"])(converter.alias)) {\n        return converter.alias.match(alias);\n    }\n    return false;\n};\n\nvar converterManager = {\n    private: {\n        matchConverter: matchConverter\n    },\n\n    list: [],\n    /**\n     * Add a new attribute converter to this instance of Flow.js.\n     *\n     * **Example**\n     *\n     *      Flow.dom.converters.register('max', function (value) {\n     *          return max(value);\n     *      }, true);\n     *\n     *      Flow.dom.converters.register({\n     *          alias: 'sig',\n     *          parse: $.noop,\n     *          convert: function (value) {\n     *              return value.firstName + ' ' + value.lastName + ', ' + value.jobTitle;\n     *      }, false);\n     *\n     *      <div>\n     *          The largest sales you had was <span data-f-bind=\"salesByYear | max | $#,###\"></span>.\n     *          The current sales manager is <span data-f-bind=\"salesMgr | sig\"></span>.\n     *      </div>\n     *\n     * @param  {string|function|RegExp} alias Formatter name.\n     * @param  {function|object} [converter] If a function, `converter` is called with the value. If an object, should include fields for `alias` (name), `parse` (function), and `convert` (function).\n     * @param {boolean} [acceptList] Determines if the converter is a 'list' converter or not. List converters take in arrays as inputs, others expect single values.\n     * @returns {void}\n     */\n    register: function (alias, converter, acceptList) {\n        var normalized = normalize(alias, converter, acceptList);\n        this.list = normalized.concat(this.list);\n    },\n\n    /**\n     * Replace an already registered converter with a new one of the same name.\n     *\n     * @param {string} alias Formatter name.\n     * @param {function|object} converter If a function, `converter` is called with the value. If an object, should include fields for `alias` (name), `parse` (function), and `convert` (function).\n     * @returns {void}\n     */\n    replace: function (alias, converter) {\n        var index;\n        this.list.forEach(function (currentConverter, i) {\n            if (matchConverter(alias, currentConverter)) {\n                index = i;\n                return false;\n            }\n        });\n        this.list.splice(index, 1, normalize(alias, converter)[0]);\n    },\n\n    getConverter: function (alias) {\n        var norm = Object(__WEBPACK_IMPORTED_MODULE_1__utils_parse_utils__[\"splitNameArgs\"])(alias);\n        norm.args = norm.args.map(__WEBPACK_IMPORTED_MODULE_1__utils_parse_utils__[\"toImplicitType\"]);\n\n        var conv = Object(__WEBPACK_IMPORTED_MODULE_0_lodash__[\"find\"])(this.list, function (converter) {\n            return matchConverter(norm.name, converter);\n        });\n        if (conv && norm.args) {\n            return $.extend({}, conv, { convert: Function.bind.apply(conv.convert, [null].concat(norm.args)) });\n        }\n        return conv;\n    },\n\n    /**\n     * Pipes the value sequentially through a list of provided converters.\n     *\n     * @param  {*} value Input for the converter to tag.\n     * @param  {string|string[]} list List of converters (maps to converter alias).\n     *\n     * @return {*} Converted value.\n     */\n    convert: function (value, list) {\n        if (!list || !list.length) {\n            return value;\n        }\n        list = [].concat(list).map(function (v) {\n            return v.trim();\n        });\n\n        var currentValue = value;\n        var me = this;\n\n        var convertArray = function (converter, val, converterName) {\n            return val.map(function (v) {\n                return converter.convert(v, converterName);\n            });\n        };\n        var convert = function (converter, value, converterName) {\n            var converted;\n            if (Array.isArray(value) && converter.acceptList !== true) {\n                converted = convertArray(converter, value, converterName);\n            } else {\n                converted = converter.convert(value, converterName);\n            }\n            return converted;\n        };\n        var convertObject = function (converter, value, converterName) {\n            return Object(__WEBPACK_IMPORTED_MODULE_0_lodash__[\"mapValues\"])(value, function (val) {\n                return convert(converter, val, converterName);\n            });\n        };\n        list.forEach(function (converterName) {\n            var converter = me.getConverter(converterName);\n            if (!converter) {\n                throw new Error('Could not find converter for ' + converterName);\n            }\n            if ($.isPlainObject(currentValue) && converter.acceptList !== true) {\n                currentValue = convertObject(converter, currentValue, converterName);\n            } else {\n                currentValue = convert(converter, currentValue, converterName);\n            }\n        });\n        return currentValue;\n    },\n\n    /**\n     * Counter-part to `convert()`. Translates converted values back to their original form.\n     *\n     * @param  {*} value Value to parse.\n     * @param  {string|string[]} list  List of parsers to run the value through. Outermost is invoked first.\n     * @return {*} Original value.\n     */\n    parse: function (value, list) {\n        if (!list || !list.length) {\n            return value;\n        }\n        list = [].concat(list).reverse().map(function (v) {\n            return v.trim();\n        });\n\n        var currentValue = value;\n        var me = this;\n        list.forEach(function (converterName) {\n            var converter = me.getConverter(converterName);\n            if (!converter) {\n                throw new Error('parse: Could not find converter ' + converterName);\n            }\n            if (converter.parse) {\n                currentValue = converter.parse(currentValue, converterName);\n            }\n        });\n        return currentValue;\n    }\n};\n\n//Bootstrap\nvar defaultconverters = [__webpack_require__(24), __webpack_require__(25), __webpack_require__(26), __webpack_require__(27), __webpack_require__(28), __webpack_require__(29), __webpack_require__(30), __webpack_require__(31)];\n\ndefaultconverters.reverse().forEach(function (converter) {\n    if (Array.isArray(converter)) {\n        converter.forEach(function (c) {\n            converterManager.register(c);\n        });\n    } else {\n        converterManager.register(converter);\n    }\n});\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (converterManager);\n\n/***/ }),\n/* 24 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/**\n * ## Number Converters\n *\n * Converters allow you to change how data is displayed. They let you display the value of any model variable in a different format than it is stored in the model -- converting the output value from one format to another.\n *\n * There are two ways to specify conversion or formatting for the display output of a particular model variable:\n *\n * * Use the `|` (pipe) character within the value of any `data-f-` attribute. Converters are chainable, so you can apply several in a row to a particular variable.\n * * Add the attribute `data-f-convert` to any element to convert all of the model variables referenced within that element's scope.\n *\n */\n\n\n\nmodule.exports = {\n  alias: 'i',\n  /**\n   * Convert the model variable to an integer. Often used for chaining to another converter.\n   *\n   * **Example**\n   *\n   *      <div>\n   *          Your car has driven\n   *          <span data-f-bind=\"Odometer | i | s0.0\"></span> miles.\n   *      </div>\n   *\n   * @param {string} value The model variable.\n   * @return {number}\n   */\n  convert: function (value) {\n    return parseFloat(value);\n  }\n};\n\n/***/ }),\n/* 25 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/**\n * ## String Converters\n *\n * Converters allow you to change how data is displayed. They let you display the value of any model variable in a different format than it is stored in the model -- converting the output value from one format to another.\n *\n * There are two ways to specify conversion or formatting for the display output of a particular model variable:\n *\n * * Use the `|` (pipe) character within the value of any `data-f-` attribute. Converters are chainable, so you can apply several in a row to a particular variable.\n * * Add the attribute `data-f-convert` to any element to convert all of the model variables referenced within that element's scope.\n *\n * For model variables that are strings (or that have been converted to strings), there are several special string formats you can apply.\n */\n\n\n\nmodule.exports = {\n\n    /**\n     * Convert the model variable to a string. Often used for chaining to another converter.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          This year you are in charge of sales for\n     *          <span data-f-bind=\"salesMgr.region | s | upperCase\"></span>.\n     *      </div>\n     *\n     * @param {Array} val The model variable.\n     * @returns {string} converted string\n     */\n    s: function (val) {\n        return val + '';\n    },\n\n    /**\n     * Convert the model variable to UPPER CASE.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          This year you are in charge of sales for\n     *          <span data-f-bind=\"salesMgr.region | s | upperCase\"></span>.\n     *      </div>\n     *\n     * @param {Array} val The model variable.\n     * @returns {string} converted string\n     */\n    upperCase: function (val) {\n        return (val + '').toUpperCase();\n    },\n\n    /**\n     * Convert the model variable to lower case.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          Enter your user name:\n     *          <input data-f-bind=\"userName | lowerCase\"></input>.\n     *      </div>\n     *\n     * @param {Array} val The model variable.\n     * @returns {string} converted string\n     */\n    lowerCase: function (val) {\n        return (val + '').toLowerCase();\n    },\n\n    /**\n     * Convert the model variable to Title Case.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          Congratulations on your promotion!\n     *          Your new title is: <span data-f-bind=\"currentRole | titleCase\"></span>.\n     *      </div>\n     *\n     * @param {string} val The model variable.\n     * @returns {string} converted string\n     */\n    titleCase: function (val) {\n        val = val + '';\n        return val.replace(/\\w\\S*/g, function (txt) {\n            return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();\n        });\n    }\n};\n\n/***/ }),\n/* 26 */\n/***/ (function(module, exports, __webpack_require__) {\n\n/**\n * ## Array Converters\n *\n * Converters allow you to change how data is displayed. They let you display the value of any model variable in a different format than it is stored in the model -- converting the output value from one format to another.\n *\n * There are two ways to specify conversion or formatting for the display output of a particular model variable:\n *\n * * Use the `|` (pipe) character within the value of any `data-f-` attribute. Converters are chainable, so you can apply several in a row to a particular variable.\n * * Add the attribute `data-f-convert` to any element to convert all of the model variables referenced within that element's scope.\n *\n * In general, if the model variable is an array, the converter is applied to each element of the array. There are a few built in array converters which, rather than converting all elements of an array, select particular elements from within the array or otherwise treat array variables specially.\n *\n */\n\nvar _ = __webpack_require__(0);\n\nfunction parseLimitArgs(starting, limit, val) {\n    var toRet = {};\n    if (arguments.length === 3) {\n        //eslint-disable-line\n        toRet = {\n            input: limit,\n            limit: starting\n        };\n    } else if (arguments.length === 2) {\n        toRet = {\n            input: starting\n        };\n    } else {\n        console.error('Too many arguments passed to last', arguments);\n        throw new Error('Too many arguments passed to last');\n    }\n\n    toRet.input = [].concat(toRet.input);\n    return toRet;\n}\n\nvar list = {\n    /**\n     * Convert the input into an array. \n     *\n     * @param {any[]} val The array model variable.\n     * @returns {any[]}\n     */\n    list: function (val) {\n        return [].concat(val);\n    },\n\n    /**\n     * Reverse the array.\n     *\n     * **Example**\n     *\n     *      <p>Show the history of our sales, starting with the last (most recent):</p>\n     *      <ul data-f-foreach=\"Sales | reverse\">\n     *          <li></li>\n     *      </ul>\n     *\n     * @param {any[]} val The array model variable.\n     * @returns {any[]} the reversed array\n     */\n    reverse: function (val) {\n        return [].concat(val).reverse();\n    },\n\n    /**\n     * Select only the last element of the array.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          In the current year, we have <span data-f-bind=\"Sales | last\"></span> in sales.\n     *      </div>\n     *\n     * @param {number} n number of items to get\n     * @param {any[]} val The array model variable.\n     * @returns {any} last element of array\n     */\n    last: function (n, val) {\n        var parsed = parseLimitArgs.apply(null, arguments);\n        var stripped = parsed.input.slice(-(parsed.limit || 1));\n        if (stripped.length <= 1) {\n            return stripped[0];\n        }\n        return stripped;\n    },\n\n    /**\n     * Select only the first element of the array.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          Our initial investment was <span data-f-bind=\"Capital | first\"></span>.\n     *      </div>\n     *\n     * @param {number} n number of items to get\n     * @param {any[]} val The array model variable.\n     * @returns {any} first element of the array\n     */\n    first: function (n, val) {\n        var parsed = parseLimitArgs.apply(null, arguments);\n        var stripped = parsed.input.slice(0, parsed.limit || 1);\n        if (stripped.length <= 1) {\n            return stripped[0];\n        }\n        return stripped;\n    },\n\n    /**\n     * Select only the previous (second to last) element of the array.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          Last year we had <span data-f-bind=\"Sales | previous\"></span> in sales.\n     *      </div>\n     *\n     * @param {any[]} val The array model variable.\n     * @returns {any} the previous (second to last) element of the array.\n     */\n    previous: function (val) {\n        val = [].concat(val);\n        return val.length <= 1 ? val[0] : val[val.length - 2];\n    },\n\n    /**\n     * Returns length of array\n     *\n     * **Example**\n     * Total Items: <h6 data-f-bind=\"items | size\"></h6>\n     * \n     * @param  {any[]} src array\n     * @return {number}     length of array\n     */\n    size: function (src) {\n        return [].concat(src).length;\n    },\n\n    /**\n     * Select every nth item from array\n     *\n     * **Example**\n     * <!-- select every 10th item starting from itself\n     * <ul data-f-foreach=\"Time | pickEvery(10)\"><li></li></ul>\n     * <!-- select every 10th item starting from the fifth\n     * <ul data-f-foreach=\"Time | pickEvery(10, 5)\"><li></li></ul>\n     * \n     * @param  {number} n          nth item to select\n     * @param  {number} [startIndex] index to start from\n     * @param  {any[]} [val]        source array\n     * @return {any[]}            shortened array\n     */\n    pickEvery: function (n, startIndex, val) {\n        if (arguments.length === 3) {\n            //eslint-disable-line\n            //last item is match string\n            val = startIndex;\n            startIndex = n - 1;\n        }\n        val = [].concat(val);\n        val = val.slice(startIndex);\n        return val.filter(function (item, index) {\n            return index % n === 0;\n        });\n    }\n};\n\nvar mapped = Object.keys(list).map(function (alias) {\n    var fn = list[alias];\n    var newfn = function () {\n        var args = _.toArray(arguments);\n        var indexOfActualValue = args.length - 2; //last item is the matchstring\n        var val = args[indexOfActualValue];\n        if ($.isPlainObject(val)) {\n            return Object.keys(val).reduce(function (accum, key) {\n                var arr = val[key];\n                var newArgs = args.slice();\n                newArgs[indexOfActualValue] = arr;\n                accum[key] = fn.apply(fn, newArgs);\n                return accum;\n            }, {});\n        }\n        return fn.apply(fn, arguments);\n    };\n    return {\n        alias: alias,\n        acceptList: true,\n        convert: newfn\n    };\n});\nmodule.exports = mapped;\n\n/***/ }),\n/* 27 */\n/***/ (function(module, exports) {\n\nfunction parseArgs(toCompare, trueVal, falseVal, valueToCompare, matchString) {\n    var toReturn = { trueVal: true, falseVal: false };\n    switch (arguments.length) {\n        case 5:\n            //eslint-disable-line\n            return $.extend(toReturn, { trueVal: trueVal, falseVal: falseVal, input: valueToCompare });\n        case 4:\n            //eslint-disable-line\n            return $.extend(toReturn, { trueVal: trueVal, falseVal: falseVal, input: falseVal });\n        case 3:\n            //eslint-disable-line\n            return $.extend(toReturn, { input: trueVal, falseVal: trueVal });\n        default:\n            return toReturn;\n    }\n}\n\nmodule.exports = [{\n    alias: 'is',\n    acceptList: false,\n    convert: function (toCompare) {\n        var args = parseArgs.apply(null, arguments);\n        return args.input === toCompare ? args.trueVal : args.falseVal;\n    }\n}];\n\n/***/ }),\n/* 28 */\n/***/ (function(module, exports, __webpack_require__) {\n\n/**\n * ## Number Format Converters\n *\n * Converters allow you to change how data is displayed. They let you display the value of any model variable in a different format than it is stored in the model -- converting the output value from one format to another.\n *\n * There are two ways to specify conversion or formatting for the display output of a particular model variable:\n *\n * * Use the `|` (pipe) character within the value of any `data-f-` attribute. Converters are chainable, so you can apply several in a row to a particular variable.\n * * Add the attribute `data-f-convert` to any element to convert all of the model variables referenced within that element's scope.\n *\n * For model variables that are numbers (or that have been [converted to numbers](../number-converter/)), there are several special number formats you can apply.\n *\n * #### Currency Number Format\n *\n * After the `|` (pipe) character, use `$` (dollar sign), `0`, and `.` (decimal point) in your converter to describe how currency should appear. The specifications follow the Excel currency formatting conventions.\n *\n * **Example**\n *\n *      <!-- convert to dollars (include cents) -->\n *      <input type=\"text\" data-f-bind=\"price[car]\" data-f-convert=\"$0.00\" />\n *      <input type=\"text\" data-f-bind=\"price[car] | $0.00\" />\n *\n *      <!-- convert to dollars (truncate cents) -->\n *      <input type=\"text\" data-f-bind=\"price[car]\" data-f-convert=\"$0.\" />\n *      <input type=\"text\" data-f-bind=\"price[car] | $0.\" />\n *\n *\n * #### Specific Digits Number Format\n *\n * After the `|` (pipe) character, use `#` (pound) and `,` (comma) in your converter to describe how the number should appear. The specifications follow the Excel number formatting conventions.\n *\n * **Example**\n *\n *      <!-- convert to thousands -->\n *      <input type=\"text\" data-f-bind=\"sales[car]\" data-f-convert=\"#,###\" />\n *      <input type=\"text\" data-f-bind=\"sales[car] | #,###\" />\n *\n *\n * #### Percentage Number Format\n *\n * After the `|` (pipe) character, use `%` (percent) and `0` in your converter to display the number as a percent.\n *\n * **Example**\n *\n *      <!-- convert to percentage -->\n *      <input type=\"text\" data-f-bind=\"profitMargin[car]\" data-f-convert=\"0%\" />\n *      <input type=\"text\" data-f-bind=\"profitMargin[car] | 0%\" />\n *\n *\n * #### Short Number Format\n *\n * After the `|` (pipe) character, use `s` and `0` in your converter to describe how the number should appear.\n *\n * The `0`s describe the significant digits.\n *\n * The `s` describes the \"short format,\" which uses 'K' for thousands, 'M' for millions, 'B' for billions. For example, `2468` converted with `s0.0` displays as `2.5K`.\n *\n * **Example**\n *\n *      <!-- convert to thousands (show 12,468 as 12.5K) -->\n *      <span type=\"text\" data-f-bind=\"price[car] | s0.0\"></span>\n *\n */\n\nvar _require = __webpack_require__(0),\n    isString = _require.isString,\n    isNumber = _require.isNumber;\n\nfunction isAllowedLeading(str) {\n    var validPrefixes = ['₹', '$', '£', '¥', '±', '’', '¢', '€'];\n    return validPrefixes.indexOf(str.trim()) !== -1;\n}\n\nmodule.exports = {\n    /**\n     * @param {string} name\n     * @returns {boolean}\n     */\n    alias: function (name) {\n        /**\n         * @param {string} v\n         * @returns {boolean}\n         */\n        function checkValMatch(v) {\n            var validStandalone = ['#', '0', '%'];\n            if (v.length === 1) {\n                return validStandalone.indexOf(v) !== -1;\n            }\n\n            var validFirstChars = ['s', '#', '0', '.'];\n            var validLastChars = ['%', '#', '0'];\n\n            if (isAllowedLeading(v.charAt(0))) {\n                v = v.slice(1);\n            }\n            var isValidFirstChar = validFirstChars.indexOf(v.charAt(0)) !== -1;\n            var isValidLastChar = validLastChars.indexOf(v.charAt(v.length - 1)) !== -1;\n\n            if (v.length === 2) {\n                return isValidFirstChar && isValidLastChar;\n            }\n\n            var validRemainingChars = ['#', '0', '.', ','];\n            var areRemainingCharactersValid = v.substr(1, v.length - 2).split('').reduce(function (accum, char) {\n                var isMatch = validRemainingChars.indexOf(char) !== -1;\n                if (!isMatch) {\n                    accum = false;\n                }\n                return accum;\n            }, true);\n\n            return isValidFirstChar && isValidLastChar && areRemainingCharactersValid;\n        }\n\n        var parts = name.split(' ');\n        if (parts.length === 3) {\n            return checkValMatch(parts[1]); //prefix and suffix\n        } else if (parts.length === 1) {\n            return checkValMatch(parts[0]); //just the number\n        } else if (parts.length === 2) {\n            return checkValMatch(parts[0]) || checkValMatch(parts[1]); //either prefix or suffix\n        }\n        return false;\n    },\n\n    /**\n     * @param {string} val\n     * @returns {number}\n     */\n    parse: function (val) {\n        val += '';\n        var isNegative = val.charAt(0) === '-';\n\n        val = val.replace(/,/g, '');\n        var floatMatcher = /([-+]?[0-9]*\\.?[0-9]+)(K?M?B?%?)/i;\n        var results = floatMatcher.exec(val);\n        var number;\n        var suffix = '';\n        if (results && results[1]) {\n            number = results[1];\n        }\n        if (results && results[2]) {\n            suffix = results[2].toLowerCase();\n        }\n\n        /*eslint no-magic-numbers: 0 complexity: 0 */\n        switch (suffix) {\n            case '%':\n                number = number / 100;\n                break;\n            case 'k':\n                number = number * 1000;\n                break;\n            case 'm':\n                number = number * 1000000;\n                break;\n            case 'b':\n                number = number * 1000000000;\n                break;\n            default:\n        }\n        number = parseFloat(number);\n        if (isNegative && number > 0) {\n            number = number * -1;\n        }\n        return number;\n    },\n\n    convert: function (value) {\n        var scales = ['', 'K', 'M', 'B', 'T'];\n        function roundTo(value, digits) {\n            return Math.round(value * Math.pow(10, digits)) / Math.pow(10, digits);\n        }\n\n        function getDigits(value, digits) {\n            value = value === 0 ? 0 : roundTo(value, Math.max(0, digits - Math.ceil(Math.log(value) / Math.LN10)));\n\n            var TXT = '';\n            var numberTXT = value.toString();\n            var decimalSet = false;\n\n            for (var iTXT = 0; iTXT < numberTXT.length; iTXT++) {\n                TXT += numberTXT.charAt(iTXT);\n                if (numberTXT.charAt(iTXT) === '.') {\n                    decimalSet = true;\n                } else {\n                    digits--;\n                }\n\n                if (digits <= 0) {\n                    return TXT;\n                }\n            }\n\n            if (!decimalSet) {\n                TXT += '.';\n            }\n            while (digits > 0) {\n                TXT += '0';\n                digits--;\n            }\n            return TXT;\n        }\n\n        function addDecimals(value, decimals, minDecimals, hasCommas) {\n            hasCommas = !!hasCommas;\n            var numberTXT = value.toString();\n            var hasDecimals = numberTXT.split('.').length > 1;\n            var iDec = 0;\n\n            if (hasCommas) {\n                for (var iChar = numberTXT.length - 1; iChar > 0; iChar--) {\n                    if (hasDecimals) {\n                        hasDecimals = numberTXT.charAt(iChar) !== '.';\n                    } else {\n                        iDec = (iDec + 1) % 3;\n                        if (iDec === 0) {\n                            numberTXT = numberTXT.substr(0, iChar) + ',' + numberTXT.substr(iChar);\n                        }\n                    }\n                }\n            }\n            if (decimals > 0) {\n                var toADD;\n                if (numberTXT.split('.').length <= 1) {\n                    toADD = minDecimals;\n                    if (toADD > 0) {\n                        numberTXT += '.';\n                    }\n                } else {\n                    toADD = minDecimals - numberTXT.split('.')[1].length;\n                }\n\n                while (toADD > 0) {\n                    numberTXT += '0';\n                    toADD--;\n                }\n            }\n            return numberTXT;\n        }\n\n        function getSuffix(formatTXT) {\n            formatTXT = formatTXT.replace('.', '');\n            var fixesTXT = formatTXT.split(new RegExp('[0|,|#]+', 'g'));\n            return fixesTXT.length > 1 ? fixesTXT[1].toString() : '';\n        }\n\n        function format(number, formatTXT) {\n            // eslint-disable-line\n            if (Array.isArray(number)) {\n                number = number[number.length - 1];\n            }\n            if (!isString(number) && !isNumber(number)) {\n                return number;\n            }\n\n            if (!formatTXT || formatTXT.toLowerCase() === 'default') {\n                return number.toString();\n            }\n\n            if (isNaN(number)) {\n                return '?';\n            }\n\n            //var formatTXT;\n            var entityCodeMapping = {\n                '&euro;': '€',\n                '&dollar;': '$',\n                '&cent;': '¢',\n                '&pound;': '£',\n                '&yen;': '¥'\n            };\n            Object.keys(entityCodeMapping).forEach(function (code) {\n                formatTXT = formatTXT.replace(code, entityCodeMapping[code]);\n            });\n\n            // Divide +/- Number Format\n            var formats = formatTXT.split(';');\n            if (formats.length > 1) {\n                return format(Math.abs(number), formats[number >= 0 ? 0 : 1]);\n            }\n\n            // Save Sign\n            var sign = number >= 0 ? '' : '-';\n            number = Math.abs(number);\n\n            var leftOfDecimal = formatTXT;\n            var d = leftOfDecimal.indexOf('.');\n            if (d > -1) {\n                leftOfDecimal = leftOfDecimal.substring(0, d);\n            }\n\n            var normalized = leftOfDecimal.toLowerCase();\n            var index = normalized.lastIndexOf('s');\n            var isShortFormat = index > -1;\n\n            if (isShortFormat) {\n                var nextChar = leftOfDecimal.charAt(index + 1);\n                if (nextChar === ' ') {\n                    isShortFormat = false;\n                }\n            }\n\n            var leadingText = isShortFormat ? formatTXT.substring(0, index) : '';\n            var rightOfPrefix = isShortFormat ? formatTXT.substr(index + 1) : formatTXT.substr(index);\n\n            //first check to make sure 's' is actually short format and not part of some leading text\n            if (isShortFormat) {\n                var shortFormatTest = /[0-9#*]/;\n                var shortFormatTestResult = rightOfPrefix.match(shortFormatTest);\n                if (!shortFormatTestResult || shortFormatTestResult.length === 0) {\n                    //no short format characters so this must be leading text ie. 'weeks '\n                    isShortFormat = false;\n                    leadingText = '';\n                }\n            }\n\n            //if (formatTXT.charAt(0) == 's')\n            if (isShortFormat) {\n                var valScale = number === 0 ? 0 : Math.floor(Math.log(Math.abs(number)) / (3 * Math.LN10));\n                valScale = number / Math.pow(10, 3 * valScale) < 1000 ? valScale : valScale + 1;\n                valScale = Math.max(valScale, 0);\n                valScale = Math.min(valScale, 4);\n                number = number / Math.pow(10, 3 * valScale);\n                //if (!isNaN(Number(formatTXT.substr(1) ) ) )\n\n                if (!isNaN(Number(rightOfPrefix)) && rightOfPrefix.indexOf('.') === -1) {\n                    var limitDigits = Number(rightOfPrefix);\n                    if (number < Math.pow(10, limitDigits)) {\n                        if (isAllowedLeading(leadingText)) {\n                            return sign + leadingText + getDigits(number, Number(rightOfPrefix)) + scales[valScale];\n                        } else {\n                            return leadingText + sign + getDigits(number, Number(rightOfPrefix)) + scales[valScale];\n                        }\n                    } else if (isAllowedLeading(leadingText)) {\n                        return sign + leadingText + Math.round(number) + scales[valScale];\n                    } else {\n                        return leadingText + sign + Math.round(number) + scales[valScale];\n                    }\n                } else {\n                    //formatTXT = formatTXT.substr(1);\n                    formatTXT = formatTXT.substr(index + 1);\n                    var SUFFIX = getSuffix(formatTXT);\n                    formatTXT = formatTXT.substr(0, formatTXT.length - SUFFIX.length);\n\n                    var valWithoutLeading = format((sign === '' ? 1 : -1) * number, formatTXT) + scales[valScale] + SUFFIX;\n                    if (isAllowedLeading(leadingText) && sign !== '') {\n                        valWithoutLeading = valWithoutLeading.substr(sign.length);\n                        return sign + leadingText + valWithoutLeading;\n                    }\n\n                    return leadingText + valWithoutLeading;\n                }\n            }\n\n            var subFormats = formatTXT.split('.');\n            var decimals;\n            var minDecimals;\n            if (subFormats.length > 1) {\n                decimals = subFormats[1].length - subFormats[1].replace(new RegExp('[0|#]+', 'g'), '').length;\n                minDecimals = subFormats[1].length - subFormats[1].replace(new RegExp('0+', 'g'), '').length;\n                formatTXT = subFormats[0] + subFormats[1].replace(new RegExp('[0|#]+', 'g'), '');\n            } else {\n                decimals = 0;\n            }\n\n            var fixesTXT = formatTXT.split(new RegExp('[0|,|#]+', 'g'));\n            var preffix = fixesTXT[0].toString();\n            var suffix = fixesTXT.length > 1 ? fixesTXT[1].toString() : '';\n\n            number = number * (formatTXT.split('%').length > 1 ? 100 : 1);\n            //            if (formatTXT.indexOf('%') !== -1) number = number * 100;\n            number = roundTo(number, decimals);\n\n            sign = number === 0 ? '' : sign;\n\n            var hasCommas = formatTXT.substr(formatTXT.length - 4 - suffix.length, 1) === ',';\n            var formatted = sign + preffix + addDecimals(number, decimals, minDecimals, hasCommas) + suffix;\n\n            //  console.log(originalNumber, originalFormat, formatted)\n            return formatted;\n        }\n\n        return format;\n    }()\n};\n\n/***/ }),\n/* 29 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/**\n * ## Number Comparison Converters\n *\n * Converters allow you to change how data is displayed. They let you display the value of any model variable in a different format than it is stored in the model -- converting the output value from one format to another.\n *\n * For a number comparison converter, the original format is your model variable, and the resulting \"format\" is a (possibly unrelated) value of your choosing. This resulting value is selected based on how the value of the model variable compares to a reference value that you pass to the converter.\n *\n * There are two ways to specify conversion or formatting for the display output of a particular model variable:\n *\n * * Use the `|` (pipe) character within the value of any `data-f-` attribute. Converters are chainable, so you can apply several in a row to a particular variable.\n * * Add the attribute `data-f-convert` to any element to convert all of the model variables referenced within that element's scope.\n *\n * For example:\n *\n *      <!-- displays \"true\" or the number of widgets -->\n *      <span data-f-bind=\"widgets | greaterThan(50)\"></span>\n *\n *      <!-- displays the first string if true, the second if false -->\n *      <span data-f-bind=\"widgets | greaterThan(50, 'nice job!', 'not enough widgets')\"></span>\n *\n * You can also chain multiple converters to simulate evaluating multiple if\\else conditions; for e.g. the following logic\n *\n *      if (temperature > 80) {\n *          return 'hot';\n *      } else if (temperature > 60) {\n *          return 'pleasant';\n *      } else if (temperature >= 30) {\n *          return 'cold';\n *      } else {\n *          return 'freezing!';\n *      }\n *\n * can be represented as\n *\n *      <h4 data-f-bind=\"temperature | greaterThan(80, hot) | greaterThan(60, pleasant) | greaterThanEqual(30, cold, freezing!)\"></h4>\n */\n\n\n\nfunction parseArgs(limit, trueVal, falseVal, valueToCompare, matchString) {\n    var toReturn = { trueVal: true, falseVal: false };\n    switch (arguments.length) {\n        case 5:\n            //eslint-disable-line\n            return $.extend(toReturn, { trueVal: trueVal, falseVal: falseVal, input: valueToCompare });\n        case 4:\n            //eslint-disable-line\n            return $.extend(toReturn, { trueVal: trueVal, falseVal: falseVal, input: falseVal });\n        case 3:\n            //eslint-disable-line\n            return $.extend(toReturn, { input: trueVal, falseVal: trueVal });\n        default:\n            return toReturn;\n    }\n}\nmodule.exports = {\n    /**\n     * Convert the model variable to true, or other values passed to the converter, based on whether the model variable is greater than the limit.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          <!-- displays true or the number of widgets -->\n     *          <span data-f-bind=\"widgets | greaterThan(50)\"></span> \n     *\n     *          <!-- displays custom text -->\n     *          <span data-f-bind=\"widgets | greaterThan(50, 'Congratulations!', 'Better luck next year')\"></span>\n     *      </div>\n     *\n     * @param {Number} limit The reference value to compare the model variable against.\n     * @param {String} trueVal (Optional) The format (value) to display if the model variable is greater than `limit`. If not included, the display is `true`. If there are commas in this argument, they must be escaped with `\\`.\n     * @param {String} falseVal (Optional) The format (value) to display if the model variable is less than or equal to `limit`. If not included, the display is the value of the model variable. If there are commas in this argument, they must be escaped with `\\`.\n     * @return {Any} If the model variable is greater than `limit`, returns trueVal or `true`. Otherwise returns falseVal if provided, or echoes the input.\n     */\n    greaterThan: function (limit) {\n        var args = parseArgs.apply(null, arguments);\n        return Number(args.input) > Number(limit) ? args.trueVal : args.falseVal;\n    },\n\n    /**\n     * Convert the model variable to true, or other values passed to the converter, based on whether the model variable is greater than or equal to the limit.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          <!-- displays true or the number of widgets -->\n     *          <span data-f-bind=\"widgets | greaterThan(50)\"></span> \n     *\n     *          <!-- displays custom text -->\n     *          <span data-f-bind=\"widgets | greaterThan(50, 'Congratulations!', 'Better luck next year')\"></span>\n     *      </div>\n     *\n     * @param {Number} limit The reference value to compare the model variable against.\n     * @param {String} trueVal (Optional) The format (value) to display if the model variable is greater than or equal to `limit`. If not included, the display is `true`. If there are commas in this argument, they must be escaped with `\\`.\n     * @param {String} falseVal (Optional) The format (value) to display if the model variable is less than `limit`. If not included, the display is the value of the model variable. If there are commas in this argument, they must be escaped with `\\`.\n     * @return {Any} If the model variable is greater than or equal to `limit`, returns trueVal or `true`. Otherwise returns falseVal if provided, or echoes the input.\n     */\n    greaterThanEqual: function (limit) {\n        var args = parseArgs.apply(null, arguments);\n        return Number(args.input) >= Number(limit) ? args.trueVal : args.falseVal;\n    },\n\n    /**\n     * Convert the model variable to true, or other values passed to the converter, based on whether the model variable is equal to the limit.\n     *\n     * \n     * **Example**\n     *\n     *      <div>\n     *          <!-- displays true or the number of widgets -->\n     *          <span data-f-bind=\"widgets | equalsNumber(50)\"></span> \n     *\n     *          <!-- display custom text -->\n     *          <span data-f-bind=\"widgets | equalsNumber(50, 'Met the goal exactly!', 'Not an exact match')\"></span>\n     *      </div>\n     *\n     * @param {Number} limit The reference value to compare the model variable against.\n     * @param {String} trueVal (Optional) The format (value) to display if the model variable is equal to `limit`. If not included, the display is `true`. If there are commas in this argument, they must be escaped with `\\`.\n     * @param {String} falseVal (Optional) The format (value) to display if the model variable is not equal to `limit`. If not included, the display is the value of the model variable. If there are commas in this argument, they must be escaped with `\\`.\n     * @return {Any} If the model variable equals `limit`, returns trueVal or `true`. Otherwise returns falseVal if provided, or echoes the input.\n     */\n    equalsNumber: function (limit) {\n        var args = parseArgs.apply(null, arguments);\n        return Number(args.input) === Number(limit) ? args.trueVal : args.falseVal;\n    },\n\n    /**\n     * Convert the model variable to true, or other values passed to the converter, based on whether the model variable is less than the limit.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          <!-- displays true or the number of widgets -->\n     *          <span data-f-bind=\"widgets | lessThan(50)\"></span> \n     *\n     *          <!-- display custom text -->\n     *          <span data-f-bind=\"widgets | lessThan(50, 'Oops didn't make quite enough!', 'Built a lot of widgets this year!')\"></span>\n     *      </div>\n     *\n     * @param {Number} limit The reference value to compare the model variable against.\n     * @param {String} trueVal (Optional) The format (value) to display if the model variable is less than `limit`. If not included, the display is `true`. If there are commas in this argument, they must be escaped with `\\`.\n     * @param {String} falseVal (Optional) The format (value) to display if the model variable is less than `limit`. If not included, the display is the value of the model variable. If there are commas in this argument, they must be escaped with `\\`.\n     * @return {Any} If the model variable is less than `limit`, returns trueVal or `true`. Otherwise returns falseVal if provided, or echoes the input.\n     */\n    lessThan: function (limit) {\n        var args = parseArgs.apply(null, arguments);\n        return Number(args.input) < Number(limit) ? args.trueVal : args.falseVal;\n    },\n\n    /**\n     * Convert the model variable to true, or other values passed to the converter, based on whether the model variable is less than or equal to the limit.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          <!-- displays true or the number of widgets -->\n     *          <span data-f-bind=\"widgets | lessThanEqual(50)\"></span> \n     *\n     *          <!-- display custom text -->\n     *          <span data-f-bind=\"widgets | lessThanEqual(50, 'Oops didn't make quite enough!', 'Built a lot of widgets this year!')\"></span>\n     *      </div>\n     *\n     * @param {Number} limit The reference value to compare the model variable against.\n     * @param {String} trueVal (Optional) The format (value) to display if the model variable is less than or equal to `limit`. If not included, the display is `true`. If there are commas in this argument, they must be escaped with `\\`.\n     * @param {String} falseVal (Optional) The format (value) to display if the model variable is less than or equal to `limit`. If not included, the display is the value of the model variable. If there are commas in this argument, they must be escaped with `\\`.\n     * @return {Any} If the model variable is less than or equal to `limit`, returns trueVal or `true`. Otherwise returns falseVal if provided, or echoes the input.\n     */\n    lessThanEqual: function (limit) {\n        var args = parseArgs.apply(null, arguments);\n        return Number(args.input) <= Number(limit) ? args.trueVal : args.falseVal;\n    }\n};\n\n/***/ }),\n/* 30 */\n/***/ (function(module, exports) {\n\n/**\n * ## Boolean Conditional Converters\n *\n * Converters allow you to change how data is displayed. They let you display the value of any model variable in a different format than it is stored in the model -- converting the output value from one format to another.\n *\n * For a boolean conditional converter, the original format is your model variable, and the resulting \"format\" is a boolean value, or another value of your choosing.\n *\n * There are two ways to specify conversion or formatting for the display output of a particular model variable:\n *\n * * Use the `|` (pipe) character within the value of any `data-f-` attribute. Converters are chainable, so you can apply several in a row to a particular variable.\n * * Add the attribute `data-f-convert` to any element to convert all of the model variables referenced within that element's scope.\n *\n * For example:\n *\n *      <!-- displays \"true\" or \"false\" -->\n *      <!-- in particular, true if sampleVar is truthy (1, true, 'some string', [] etc.), \n *            false if sampleVar is falsy (0, false, '') -->\n *      <span data-f-bind=\"sampleVar | toBool\"></span>\n *\n */\n\nfunction parseArgs(trueVal, falseVal, input, matchString) {\n    var toReturn = { trueVal: true, falseVal: false };\n    switch (arguments.length) {\n        case 4:\n            //eslint-disable-line\n            return $.extend(toReturn, { trueVal: trueVal, falseVal: falseVal, input: input });\n        case 3:\n            //eslint-disable-line\n            return $.extend(toReturn, { trueVal: trueVal, falseVal: falseVal, input: falseVal });\n        default:\n            return toReturn;\n    }\n}\n\nmodule.exports = {\n    /**\n     * Convert 'truthy' values to true and 'falsy' values to false.\n     *\n     * **Example**\n     *\n     *      <!-- displays \"true\" or \"false\" -->\n     *      <!-- in particular, true if sampleVar is truthy (1, true, 'some string', [] etc.), \n     *            false if sampleVar is falsy (0, false, '') -->\n     *      <span data-f-bind=\"sampleVar | toBool\"></span>\n     * \n     * @param {Any} value\n     * @return {Boolean}\n     */\n    toBool: function (value) {\n        return !!value;\n    },\n\n    /**\n     * Converts values to boolean and negates.\n     *\n     * **Example**\n     *\n     *      <!-- disables input if isGameInProgress is false -->\n     *      <input type=\"text\" data-f-disabled=\"isGameInProgress | not\" />\n     * \n     * @param {Any} value\n     * @return {Boolean}\n     */\n    not: function (value) {\n        return !value;\n    },\n\n    /**\n     * Convert the input to a new value (for example, some text), based on whether it is true or false.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          <span data-f-bind=\"sampleVar | ifTrue('yes! please move forward', 'not ready to proceed')\"></span> \n     *          <span data-f-bind=\"sampleVar | ifTrue('yes! please move forward')\"></span>\n     *      </div>\n     *\n     * @param {String} trueVal The value to display if the input is true. If there are commas in this argument, they must be escaped with `\\`.\n     * @param {String} falseVal (Optional) The value to display if the input is false. If not included, returns the input. If there are commas in this argument, they must be escaped with `\\`.\n     * @param {Any} input (Optional) The input to test. If not included, the output of the previous argument is used.\n     * @return {Any} If input is true, returns trueVal. If input is false, returns falseVal if provided, or echoes the input.\n     */\n    ifTrue: function () {\n        var args = parseArgs.apply(null, arguments);\n        return args.input ? args.trueVal : args.falseVal;\n    },\n    /**\n     * Convert the input to a new value (for example, some text), based on whether it is false or true.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          <span data-f-bind=\"sampleVar | ifFalse('not ready to proceed', 'actually this is still true')\"></span> \n     *          <span data-f-bind=\"sampleVar | ifFalse('not ready to proceed')\"></span>\n     *      </div>\n     *\n     * @param {String} trueVal The value to display if the input is false. If there are commas in this argument, they must be escaped with `\\`.\n     * @param {String} falseVal (Optional) The value to display if the input is true. If not included, returns the input. If there are commas in this argument, they must be escaped with `\\`.\n     * @param {Any} input (Optional) The input to test. If not included, the output of the previous argument is used.\n     * @return {Any} If input is false, returns trueVal. If input is true, returns falseVal if provided, or echoes the input.\n     */\n    ifFalse: function () {\n        var args = parseArgs.apply(null, arguments);\n        return !args.input ? args.trueVal : args.falseVal;\n    }\n};\n\n/***/ }),\n/* 31 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar _ = __webpack_require__(0);\n\nvar list = {\n    /**\n     * Returns all values in array matching argument\n     *\n     * ** Example **\n     * <!-- list online users -->\n     * <ul data-f-foreach=\"users | filter(isOnline)\"><li></li></button>\n     * \n     * @param  {string|number|boolean} valueToFilterBy value to reject\n     * @param  {any[]} source The arrayed model variable\n     * @return {any[]}     filtered lsit\n     */\n    filter: function (valueToFilterBy, source) {\n        source = [].concat(source);\n        if ($.isPlainObject(source[0])) {\n            return _.filter(source, valueToFilterBy);\n        }\n        return source.filter(function (v) {\n            return v === valueToFilterBy;\n        });\n    },\n\n    /**\n     * Returns all values in array excluding match\n     *\n     * ** Example **\n     * <!-- list offline users -->\n     * <ul data-f-foreach=\"users | except(isOnline)\"><li></li></button>\n     * \n     * @param  {string|number|boolean} valueToReject value to reject\n     * @param  {any[]} source The arrayed model variable\n     * @return {any[]}     filtered lsit\n     */\n    except: function (valueToReject, source) {\n        source = [].concat(source);\n        if ($.isPlainObject(source[0])) {\n            return _.reject(source, valueToReject);\n        }\n        return source.filter(function (v) {\n            return v !== valueToReject;\n        });\n    },\n\n    /**\n     * Checks if array contains *any* item passing the test\n     *\n     * ** Example **\n     * <!-- hides button if any of the users are not online -->\n     * <button data-f-hideif=\"users | any(isOnline) | not\">Get Started</button>\n     * <button data-f-hideif=\"users | any({ isOnline: false })\">Get Started</button>\n     * \n     * @param  {string|object} value value to check for\n     * @param  {any[]} source The arrayed model variable\n     * @return {boolean}     True if match found in array\n     */\n    any: function (value, source) {\n        source = [].concat(source);\n        if ($.isPlainObject(source[0])) {\n            return _.some(source, value);\n        }\n        return source.indexOf(value) !== -1;\n    },\n\n    /**\n     * Checks if *every* item in the array passes the test\n     *\n     * ** Example **\n     * <!-- shows button if any of the users are not online -->\n     * <button data-f-showif=\"users | every(isOnline)\">Get Started</button>\n     * \n     * @param  {string|object} value value to check for\n     * @param  {any[]} source The arrayed model variable\n     * @return {boolean}     True if match found in array\n     */\n    every: function (value, source) {\n        source = [].concat(source);\n        if ($.isPlainObject(source[0])) {\n            return _.every(source, value);\n        }\n        return source.filter(function (v) {\n            return v === value;\n        }).length === source.length;\n    }\n};\nvar converters = Object.keys(list).map(function (name) {\n    return {\n        alias: name,\n        acceptList: true,\n        convert: list[name]\n    };\n});\n\nmodule.exports = converters;\n\n/***/ }),\n/* 32 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_lodash__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_lodash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_lodash__);\n\n/**\n * @typedef NodeHandler\n * @property {string} selector\n * @property {Function} handle\n */\n\n/**\n * @param {string | undefined} selector\n * @param {Function | NodeHandler } handler\n * @return {NodeHandler}\n */\nvar normalize = function (selector, handler) {\n    if (!selector) {\n        selector = '*';\n    }\n    if (Object(__WEBPACK_IMPORTED_MODULE_0_lodash__[\"isFunction\"])(handler)) {\n        handler = {\n            selector: selector,\n            handle: handler\n        };\n    }\n\n    handler.selector = selector;\n    return handler;\n};\n\n/**\n * @param {string|HTMLElement|JQuery<HTMLElement>} toMatch\n * @param { {selector:string} } node\n * @return {boolean}\n */\nvar match = function (toMatch, node) {\n    if (Object(__WEBPACK_IMPORTED_MODULE_0_lodash__[\"isString\"])(toMatch)) {\n        return toMatch === node.selector;\n    }\n    return $(toMatch).is(node.selector);\n};\n\nvar nodeManager = {\n    list: [],\n\n    /**\n     * Add a new node handler\n     * @param  {string} selector jQuery-compatible selector to use to match nodes\n     * @param  {function} handler  Handlers are new-able functions. They will be called with $el as context.? TODO: Think this through\n     * @returns {void}\n     */\n    register: function (selector, handler) {\n        this.list.unshift(normalize(selector, handler));\n    },\n\n    /**\n     * @param {string|HTMLElement|JQuery<HTMLElement>} selector\n     * @return NodeHandler\n     */\n    getHandler: function (selector) {\n        return this.list.find(function (node) {\n            return match(selector, node);\n        });\n    },\n\n    replace: function (selector, handler) {\n        var index = void 0;\n        this.list.forEach(function (currentHandler, i) {\n            if (selector === currentHandler.selector) {\n                index = i;\n                return false;\n            }\n        });\n        this.list.splice(index, 1, normalize(selector, handler));\n    }\n};\n\n//bootstraps\nvar defaultHandlers = [__webpack_require__(33).default, __webpack_require__(11), __webpack_require__(12)];\ndefaultHandlers.reverse().forEach(function (handler) {\n    nodeManager.register(handler.selector, handler);\n});\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (nodeManager);\n\n/***/ }),\n/* 33 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__default_input_node__ = __webpack_require__(11);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__default_input_node___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0__default_input_node__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_config__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_config___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_config__);\n\n\n\nvar offAttr = __WEBPACK_IMPORTED_MODULE_1_config___default.a.attrs.checkboxOffValue;\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (__WEBPACK_IMPORTED_MODULE_0__default_input_node___default.a.extend({\n    propertyHandlers: [],\n\n    getUIValue: function () {\n        var $el = this.$el;\n        var offAttrVal = $el.attr(offAttr);\n        var offVal = offAttrVal && typeof offAttrVal !== 'undefined' ? offAttrVal : false;\n\n        var onAttrVal = $el.attr('value');\n        //attr = initial value, prop = current value\n        var onVal = onAttrVal && typeof onAttrVal !== 'undefined' ? $el.prop('value') : true;\n\n        var val = $el.is(':checked') ? onVal : offVal;\n        return val;\n    },\n    initialize: function () {\n        __WEBPACK_IMPORTED_MODULE_0__default_input_node___default.a.prototype.initialize.apply(this, arguments);\n    }\n}, { selector: ':checkbox,:radio' }));\n\n/***/ }),\n/* 34 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_lodash__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_lodash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_lodash__);\n/**\n * ## Attribute Manager\n *\n * Flow.js provides a set of custom DOM attributes that serve as a data binding between variables and operations in your project's model and HTML elements in your project's user interface. Under the hood, Flow.js is doing automatic conversion of these custom attributes, like `data-f-bind`, into HTML specific to the attribute's assigned value, like the current value of `myModelVar`.\n *\n * If you are looking for examples of using particular attributes, see the [specific attributes subpages](../../../../attributes-overview/).\n *\n * If you would like to extend Flow.js with your own custom attributes, you can add them to Flow.js using the Attribute Manager.\n *\n * The Attribute Manager is specific to adding custom attributes and describing their implementation (handlers). (The [Dom Manager](../../) contains the general implementation.)\n *\n *\n * **Examples**\n *\n * Built-in attribute handlers like `data-f-value` and `data-f-foreach` automatically bind variables in your project's model to particular HTML elements. However, your UI may sometimes require displaying only part of the variable (e.g. if it's an object), or \"doing something\" with the value of the variable, rather than simply displaying it.\n *\n * One example of when custom attribute handlers are useful is when your model variable is a complex object and you want to display the fields in a particular way, or you only want to display some of the fields. While the combination of the [`data-f-foreach` attribute](../loop-attrs/foreach-attr/) and [templating](../../../../#templates) can help with this, sometimes it's easier to write your own attribute handler. (This is especially true if you will be reusing the attribute handler -- you won't have to copy your templating code over and over.)\n *\n *      Flow.dom.attributes.register('showSched', '*', function (sched) {\n *            // display all the schedule milestones\n *            // sched is an object, each element is an array\n *            // of ['Formal Milestone Name', milestoneMonth, completionPercentage]\n *\n *            const schedStr = '<ul>';\n *            const sortedSched = sortBy(sched, function(el) { return el[1]; });\n *\n *            for (let i = 0; i < sortedSched.length; i++) {\n *                  schedStr += '<li><strong>' + sortedSched[i][0]\n *                        + '</strong> currently scheduled for <strong>Month '\n *                        + sortedSched[i][1] + '</strong></li>';\n *            }\n *            schedStr += '</ul>';\n *\n *            this.html(schedStr);\n *      });\n *\n * Then, you can use the attribute handler in your HTML just like other Flow.js attributes:\n *\n *      <div data-f-showSched=\"schedule\"></div>\n *\n */\n\n\n\nvar defaultHandlers = [__webpack_require__(35).default, __webpack_require__(36).default, __webpack_require__(37).default, __webpack_require__(38).default, __webpack_require__(41).default, __webpack_require__(42).default, __webpack_require__(43).default, __webpack_require__(44).default, __webpack_require__(45).default, __webpack_require__(46).default, __webpack_require__(47).default, __webpack_require__(49).default];\n\nvar handlersList = [];\n\nvar normalize = function (attributeMatcher, nodeMatcher, handler) {\n    if (!nodeMatcher) {\n        nodeMatcher = '*';\n    }\n    if (Object(__WEBPACK_IMPORTED_MODULE_0_lodash__[\"isFunction\"])(handler)) {\n        handler = {\n            handle: handler\n        };\n    }\n    return $.extend(handler, { test: attributeMatcher, target: nodeMatcher });\n};\n\ndefaultHandlers.forEach(function (handler) {\n    handlersList.push(normalize(handler.test, handler.target, handler));\n});\n\nvar matchAttr = function (matchExpr, attr, $el) {\n    var attrMatch = void 0;\n\n    if (Object(__WEBPACK_IMPORTED_MODULE_0_lodash__[\"isString\"])(matchExpr)) {\n        attrMatch = matchExpr === '*' || matchExpr.toLowerCase() === attr.toLowerCase();\n    } else if (Object(__WEBPACK_IMPORTED_MODULE_0_lodash__[\"isFunction\"])(matchExpr)) {\n        //TODO: remove element selectors from attributes\n        attrMatch = matchExpr(attr, $el);\n    } else if (Object(__WEBPACK_IMPORTED_MODULE_0_lodash__[\"isRegExp\"])(matchExpr)) {\n        attrMatch = attr.match(matchExpr);\n    }\n    return attrMatch;\n};\n\nvar matchNode = function (target, nodeFilter) {\n    return Object(__WEBPACK_IMPORTED_MODULE_0_lodash__[\"isString\"])(nodeFilter) ? nodeFilter === target : nodeFilter.is(target);\n};\n\nvar attributeManager = {\n    list: handlersList,\n    /**\n     * Add a new attribute handler.\n     *\n     * @param  {string|Function|RegExp} attributeMatcher Description of which attributes to match.\n     * @param  {string|JQuery<HTMLElement>} nodeMatcher Which nodes to add attributes to. Use [jquery Selector syntax](https://api.jquery.com/category/selectors/).\n     * @param  {Function|object} handler If `handler` is a function, the function is called with `$element` as context, and attribute value + name. If `handler` is an object, it should include two functions, and have the form: `{ init: fn,  handle: fn }`. The `init` function is called when the page loads; use this to define event handlers. The `handle` function is called with `$element` as context, and attribute value + name.\n     * @returns {void}\n     */\n    register: function (attributeMatcher, nodeMatcher, handler) {\n        handlersList.unshift(normalize.apply(null, arguments));\n    },\n\n    /**\n     * Find an attribute matcher matching some criteria.\n     *\n     * @param  {string} attrFilter Attribute to match.\n     * @param  {string|JQuery<HTMLElement>} nodeFilter Node to match.\n     *\n     * @return {AttributeHandler[]} An array of matching attribute handlers, or null if no matches found.\n     */\n    filter: function (attrFilter, nodeFilter) {\n        var filtered = handlersList.filter(function (handler) {\n            return matchAttr(handler.test, attrFilter);\n        });\n        if (nodeFilter) {\n            filtered = filtered.filter(function (handler) {\n                return matchNode(handler.target, nodeFilter);\n            });\n        }\n        return filtered;\n    },\n\n    /**\n     * Replace an existing attribute handler.\n     *\n     * @param  {string} attrFilter Attribute to match.\n     * @param  {string|JQuery<HTMLElement>} nodeFilter Node to match.\n     * @param  {Function|object} handler The updated attribute handler. If `handler` is a function, the function is called with `$element` as context, and attribute value + name. If `handler` is an object, it should include two functions, and have the form: `{ init: fn,  handle: fn }`. The `init` function is called when the page loads; use this to define event handlers. The `handle` function is called with `$element` as context, and attribute value + name.\n     * @returns {void}\n     */\n    replace: function (attrFilter, nodeFilter, handler) {\n        var index = void 0;\n        Object(__WEBPACK_IMPORTED_MODULE_0_lodash__[\"each\"])(handlersList, function (currentHandler, i) {\n            if (matchAttr(currentHandler.test, attrFilter) && matchNode(currentHandler.target, nodeFilter)) {\n                index = i;\n                return false;\n            }\n        });\n        handlersList.splice(index, 1, normalize(attrFilter, nodeFilter, handler));\n    },\n\n    /**\n     *  Retrieve the appropriate handler for a particular attribute. There may be multiple matching handlers, but the first (most exact) match is always used.\n     *\n     * @param {string} property The attribute.\n     * @param {string|JQuery<HTMLElement>} $el The DOM element.\n     *\n     * @return {AttributeHandler|undefined} The attribute handler, if a matching one is found\n     */\n    getHandler: function (property, $el) {\n        var filtered = this.filter(property, $el);\n        //There could be multiple matches, but the top first has the most priority\n        return filtered[0];\n    }\n};\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (attributeManager);\n\n/***/ }),\n/* 35 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/**\n * ## No-op Attributes\n *\n * Flow.js provides special handling for both `data-f-model` (described [here](../../../../#using_in_project)) and `data-f-convert` (described [here](../../../../converter-overview/)). For these attributes, the default behavior is to do nothing, so that this additional special handling can take precendence.\n *\n */\n\n/**\n * @type AttributeHandler \n */\nvar noopAttr = {\n\n  target: '*',\n\n  test: /^(?:model|convert|channel|on-init)/i,\n\n  handle: function () {},\n  parse: function () {\n    return [];\n  }\n};\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (noopAttr);\n\n/***/ }),\n/* 36 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_config__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_config___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_config__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_utils_parse_utils__ = __webpack_require__(3);\n\n\n\n/**\n * @type AttributeHandler \n */\nvar defaultEventAttr = {\n\n    target: '*',\n\n    test: function (attr) {\n        return attr.indexOf('on-') === 0;\n    },\n\n    unbind: function (attr, $el) {\n        var eventName = attr.replace('on-', '');\n        $el.off(eventName);\n    },\n\n    parse: function () {\n        return [];\n    }, //There's nothing to subscribe to on an event\n    handle: function () {},\n\n    init: function (attr, topics, $el) {\n        var eventName = attr.replace('on-', '');\n        var matching = topics[0] && topics[0].name; //multiple topics aren't really relevant here\n        $el.off(eventName).on(eventName, function (evt) {\n            evt.preventDefault();\n            var listOfOperations = Object(__WEBPACK_IMPORTED_MODULE_1_utils_parse_utils__[\"toPublishableFormat\"])(matching);\n            $el.trigger(__WEBPACK_IMPORTED_MODULE_0_config__[\"events\"].trigger, { data: listOfOperations, source: attr });\n        });\n    }\n};\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (defaultEventAttr);\n\n/***/ }),\n/* 37 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_utils_parse_utils__ = __webpack_require__(3);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__config__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__config___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1__config__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__loop_attr_utils__ = __webpack_require__(14);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_utils_animation__ = __webpack_require__(9);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_lodash__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_lodash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_lodash__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__attr_template_utils__ = __webpack_require__(10);\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n\n\n\n\n\n\n\n\n\nvar elAnimatedMap = new WeakMap(); //TODO: Can probably get rid of this if we make subscribe a promise and distinguish between initial value\n\n/**\n * @type AttributeHandler\n */\nvar foreachAttr = {\n\n    test: 'foreach',\n\n    target: '*',\n\n    unbind: function (attr, $el) {\n        var el = $el.get(0);\n        elAnimatedMap.delete(el);\n\n        var template = Object(__WEBPACK_IMPORTED_MODULE_5__attr_template_utils__[\"e\" /* getOriginalContents */])($el);\n        var current = $el.html();\n        if (template && current !== template) {\n            $el.html(template);\n        }\n        Object(__WEBPACK_IMPORTED_MODULE_5__attr_template_utils__[\"b\" /* clearOriginalContents */])($el);\n        Object(__WEBPACK_IMPORTED_MODULE_5__attr_template_utils__[\"g\" /* removeKnownData */])($el);\n    },\n\n    parse: function (topics) {\n        return Object(__WEBPACK_IMPORTED_MODULE_2__loop_attr_utils__[\"b\" /* parseTopics */])(topics);\n    },\n\n    handle: function (value, prop, $el, topics) {\n        value = $.isPlainObject(value) ? value : [].concat(value);\n\n        var _aliasesFromTopics = Object(__WEBPACK_IMPORTED_MODULE_2__loop_attr_utils__[\"a\" /* aliasesFromTopics */])(topics, value),\n            keyAlias = _aliasesFromTopics.keyAlias,\n            valueAlias = _aliasesFromTopics.valueAlias;\n\n        var originalHTML = Object(__WEBPACK_IMPORTED_MODULE_5__attr_template_utils__[\"e\" /* getOriginalContents */])($el, function ($el) {\n            return $el.html();\n        });\n        var knownData = Object(__WEBPACK_IMPORTED_MODULE_5__attr_template_utils__[\"d\" /* getKnownDataForEl */])($el);\n        var missingReferences = Object(__WEBPACK_IMPORTED_MODULE_5__attr_template_utils__[\"c\" /* findMissingReferences */])(originalHTML, [keyAlias, valueAlias].concat(Object.keys(knownData)));\n        var stubbedTemplate = Object(__WEBPACK_IMPORTED_MODULE_5__attr_template_utils__[\"h\" /* stubMissingReferences */])(originalHTML, missingReferences);\n\n        var templateFn = Object(__WEBPACK_IMPORTED_MODULE_4_lodash__[\"template\"])(stubbedTemplate);\n        var $dummyEl = $('<div></div>');\n        Object(__WEBPACK_IMPORTED_MODULE_4_lodash__[\"each\"])(value, function (dataval, datakey) {\n            var _$$extend;\n\n            if (dataval === undefined || dataval === null) {\n                dataval = dataval + ''; //convert undefineds to strings\n            }\n            var templateData = $.extend(true, {}, knownData, (_$$extend = {}, _defineProperty(_$$extend, keyAlias, datakey), _defineProperty(_$$extend, valueAlias, dataval), _$$extend));\n\n            var nodes = void 0;\n            var isTemplated = void 0;\n            try {\n                var templated = templateFn(templateData);\n                var templatedWithReferences = Object(__WEBPACK_IMPORTED_MODULE_5__attr_template_utils__[\"a\" /* addBackMissingReferences */])(templated, missingReferences);\n                isTemplated = templatedWithReferences !== stubbedTemplate;\n                nodes = $(templatedWithReferences);\n            } catch (e) {\n                //you don't have all the references you need;\n                nodes = $(stubbedTemplate);\n                isTemplated = true;\n                Object(__WEBPACK_IMPORTED_MODULE_5__attr_template_utils__[\"i\" /* updateKnownDataForEl */])($(nodes), templateData);\n            }\n\n            nodes.each(function (i, newNode) {\n                var $newNode = $(newNode);\n                Object(__WEBPACK_IMPORTED_MODULE_4_lodash__[\"each\"])($newNode.data(), function (val, key) {\n                    $newNode.data(key, Object(__WEBPACK_IMPORTED_MODULE_0_utils_parse_utils__[\"toImplicitType\"])(val));\n                });\n                if (!isTemplated && !$newNode.html().trim()) {\n                    $newNode.html(dataval);\n                }\n            });\n            $dummyEl.append(nodes);\n        });\n\n        var el = $el.get(0);\n        var isInitialAnim = !elAnimatedMap.get(el);\n        var $withAnimAttrs = Object(__WEBPACK_IMPORTED_MODULE_3_utils_animation__[\"a\" /* addChangeClassesToList */])($el.children(), $dummyEl.children(), isInitialAnim, __WEBPACK_IMPORTED_MODULE_1__config__[\"animation\"]);\n        $el.empty().append($withAnimAttrs);\n\n        elAnimatedMap.set(el, true);\n    }\n};\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (foreachAttr);\n\n/***/ }),\n/* 38 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_lodash__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_lodash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_lodash__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_utils_parse_utils__ = __webpack_require__(3);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_utils_general__ = __webpack_require__(7);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__config__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__config___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3__config__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_utils_animation__ = __webpack_require__(9);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__attr_template_utils__ = __webpack_require__(10);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__loop_attr_utils__ = __webpack_require__(14);\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n\n\n\n\n\nvar templateIdAttr = __WEBPACK_IMPORTED_MODULE_3__config__[\"attrs\"].repeat.templateId;\n\n\n\nvar elAnimatedMap = new WeakMap(); //TODO: Can probably get rid of this if we make subscribe a promise and distinguish between initial value\n\n\n\n\n\n/**\n * @type AttributeHandler \n */\nvar loopAttrHandler = {\n    test: 'repeat',\n\n    target: '*',\n\n    unbind: function (attr, $el) {\n        var id = $el.data(templateIdAttr);\n        if (id) {\n            $el.nextUntil(':not([data-' + id + '])').remove();\n            // $el.removeAttr('data-' + templateIdAttr); //FIXME: Something about calling rebind multiple times in IB makes this happen without the removal\n        }\n\n        var el = $el.get(0);\n        elAnimatedMap.delete(el);\n\n        var originalHTML = Object(__WEBPACK_IMPORTED_MODULE_5__attr_template_utils__[\"e\" /* getOriginalContents */])($el);\n        var current = $el.get(0).outerHTML;\n        if (originalHTML && current !== originalHTML) {\n            $el.replaceWith(originalHTML);\n        }\n        Object(__WEBPACK_IMPORTED_MODULE_5__attr_template_utils__[\"b\" /* clearOriginalContents */])($el);\n        Object(__WEBPACK_IMPORTED_MODULE_5__attr_template_utils__[\"g\" /* removeKnownData */])($el);\n    },\n\n    parse: function (topics) {\n        return Object(__WEBPACK_IMPORTED_MODULE_6__loop_attr_utils__[\"b\" /* parseTopics */])(topics);\n    },\n\n    handle: function (value, prop, $el, topics) {\n        value = $.isPlainObject(value) ? value : [].concat(value);\n        var id = $el.data(templateIdAttr);\n\n        var originalHTML = Object(__WEBPACK_IMPORTED_MODULE_5__attr_template_utils__[\"e\" /* getOriginalContents */])($el, function ($el) {\n            return $el.get(0).outerHTML;\n        });\n\n        var $dummyOldDiv = $('<div></div>');\n        if (id) {\n            var $removed = $el.nextUntil(':not([data-' + id + '])').remove();\n            $dummyOldDiv.append($removed);\n        } else {\n            id = Object(__WEBPACK_IMPORTED_MODULE_2_utils_general__[\"c\" /* random */])('repeat-');\n            $el.attr('data-' + templateIdAttr, id);\n        }\n\n        var _aliasesFromTopics = Object(__WEBPACK_IMPORTED_MODULE_6__loop_attr_utils__[\"a\" /* aliasesFromTopics */])(topics, value),\n            keyAlias = _aliasesFromTopics.keyAlias,\n            valueAlias = _aliasesFromTopics.valueAlias;\n\n        var knownData = Object(__WEBPACK_IMPORTED_MODULE_5__attr_template_utils__[\"d\" /* getKnownDataForEl */])($el);\n        var missingReferences = Object(__WEBPACK_IMPORTED_MODULE_5__attr_template_utils__[\"c\" /* findMissingReferences */])(originalHTML, [keyAlias, valueAlias].concat(Object.keys(knownData)));\n        var stubbedTemplate = Object(__WEBPACK_IMPORTED_MODULE_5__attr_template_utils__[\"h\" /* stubMissingReferences */])(originalHTML, missingReferences);\n\n        var templateFn = Object(__WEBPACK_IMPORTED_MODULE_0_lodash__[\"template\"])(stubbedTemplate);\n        var last;\n        Object(__WEBPACK_IMPORTED_MODULE_0_lodash__[\"each\"])(value, function (dataval, datakey) {\n            var _$$extend;\n\n            if (dataval === undefined || dataval === null) {\n                dataval = dataval + ''; //convert undefineds to strings\n            }\n            var templateData = $.extend(true, {}, knownData, (_$$extend = {}, _defineProperty(_$$extend, keyAlias, datakey), _defineProperty(_$$extend, valueAlias, dataval), _$$extend));\n\n            var nodes = void 0;\n            var isTemplated = void 0;\n            try {\n                var templated = templateFn(templateData);\n                var templatedWithReferences = Object(__WEBPACK_IMPORTED_MODULE_5__attr_template_utils__[\"a\" /* addBackMissingReferences */])(templated, missingReferences);\n                isTemplated = templatedWithReferences !== stubbedTemplate;\n                nodes = $(templatedWithReferences);\n            } catch (e) {\n                //you don't have all the references you need;\n                nodes = $(stubbedTemplate);\n                isTemplated = true;\n                Object(__WEBPACK_IMPORTED_MODULE_5__attr_template_utils__[\"i\" /* updateKnownDataForEl */])($(nodes), templateData);\n            }\n\n            var hasData = dataval !== null && dataval !== undefined;\n            nodes.each(function (i, newNode) {\n                var $newNode = $(newNode);\n                $newNode.removeAttr('data-f-repeat').removeAttr('data-' + templateIdAttr);\n                Object(__WEBPACK_IMPORTED_MODULE_0_lodash__[\"each\"])($newNode.data(), function (val, key) {\n                    if (!last) {\n                        $el.data(key, Object(__WEBPACK_IMPORTED_MODULE_1_utils_parse_utils__[\"toImplicitType\"])(val));\n                    } else {\n                        $newNode.data(key, Object(__WEBPACK_IMPORTED_MODULE_1_utils_parse_utils__[\"toImplicitType\"])(val));\n                    }\n                });\n                $newNode.attr('data-' + id, true);\n                if (!isTemplated && !$newNode.children().length && hasData) {\n                    $newNode.html(dataval + '');\n                }\n            });\n            if (!last) {\n                last = $el.html(nodes.html());\n            } else {\n                last = nodes.insertAfter(last);\n            }\n        });\n\n        var $newEls = $el.nextUntil(':not(\\'[data-' + id + ']\\')');\n\n        var el = $el.get(0);\n        var isInitialAnim = !elAnimatedMap.get(el);\n        Object(__WEBPACK_IMPORTED_MODULE_4_utils_animation__[\"a\" /* addChangeClassesToList */])($dummyOldDiv.children(), $newEls, isInitialAnim, __WEBPACK_IMPORTED_MODULE_3__config__[\"animation\"]);\n\n        elAnimatedMap.set(el, true);\n    }\n};\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (loopAttrHandler);\n\n/***/ }),\n/* 39 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = makePromise;\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_lodash__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_lodash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_lodash__);\n\n\n/**\n * @param {any} val \n * @returns {Promise}\n */\nfunction makePromise(val) {\n    //Can be replaced with Promise.resolve when we drop IE11;\n    // if (isFunction(val)) {\n    //     return Promise.resolve(val());\n    // }\n    // return Promise.resolve(val);\n    if (val.then) {\n        return val;\n    }\n    var $def = $.Deferred();\n    if (Object(__WEBPACK_IMPORTED_MODULE_0_lodash__[\"isFunction\"])(val)) {\n        try {\n            var toReturn = val();\n            if (toReturn && toReturn.then) {\n                return toReturn.then(function (r) {\n                    return $def.resolve(r);\n                }).catch(function (e) {\n                    return $def.reject(e);\n                });\n            }\n            $def.resolve(toReturn);\n        } catch (e) {\n            $def.reject(e);\n        }\n    } else {\n        $def.resolve(val);\n    }\n    return $def.promise();\n}\n\n/***/ }),\n/* 40 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = debounceAndMerge;\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_lodash__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_lodash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_lodash__);\n\n\n/**\n * Returns debounced version of original (optionally promise returning) function\n * \n * @param {Function} fn function to debounce\n * @param {number} debounceInterval \n * @param {Function[]} [argumentsReducers] pass in 1 reducer for each option your function takes\n * @return {Function} debounced function\n */\nfunction debounceAndMerge(fn, debounceInterval, argumentsReducers) {\n    var timer = null;\n    var $def = null;\n    var prom = null;\n\n    var argsToPass = [];\n    if (!argumentsReducers) {\n        var arrayReducer = function (accum, newVal) {\n            if (!accum) {\n                accum = [];\n            }\n            return accum.concat(newVal);\n        };\n        argumentsReducers = [arrayReducer];\n    }\n\n    /**\n     * @returns {Promise}\n     */\n    return function debouncedFunction() {\n        var newArgs = Object(__WEBPACK_IMPORTED_MODULE_0_lodash__[\"toArray\"])(arguments);\n        argsToPass = newArgs.map(function (arg, index) {\n            var reducer = argumentsReducers[index];\n            if (reducer) {\n                return reducer(argsToPass[index], arg);\n            } else {\n                return arg;\n            }\n        });\n        if (timer) {\n            clearTimeout(timer);\n        }\n\n        if (!$def) {\n            $def = $.Deferred();\n            prom = $def.promise();\n        }\n        timer = setTimeout(function () {\n            timer = null;\n            var res;\n            try {\n                res = fn.apply(fn, argsToPass);\n            } catch (e) {\n                argsToPass = [];\n                $def.reject(e);\n            }\n            if (res && res.then) {\n                return res.then(function (arg) {\n                    argsToPass = [];\n                    $def.resolve(arg);\n                }, function (e) {\n                    argsToPass = [];\n                    $def.reject(e);\n                });\n            } else {\n                argsToPass = [];\n                $def.resolve(res);\n            }\n        }, debounceInterval);\n        prom.then(function (r) {\n            $def = prom = null;\n            return r;\n        }, function (err) {\n            $def = prom = null;\n            throw err;\n        });\n        return prom;\n    };\n}\n\n/***/ }),\n/* 41 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_lodash__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_lodash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_lodash__);\n\n\nvar elClassesMap = new WeakMap();\nfunction deleteAddedClasses($el) {\n    var el = $el.get(0);\n    var addedClasses = elClassesMap.get(el);\n    if (addedClasses) {\n        $el.removeClass(addedClasses);\n    }\n}\n/**\n * @type AttributeHandler\n */\nvar classAttr = {\n    test: 'class',\n\n    target: '*',\n\n    unbind: function (attr, $el) {\n        var el = $el.get(0);\n        deleteAddedClasses($el);\n        elClassesMap.delete(el);\n    },\n\n    handle: function (value, prop, $el) {\n        if (Array.isArray(value)) {\n            value = value[value.length - 1];\n        }\n\n        var el = $el.get(0);\n        deleteAddedClasses($el);\n\n        if (Object(__WEBPACK_IMPORTED_MODULE_0_lodash__[\"isNumber\"])(value)) {\n            value = 'value-' + value;\n        }\n        setTimeout(function () {\n            $el.addClass(value); //If the classes have an animation set, removing with a timeout will trigger it\n        }, 0);\n        elClassesMap.set(el, value);\n    }\n};\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (classAttr);\n\n/***/ }),\n/* 42 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/**\n * @type AttributeHandler \n */\nvar booleanAttrHandler = {\n    target: '*',\n\n    test: /^(?:checked|selected|async|autofocus|autoplay|controls|defer|ismap|loop|multiple|open|required|scoped|disabled|hidden|readonly)$/i,\n\n    handle: function (value, prop, $el) {\n        if (Array.isArray(value)) {\n            value = value[value.length - 1];\n        }\n        var val = $el.attr('value') ? value == $el.prop('value') : !!value; //eslint-disable-line eqeqeq\n        $el.prop(prop, val);\n    }\n};\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (booleanAttrHandler);\n\n/***/ }),\n/* 43 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/**\n  * @type AttributeHandler\n  */\nvar showifHandler = {\n    test: 'showif',\n\n    target: '*',\n\n    init: function (attr, value, $el) {\n        $el.hide(); //hide by default; if not this shows text until data is fetched\n    },\n\n    handle: function (value, prop, $el) {\n        if (Array.isArray(value)) {\n            value = value[value.length - 1];\n        }\n        return value && ('' + value).trim() ? $el.show() : $el.hide();\n    }\n};\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (showifHandler);\n\n/***/ }),\n/* 44 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/**\n  * @type AttributeHandler\n  */\nvar hideifHandler = {\n    test: 'hideif',\n\n    target: '*',\n\n    init: function (attr, value, $el) {\n        $el.hide(); //hide by default; if not this shows text until data is fetched\n    },\n    handle: function (value, prop, $el) {\n        if (Array.isArray(value)) {\n            value = value[value.length - 1];\n        }\n        if (value && ('' + value).trim()) {\n            $el.hide();\n        } else {\n            $el.show();\n        }\n    }\n};\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (hideifHandler);\n\n/***/ }),\n/* 45 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/**\n  * @type {AttributeHandler}\n  */\nvar checkboxAttrHandler = {\n\n    target: ':checkbox,:radio',\n\n    test: 'bind',\n\n    handle: function (value, prop, $el) {\n        if (Array.isArray(value)) {\n            value = value[value.length - 1];\n        }\n        var settableValue = $el.attr('value'); //initial value\n        var isChecked = typeof settableValue !== 'undefined' ? settableValue == value : !!value; //eslint-disable-line eqeqeq\n        $el.prop('checked', isChecked);\n    }\n};\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (checkboxAttrHandler);\n\n/***/ }),\n/* 46 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/**\n * @type AttributeHandler \n */\nvar inputBindAttr = {\n    target: 'input, select, textarea',\n\n    test: 'bind',\n\n    handle: function (value, prop, $el) {\n        if (value === undefined) {\n            value = '';\n        } else if (Array.isArray(value)) {\n            value = value[value.length - 1];\n        }\n        $el.val(value + '');\n    }\n};\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (inputBindAttr);\n\n/***/ }),\n/* 47 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_lodash__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_lodash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_lodash__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_utils_animation__ = __webpack_require__(9);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_config__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_config___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_config__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__bind_utils__ = __webpack_require__(48);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__attr_template_utils__ = __webpack_require__(10);\n\n\n\n\n\n\n\n\nvar elAnimatedMap = new WeakMap(); //TODO: Can probably get rid of this if we make subscribe a promise and distinguish between initial value\n\nfunction toAliasMap(topics) {\n    return (topics || []).reduce(function (accum, topic) {\n        accum[topic.name] = topic.alias;\n        return accum;\n    }, {});\n}\n\nfunction getNewContent(currentContents, value, $el, topics) {\n    if (!Object(__WEBPACK_IMPORTED_MODULE_4__attr_template_utils__[\"f\" /* isTemplated */])(currentContents)) {\n        return Object(__WEBPACK_IMPORTED_MODULE_3__bind_utils__[\"c\" /* translateDataToInsertable */])(value);\n    }\n\n    var templateData = Object(__WEBPACK_IMPORTED_MODULE_3__bind_utils__[\"d\" /* translateDataToTemplatable */])(value, toAliasMap(topics));\n    var knownData = Object(__WEBPACK_IMPORTED_MODULE_4__attr_template_utils__[\"d\" /* getKnownDataForEl */])($el);\n    $.extend(templateData, knownData);\n\n    var missingReferences = Object(__WEBPACK_IMPORTED_MODULE_4__attr_template_utils__[\"c\" /* findMissingReferences */])(currentContents, Object.keys(templateData));\n    var stubbedTemplate = Object(__WEBPACK_IMPORTED_MODULE_4__attr_template_utils__[\"h\" /* stubMissingReferences */])(currentContents, missingReferences);\n\n    var templateFn = Object(__WEBPACK_IMPORTED_MODULE_0_lodash__[\"template\"])(stubbedTemplate);\n    try {\n        var templatedHTML = templateFn(templateData);\n        var templatedWithReferences = Object(__WEBPACK_IMPORTED_MODULE_4__attr_template_utils__[\"a\" /* addBackMissingReferences */])(templatedHTML, missingReferences);\n        return templatedWithReferences;\n    } catch (e) {\n        //you don't have all the references you need;\n        Object(__WEBPACK_IMPORTED_MODULE_4__attr_template_utils__[\"i\" /* updateKnownDataForEl */])($el, templateData);\n        return currentContents;\n    }\n}\n\n/**\n * @type AttributeHandler \n */\nvar bindAttrHandler = {\n\n    target: '*',\n\n    test: 'bind',\n\n    parse: function (topics) {\n        return topics.map(function (topic) {\n            var attrVal = topic.name;\n            return {\n                name: Object(__WEBPACK_IMPORTED_MODULE_3__bind_utils__[\"b\" /* extractVariableName */])(attrVal),\n                alias: Object(__WEBPACK_IMPORTED_MODULE_3__bind_utils__[\"a\" /* extractAlias */])(attrVal)\n            };\n        });\n    },\n\n    //FIXME: Can't do this because if you have a bind within a foreach, foreach overwrites the old el with a new el, and at that points contents are lost\n    // But if i don't do this the <%= %> is going to show up\n    // init: function (attr, value, $el) {\n    //     const contents = getOriginalContents($el, ($el)=> $el.html());\n    //     if (isTemplated(contents)) {\n    //         $el.empty();\n    //     }\n    // },\n\n    unbind: function (attr, $el) {\n        var el = $el.get(0);\n        elAnimatedMap.delete(el);\n\n        var bindTemplate = Object(__WEBPACK_IMPORTED_MODULE_4__attr_template_utils__[\"e\" /* getOriginalContents */])($el);\n        var current = $el.html();\n        if (bindTemplate && current !== bindTemplate) {\n            $el.html(bindTemplate);\n        }\n        Object(__WEBPACK_IMPORTED_MODULE_4__attr_template_utils__[\"b\" /* clearOriginalContents */])($el);\n        Object(__WEBPACK_IMPORTED_MODULE_4__attr_template_utils__[\"g\" /* removeKnownData */])($el);\n    },\n\n    handle: function (value, prop, $el, topics) {\n        var el = $el.get(0);\n        var originalContents = Object(__WEBPACK_IMPORTED_MODULE_4__attr_template_utils__[\"e\" /* getOriginalContents */])($el, function ($el) {\n            return $el.html();\n        });\n        var contents = getNewContent(originalContents, value, $el, topics);\n\n        Object(__WEBPACK_IMPORTED_MODULE_1_utils_animation__[\"b\" /* addContentAndAnimate */])($el, contents, !elAnimatedMap.has(el), __WEBPACK_IMPORTED_MODULE_2_config__[\"animation\"]);\n        elAnimatedMap.set(el, true);\n    }\n};\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (bindAttrHandler);\n\n/***/ }),\n/* 48 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (immutable) */ __webpack_exports__[\"c\"] = translateDataToInsertable;\n/* harmony export (immutable) */ __webpack_exports__[\"d\"] = translateDataToTemplatable;\n/* harmony export (immutable) */ __webpack_exports__[\"b\"] = extractVariableName;\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = extractAlias;\nfunction translateDataToInsertable(value) {\n    if (Array.isArray(value)) {\n        value = value[value.length - 1];\n    }\n    value = $.isPlainObject(value) ? JSON.stringify(value) : value + '';\n    return value;\n}\n\n/**\n * @param {any} value\n * @param {object} aliasMap\n * @returns {{value: any}}\n */\nfunction translateDataToTemplatable(value, aliasMap) {\n    var templateData = { value: value };\n    if ($.isPlainObject(value)) {\n        Object.keys(value).forEach(function (originalName) {\n            var alias = aliasMap[originalName] || originalName;\n            templateData[alias] = value[originalName];\n        });\n    } else {\n        Object.keys(aliasMap).forEach(function (originalName) {\n            var alias = aliasMap[originalName] || originalName;\n            templateData[alias] = value;\n        });\n    }\n\n    return templateData;\n}\n\nvar AS_REGEX = /(.*) (?:as)\\s+\\((.*)\\)/;\n\n/**\n * @param {string} attrVal \n * @returns {string}\n */\nfunction extractVariableName(attrVal) {\n    var asMatch = attrVal.trim().match(AS_REGEX);\n    var varName = asMatch && asMatch[1] ? asMatch[1] : attrVal;\n    return varName.trim();\n}\n\n/**\n * @param {string} attrVal \n * @returns {string}\n */\nfunction extractAlias(attrVal) {\n    var asMatch = attrVal.trim().match(AS_REGEX);\n    var alias = asMatch && asMatch[2] ? asMatch[2] : attrVal;\n    return alias.trim();\n}\n\n/***/ }),\n/* 49 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/**\n * @type AttributeHandler \n */\nvar defaultAttr = {\n    test: '*',\n\n    target: '*',\n\n    handle: function (value, prop, $el) {\n        //FIXME: The _right_ way to do this would be to set attr, not prop. \n        //However Polymer 1.0 doesn't link attrs with stringified JSON, and that's really the primary use-case for this, so, ignoring\n        //However Polymer is fine with 'data-X' attrs having stringified JSON. Eventually we should make this attr and fix polymer\n        //but can't do that for backwards comptability reason. See commit bbc4a49039fb73faf1ef591a07b371d7d667cf57\n        $el.prop(prop, value);\n    }\n};\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (defaultAttr);\n\n/***/ }),\n/* 50 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/**\n * Hooks up dom elements to mutation observer\n * @param  {HTMLElement} target     root to start observing from\n * @param  {object} domManager \n * @param  {boolean} isEnabled Determines if it's enabled by default\n * @return {object}\n */\n/* harmony default export */ __webpack_exports__[\"default\"] = (function (target, domManager, isEnabled) {\n    if (typeof MutationObserver === 'undefined') {\n        return;\n    }\n    // Create an observer instance\n    var observer = new MutationObserver(function (mutations) {\n        mutations.forEach(function (mutation) {\n            var added = $(mutation.addedNodes).find(':f');\n            added = added.add($(mutation.addedNodes).filter(':f'));\n            var removed = $(mutation.removedNodes).find(':f');\n            removed = removed.add($(mutation.removedNodes).filter(':f'));\n            if (added && added.length) {\n                domManager.bindAll(added);\n            }\n            if (removed && removed.length) {\n                domManager.unbindAll(removed);\n            }\n            if (mutation.attributeName === 'data-f-channel') {\n                domManager.unbindAll(mutation.target);\n                domManager.bindAll(mutation.target);\n            }\n        });\n    });\n    var mutconfig = {\n        attributes: true,\n        attributeFilter: ['data-f-channel'],\n        childList: true,\n        subtree: true,\n        characterData: false\n    };\n    var publicApi = {\n        enable: function () {\n            observer.observe(target, mutconfig);\n        },\n        disable: function () {\n            observer.disconnect();\n        }\n    };\n    if (isEnabled) {\n        publicApi.enable();\n    }\n    return publicApi;\n});\n\n/***/ }),\n/* 51 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony export (immutable) */ __webpack_exports__[\"default\"] = ChannelManager;\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__channel_manager__ = __webpack_require__(52);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_channels_channel_router__ = __webpack_require__(4);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__route_handlers__ = __webpack_require__(57);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__channel_manager_enhancements__ = __webpack_require__(72);\n\n\n\n\n\n\n//Moving connecting glue here so channel-manager can be tested in isolation\nvar InterpolatableRoutableChannelManager = Object(__WEBPACK_IMPORTED_MODULE_3__channel_manager_enhancements__[\"a\" /* interpolatable */])(Object(__WEBPACK_IMPORTED_MODULE_3__channel_manager_enhancements__[\"b\" /* routable */])(__WEBPACK_IMPORTED_MODULE_0__channel_manager__[\"a\" /* default */], __WEBPACK_IMPORTED_MODULE_1_channels_channel_router__[\"a\" /* default */]));\nfunction ChannelManager(opts) {\n    var defaultRouteHandlers = [__WEBPACK_IMPORTED_MODULE_2__route_handlers__[\"b\" /* JSONRouteHandler */], __WEBPACK_IMPORTED_MODULE_2__route_handlers__[\"a\" /* EpicenterRouteHandler */]];\n    var routes = opts && opts.routes ? opts.routes : [];\n    var cm = new InterpolatableRoutableChannelManager($.extend(true, {}, {\n        routes: [].concat(routes, defaultRouteHandlers)\n    }, opts));\n    return cm;\n}\n\n/***/ }),\n/* 52 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_jquery__ = __webpack_require__(53);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_jquery___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_jquery__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__channel_utils__ = __webpack_require__(5);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_lodash__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_lodash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_lodash__);\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n\n\n\n/**\n * \n * @param {String[]|String} topics \n * @param {Function} callback \n * @param {Object} options\n * @return {Subscription}\n */\nfunction makeSubs(topics, callback, options) {\n    var id = Object(__WEBPACK_IMPORTED_MODULE_2_lodash__[\"uniqueId\"])('subs-');\n    var defaults = {\n        batch: false,\n\n        /**\n         * Determines if the last published data should be cached for future notifications. For e.g.,\n         *\n         * channel.subscribe(['price', 'cost'], callback1, { batch: true, cache: false });\n         * channel.subscribe(['price', 'cost'], callback2, { batch: true, cache: true });\n         *\n         * channel.publish({ price: 1 });\n         * channel.publish({ cost: 1 });\n         *\n         * callback1 will have been called once, and callback2 will not have been called. i.e., the channel caches the first publish value and notifies after all dependent topics have data\n         * If we'd done channel.publish({ price: 1, cost: 1 }) would have called both callback1 and callback2\n         *\n         * `cache: true` is useful if you know if your topics will can published individually, but you still want to handle them together.\n         * `cache: false` is useful if you know if your topics will *always* be published together and they'll be called at the same time.\n         *\n         * Note this has no discernible effect if batch is false\n         * @type {Boolean}\n         */\n        cache: true\n    };\n    var opts = __WEBPACK_IMPORTED_MODULE_0_jquery___default.a.extend({}, defaults, options);\n    if (!callback || !Object(__WEBPACK_IMPORTED_MODULE_2_lodash__[\"isFunction\"])(callback)) {\n        throw new Error('subscribe callback should be a function');\n    }\n    return __WEBPACK_IMPORTED_MODULE_0_jquery___default.a.extend(true, {\n        id: id,\n        topics: [].concat(topics),\n        callback: callback\n    }, opts);\n}\n\nvar cacheBySubsId = {};\nvar sentDataBySubsId = {};\n\nfunction copy(data) {\n    if (Array.isArray(data)) {\n        return data.map(function (d) {\n            return copy(d);\n        });\n    } else if (__WEBPACK_IMPORTED_MODULE_0_jquery___default.a.isPlainObject(data)) {\n        return Object.keys(data).reduce(function (accum, key) {\n            accum[key] = copy(data[key]);\n            return accum;\n        }, {});\n    }\n    return data;\n}\n/**\n* @param {Subscription} subscription \n* @param {*} data\n*/\nfunction callbackIfChanged(subscription, data) {\n    var id = subscription.id;\n    // if (!isEqual(sentDataBySubsId[id], data)) { //This won't work for operations; reset for e.g., will only be called once\n    // sentDataBySubsId[id] = copy(data);\n    subscription.callback(data, { id: id });\n    // }\n}\n\n/**\n* @param {Publishable[]} topics\n* @param {Subscription} subscription \n*/\nfunction checkAndNotifyBatch(topics, subscription) {\n    var publishData = Object(__WEBPACK_IMPORTED_MODULE_1__channel_utils__[\"c\" /* publishableToObject */])(topics);\n    var matchingTopics = Object(__WEBPACK_IMPORTED_MODULE_2_lodash__[\"intersection\"])(Object.keys(publishData), subscription.topics);\n    if (!matchingTopics.length) {\n        return;\n    }\n    var relevantDataFromPublish = matchingTopics.reduce(function (accum, topic) {\n        accum[topic] = publishData[topic];\n        return accum;\n    }, {});\n\n    var cachedDataForSubs = cacheBySubsId[subscription.id] || {};\n    var knownDataForSubs = __WEBPACK_IMPORTED_MODULE_0_jquery___default.a.extend(true, {}, cachedDataForSubs, relevantDataFromPublish);\n\n    if (subscription.cache) {\n        cacheBySubsId[subscription.id] = knownDataForSubs;\n    }\n    var hasDataForAllTopics = Object(__WEBPACK_IMPORTED_MODULE_2_lodash__[\"intersection\"])(Object.keys(knownDataForSubs), subscription.topics).length === subscription.topics.length;\n    if (hasDataForAllTopics) {\n        callbackIfChanged(subscription, knownDataForSubs);\n    }\n}\n\n/**\n * @param {Publishable[]} topics\n * @param {Subscription} subscription \n */\nfunction checkAndNotify(topics, subscription) {\n    topics.forEach(function (topic) {\n        if (Object(__WEBPACK_IMPORTED_MODULE_2_lodash__[\"includes\"])(subscription.topics, topic.name) || Object(__WEBPACK_IMPORTED_MODULE_2_lodash__[\"includes\"])(subscription.topics, '*')) {\n            var toSend = {};\n            toSend[topic.name] = topic.value;\n            callbackIfChanged(subscription, toSend);\n        }\n    });\n}\n\n/**\n* @param {Subscription[]} subcriptionList\n* @return {String[]}\n*/\nfunction getTopicsFromSubsList(subcriptionList) {\n    return subcriptionList.reduce(function (accum, subs) {\n        accum = accum.concat(subs.topics);\n        return accum;\n    }, []);\n}\n\n/**\n * @class ChannelManager\n */\n\nvar ChannelManager = function () {\n    function ChannelManager(options) {\n        _classCallCheck(this, ChannelManager);\n\n        this.subscriptions = [];\n    }\n\n    /**\n     * @param {String | Publishable } topic\n     * @param {any} [value] item to publish\n     * @param {PublishOptions} [options]\n     * @return {Promise}\n     */\n\n\n    _createClass(ChannelManager, [{\n        key: 'publish',\n        value: function publish(topic, value, options) {\n            var _this = this;\n\n            var normalized = Object(__WEBPACK_IMPORTED_MODULE_1__channel_utils__[\"a\" /* normalizeParamOptions */])(topic, value, options);\n            var prom = __WEBPACK_IMPORTED_MODULE_0_jquery___default.a.Deferred().resolve(normalized.params).promise();\n            prom = prom.then(function (publishResponses) {\n                _this.notify(publishResponses, options);\n                return publishResponses;\n            });\n            return prom;\n        }\n    }, {\n        key: 'notify',\n        value: function notify(topic, value, options) {\n            var normalized = Object(__WEBPACK_IMPORTED_MODULE_1__channel_utils__[\"a\" /* normalizeParamOptions */])(topic, value, options);\n            // console.log('notify', normalized.params);\n            return this.subscriptions.forEach(function (subs) {\n                var fn = subs.batch ? checkAndNotifyBatch : checkAndNotify;\n                fn(normalized.params, subs);\n            });\n        }\n\n        /**\n         * @param {String[] | String} topics\n         * @param {Function} cb\n         * @param {Object} [options]\n         * @return {String}\n         */\n\n    }, {\n        key: 'subscribe',\n        value: function subscribe(topics, cb, options) {\n            var subs = makeSubs(topics, cb, options);\n            delete cacheBySubsId[subs.id];\n            delete sentDataBySubsId[subs.id];\n            this.subscriptions = this.subscriptions.concat(subs);\n            return subs.id;\n        }\n\n        /**\n         * @param {String} token\n         */\n\n    }, {\n        key: 'unsubscribe',\n        value: function unsubscribe(token) {\n            var olderLength = this.subscriptions.length;\n            var remaining = this.subscriptions.filter(function (subs) {\n                return subs.id !== token;\n            });\n            if (remaining.length === olderLength) {\n                throw new Error('No subscription found for token ' + token);\n            }\n            delete cacheBySubsId[token];\n            delete sentDataBySubsId[token];\n            this.subscriptions = remaining;\n        }\n    }, {\n        key: 'unsubscribeAll',\n        value: function unsubscribeAll() {\n            cacheBySubsId = {};\n            sentDataBySubsId = {};\n            this.subscriptions = [];\n        }\n\n        /**\n         * @return {String[]}\n         */\n\n    }, {\n        key: 'getSubscribedTopics',\n        value: function getSubscribedTopics() {\n            var list = Object(__WEBPACK_IMPORTED_MODULE_2_lodash__[\"uniq\"])(getTopicsFromSubsList(this.subscriptions));\n            return list;\n        }\n\n        /**\n         * @param {String} [topic] optional topic to filter by\n         * @return {Subscription[]}\n         */\n\n    }, {\n        key: 'getSubscribers',\n        value: function getSubscribers(topic) {\n            if (topic) {\n                return this.subscriptions.filter(function (subs) {\n                    return Object(__WEBPACK_IMPORTED_MODULE_2_lodash__[\"includes\"])(subs.topics, topic);\n                });\n            }\n            return this.subscriptions;\n        }\n    }]);\n\n    return ChannelManager;\n}();\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (ChannelManager);\n\n/***/ }),\n/* 53 */\n/***/ (function(module, exports) {\n\nmodule.exports = jQuery;\n\n/***/ }),\n/* 54 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* unused harmony export findBestHandler */\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = groupByHandlers;\n/* harmony export (immutable) */ __webpack_exports__[\"b\"] = groupSequentiallyByHandlers;\n/* harmony export (immutable) */ __webpack_exports__[\"c\"] = normalizeSubscribeResponse;\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_lodash__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_lodash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_lodash__);\n\n\n/**\n * @param {String} topic\n * @param {Handler[]} handlers\n * @param {any} [matchOptions] options to pass on to matcher\n * @return {Handler | undefined}\n */\nfunction findBestHandler(topic, handlers, matchOptions) {\n    for (var i = 0; i < handlers.length; i++) {\n        var thishandler = handlers[i];\n        var match = thishandler.match(topic, matchOptions);\n        if (match !== false) {\n            return $.extend(true, {}, thishandler, { matched: match });\n        }\n    }\n    return undefined;\n}\n\n/**\n * [groupByHandlers description]\n * @param  {String[]} topics   List of topics to match. Format can be anything your handler.match function handles\n * @param  {Handler[]} handlers Handlers of type [{ match: func }]\n * @return {HandlerWithTopics[]} The handler array with each item now having an additional 'data' attr added to it with the matching topics\n */\nfunction groupByHandlers(topics, handlers) {\n    handlers = handlers.map(function (h, index) {\n        h.key = index;\n        return h;\n    });\n    var topicMapping = [].concat(topics).reduce(function (accum, topic) {\n        var bestHandler = findBestHandler(topic, handlers);\n        if (bestHandler) {\n            //if handler matches different strings treat both as different handlers\n            var key = bestHandler.key + bestHandler.matched;\n            if (!accum[key]) {\n                bestHandler.data = [];\n                accum[key] = bestHandler;\n            }\n            accum[key].data.push(topic);\n        }\n        return accum;\n    }, {});\n    return __WEBPACK_IMPORTED_MODULE_0_lodash___default.a.values(topicMapping);\n}\n\n/**\n * Takes a `publish` dataset and groups it by handler maintaining the data sequence\n * @param  {Publishable[]} data     Of the form [{ name: 'X', }]\n * @param  {Handler[]} handlers Handlers of type [{ match: func }]\n * @return {HandlerWithData[]} The handler array with each item now having an additional 'data' attr added to it with the publishable data\n */\nfunction groupSequentiallyByHandlers(data, handlers) {\n    handlers = handlers.map(function (h, index) {\n        h.key = index;\n        return h;\n    });\n    var grouped = data.reduce(function (accum, dataPt) {\n        var lastHandler = accum[accum.length - 1];\n        var bestHandler = findBestHandler(dataPt.name, handlers, true);\n        if (bestHandler) {\n            if (lastHandler && bestHandler.key === lastHandler.key) {\n                lastHandler.data.push(dataPt);\n            } else {\n                accum.push($.extend({}, bestHandler, { data: [dataPt] }));\n            }\n        } else {\n            accum.push({ data: [dataPt], matched: false });\n        }\n        return accum;\n    }, []);\n    return grouped;\n}\n\n/**\n * @param {any} response \n * @param {string[]} topics \n * @returns {Publishable[]}\n */\nfunction normalizeSubscribeResponse(response, topics) {\n    // @ts-ignore\n    if (response === undefined) {\n        return [];\n    }\n    var isAlreadyInPublishableFormat = Array.isArray(response) && (!response.length || response[0].name !== undefined);\n    if (isAlreadyInPublishableFormat) {\n        return response;\n    }\n    if (typeof response === 'object' && !Array.isArray(response)) {\n        return topics.reduce(function (accum, t) {\n            accum.push({ name: t, value: response[t] });\n            return accum;\n        }, []);\n    }\n    if (topics.length === 1) {\n        //it's not in a publishable format, so someone just returned a string or something\n        var name = topics[0];\n        return [{ name: name, value: response }];\n    }\n    throw new Error('unrecognized subscribe response format');\n}\n\n/***/ }),\n/* 55 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = silencable;\n/**\n * @param {Publishable[]} published \n * @param {boolean|String[]|{except: String[]}} [silentOptions]\n * @return {Publishable[]} filtered list\n */\nfunction silencable(published, silentOptions) {\n    if (silentOptions === true || !published) {\n        return [];\n    } else if (Array.isArray(silentOptions)) {\n        return published.filter(function (data) {\n            var found = silentOptions.indexOf(data.name) !== -1;\n            return !found;\n        });\n    } else if (silentOptions && silentOptions.except) {\n        return published.filter(function (data) {\n            var found = (silentOptions.except || []).indexOf(data.name) !== -1;\n            return found;\n        });\n    }\n    return published;\n}\n\n/***/ }),\n/* 56 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = excludeReadOnly;\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_lodash__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_lodash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_lodash__);\n\n\n/**\n * \n * @param {Publishable[]} publishable \n * @param {boolean|string[]|Function} readOnlyOptions \n * @return {Publishable[]} filtered list\n */\nfunction excludeReadOnly(publishable, readOnlyOptions) {\n    if (Object(__WEBPACK_IMPORTED_MODULE_0_lodash__[\"isFunction\"])(readOnlyOptions)) {\n        readOnlyOptions = readOnlyOptions();\n    }\n    if (readOnlyOptions === true) {\n        console.error('Tried to publish to a readonly channel', publishable);\n        return [];\n    }\n    if (Array.isArray(readOnlyOptions)) {\n        var split = publishable.reduce(function (accum, data) {\n            var isReadonly = readOnlyOptions.indexOf(data.name) !== -1;\n            if (isReadonly) {\n                accum.readOnly.push(data);\n            } else {\n                accum.remaining.push(data);\n            }\n            return accum;\n        }, { readOnly: [], remaining: [] });\n\n        if (split.readOnly.length) {\n            console.warn('Ignoring readonly publishes', split.readOnly);\n        }\n        return split.remaining;\n    }\n    return publishable;\n}\n\n/***/ }),\n/* 57 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__json_router__ = __webpack_require__(58);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"b\", function() { return __WEBPACK_IMPORTED_MODULE_0__json_router__[\"a\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__epicenter_router__ = __webpack_require__(59);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return __WEBPACK_IMPORTED_MODULE_1__epicenter_router__[\"a\"]; });\n\n\n\n/***/ }),\n/* 58 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* unused harmony export match */\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_utils_parse_utils__ = __webpack_require__(3);\n\n\nfunction match(topic) {\n    var parsed = Object(__WEBPACK_IMPORTED_MODULE_0_utils_parse_utils__[\"toImplicitType\"])(topic);\n    return typeof parsed !== 'string' ? '' : false;\n}\n\n/* harmony default export */ __webpack_exports__[\"a\"] = ({\n    match: match,\n    name: 'JSON Route',\n    subscribeHandler: function (topics) {\n        var parsed = topics.map(function (t) {\n            return {\n                name: t,\n                value: Object(__WEBPACK_IMPORTED_MODULE_0_utils_parse_utils__[\"toImplicitType\"])(t)\n            };\n        });\n        return parsed;\n    }\n});\n\n/***/ }),\n/* 59 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__run_manager_router__ = __webpack_require__(60);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__scenario_manager_router__ = __webpack_require__(65);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__custom_run_router__ = __webpack_require__(66);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__world_manager_router__ = __webpack_require__(68);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__runs_router__ = __webpack_require__(71);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_channels_channel_router_utils__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_channels_route_handlers_route_matchers__ = __webpack_require__(6);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_channels_channel_router__ = __webpack_require__(4);\n\n\n\n\n\n\n\n// import UserRouter from './user-router/current-user-channel';\n\n\n\n\n\n\nfunction getOptions(opts, key) {\n    var serviceOptions = $.extend(true, {}, opts.defaults, opts[key]);\n    var channelOptions = $.extend(true, {}, serviceOptions.channelOptions);\n    delete serviceOptions.channelOptions;\n\n    return { serviceOptions: serviceOptions, channelOptions: channelOptions };\n}\n\nvar SCENARIO_PREFIX = 'sm:';\nvar RUN_PREFIX = 'rm:';\nvar WORLD_PREFIX = 'world:';\n\nvar sampleRunidLength = '000001593dd81950d4ee4f3df14841769a0b'.length;\nvar runidRegex = '(?:.{' + sampleRunidLength + '})';\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (function (config, notifier, channelManagerContext) {\n    var opts = $.extend(true, {}, config);\n\n    var customRunChannelOpts = getOptions(opts, 'runid');\n    var customRunChannel = new __WEBPACK_IMPORTED_MODULE_2__custom_run_router__[\"a\" /* default */](customRunChannelOpts, notifier);\n    var runsChannel = new __WEBPACK_IMPORTED_MODULE_4__runs_router__[\"a\" /* default */](customRunChannelOpts, Object(__WEBPACK_IMPORTED_MODULE_5_channels_channel_router_utils__[\"g\" /* withPrefix */])(notifier, 'runs'), channelManagerContext);\n    // var userChannel = new UserRouter(getOptions(opts, 'runManager').run, withPrefix(notifier, 'user:'), channelManagerContext);\n\n    /** @type {Handler[]} **/\n    var handlers = [$.extend({}, customRunChannel, {\n        name: 'customRun',\n        match: Object(__WEBPACK_IMPORTED_MODULE_6_channels_route_handlers_route_matchers__[\"c\" /* matchRegex */])(runidRegex),\n        options: customRunChannelOpts.channelOptions\n    }), $.extend({}, runsChannel, {\n        name: 'archiveRuns',\n        match: Object(__WEBPACK_IMPORTED_MODULE_6_channels_route_handlers_route_matchers__[\"b\" /* matchPrefix */])('runs:'),\n        options: customRunChannelOpts.channelOptions\n    })];\n    var exposable = {};\n\n    var runManagerOpts = getOptions(opts, 'runManager');\n    if (opts.runManager || !opts.scenarioManager && runManagerOpts.serviceOptions.run) {\n        var rm;\n        var isMultiplayer = runManagerOpts.serviceOptions.strategy === 'multiplayer';\n        if (opts.scenarioManager) {\n            rm = new __WEBPACK_IMPORTED_MODULE_0__run_manager_router__[\"a\" /* default */](runManagerOpts, Object(__WEBPACK_IMPORTED_MODULE_5_channels_channel_router_utils__[\"g\" /* withPrefix */])(notifier, RUN_PREFIX));\n            handlers.push($.extend({}, rm, {\n                name: 'run',\n                match: Object(__WEBPACK_IMPORTED_MODULE_6_channels_route_handlers_route_matchers__[\"b\" /* matchPrefix */])(RUN_PREFIX), //if both scenario manager and run manager are being used, require a prefix\n                options: runManagerOpts.channelOptions\n            }));\n        } else if (isMultiplayer) {\n            //Ignore case where both scenario manager and multiplayer are being used\n            rm = new __WEBPACK_IMPORTED_MODULE_3__world_manager_router__[\"a\" /* default */](runManagerOpts, Object(__WEBPACK_IMPORTED_MODULE_5_channels_channel_router_utils__[\"g\" /* withPrefix */])(notifier, [WORLD_PREFIX, '']));\n            handlers.push($.extend({}, rm, {\n                name: 'World run',\n                match: Object(__WEBPACK_IMPORTED_MODULE_6_channels_route_handlers_route_matchers__[\"a\" /* matchDefaultPrefix */])(WORLD_PREFIX),\n                isDefault: true,\n                options: runManagerOpts.channelOptions\n            }));\n        } else {\n            rm = new __WEBPACK_IMPORTED_MODULE_0__run_manager_router__[\"a\" /* default */](runManagerOpts, Object(__WEBPACK_IMPORTED_MODULE_5_channels_channel_router_utils__[\"g\" /* withPrefix */])(notifier, [RUN_PREFIX, '']));\n            handlers.push($.extend({}, rm, {\n                name: 'run',\n                match: Object(__WEBPACK_IMPORTED_MODULE_6_channels_route_handlers_route_matchers__[\"a\" /* matchDefaultPrefix */])(RUN_PREFIX),\n                isDefault: true,\n                options: runManagerOpts.channelOptions\n            }));\n        }\n\n        $.extend(exposable, rm.expose);\n    }\n\n    if (opts.scenarioManager) {\n        var scenarioManagerOpts = getOptions(opts, 'scenarioManager');\n        var sm = new __WEBPACK_IMPORTED_MODULE_1__scenario_manager_router__[\"a\" /* default */](scenarioManagerOpts, Object(__WEBPACK_IMPORTED_MODULE_5_channels_channel_router_utils__[\"g\" /* withPrefix */])(notifier, [SCENARIO_PREFIX, '']));\n        handlers.push($.extend({}, sm, {\n            name: 'scenario',\n            match: Object(__WEBPACK_IMPORTED_MODULE_6_channels_route_handlers_route_matchers__[\"a\" /* matchDefaultPrefix */])(SCENARIO_PREFIX),\n            options: scenarioManagerOpts.channelOptions,\n            isDefault: true\n        }));\n\n        $.extend(exposable, sm.expose);\n    }\n\n    var epicenterRouter = Object(__WEBPACK_IMPORTED_MODULE_7_channels_channel_router__[\"a\" /* default */])(handlers, notifier);\n    epicenterRouter.expose = exposable;\n\n    return epicenterRouter;\n});\n\n/***/ }),\n/* 60 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__run_router__ = __webpack_require__(8);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_channels_channel_router_utils__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_channels_channel_router__ = __webpack_require__(4);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_channels_route_handlers_route_matchers__ = __webpack_require__(6);\n\n\n\n\n\n\nvar _window = window,\n    F = _window.F;\n\n\nvar RUN_PREFIX = 'current:';\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (function (config, notifier) {\n    var defaults = {\n        serviceOptions: {},\n        channelOptions: {}\n    };\n    var opts = $.extend(true, {}, defaults, config);\n\n    var rmOptions = opts.serviceOptions;\n    var rm = new F.manager.RunManager(rmOptions);\n\n    var $creationPromise = rm.getRun().then(function (run) {\n        return rm.run;\n    });\n    var currentChannelOpts = $.extend(true, { serviceOptions: $creationPromise }, opts.defaults, opts.current);\n    var currentRunChannel = new __WEBPACK_IMPORTED_MODULE_0__run_router__[\"a\" /* default */](currentChannelOpts, Object(__WEBPACK_IMPORTED_MODULE_1_channels_channel_router_utils__[\"g\" /* withPrefix */])(notifier, [RUN_PREFIX, '']));\n\n    var runRouteHandler = $.extend(currentRunChannel, {\n        match: Object(__WEBPACK_IMPORTED_MODULE_3_channels_route_handlers_route_matchers__[\"a\" /* matchDefaultPrefix */])(RUN_PREFIX), //TODO: Just remove prefix?\n        name: 'Current Run',\n        isDefault: true,\n        options: currentChannelOpts.channelOptions\n    });\n    var handlers = [runRouteHandler];\n\n    var runMangerRouter = Object(__WEBPACK_IMPORTED_MODULE_2_channels_channel_router__[\"a\" /* default */])(handlers);\n    runMangerRouter.expose = { runManager: rm };\n\n    return runMangerRouter;\n});\n\n/***/ }),\n/* 61 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = RunMetaChannel;\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_channels_channel_utils__ = __webpack_require__(5);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_lodash__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_lodash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_lodash__);\n\n\n\nfunction RunMetaChannel($runServicePromise, notifier) {\n\n    function mergeAndSend(runMeta, requestedTopics) {\n        var toSend = [].concat(requestedTopics).reduce(function (accum, meta) {\n            accum.push({ name: meta, value: runMeta[meta] });\n            return accum;\n        }, []);\n        return toSend;\n        // return notifier(toSend);\n    }\n    return {\n        subscribeHandler: function (topics, options) {\n            topics = [].concat(topics);\n\n            return $runServicePromise.then(function (runService) {\n                var cachedValues = Object(__WEBPACK_IMPORTED_MODULE_1_lodash__[\"intersection\"])(Object.keys(runService.runMeta || {}), topics);\n                if (options.autoFetch === false) {\n                    return $.Deferred().resolve({}).promise();\n                } else if (cachedValues.length === topics.length) {\n                    //FIXME: Add 'updated time' to meta, and fetch if that's < debounce interval -- use the custom debounce fn with the custom merge (debounce save as well?)\n                    //Make run service factory return patched run-service?\n                    return $.Deferred().resolve(mergeAndSend(runService.runMeta, topics)).promise();\n                }if (!runService.loadPromise) {\n                    runService.loadPromise = runService.load().then(function (data) {\n                        runService.runMeta = data;\n                        return data;\n                    });\n                }\n                return runService.loadPromise.then(function (data) {\n                    return mergeAndSend(data, topics);\n                });\n            });\n        },\n        publishHandler: function (topics, options) {\n            return $runServicePromise.then(function (runService) {\n                var toSave = Object(__WEBPACK_IMPORTED_MODULE_0_channels_channel_utils__[\"c\" /* publishableToObject */])(topics);\n                return runService.save(toSave).then(function (res) {\n                    runService.runMeta = $.extend({}, true, runService.runMeta, res);\n                    return Object(__WEBPACK_IMPORTED_MODULE_0_channels_channel_utils__[\"b\" /* objectToPublishable */])(res);\n                });\n            });\n        }\n    };\n}\n\n/***/ }),\n/* 62 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = RunVariablesChannel;\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_utils_general__ = __webpack_require__(7);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_channels_channel_utils__ = __webpack_require__(5);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_lodash__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_lodash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_lodash__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__retriable_variable_fetch__ = __webpack_require__(63);\n\n\n\n\n// import { optimizedFetch } from './optimized-variables-fetch';\n\nfunction RunVariablesChannel($runServicePromise, notifier) {\n    var id = Object(__WEBPACK_IMPORTED_MODULE_2_lodash__[\"uniqueId\"])('variable-channel');\n\n    function debouncedVariableQuery(runService, debounceInterval) {\n        if (!runService.debouncedFetchers) {\n            runService.debouncedFetchers = {};\n        }\n        if (!runService.debouncedFetchers[id]) {\n            runService.debouncedFetchers[id] = Object(__WEBPACK_IMPORTED_MODULE_0_utils_general__[\"a\" /* debounceAndMerge */])(function (variables) {\n                return Object(__WEBPACK_IMPORTED_MODULE_3__retriable_variable_fetch__[\"a\" /* retriableFetch */])(runService, variables);\n            }, debounceInterval, [function mergeVariables(accum, newval) {\n                if (!accum) {\n                    accum = [];\n                }\n                return Object(__WEBPACK_IMPORTED_MODULE_2_lodash__[\"uniq\"])(accum.concat(newval)).filter(function (v) {\n                    return !!(v && v.trim());\n                });\n            }]);\n        }\n        return runService.debouncedFetchers[id];\n    }\n\n    var knownTopics = [];\n    return {\n        fetch: function () {\n            return $runServicePromise.then(function (runService) {\n                return Object(__WEBPACK_IMPORTED_MODULE_3__retriable_variable_fetch__[\"a\" /* retriableFetch */])(runService, [].concat(knownTopics)).then(__WEBPACK_IMPORTED_MODULE_1_channels_channel_utils__[\"b\" /* objectToPublishable */]).then(notifier);\n            });\n        },\n\n        unsubscribeHandler: function (unsubscribedTopics, remainingTopics) {\n            knownTopics = knownTopics.filter(function (t) {\n                return unsubscribedTopics.indexOf(t) === -1;\n            });\n        },\n        subscribeHandler: function (topics, options) {\n            var isAutoFetchEnabled = options.autoFetch;\n            var debounceInterval = options.debounce;\n\n            return $runServicePromise.then(function (runService) {\n                knownTopics = Object(__WEBPACK_IMPORTED_MODULE_2_lodash__[\"uniq\"])(knownTopics.concat(topics));\n                if (!knownTopics.length) {\n                    return $.Deferred().resolve([]).promise();\n                } else if (!isAutoFetchEnabled) {\n                    return $.Deferred().resolve(topics).promise();\n                }\n                return debouncedVariableQuery(runService, debounceInterval)(topics).then(function (response) {\n                    var missingVariables = Object(__WEBPACK_IMPORTED_MODULE_2_lodash__[\"difference\"])(topics, Object.keys(response));\n                    if (missingVariables.length) {\n                        return $.Deferred().reject({\n                            context: missingVariables,\n                            message: 'Missing variables: ' + missingVariables.join(',')\n                        }).promise();\n                    }\n                    return response;\n                });\n            });\n        },\n        notify: function (variableObj) {\n            return $runServicePromise.then(function (runService) {\n                var variables = Object.keys(variableObj);\n                return Object(__WEBPACK_IMPORTED_MODULE_3__retriable_variable_fetch__[\"a\" /* retriableFetch */])(runService, variables).then(__WEBPACK_IMPORTED_MODULE_1_channels_channel_utils__[\"b\" /* objectToPublishable */]).then(notifier);\n            });\n        },\n        publishHandler: function (topics, options) {\n            return $runServicePromise.then(function (runService) {\n                var toSave = Object(__WEBPACK_IMPORTED_MODULE_1_channels_channel_utils__[\"c\" /* publishableToObject */])(topics);\n                return runService.variables().save(toSave).then(function (response) {\n                    var variables = Object.keys(toSave);\n                    //Get the latest from the server because what you think you saved may not be what was saved\n                    //bool -> 1, scalar to array for time-based models etc\n                    //FIXME: This causes dupe requests, one here and one after fetch by the run-variables channel\n                    //FIXME: Other publish can't do anything till this is done, so debouncing won't help. Only way out is caching\n                    return Object(__WEBPACK_IMPORTED_MODULE_3__retriable_variable_fetch__[\"a\" /* retriableFetch */])(runService, variables).then(__WEBPACK_IMPORTED_MODULE_1_channels_channel_utils__[\"b\" /* objectToPublishable */]);\n                });\n            });\n        }\n    };\n}\n\n/***/ }),\n/* 63 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = retriableFetch;\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_lodash__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_lodash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_lodash__);\n\n\nfunction retriableFetch(runService, variables) {\n    if (!variables || !variables.length) {\n        return $.Deferred().resolve({}).promise();\n    }\n    return runService.variables().query(variables).catch(function (e) {\n        var response = e.responseJSON;\n        var info = response.information;\n        if (info.code !== 'VARIABLE_NOT_FOUND') {\n            throw e;\n        }\n        var goodVariables = Object(__WEBPACK_IMPORTED_MODULE_0_lodash__[\"difference\"])(variables, info.context.names);\n        return retriableFetch(runService, goodVariables);\n    });\n}\n\n/***/ }),\n/* 64 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = RunOperationsChannel;\nfunction RunOperationsChannel($runServicePromise, notifier) {\n    return {\n        notify: function (operationsResponse) {\n            var parsed = [{ name: operationsResponse.name, value: operationsResponse.result }];\n            return notifier(parsed);\n        },\n\n        subscribeHandler: function () {\n            return [];\n        },\n        publishHandler: function (topics, options) {\n            return $runServicePromise.then(function (runService) {\n                var toSave = topics.map(function (topic) {\n                    return { name: topic.name, params: topic.value };\n                });\n                return runService.serial(toSave).then(function (result) {\n                    var toReturn = result.map(function (response, index) {\n                        return { name: topics[index].name, value: response.result };\n                    });\n                    return toReturn;\n                });\n            });\n        }\n    };\n}\n\n/***/ }),\n/* 65 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__run_router__ = __webpack_require__(8);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_channels_channel_router_utils__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_channels_channel_router__ = __webpack_require__(4);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_channels_route_handlers_route_matchers__ = __webpack_require__(6);\n\n\n\n\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (function (config, notifier) {\n    var defaults = {\n        serviceOptions: {},\n        channelOptions: {}\n    };\n    var opts = $.extend(true, {}, defaults, config);\n\n    var sm = new window.F.manager.ScenarioManager(opts.serviceOptions);\n\n    var baselinePromise = sm.baseline.getRun().then(function () {\n        return sm.baseline.run;\n    });\n    var baselineOptions = $.extend(true, {\n        serviceOptions: baselinePromise,\n        channelOptions: {\n            meta: {\n                readOnly: true\n            },\n            variables: {\n                readOnly: true\n            }\n        }\n    }, opts.defaults, opts.baseline);\n    var currentRunPromise = sm.current.getRun().then(function () {\n        return sm.current.run;\n    });\n\n    var runOptions = $.extend(true, {\n        serviceOptions: currentRunPromise\n    }, opts.defaults, opts.current);\n\n    var baselineChannel = new __WEBPACK_IMPORTED_MODULE_0__run_router__[\"a\" /* default */](baselineOptions, Object(__WEBPACK_IMPORTED_MODULE_1_channels_channel_router_utils__[\"g\" /* withPrefix */])(notifier, 'baseline:'));\n    var currentRunChannel = new __WEBPACK_IMPORTED_MODULE_0__run_router__[\"a\" /* default */](runOptions, Object(__WEBPACK_IMPORTED_MODULE_1_channels_channel_router_utils__[\"g\" /* withPrefix */])(notifier, ['current:', '']));\n    var handlers = [$.extend(baselineChannel, {\n        name: 'baseline',\n        match: Object(__WEBPACK_IMPORTED_MODULE_3_channels_route_handlers_route_matchers__[\"b\" /* matchPrefix */])('baseline:'),\n        options: baselineOptions.channelOptions\n    }), $.extend(currentRunChannel, {\n        isDefault: true,\n        name: 'current',\n        match: Object(__WEBPACK_IMPORTED_MODULE_3_channels_route_handlers_route_matchers__[\"a\" /* matchDefaultPrefix */])('current:'),\n        options: runOptions.channelOptions\n    })];\n\n    var scenarioManagerRouter = Object(__WEBPACK_IMPORTED_MODULE_2_channels_channel_router__[\"a\" /* default */])(handlers, notifier);\n    scenarioManagerRouter.expose = { scenarioManager: sm };\n    return scenarioManagerRouter;\n});\n\n/***/ }),\n/* 66 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__run_router_factory__ = __webpack_require__(67);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_channels_channel_router_utils__ = __webpack_require__(2);\n\n\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (function (options, notifier) {\n    if (!options) options = {};\n\n    var opts = {};\n    opts.serviceOptions = options.serviceOptions && options.serviceOptions.run ? options.serviceOptions.run : {};\n    opts.channelOptions = options.channelOptions;\n\n    return {\n        subscribeHandler: function (topics, options, prefix) {\n            var runid = Object(__WEBPACK_IMPORTED_MODULE_1_channels_channel_router_utils__[\"d\" /* stripSuffixDelimiter */])(prefix);\n            //FIXME: Should i merge options here?\n            var channel = Object(__WEBPACK_IMPORTED_MODULE_0__run_router_factory__[\"a\" /* default */])(runid, opts, Object(__WEBPACK_IMPORTED_MODULE_1_channels_channel_router_utils__[\"g\" /* withPrefix */])(notifier, prefix));\n            return channel.subscribeHandler(topics, options, prefix);\n        },\n        publishHandler: function (topics, options, prefix) {\n            var runid = Object(__WEBPACK_IMPORTED_MODULE_1_channels_channel_router_utils__[\"d\" /* stripSuffixDelimiter */])(prefix);\n            var channel = Object(__WEBPACK_IMPORTED_MODULE_0__run_router_factory__[\"a\" /* default */])(runid, opts, Object(__WEBPACK_IMPORTED_MODULE_1_channels_channel_router_utils__[\"g\" /* withPrefix */])(notifier, prefix));\n            return channel.publishHandler(topics);\n        }\n    };\n});\n\n/***/ }),\n/* 67 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__run_router__ = __webpack_require__(8);\n\nvar knownRunIDServiceChannels = {};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (function (runid, options, notifier) {\n    var runChannel = knownRunIDServiceChannels[runid];\n    if (!runChannel) {\n        var runOptions = $.extend(true, {}, options, { serviceOptions: { id: runid } });\n        runChannel = new __WEBPACK_IMPORTED_MODULE_0__run_router__[\"a\" /* default */](runOptions, notifier);\n        knownRunIDServiceChannels[runid] = runChannel;\n    }\n    return runChannel;\n});\n\n/***/ }),\n/* 68 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__world_users_channel__ = __webpack_require__(69);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__world_current_user_channel__ = __webpack_require__(70);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_channels_channel_router_utils__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_channels_route_handlers_route_matchers__ = __webpack_require__(6);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__run_router__ = __webpack_require__(8);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_channels_channel_router__ = __webpack_require__(4);\n\n\n\n\n\n\n\n\n\nvar _window = window,\n    F = _window.F;\n\n//TODO: Add custom worldid channel as well\n//\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (function (config, notifier) {\n    var _this = this;\n\n    var defaults = {\n        serviceOptions: {},\n        channelOptions: {}\n    };\n    var opts = $.extend(true, {}, defaults, config);\n\n    var rmOptions = opts.serviceOptions;\n    var rm = new F.manager.RunManager(rmOptions);\n\n    var getRunPromise = rm.getRun().then(function (run) {\n        if (!run.world) {\n            console.error('No world found in run. Make sure you\\'re using EpicenterJS version > 2.7');\n            throw new Error('Could not find world');\n        }\n        return run;\n    }, function (err) {\n        console.error('Run manager get run error', err);\n        throw err;\n    });\n    var $runPromise = getRunPromise.then(function (run) {\n        if (rm.run.channel) {\n            return rm.run;\n        }\n        var channelManager = new F.manager.ChannelManager();\n        var worldChannel = channelManager.getWorldChannel(run.world);\n\n        worldChannel.subscribe(worldChannel.TOPICS.RUN_RESET, function (run) {\n            rm.run.updateConfig({ filter: run.id });\n        }, _this, { includeMine: false });\n        rm.run.channel = worldChannel;\n        return rm.run;\n    });\n\n    var currentRunChannelOpts = $.extend(true, { serviceOptions: $runPromise }, opts.defaults, opts.current);\n    var currentRunChannel = new __WEBPACK_IMPORTED_MODULE_4__run_router__[\"a\" /* default */](currentRunChannelOpts, Object(__WEBPACK_IMPORTED_MODULE_2_channels_channel_router_utils__[\"g\" /* withPrefix */])(notifier, ['run:', '']));\n\n    var handlers = [];\n\n    var runRouteHandler = $.extend(currentRunChannel, {\n        match: Object(__WEBPACK_IMPORTED_MODULE_3_channels_route_handlers_route_matchers__[\"a\" /* matchDefaultPrefix */])('run:'),\n        name: 'World Run',\n        isDefault: true,\n        options: currentRunChannelOpts.channelOptions\n    });\n    handlers.unshift(runRouteHandler);\n\n    var worldPromise = getRunPromise.then(function (run) {\n        return run.world;\n    });\n    var multiUserChannel = new __WEBPACK_IMPORTED_MODULE_0__world_users_channel__[\"a\" /* default */](worldPromise, Object(__WEBPACK_IMPORTED_MODULE_2_channels_channel_router_utils__[\"g\" /* withPrefix */])(notifier, 'users:'));\n    var multiUserHandler = $.extend(multiUserChannel, {\n        match: Object(__WEBPACK_IMPORTED_MODULE_3_channels_route_handlers_route_matchers__[\"b\" /* matchPrefix */])('users:'),\n        name: 'world users'\n    });\n    handlers.unshift(multiUserHandler);\n\n    var userChannel = new __WEBPACK_IMPORTED_MODULE_1__world_current_user_channel__[\"a\" /* default */](worldPromise, Object(__WEBPACK_IMPORTED_MODULE_2_channels_channel_router_utils__[\"g\" /* withPrefix */])(notifier, 'user:'));\n    var userHandler = $.extend(userChannel, {\n        match: Object(__WEBPACK_IMPORTED_MODULE_3_channels_route_handlers_route_matchers__[\"b\" /* matchPrefix */])('user:'),\n        name: 'current user'\n    });\n    handlers.unshift(userHandler);\n\n    var runMangerRouter = Object(__WEBPACK_IMPORTED_MODULE_5_channels_channel_router__[\"a\" /* default */])(handlers);\n    runMangerRouter.expose = { runManager: rm };\n\n    return runMangerRouter;\n});\n\n/***/ }),\n/* 69 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = WorldUsersChanngel;\nvar F = window.F;\n\nfunction WorldUsersChanngel(worldPromise, notifier) {\n    var presenceSubsId = void 0;\n\n    var store = {\n        users: [],\n        mark: function (userid, isOnline) {\n            store.users = store.users.map(function (u) {\n                if (u.userId === userid) {\n                    u.isOnline = isOnline;\n                }\n                return u;\n            });\n            return store.users;\n        }\n    };\n    var channelManager = new F.manager.ChannelManager();\n\n    var parsedUsersPromise = worldPromise.then(function (world) {\n        var am = new F.manager.AuthManager();\n        var session = am.getCurrentUserSessionInfo();\n        var parsed = world.users.map(function (u) {\n            u.name = u.lastName;\n            u.isMe = u.userId === session.userId;\n            u.isOnline = u.isMe; //Assume i'm the only online one by default\n            return u;\n        });\n        store.users = parsed;\n        return parsed;\n    });\n\n    return {\n        unsubscribeHandler: function (knownTopics, remainingTopics) {\n            if (remainingTopics.length || !presenceSubsId) {\n                return;\n            }\n            worldPromise.then(function (world) {\n                var worldChannel = channelManager.getWorldChannel(world);\n                worldChannel.unsubscribe(presenceSubsId);\n                presenceSubsId = null;\n            });\n        },\n        subscribeHandler: function (userids) {\n            if (!presenceSubsId) {\n                //TODO: Also listen to roles channel to update users\n                worldPromise.then(function (world) {\n                    var worldChannel = channelManager.getWorldChannel(world);\n                    presenceSubsId = worldChannel.subscribe(worldChannel.TOPICS.PRESENCE, function (user, meta) {\n                        var userid = user.id;\n                        store.mark(userid, user.isOnline);\n                        return notifier([{ name: '', value: store.users }]);\n                    }, { includeMine: false });\n                });\n            }\n            return parsedUsersPromise.then(function (users) {\n                return [{ name: '', value: users }];\n            });\n        },\n        publishHandler: function (topics, options) {\n            var ps = new F.service.Presence();\n            topics.forEach(function (topic) {\n                var split = topic.name.split(':');\n                if (split[1]) {\n                    if (split[1] === 'markOnline') {\n                        ps.markOnline(split[0]);\n                    } else if (split[1] === 'markOffline') {\n                        ps.markOffline(split[0]);\n                    }\n                }\n            });\n            return topics;\n        }\n    };\n}\n\n/***/ }),\n/* 70 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = WorldUsersChanngel;\nvar F = window.F;\n\nfunction WorldUsersChanngel(worldPromise, notifier) {\n    var subsid = void 0;\n\n    var am = new F.manager.AuthManager();\n    var store = $.extend(true, {\n        isMe: true,\n        isOnline: true\n    }, am.getCurrentUserSessionInfo());\n    var channelManager = new F.manager.ChannelManager();\n\n    return {\n        unsubscribeHandler: function (unsubscribedTopics, remainingTopics) {\n            var stillNeedRoles = remainingTopics.indexOf('role') !== -1;\n            if (!stillNeedRoles && subsid) {\n                worldPromise.then(function (world) {\n                    var worldChannel = channelManager.getWorldChannel(world);\n                    worldChannel.unsubscribe(subsid);\n                });\n                subsid = null;\n            }\n        },\n        subscribeHandler: function (userFields) {\n            return worldPromise.then(function (world) {\n                var session = am.getCurrentUserSessionInfo();\n                var myUser = world.users.find(function (user) {\n                    return user.userId === session.userId;\n                });\n                $.extend(store, myUser);\n\n                var toNotify = userFields.reduce(function (accum, field) {\n                    if (field === '') {\n                        //the entire user object\n                        accum.push({ name: field, value: store });\n                    } else if (store[field] !== undefined) {\n                        accum.push({ name: field, value: store[field] });\n                    }\n                    return accum;\n                }, []);\n\n                var isSubscribingToRole = userFields.indexOf('role') !== -1;\n                if (isSubscribingToRole && !subsid) {\n                    var worldChannel = channelManager.getWorldChannel(world);\n                    subsid = worldChannel.subscribe(worldChannel.TOPICS.ROLES, function (users, meta) {\n                        var myUser = users.find(function (u) {\n                            return u.userId === session.userId;\n                        });\n                        if (myUser && myUser.role !== store.role) {\n                            store.role = myUser.role;\n                            notifier([{ name: 'role', value: myUser.role }]);\n                        }\n                    });\n                }\n                return toNotify;\n            });\n        }\n    };\n}\n\n/***/ }),\n/* 71 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = RunsRouter;\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_utils_general__ = __webpack_require__(7);\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\n\nvar _window = window,\n    F = _window.F;\n\n\nfunction RunsRouter(options, notifier, channelManagerContext) {\n    var runService = new F.service.Run(options.serviceOptions.run);\n\n    var topicParamMap = {};\n\n    function extractFiltersFromTopic(topicString) {\n        var filters = topicString.replace('(', '').replace(')', '');\n        var filterParam = filters.split(';').reduce(function (accum, filter) {\n            var _filter$split = filter.split('='),\n                _filter$split2 = _slicedToArray(_filter$split, 2),\n                key = _filter$split2[0],\n                val = _filter$split2[1];\n\n            if (val) {\n                val = true;\n            }\n            accum[key] = val;\n            return accum;\n        }, {});\n        return filterParam;\n    }\n\n    function fetch(topic, variables) {\n        var filters = extractFiltersFromTopic(topic);\n        return runService.query(filters, { include: variables }).then(function (runs) {\n            notifier([{ name: topic, value: runs }]);\n\n            // if (topicParamMap[topic]) {\n            //     Object.keys(topicParamMap[topic]).forEach((runid)=> {\n            //         channelManagerContext.unsubscribe(topicParamMap[topic][runid]);\n            //     });\n            // }\n\n            return runs;\n        });\n    }\n\n    return {\n        fetch: fetch,\n\n        unsubscribeHandler: function (unsubscribedTopics, remainingTopics) {\n            console.log('unsubs');\n            // knownTopics = remainingTopics;\n        },\n        subscribeHandler: function (topics, options) {\n            var topic = [].concat(topics)[0];\n\n            var filters = extractFiltersFromTopic(topic);\n            var variables = options && options.include;\n\n            var debounceInterval = 300;\n            var debouncedFetch = Object(__WEBPACK_IMPORTED_MODULE_0_utils_general__[\"a\" /* debounceAndMerge */])(fetch, debounceInterval, function (accum, newval) {\n                return newval;\n            });\n            return fetch(topic, variables).then(function (runs) {\n                var subsMap = {};\n                //TODO: Provide this meta information to runs-factory so it doesn't trigger a fetch to get meta for each run\n                runs.forEach(function (run) {\n                    var subscriptions = Object.keys(filters).map(function (filter) {\n                        return run.id + ':meta:' + filter;\n                    });\n                    var subsid = channelManagerContext.subscribe(subscriptions, function () {\n                        debouncedFetch(topic, variables);\n                    }, { batch: false, autoFetch: false, cache: false });\n                    subsMap[run.id] = subsid;\n                });\n\n                topicParamMap[topic] = subsMap;\n                return runs;\n            });\n        }\n    };\n}\n\n/***/ }),\n/* 72 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__interpolatable__ = __webpack_require__(73);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return __WEBPACK_IMPORTED_MODULE_0__interpolatable__[\"a\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__routable__ = __webpack_require__(76);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"b\", function() { return __WEBPACK_IMPORTED_MODULE_1__routable__[\"a\"]; });\n\n\n// export { default as withMiddleware } from './with-middleware';\n\n/***/ }),\n/* 73 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = interpolatable;\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__subscribe_interpolator__ = __webpack_require__(74);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__publish_interpolator__ = __webpack_require__(75);\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\n\n\n\n/**\n * Decorates passed channel manager with interpolation functionality\n * @param  {ChannelManager} ChannelManager\n * @return {ChannelManager}                wrapped channel manager\n */\nfunction interpolatable(ChannelManager) {\n    var subsidMap = {};\n\n    /**\n     * @implements {ChannelManager}\n     */\n    return function (_ChannelManager) {\n        _inherits(InterpolatedChannelManager, _ChannelManager);\n\n        function InterpolatedChannelManager(options) {\n            _classCallCheck(this, InterpolatedChannelManager);\n\n            //FIXME: Add on-error (from routable) here?\n            var _this = _possibleConstructorReturn(this, (InterpolatedChannelManager.__proto__ || Object.getPrototypeOf(InterpolatedChannelManager)).call(this, options));\n\n            _this.subscribe = Object(__WEBPACK_IMPORTED_MODULE_0__subscribe_interpolator__[\"a\" /* default */])(_this.subscribe.bind(_this), function (dependencySubsId, newDependentId) {\n                var existing = subsidMap[dependencySubsId];\n                if (existing) {\n                    _this.unsubscribe(existing);\n                }\n                subsidMap[dependencySubsId] = newDependentId;\n            });\n\n            _this.publish = Object(__WEBPACK_IMPORTED_MODULE_1__publish_interpolator__[\"a\" /* default */])(_this.publish.bind(_this), function (variables, cb) {\n                _get(InterpolatedChannelManager.prototype.__proto__ || Object.getPrototypeOf(InterpolatedChannelManager.prototype), 'subscribe', _this).call(_this, variables, function (response, meta) {\n                    _this.unsubscribe(meta.id);\n                    cb(response);\n                }, { autoFetch: true, batch: true, onError: function (e) {\n                        throw e;\n                    } });\n            });\n            return _this;\n        }\n\n        _createClass(InterpolatedChannelManager, [{\n            key: 'unsubscribe',\n            value: function unsubscribe(token) {\n                var existing = subsidMap[token];\n                if (existing) {\n                    _get(InterpolatedChannelManager.prototype.__proto__ || Object.getPrototypeOf(InterpolatedChannelManager.prototype), 'unsubscribe', this).call(this, existing);\n                }\n                _get(InterpolatedChannelManager.prototype.__proto__ || Object.getPrototypeOf(InterpolatedChannelManager.prototype), 'unsubscribe', this).call(this, token);\n                delete subsidMap[token];\n            }\n        }, {\n            key: 'unsubscribeAll',\n            value: function unsubscribeAll() {\n                subsidMap = {};\n                _get(InterpolatedChannelManager.prototype.__proto__ || Object.getPrototypeOf(InterpolatedChannelManager.prototype), 'unsubscribeAll', this).call(this);\n            }\n        }]);\n\n        return InterpolatedChannelManager;\n    }(ChannelManager);\n}\n\n/***/ }),\n/* 74 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* unused harmony export getDependencies */\n/* unused harmony export interpolateWithDependencies */\n/* unused harmony export mergeInterpolatedTopicsWithData */\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = subscribeInterpolator;\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__interpolatable_utils__ = __webpack_require__(15);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_lodash__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_lodash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_lodash__);\n\n\n\n/**\n * @param {String[]} topics\n * @return {String[]} interpolated\n */\nfunction getDependencies(topics) {\n    var deps = topics.reduce(function (accum, topic) {\n        var inner = Object(__WEBPACK_IMPORTED_MODULE_0__interpolatable_utils__[\"a\" /* extractDependencies */])(topic);\n        accum = accum.concat(inner);\n        return accum;\n    }, []);\n    return Object(__WEBPACK_IMPORTED_MODULE_1_lodash__[\"uniq\"])(deps);\n}\n\n/**\n * @param {String[]} topics\n * @param {Object} data\n * @return {String[]}\n */\nfunction interpolateWithDependencies(topics, data) {\n    return topics.map(function (topic) {\n        return Object(__WEBPACK_IMPORTED_MODULE_0__interpolatable_utils__[\"b\" /* interpolateWithValues */])(topic, data);\n    });\n}\n\n/**\n * @param  {String[]} originalTopics     \n * @param  {String[]} interpolatedTopics \n * @param  {Object} data               \n * @return {Object}                    Interpolated\n */\nfunction mergeInterpolatedTopicsWithData(originalTopics, interpolatedTopics, data) {\n    return interpolatedTopics.reduce(function (accum, interpolatedTopic, index) {\n        var original = originalTopics[index];\n        var val = data[interpolatedTopic];\n        if (val !== undefined) {\n            accum[original] = data[interpolatedTopic];\n        }\n        return accum;\n    }, {});\n}\n\n/**\n * Takes a subscribe function and resolves any interpolated inputs\n * @param  {Function} subscribeFn        function to wrap\n * @param  {Function} onDependencyChange callback function when any dependencies change\n * @return {Function}                    wrapped function\n */\nfunction subscribeInterpolator(subscribeFn, onDependencyChange) {\n    return function interpolatedSubscribe(topics, cb, options) {\n        topics = [].concat(topics);\n        var dependencies = getDependencies(topics);\n        if (!dependencies.length) {\n            return subscribeFn(topics, cb, options);\n        }\n        var innerSubsId = subscribeFn(dependencies, function handleDependencyValueChange(data, dependenciesMeta) {\n            var interpolatedTopics = interpolateWithDependencies(topics, data);\n\n            var outerSubsId = subscribeFn(interpolatedTopics, function handleInterpolatedValueChange(actualData, actualMeta) {\n                var toSendback = mergeInterpolatedTopicsWithData(topics, interpolatedTopics, actualData);\n\n                cb(toSendback, actualMeta);\n            }, options);\n\n            (onDependencyChange || $.noop)(dependenciesMeta.id, outerSubsId);\n            return outerSubsId;\n        }, $.extend(options, { autoFetch: true, batch: true }));\n\n        return innerSubsId;\n    };\n}\n\n/***/ }),\n/* 75 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* unused harmony export getDependencies */\n/* unused harmony export interpolateWithDependencies */\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = publishInterpolator;\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__interpolatable_utils__ = __webpack_require__(15);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_channels_channel_utils__ = __webpack_require__(5);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_lodash__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_lodash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_lodash__);\n\n\n\n\n\n/**\n * @param {Publishable[]} publishInputs\n * @returns {String[]} dependencies for inputs\n */\nfunction getDependencies(publishInputs) {\n    var deps = publishInputs.reduce(function (accum, input) {\n        var inner = Object(__WEBPACK_IMPORTED_MODULE_0__interpolatable_utils__[\"a\" /* extractDependencies */])(input.name);\n        accum = accum.concat(inner);\n        return accum;\n    }, []);\n    return Object(__WEBPACK_IMPORTED_MODULE_2_lodash__[\"uniq\"])(deps);\n}\n\n/**\n * @param {Publishable[]} publishInputs\n * @param {Object} valuesToInterpolate\n * @returns {Publishable[]} inputs with resolved dependencies\n */\nfunction interpolateWithDependencies(publishInputs, valuesToInterpolate) {\n    return publishInputs.map(function (ip) {\n        return {\n            name: Object(__WEBPACK_IMPORTED_MODULE_0__interpolatable_utils__[\"b\" /* interpolateWithValues */])(ip.name, valuesToInterpolate),\n            value: ip.value\n        };\n    });\n}\n\n/**\n * Publish function to wrap\n * @param  {Function} publishFunction\n * @param  {Function} fetchFn         function to get interpolated values from\n * @return {Function}                 wrapped function\n */\nfunction publishInterpolator(publishFunction, fetchFn) {\n    return function interpolatedPublishfunction(topic, value, options) {\n        var normalizedPublishInputs = Object(__WEBPACK_IMPORTED_MODULE_1_channels_channel_utils__[\"a\" /* normalizeParamOptions */])(topic, value, options);\n        var dependencies = getDependencies(normalizedPublishInputs.params);\n        if (!dependencies.length) {\n            return publishFunction(topic, value, options);\n        }\n\n        var prom = $.Deferred();\n        fetchFn(dependencies, function handleDependencyChange(resolvedDependencies) {\n            var interpolated = interpolateWithDependencies(normalizedPublishInputs.params, resolvedDependencies);\n            var newPublishProm = publishFunction(interpolated, normalizedPublishInputs.options);\n            newPublishProm.then(prom.resolve, prom.reject);\n        });\n        return prom.promise();\n    };\n}\n\n/***/ }),\n/* 76 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = withRouter;\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__channel_utils__ = __webpack_require__(5);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_lodash__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_lodash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_lodash__);\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\n\n\n\nfunction getTopicsFromSubsList(subcriptionList) {\n    var allTopics = subcriptionList.reduce(function (accum, subs) {\n        accum = accum.concat(subs.topics);\n        return accum;\n    }, []);\n    return Object(__WEBPACK_IMPORTED_MODULE_1_lodash__[\"uniq\"])(allTopics);\n}\n\n/**\n * Decorates passed channel manager with middleware functionality\n * @param  {ChannelManager} ChannelManager\n * @return {ChannelManager} wrapped channel manager\n */\nfunction withRouter(ChannelManager, router) {\n    /**\n     * @augments ChannelManager\n     */\n    return function (_ChannelManager) {\n        _inherits(ChannelWithRouter, _ChannelManager);\n\n        function ChannelWithRouter(options) {\n            _classCallCheck(this, ChannelWithRouter);\n\n            var _this = _possibleConstructorReturn(this, (ChannelWithRouter.__proto__ || Object.getPrototypeOf(ChannelWithRouter)).call(this, options));\n\n            var defaults = {\n                routes: []\n            };\n            var opts = $.extend(true, {}, defaults, options);\n            var optsToPassOn = Object(__WEBPACK_IMPORTED_MODULE_1_lodash__[\"omit\"])(opts, Object.keys(defaults));\n\n            _this.router = router(opts.routes, optsToPassOn, _this.notify.bind(_this));\n            return _this;\n        }\n\n        /**\n         * Allow intercepting and excluding topics from by subsequent middlewares\n         * @param  {string | string[]}   topics\n         * @param  {Function} cb\n         * @param  {Object}   options\n         * @return {string}           subscription id\n         */\n\n\n        _createClass(ChannelWithRouter, [{\n            key: 'subscribe',\n            value: function subscribe(topics, cb, options) {\n                var _this2 = this;\n\n                var subsid = _get(ChannelWithRouter.prototype.__proto__ || Object.getPrototypeOf(ChannelWithRouter.prototype), 'subscribe', this).call(this, topics, cb, options);\n                this.router.subscribeHandler([].concat(topics), options).then(function (topicsWithData) {\n                    if (topicsWithData.length) {\n                        _this2.notify([].concat(topicsWithData));\n                    }\n                }, function (err) {\n                    _this2.unsubscribe(subsid);\n                    if (options && options.onError) {\n                        options.onError(err);\n                    }\n                });\n                return subsid;\n            }\n\n            /**\n             * Allow intercepting and handling/suppressing data to publish calls.\n             * @param {string | Publishable } topic\n             * @param {any} [value] item to publish\n             * @param {Object} [options]\n             * @return {Promise}\n             */\n\n        }, {\n            key: 'publish',\n            value: function publish(topic, value, options) {\n                var _this3 = this;\n\n                var publishData = Object(__WEBPACK_IMPORTED_MODULE_0__channel_utils__[\"a\" /* normalizeParamOptions */])(topic, value, options);\n                return this.router.publishHandler(publishData.params, publishData.options).then(function (published) {\n                    return _get(ChannelWithRouter.prototype.__proto__ || Object.getPrototypeOf(ChannelWithRouter.prototype), 'publish', _this3).call(_this3, published, publishData.options);\n                });\n            }\n\n            /**\n             * Calls unsubscribe middleware *after* unsubscription with a list of recently unsubscribed topics\n             * @param  {string} token\n             * @return {void}\n             */\n\n        }, {\n            key: 'unsubscribe',\n            value: function unsubscribe(token) {\n                var originalTopics = getTopicsFromSubsList(this.subscriptions);\n                _get(ChannelWithRouter.prototype.__proto__ || Object.getPrototypeOf(ChannelWithRouter.prototype), 'unsubscribe', this).call(this, token);\n                var remainingTopics = getTopicsFromSubsList(this.subscriptions);\n                var unsubscribedTopics = Object(__WEBPACK_IMPORTED_MODULE_1_lodash__[\"difference\"])(originalTopics, remainingTopics);\n\n                this.router.unsubscribeHandler(unsubscribedTopics, remainingTopics);\n            }\n\n            /**\n             * Calls unsubscribe middleware after unsubscribeAll on the channel\n             * @return {void}\n             */\n\n        }, {\n            key: 'unsubscribeAll',\n            value: function unsubscribeAll() {\n                var originalTopics = getTopicsFromSubsList(this.subscriptions);\n                _get(ChannelWithRouter.prototype.__proto__ || Object.getPrototypeOf(ChannelWithRouter.prototype), 'unsubscribeAll', this).call(this);\n\n                return this.router.unsubscribeHandler(originalTopics, []);\n            }\n        }]);\n\n        return ChannelWithRouter;\n    }(ChannelManager);\n}\n\n/***/ })\n/******/ ]);\n\n\n// WEBPACK FOOTER //\n// flow.min.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 16);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 04f51160a6aa9a0653be","module.exports = _;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"_\"\n// module id = 0\n// module chunks = 0","module.exports = {\n    prefix: 'f',\n    binderAttr: 'f-bind',\n\n    events: {\n        //UI Change to publish to the channel.\n        trigger: 'update.f.ui',\n\n        //Trigger with payload '{attrToUpdate: value}', for e.g. { bind: 34 }. This will run this through all the converts and pass it to attr handler. Useful to by-pass getting this from the model directly.\n        convert: 'f.convert',\n    },\n\n    attrs: {\n        checkboxOffValue: 'data-off-value',\n        //Used by repeat attr handler to keep track of template after first evaluation\n        repeat: {\n            templateId: 'repeat-template-id' //don't prefix by f or dom-manager unbind will kill it\n        },\n    },\n\n    errorAttr: 'data-flow-error',\n    animation: {\n        addAttr: 'data-add',\n        changeAttr: 'data-update',\n        initialAttr: 'data-initial',\n    }\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/config.js","const CHANNEL_DELIMITER = ':';\n\nexport { default as silencable } from './silencable';\nexport { default as excludeReadOnly } from './exclude-read-only';\n\n/**\n * \n * @param {string} text\n * @return {string}\n */\nexport function stripSuffixDelimiter(text) {\n    if (text && text.indexOf(CHANNEL_DELIMITER) === (text.length - 1)) {\n        text = text.replace(CHANNEL_DELIMITER, '');\n    }\n    return text;\n}\n\n/**\n * \n * @param {Publishable[]} dataArray \n * @param {string} prefix \n * @return {Publishable[]} array with name prefixed\n */\nexport function mapWithPrefix(dataArray, prefix) {\n    if (!prefix) return dataArray;\n    return (dataArray || []).map(function (datapt) {\n        const name = (prefix + datapt.name).replace(/:$/, ''); //replace trailing delimiters\n        return $.extend(true, {}, datapt, { name: name });\n    });\n}\n\n/**\n * \n * @param {Function} callback \n * @param {string|string[]} prefixList\n * @return {Function}\n */\nexport function withPrefix(callback, prefixList) {\n    const arr = [].concat(prefixList);\n\n    /**\n     * @param {Publishable[]} data\n     */\n    return function (data) {\n        arr.forEach(function (prefix) {\n            const mapped = mapWithPrefix(data, prefix);\n            callback(mapped);\n        });\n    };\n}\n\n/**\n * \n * @param {string[]} list \n * @param {string} prefix\n * @return {string[]} Item with prefix removed\n */\nexport function unprefixTopics(list, prefix) {\n    if (!prefix) return list;\n    const unprefixed = list.map(function (item) {\n        return item.replace(prefix, '');\n    });\n    return unprefixed;\n}\n\n/**\n * \n * @param {Publishable[]} list \n * @param {string} prefix\n * @return {Publishable[]} Item with prefix removed\n */\nexport function unprefix(list, prefix) {\n    if (!prefix) return list;\n    const unprefixed = list.map(function (item) {\n        if (item.name) {\n            return $.extend(true, {}, item, { name: item.name.replace(prefix, '') });\n        }\n        return item.replace(prefix, '');\n    });\n    return unprefixed;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/channel-router/utils/index.js","/* eslint-disable complexity */\nfunction toImplicitType(data) {\n    const objRegex = /^(?:\\{.*\\})$/;\n    const arrRegex = /^(?:\\[.*])$/;\n\n    let converted = data;\n    if (typeof data === 'string') {\n        converted = data.trim();\n\n        if (converted === 'true') {\n            converted = true;\n        } else if (converted === 'false') {\n            converted = false;\n        } else if (converted === 'null') {\n            converted = null;\n        } else if (converted === 'undefined') {\n            converted = '';\n        } else if (converted.charAt(0) === '\\'' || converted.charAt(0) === '\"') {\n            converted = converted.substring(1, converted.length - 1);\n        } else if ($.isNumeric(converted)) {\n            converted = +converted;\n        } else if (arrRegex.test(converted)) {\n            const bracketReplaced = converted.replace(/[[\\]]/g, '');\n            if (!bracketReplaced) return [];\n            const parsed = bracketReplaced.split(/,(?![^[]*])/).map((val)=> {\n                return toImplicitType(val);\n            });\n            return parsed;\n        } else if (objRegex.test(converted)) {\n            try {\n                converted = JSON.parse(converted);\n            } catch (e) {\n                console.error('toImplicitType: couldn\\'t convert', converted);\n            }\n        }\n    }\n    return converted;\n}\n\nfunction splitUnescapedCommas(str) {\n    const regex = /(\\\\.|[^,])+/g;\n    let m;\n\n    const op = [];\n    while ((m = regex.exec(str)) !== null) { //eslint-disable-line\n        // This is necessary to avoid infinite loops with zero-width matches\n        if (m.index === regex.lastIndex) {\n            regex.lastIndex++;\n        }\n        m.forEach(function (match, groupIndex) {\n            if (groupIndex === 0) {\n                op.push(match.replace('\\\\', ''));\n            }\n        });\n    }\n    return op;\n}\n\nfunction splitNameArgs(value) {\n    value = value.trim();\n    const fnName = value.split('(')[0];\n    const params = value.substring(value.indexOf('(') + 1, value.indexOf(')'));\n    const args = splitUnescapedCommas(params).map((p)=> p.trim());\n    return { name: fnName, args: args };\n}\n\n/**\n * @param  {string} value\n * @return {{ name: string, value: any}[]}       [description]\n */\nfunction toPublishableFormat(value) {\n    const OPERATIONS_SEPERATOR = '&&';\n    const split = (value || '').split(OPERATIONS_SEPERATOR);\n    const listOfOperations = split.map(function (value) {\n        if (value && value.indexOf('=') !== -1) {\n            const split = value.split('=');\n            return { name: split[0].trim(), value: split[1].trim() };\n        }\n        const parsed = splitNameArgs(value);\n        return { name: parsed.name, value: parsed.args };\n    });\n    return listOfOperations;\n}\n\nexport { toImplicitType, toPublishableFormat, splitNameArgs };\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils/parse-utils.js","import { groupByHandlers, groupSequentiallyByHandlers, normalizeSubscribeResponse } from './utils/handler-utils';\nimport { unprefix, unprefixTopics, mapWithPrefix, silencable, excludeReadOnly } from './utils';\nimport { makePromise } from 'utils/general';\nimport _ from 'lodash';\n\n\n/**\n * Handle subscriptions\n * @param  {Handler[]} handlers Array of the form [{ match: function (){}, }]\n * @param  {String[]} topics   Array of strings\n * @param  {SubscribeOptions} [options]\n * @return {Promise<Publishable[]>} Returns populated topics if available\n */\nexport function notifySubscribeHandlers(handlers, topics, options) {\n    const grouped = groupByHandlers(topics, handlers);\n    const promises = [];\n    grouped.filter((handler)=> handler.subscribeHandler).forEach(function (handler) {\n        const mergedOptions = $.extend(true, {}, handler.options, options);\n        const unprefixed = unprefixTopics(handler.data, handler.matched);\n        const promise = makePromise(()=> {\n            const subsResponse = handler.subscribeHandler(unprefixed, mergedOptions, handler.matched);\n            return subsResponse;\n        }).then((topicsWithData)=> {\n            const normalized = normalizeSubscribeResponse(topicsWithData, unprefixed);\n            const prefixed = mapWithPrefix(normalized, handler.matched);\n            return prefixed;\n        });\n        promises.push(promise);\n    });\n    return $.when.apply(null, promises).then(function () {\n        const arr = [].concat.apply([], arguments);\n        return arr;\n    });\n}\n\n/**\n * \n * @param {Handler[]} handlers \n * @param {String[]} recentlyUnsubscribedTopics\n * @param {String[]} remainingTopics \n */\nexport function notifyUnsubscribeHandlers(handlers, recentlyUnsubscribedTopics, remainingTopics) {\n    handlers = handlers.map(function (h, index) {\n        h.unsubsKey = index;\n        return h;\n    });\n\n    const unsubsGrouped = groupByHandlers(recentlyUnsubscribedTopics, handlers);\n    const remainingGrouped = groupByHandlers(remainingTopics, handlers);\n\n    unsubsGrouped.filter((h)=> h.unsubscribeHandler).forEach(function (handler) {\n        const unprefixedUnsubs = unprefixTopics(handler.data, handler.matched);\n        const matchingRemainingHandler = _.find(remainingGrouped, function (remainingHandler) {\n            return remainingHandler.unsubsKey === handler.unsubsKey;\n        });\n        const matchingTopicsRemaining = matchingRemainingHandler ? matchingRemainingHandler.data : [];\n        const unprefixedRemaining = unprefixTopics(matchingTopicsRemaining || [], handler.matched);\n        handler.unsubscribeHandler(unprefixedUnsubs, unprefixedRemaining);\n    });\n}\n\n/**\n * \n * @param {Handler[]} handlers \n * @param {Publishable[]} publishData \n * @param {PublishOptions} [options]\n * @return {Promise}\n */\nexport function passthroughPublishInterceptors(handlers, publishData, options) {\n    const grouped = groupSequentiallyByHandlers(publishData, handlers);\n    let $initialProm = $.Deferred().resolve([]).promise();\n    grouped.forEach(function (handler) {\n        $initialProm = $initialProm.then(function (dataSoFar) {\n            const mergedOptions = $.extend(true, {}, handler.options, options);\n            const unprefixed = unprefix(handler.data, handler.matched);\n\n            const publishableData = excludeReadOnly(unprefixed, mergedOptions.readOnly);\n            if (!publishableData.length) {\n                return dataSoFar;\n            }\n\n            const result = handler.publishHandler ? handler.publishHandler(publishableData, mergedOptions, handler.matched) : publishableData;\n            const publishProm = $.Deferred().resolve(result).promise();\n            return publishProm.then(function (published) {\n                return silencable(published, mergedOptions.silent);\n            }).then(function (published) {\n                let mapped = mapWithPrefix(published, handler.matched);\n                if (handler.isDefault && handler.matched) {\n                    mapped = mapped.concat(published);\n                }\n                return mapped;\n            }).then(function (mapped) {\n                return [].concat(dataSoFar, mapped);\n            });\n        });\n    });\n    return $initialProm;\n}\n\n/**\n * Router\n * @param  {Handler[]} handlers\n * @param {object} [options]\n * @param {function} [notifier]\n * @return {Router}\n */\nexport default function router(handlers, options, notifier) {\n    let myHandlers = (handlers || []).map((Handler)=> {\n        let handler = Handler;\n        if (_.isFunction(Handler)) {\n            handler = new Handler(options, notifier);\n            $.extend(this, handler.expose);\n        }\n        if (typeof handler.match === 'string') {\n            const matchString = handler.match;\n            handler.name = matchString;\n            handler.match = (t)=> t === matchString ? '' : false;\n        }\n        return handler;\n    });\n\n    return {\n        match: (topic)=> {\n            return myHandlers.reduce((match, handler)=> {\n                const matched = handler.match(topic);\n                if (match === false && matched !== false) {\n                    return '';\n                }\n                return match;\n            }, false);\n        },\n\n        /**\n         * @param {String[]} topics\n         * @param {SubscribeOptions} [options]\n         * @return {Promise<Publishable[]>} Returns populated topics if available\n         */\n        subscribeHandler: function (topics, options) {\n            return notifySubscribeHandlers(myHandlers, topics, options);\n        },\n        /**\n         * @param {String[]} recentlyUnsubscribedTopics\n         * @param {String[]} remainingTopics\n         * @return {void}\n         */\n        unsubscribeHandler: function (recentlyUnsubscribedTopics, remainingTopics) {\n            return notifyUnsubscribeHandlers(myHandlers, recentlyUnsubscribedTopics, remainingTopics);\n        },\n\n        /**\n         * @param {Publishable[]} data\n         * @param {PublishOptions} [options]\n         * @return {Promise}\n         */\n        publishHandler: function (data, options) {\n            return passthroughPublishInterceptors(myHandlers, data, options);\n        },\n\n        addRoute: function (handler) {\n            if (!handler || !handler.match) {\n                throw Error('Handler does not have a valid `match` property');\n            }\n            handler.id = _.uniqueId('routehandler-');\n            myHandlers.unshift(handler);\n            return handler.id;\n        },\n        removeRoute: function (routeid) {\n            myHandlers = myHandlers.filter((handler)=> {\n                return handler.id !== routeid;\n            });\n        }\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/channel-router/index.js","/**\n * \n * @param {object} obj\n * @return {Publishable[]}\n */\nexport function objectToPublishable(obj) {\n    var mapped = Object.keys(obj || {}).map(function (t) {\n        return { name: t, value: obj[t] };\n    });\n    return mapped;\n}\n\n/**\n * Converts arrays of the form [{ name: '', value: ''}] to {[name]: value}\n * @param {Publishable[]} arr\n * @param {object} [mergeWith]\n * @returns {object}\n */\nexport function publishableToObject(arr, mergeWith) {\n    var result = (arr || []).reduce(function (accum, topic) {\n        accum[topic.name] = topic.value;\n        return accum;\n    }, $.extend(true, {}, mergeWith));\n    return result;\n}\n\n/**\n * @typedef NormalizedParam\n * @property {Publishable[]} params\n * @property {Object} options\n */\n\n/**\n *\n * @param {String|Object|array} topic \n * @param {*} publishValue \n * @param {Object} [options]\n * @return {NormalizedParam}\n */\nexport function normalizeParamOptions(topic, publishValue, options) {\n    if (!topic) {\n        return { params: [], options: {} };\n    }\n    if ($.isPlainObject(topic)) {\n        return { params: objectToPublishable(topic), options: publishValue };\n    }\n    if (Array.isArray(topic)) {\n        return { params: topic, options: publishValue };\n    }\n    return { params: [{ name: topic, value: publishValue }], options: options };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/channel-utils.js","var CHANNEL_DELIMITER = ':';\n\n/**\n * \n * @param {string} prefix\n * @returns {matchFunction}\n */\nexport function matchPrefix(prefix) {\n    return function prefixMatcher(topic) {\n        const hasPrefix = topic.indexOf(prefix) === 0;\n        if (hasPrefix) return prefix;\n\n        const isOnlyPrefix = prefix.replace(/:/g, '') === topic;\n        if (isOnlyPrefix) return topic;\n\n        return false;\n    };\n}\n\n/**\n* \n* @param {string} prefix\n* @returns {matchFunction}\n*/\nexport function matchDefaultPrefix(prefix) {\n    return function defaultPrefixMatcher(topic, forcePrefix) {\n        const hasPrefix = topic.indexOf(prefix) === 0;\n        return (hasPrefix || forcePrefix) ? prefix : '';\n    };\n}\n\n/**\n * \n * @param {string} regex\n * @returns {matchFunction}\n */\nexport function matchRegex(regex) {\n    var toMatch = new RegExp('^' + regex + CHANNEL_DELIMITER);\n    return function regexMatcher(topic) {\n        var match = topic.match(toMatch);\n        if (match && match.length) {\n            return match[0];\n        }\n        return false;\n    };\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/route-matchers.js","import { uniqueId, random as _random } from 'lodash';\n\nexport { default as makePromise } from './make-promise';\nexport { default as debounceAndMerge } from './debounce-and-merge';\n\nexport function random(prefix, min, max) {\n    if (!min) {\n        min = parseInt(uniqueId(), 10);\n    }\n    if (!max) {\n        max = 100000; //eslint-disable-line no-magic-numbers\n    }\n    var rnd = _random(min, max, false) + '';\n    if (prefix) {\n        rnd = prefix + rnd;\n    }\n    return rnd;\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils/general/index.js","import MetaChannel from './run-meta-channel';\nimport VariablesChannel from './run-variables-channel';\nimport OperationsChannel from './run-operations-channel';\n\nimport router from 'channels/channel-router';\nimport { withPrefix } from 'channels/channel-router/utils';\nimport { matchPrefix, matchDefaultPrefix } from 'channels/route-handlers/route-matchers';\n\nimport _ from 'lodash';\n\nexport const VARIABLES_PREFIX = 'variables:';\nexport const META_PREFIX = 'meta:';\nexport const OPERATIONS_PREFIX = 'operations:';\n\n/**\n * \n * @param {Publishable[]} result \n * @param {string[]} ignoreOperations \n * @returns {boolean}\n */\nexport function _shouldFetch(result, ignoreOperations) {\n    const filtered = (result || []).filter((r)=> {\n        const name = r.name || '';\n        const isIgnored = (ignoreOperations || []).indexOf(name.replace(OPERATIONS_PREFIX, '')) !== -1;\n        const isVariable = name.indexOf(VARIABLES_PREFIX) === 0;\n        const isOperation = name.indexOf(OPERATIONS_PREFIX) === 0;\n\n        return isVariable || (isOperation && !isIgnored);\n    });\n    return filtered.length > 0;\n}\n\nexport default function RunRouter(config, notifier) {\n    const defaults = {\n        serviceOptions: {},\n        channelOptions: {\n            variables: {\n                autoFetch: true,\n                debounce: 200,\n                silent: false,\n                readOnly: false,\n            },\n            operations: {\n                readOnly: false,\n                silent: false,\n            },\n            meta: {\n                silent: false,\n                autoFetch: true,\n                readOnly: ['id', 'created', 'account', 'project', 'model', 'lastModified']\n            },\n        }\n    };\n    const opts = $.extend(true, {}, defaults, config);\n\n    const serviceOptions = _.result(opts, 'serviceOptions');\n\n    let $initialProm = null;\n    if (serviceOptions instanceof window.F.service.Run) {\n        $initialProm = $.Deferred().resolve(serviceOptions).promise();\n    } else if (serviceOptions.then) {\n        $initialProm = serviceOptions;\n    } else {\n        const rs = new window.F.service.Run(serviceOptions);\n        $initialProm = $.Deferred().resolve(rs).promise();\n    }\n\n    const operationNotifier = withPrefix(notifier, OPERATIONS_PREFIX);\n    const variableNotifier = withPrefix(notifier, [VARIABLES_PREFIX, '']);\n\n    const metaChannel = new MetaChannel($initialProm, withPrefix(notifier, META_PREFIX));\n    const operationsChannel = new OperationsChannel($initialProm, operationNotifier);\n    const variableschannel = new VariablesChannel($initialProm, variableNotifier);\n\n    let subscribed = false;\n    $initialProm.then((rs)=> {\n        if (rs.channel && !subscribed) {\n            subscribed = true;\n            const { TOPICS } = rs.channel;\n            const subscribeOpts = { includeMine: false };\n            //FIXME: Exclude silenced -- let notify take care of this?\n            //FIXME: Provide subscription fn to individual channels and let them handle it\n            rs.channel.subscribe(TOPICS.RUN_VARIABLES, (data, meta)=> {\n                console.log('variables', data, meta);\n                variableschannel.notify(data, meta);\n                variableschannel.fetch();\n            }, this, subscribeOpts);\n            rs.channel.subscribe(TOPICS.RUN_OPERATIONS, (data, meta)=> {\n                operationsChannel.notify(data, meta);\n                variableschannel.fetch();\n            }, this, subscribeOpts);\n            rs.channel.subscribe(TOPICS.RUN_RESET, (data, meta)=> {\n                operationsChannel.notify({ name: 'reset', result: data }, meta);\n            }, this, subscribeOpts);\n\n            // rs.channel.subscribe('', (data, meta)=> {\n            //     console.log('everything', data, meta);\n            // });\n        }\n    });\n\n    const handlers = [\n        $.extend({}, metaChannel, { \n            name: 'meta',\n            match: matchPrefix(META_PREFIX),\n            options: opts.channelOptions.meta,\n        }),\n        $.extend({}, operationsChannel, { \n            name: 'operations',\n            match: matchPrefix(OPERATIONS_PREFIX),\n            options: opts.channelOptions.operations,\n        }),\n        $.extend({}, variableschannel, { \n            isDefault: true,\n            name: 'variables',\n            match: matchDefaultPrefix(VARIABLES_PREFIX),\n            options: opts.channelOptions.variables,\n        }),\n    ];\n\n    // router.addRoute(prefix('meta:'), metaChannel, opts.channelOptions.meta);\n\n    const runRouter = router(handlers);\n    const oldhandler = runRouter.publishHandler;\n    runRouter.publishHandler = function () {\n        const prom = oldhandler.apply(router, arguments);\n        return prom.then(function (result) { //all the silencing will be taken care of by the router\n            const shouldFetch = _shouldFetch(result, ['reset']);\n            if (shouldFetch) {\n                variableschannel.fetch();\n            }\n            return result;\n        });\n    };\n    return runRouter;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/epicenter-router/run-router/index.js","export function _findMostConsequtive(arr, match) {\n    const reduced = arr.reduce((accum, val)=> {\n        if (val === match) {\n            if (accum.prev === match) {\n                accum.count = accum.count + 1;\n            } else {\n                accum.count = 1;\n            }\n        }\n        accum.maxCount = Math.max(accum.maxCount, accum.count);\n        accum.prev = val;\n        return accum;\n    }, { prev: null, count: 0, maxCount: 0 });\n    return reduced.maxCount;\n}\n\nfunction buildDiffArray(currentcontents, newContents) {\n    return newContents.map((contents, index)=> {\n        const isSame = contents === currentcontents[index]; \n        return isSame;\n    });\n}\n\nfunction fill(count, val) {\n    const a = [];\n    for (let i = 0; i < count; i++) {\n        a.push(val);\n    }\n    return a;\n}\n\nfunction elToContents(el) {\n    //ignore data attributes for comparison\n    return el.outerHTML\n        .replace(/\\s?data-[a-zA-Z]*=['\"][a-zA-Z0-9]*['\"]/g, '')\n        .replace(/\\s\\s/g, ' ').trim();\n}\n\nfunction elementsToContents($els) {\n    return $els.map((index, child)=> {\n        return elToContents(child);\n    }).get();\n}\n\nconst defaults = {\n    addAttr: 'data-add',\n    changeAttr: 'data-update',\n    initialAttr: 'data-initial',\n};\n\n/**\n * Compares 2 lists and Adds add or update classes\n * @param {JQuery<HTMLElement>} $currentEls existing elements\n * @param {JQuery<HTMLElement>} $newEls   new elements\n * @param {Boolean} isInitial check if this is initial data or it's updating\n * @param {{ addAttr: string, changeAttr: string}} [options]\n * @returns {JQuery<HTMLElement>} elements with updated attributes\n */\nexport function addChangeClassesToList($currentEls, $newEls, isInitial, options) {\n    const opts = $.extend({}, defaults, options);\n\n    let currentcontents = elementsToContents($currentEls);\n    const newContents = elementsToContents($newEls);\n    const reversedContents = currentcontents;\n\n    //Guess if data was added to end or beginning of array\n    const diffFromEnd = buildDiffArray(currentcontents, newContents);\n    const diffFromBeginning = buildDiffArray(reversedContents.slice().reverse(), newContents.slice().reverse());\n\n    const endMatches = _findMostConsequtive(diffFromEnd, true);\n    const beginningMatches = _findMostConsequtive(diffFromBeginning, true);\n\n    const placeHoldersCount = newContents.length - currentcontents.length;\n    const placeHolders = fill(placeHoldersCount, undefined);\n\n    if (beginningMatches <= endMatches) {\n        currentcontents = currentcontents.concat(placeHolders);\n    } else {\n        currentcontents = placeHolders.concat(currentcontents);\n    }\n\n    for (let i = 0; i < newContents.length; i++) {\n        const $el = $newEls.eq(i);\n        const curr = currentcontents[i];\n        $el.removeAttr(opts.initialAttr);\n\n        const contents = elToContents($el.get(0));\n        if (curr === undefined) {\n            $el.attr({\n                [opts.addAttr]: true,\n                [opts.initialAttr]: isInitial || null\n            });\n            $el.removeAttr(opts.changeAttr);\n        } else if (curr !== contents) {\n            $el.attr({\n                [opts.changeAttr]: true,\n                [opts.initialAttr]: isInitial || null\n            });\n            $el.removeAttr(opts.addAttr);\n        } else {\n            $el.removeAttr(`${opts.addAttr} ${opts.changeAttr}`);\n        }\n    }\n\n    return $newEls;\n}\n\nexport function addContentAndAnimate($el, newValue, isInitial, options) {\n    const opts = $.extend({}, defaults, options);\n    const current = $el.html().trim();\n\n    $el.removeAttr(`${opts.changeAttr} ${opts.initialAttr}`);\n    if (current === `${newValue}`.trim()) {\n        return $el;\n    }\n\n    $el.html(newValue);\n    setTimeout(function () {\n        $el.attr({\n            [opts.changeAttr]: true,\n            [opts.initialAttr]: isInitial || null //jquery removes if set to null\n        });\n    }, 0); //need this to trigger animation\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils/animation.js","import { uniqueId } from 'lodash';\n\nconst CURRENT_INDEX_KEY = 'current-index';\nconst CURRENT_INDEX_ATTR = `data-${CURRENT_INDEX_KEY}`;\n\nexport function getKnownDataForEl($el) {\n    const closestKnownDataEl = $el.closest(`[${CURRENT_INDEX_ATTR}]`);\n    let knownData = {};\n    if (closestKnownDataEl.length) {\n        knownData = closestKnownDataEl.data(CURRENT_INDEX_KEY);\n    }\n    return knownData;\n}\nexport function updateKnownDataForEl($el, data) {\n    $el.attr(CURRENT_INDEX_ATTR, JSON.stringify(data));\n}\nexport function removeKnownData($el) {\n    $el.removeAttr(CURRENT_INDEX_ATTR);\n}\n\nexport function getTemplateTags(template) {\n    template = template.replace(/&lt;/g, '<').replace(/&gt;/g, '>');\n    const templateTagsUsed = template.match(/<%[=-]?([\\s\\S]+?)%>/g);\n    return templateTagsUsed || [];\n}\nexport function isTemplated(template) {\n    return getTemplateTags(template).length > 0;\n}\n\n\nexport function findMissingReferences(template, knownDataKeys) {\n    function isKnownTag(tag, knownTags) {\n        const match = knownDataKeys.find((key)=> {\n            const regex = new RegExp('\\\\b' + key + '\\\\b');\n            return regex.test(tag);\n        });\n        return match;\n    }\n\n    template = template.replace(/&lt;/g, '<').replace(/&gt;/g, '>');\n    const missingReferences = {};\n    const templateTagsUsed = getTemplateTags(template);\n    if (templateTagsUsed) {\n        templateTagsUsed.forEach(function (tag) {\n            if (tag.match(/\\w+/) && !isKnownTag(tag, knownDataKeys)) {\n                let refKey = missingReferences[tag];\n                if (!refKey) {\n                    refKey = uniqueId('no-ref');\n                    missingReferences[tag] = refKey;\n                }\n            }\n        });\n    }\n    return missingReferences;\n}\n\nfunction refToMarkup(refKey) {\n    return '<!--' + refKey + '-->';\n}\n\nexport function stubMissingReferences(template, missingReferences) {\n    template = template.replace(/&lt;/g, '<').replace(/&gt;/g, '>');\n\n    Object.keys(missingReferences).forEach((tag)=> {\n        const refId = missingReferences[tag];\n        const r = new RegExp(tag, 'g');\n        template = template.replace(r, refToMarkup(refId));\n    });\n    return template;\n}\n\nexport function addBackMissingReferences(template, missingReferences) {\n    Object.keys(missingReferences).forEach((originalTemplateVal)=> {\n        const commentRef = missingReferences[originalTemplateVal];\n        const r = new RegExp(refToMarkup(commentRef), 'g');\n        template = template.replace(r, originalTemplateVal);\n    });\n\n    return template;\n}\n\n\nconst elTemplateMap = new WeakMap();\nexport function getOriginalContents($el, resolver) {\n    const el = $el.get(0);\n    let originalHTML = elTemplateMap.get(el);\n    if (!originalHTML && resolver) {\n        originalHTML = resolver($el).replace(/&lt;/g, '<').replace(/&gt;/g, '>');\n        elTemplateMap.set(el, originalHTML);\n    }\n    return originalHTML;\n}\nexport function clearOriginalContents($el) {\n    const el = $el.get(0);\n    elTemplateMap.delete(el);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attributes/attr-template-utils.js","'use strict';\nconst config = require('../../config');\nconst BaseView = require('./default-node');\n\nmodule.exports = BaseView.extend({\n    propertyHandlers: [],\n\n    uiChangeEvent: 'change',\n    getUIValue: function () {\n        return this.$el.val();\n    },\n\n    removeEvents: function () {\n        this.$el.off(this.uiChangeEvent);\n    },\n\n    initialize: function () {\n        const me = this;\n        const propName = this.$el.data(config.binderAttr);\n\n        if (propName) {\n            this.$el.off(this.uiChangeEvent).on(this.uiChangeEvent, function () {\n                const val = me.getUIValue();\n\n                const payload = [{ name: propName, value: val }];\n                me.$el.trigger(config.events.trigger, { data: payload, source: 'bind' });\n            });\n        }\n        BaseView.prototype.initialize.apply(this, arguments);\n    }\n}, { selector: 'input, select, textarea' });\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/nodes/default-input-node.js","'use strict';\n\nvar BaseView = require('../../utils/base-view');\n\nmodule.exports = BaseView.extend({\n    propertyHandlers: [\n\n    ],\n\n    initialize: function () {\n    }\n}, { selector: '*' });\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/nodes/default-node.js","const { extend, has } = require('lodash');\n\nvar extendView = function (protoProps, staticProps) {\n    var me = this;\n    var child;\n\n    // The constructor function for the new subclass is either defined by you\n    // (the \"constructor\" property in your `extend` definition), or defaulted\n    // by us to simply call the parent's constructor.\n    if (protoProps && has(protoProps, 'constructor')) {\n        child = protoProps.constructor;\n    } else {\n        child = function () { return me.apply(this, arguments); };\n    }\n\n    // Add static properties to the constructor function, if supplied.\n    extend(child, me, staticProps);\n\n    // Set the prototype chain to inherit from `parent`, without calling\n    // `parent`'s constructor function.\n    var Surrogate = function () { this.constructor = child; };\n    Surrogate.prototype = me.prototype;\n    child.prototype = new Surrogate();\n\n    // Add prototype properties (instance properties) to the subclass,\n    // if supplied.\n    if (protoProps) {\n        extend(child.prototype, protoProps);\n    }\n\n    // Set a convenience property in case the parent's prototype is needed\n    // later.\n    child.__super__ = me.prototype; //eslint-disable-line no-underscore-dangle\n\n    return child;\n};\n\nvar View = function (options) {\n    this.$el = (options.$el) || $(options.el);\n    this.el = options.el;\n    this.initialize.apply(this, arguments);\n\n};\nextend(View.prototype, {\n    initialize: function () {},\n});\n\nView.extend = extendView;\n\nmodule.exports = View;\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils/base-view.js","const IN_OF_REGEX = /\\((.*)\\) (?:in|of)\\s+(.*)/;\nconst KEY_VALUE_REGEX = /(.*),(.*)/;\n\n/**\n * @param {string} attrVal \n * @return {string}\n */\nexport function extractVariableName(attrVal) {\n    const inMatch = attrVal.trim().match(IN_OF_REGEX);\n    const varName = inMatch ? inMatch[2] : attrVal;\n    return varName.trim();\n}\n\n/**\n * @param {string} attrVal \n * @return {string}\n */\nexport function parseKeyAlias(attrVal) {\n    const inMatch = attrVal.match(IN_OF_REGEX);\n    if (!inMatch) {\n        return undefined;\n    }\n    const itMatch = inMatch[1].match(KEY_VALUE_REGEX);\n    const alias = itMatch ? itMatch[1].trim() : undefined;\n    return alias;\n}\n\n/**\n * @param {string} attrVal \n * @return {string}\n */\nexport function parseValueAlias(attrVal) {\n    const inMatch = attrVal.match(IN_OF_REGEX);\n    if (!inMatch) {\n        return undefined;\n    }\n    const itMatch = inMatch[1].match(KEY_VALUE_REGEX);\n    const alias = itMatch ? itMatch[2] : inMatch[1];\n    return alias.trim();\n}\n\n\n//Public exports\n\nexport function aliasesFromTopics(topics, value) {\n    const relevantTopic = topics[0]; //doesn't support multiple topics\n\n    const defaultKey = $.isPlainObject(value) ? 'key' : 'index';\n    const keyAlias = relevantTopic.keyAlias || defaultKey;\n    const valueAlias = relevantTopic.valueAlias || 'value';\n\n    return { keyAlias: keyAlias, valueAlias: valueAlias };\n}\nexport function parseTopics(topics) {\n    const attrVal = topics[0].name; //doesn't support multiple topics\n    return [{\n        name: extractVariableName(attrVal),\n        keyAlias: parseKeyAlias(attrVal),\n        valueAlias: parseValueAlias(attrVal),\n    }];\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attributes/loop-attrs/loop-attr-utils.js","var interpolationRegex = /<(.*?)>/g;\n/**\n *  \n * @param {String} topic topic to extract dependencies from\n * @return {String[]} dependencies\n */\nexport function extractDependencies(topic) {\n    var deps = (topic.match(interpolationRegex) || []).map((val)=> {\n        return val.substring(1, val.length - 1); \n    });\n    return deps;\n}\n\n/**\n * @param {String} topic topic with dependencies\n * @param {Object} data object with values of dependencies\n * @return {String} interpolated string\n */\nexport function interpolateWithValues(topic, data) {\n    var interpolatedTopic = topic.replace(interpolationRegex, (match, dependency)=> {\n        var val = data[dependency];\n        var toReplace = Array.isArray(val) ? val[val.length - 1] : val;\n        return toReplace;\n    });\n    return interpolatedTopic;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/channel-manager-enhancements/interpolatable/interpolatable-utils.js","/**\n * ## Flow.js Initialization\n *\n * To use Flow.js in your project, simply call `Flow.initialize()` in your user interface. In the basic case, `Flow.initialize()` can be called without any arguments. While Flow.js needs to know the account, project, and model you are using, by default these values are extracted from the URL of Epicenter project and by the use of `data-f-model` in your `<body>` tag. See more on the [basics of using Flow.js in your project.](../../#using_in_project).\n *\n * However, sometimes you want to be explicit in your initialization call, and there are also some additional parameters that let you customize your use of Flow.js.\n *\n * #### Parameters\n *\n * The parameters for initializing Flow.js include:\n *\n * * `channel` Configuration details for the channel Flow.js uses in connecting with underlying APIs.\n * * `channel.strategy` The run creation strategy describes when to create new runs when an end user visits this page. The default is `new-if-persisted`, which creates a new run when the end user is idle for longer than your project's **Model Session Timeout** (configured in your project's [Settings](../../../updating_your_settings/)), but otherwise uses the current run.. See more on [Run Strategies](../../../api_adapters/generated/strategies/).\n * * `channel.run` Configuration details for each run created.\n * * `channel.run.account` The **User ID** or **Team ID** for this project. By default, taken from the URL where the user interface is hosted, so you only need to supply this is you are running your project's user interface [on your own server](../../../how_to/self_hosting/).\n * * `channel.run.project` The **Project ID** for this project.\n * * `channel.run.model` Name of the primary model file for this project. By default, taken from `data-f-model` in your HTML `<body>` tag.\n * * `channel.run.variables` Configuration options for the variables being listened to on this channel.\n * * `channel.run.variables.silent` Provides granular control over when user interface updates happen for changes on this channel. See below for possible values.\n * * `channel.run.variables.autoFetch` Options for fetching variables from the API as they're being subscribed. See [Variables Channel](../channels/variables-channel/) for details.\n * * `channel.run.operations` Configuration options for the operations being listened to on this channel. Currently there is only one configuration option: `silent`.\n * * `channel.run.operations.silent` Provides granular control over when user interface updates happen for changes on this channel. See below for possible values.\n * * `channel.run.server` Object with additional server configuration, defaults to `host: 'api.forio.com'`.\n * * `channel.run.transport` An object which takes all of the jquery.ajax options at <a href=\"http://api.jquery.com/jQuery.ajax/\">http://api.jquery.com/jQuery.ajax/</a>.\n * * `dom` Configuration options for the DOM where this instance of Flow.js is created.\n * * `dom.root` The root HTML element being managed by the Flow.js DOM Manager. Defaults to `body`.\n * * `dom.autoBind` If `true` (default), automatically parse variables added to the DOM after this `Flow.initialize()` call. Note, this does not work in IE versions < 11.\n *\n * The `silent` configuration option for the `run.variables` and `run.operations` is a flag for providing more granular control over when user interface updates happen for changes on this channel. Values can be:\n *\n * * `false`: Always update the UI for any changes (variables updated, operations called) on this channel. This is the default behavior.\n * * `true`: Never update the UI for any on changes (variables updated, operations called) on this channel.\n * * Array of variables or operations for which the UI *should not* be updated. For example, `variables: { silent: [ 'price', 'sales' ] }` means this channel is silent (no updates for the UI) when the variables 'price' or 'sales' change, and the UI is always updated for any changes to other variables. This is useful if you know that changing 'price' or 'sales' does not impact anything else in the UI directly, for instance.\n * * `except`: With array of variables or operations for which the UI *should* be updated. For example, `variables { silent: { except: [ 'price', 'sales' ] } }` is the converse of the above. The UI is always updated when anything on this channel changes *except* when the variables 'price' or 'sales' are updated.\n *\n * Although Flow.js provides a bi-directional binding between the model and the user interface, the `silent` configuration option applies only for the binding from the model to the user interface; updates in the user interface (including calls to operations) are still sent to the model.\n *\n * The `Flow.initialize()` call is based on the Epicenter.js [Run Service](../../../api_adapters/generated/run-api-service/) from the [API Adapters](../../../api_adapters/). See those pages for additional information on parameters.\n *\n * The `Flow.initialize()` call returns a promise, which is resolved when initialization is complete.\n *\n * #### Example\n *\n *      Flow.initialize({\n *          channel: {\n *              strategy: 'new-if-persisted',\n *              run: {\n *                  model: 'supply-chain-game.py',\n *                  account: 'acme-simulations',\n *                  project: 'supply-chain-game',\n *                  server: { host: 'api.forio.com' },\n *                  variables: { silent: ['price', 'sales'] },\n *                  operations: { silent: false },\n *                  transport: {\n *                      beforeSend: function() { $('body').addClass('loading'); },\n *                      complete: function() { $('body').removeClass('loading'); }\n *                  }\n *              }\n *          }\n *      }).then(function() {\n *          // code that depends on initialization\n *      });\n *\n */\n\nconst domManager = require('./dom/dom-manager');\nconst BaseView = require('./utils/base-view');\n\nconst ChannelManager = require('channels/configured-channel-manager').default;\nconst config = require('config');\n\nvar Flow = {\n    dom: domManager,\n    utils: {\n        BaseView: BaseView\n    },\n    initialize: function (config) {\n        var model = $('body').data('f-model');\n\n        var defaults = {\n            channel: {\n                //FIXME: Defaults can't be here..\n                defaults: {\n                    run: {\n                        model: model,\n                    }\n                },\n            },\n            dom: {\n                root: 'body',\n                autoBind: true\n            }\n        };\n\n        var options = $.extend(true, {}, defaults, config);\n   \n        if (config && config.channel && (config.channel instanceof ChannelManager)) {\n            this.channel = config.channel;\n        } else {\n            this.channel = new ChannelManager(options.channel);\n        }\n\n        var prom = domManager.initialize($.extend(true, {\n            channel: this.channel\n        }, options.dom));\n        \n        this.channel.subscribe('operations:reset', function () {\n            domManager.unbindAll();\n            domManager.bindAll();\n        });\n\n        return prom;\n    }\n};\nFlow.ChannelManager = ChannelManager;\nFlow.constants = config;\n//set by grunt\nif (RELEASE_VERSION) Flow.version = RELEASE_VERSION; //eslint-disable-line no-undef\nmodule.exports = Flow;\n\n\n\n// WEBPACK FOOTER //\n// ./src/flow.js","\n/**\n * ## DOM Manager\n *\n * The Flow.js DOM Manager provides two-way data bindings from your project's user interface to the channel. The DOM Manager is the 'glue' through which HTML DOM elements -- including the attributes and attribute handlers provided by Flow.js for [variables](../../attributes-overview/), [operations](../../operations-overview/) and [conversion](../../converter-overview/), and those [you create](./attributes/attribute-manager/) -- are bound to the variable and operations [channels](../../channel-overview/) to link them with your project's model. See the [Epicenter architecture details](../../../creating_your_interface/arch_details/) for a visual description of how the DOM Manager relates to the [rest of the Epicenter stack](../../../creating_your_interface/).\n *\n * The DOM Manager is an integral part of the Flow.js architecture but, in keeping with our general philosophy of extensibility and configurability, it is also replaceable. For instance, if you want to manage your DOM state with [Backbone Views](http://backbonejs.org) or [Angular.js](https://angularjs.org), while still using the channels to handle the communication with your model, this is the piece you'd replace. [Contact us](http://forio.com/about/contact/) if you are interested in extending Flow.js in this way -- we'll be happy to talk about it in more detail.\n *\n */\n\nconst { \n    getConvertersForEl, getChannelForAttribute, getChannelConfigForElement, parseTopicsFromAttributeValue \n} = require('./dom-manager-utils/dom-parse-helpers');\n\nconst { addPrefixToTopics, addDefaultPrefix } = require('./dom-manager-utils/dom-channel-prefix-helpers');\nconst { toImplicitType } = require('utils/parse-utils');\n\nconst { pick } = require('lodash');\n\nconst config = require('../config');\n\nconst converterManager = require('converters/converter-manager').default;\nconst nodeManager = require('./nodes/node-manager').default;\nconst attrManager = require('./attributes/attribute-manager').default;\nconst autoUpdatePlugin = require('./plugins/auto-update-bindings').default;\n\nmodule.exports = (function () {\n    //Jquery selector to return everything which has a f- property set\n    $.expr.pseudos[config.prefix] = function (el) {\n        if (!el || !el.attributes) {\n            return false;\n        }\n        for (let i = 0; i < el.attributes.length; i++) {\n            const attr = el.attributes[i].nodeName;\n            if (attr.indexOf('data-' + config.prefix) === 0) {\n                return true;\n            }\n        }\n        return false;\n    };\n\n    /**\n     * @param {JQuery<HTMLElement>} root\n     * @return {JQuery<HTMLElement>}\n     */ \n    function getMatchingElements(root) {\n        const $root = $(root);\n        let matchedElements = $root.find(':' + config.prefix);\n        if ($root.is(':' + config.prefix)) {\n            matchedElements = matchedElements.add($root);\n        }\n        return matchedElements;\n    }\n\n    /**\n     * @param {JQuery<HTMLElement> | HTMLElement} element\n     * @param {*} [context]\n     * @return {HTMLElement}\n     */ \n    function getElementOrError(element, context) {\n        const el = (element instanceof $) ? element.get(0) : element;\n        if (!el || !el.nodeName) {\n            console.error(context, 'Expected to get DOM Element, got ', element);\n            throw new Error(context + ': Expected to get DOM Element, got' + (typeof element));\n        }\n        return el;\n    }\n\n    //Unbind utils\n    function removeAllSubscriptions(subscriptions, channel) {\n        [].concat(subscriptions).forEach(function (subs) {\n            channel.unsubscribe(subs);\n        });\n    }\n    function unbindAllAttributes(domEl) {\n        const $el = $(domEl);\n        $(domEl.attributes).each(function (index, nodeMap) {\n            let attr = nodeMap.nodeName;\n            const wantedPrefix = 'data-f-';\n            if (attr.indexOf(wantedPrefix) === 0) {\n                attr = attr.replace(wantedPrefix, '');\n                const handler = attrManager.getHandler(attr, $el);\n                if (handler.unbind) {\n                    handler.unbind(attr, $el);\n                }\n            }\n        });\n    }\n    function unbindAllNodeHandlers(domEl) {\n        const $el = $(domEl);\n        //FIXME: have to readd events to be able to remove them. Ugly\n        const Handler = nodeManager.getHandler($el);\n        const h = new Handler.handle({\n            el: domEl\n        });\n        if (h.removeEvents) {\n            h.removeEvents();\n        }\n    }\n\n    const publicAPI = {\n\n        nodes: nodeManager,\n        attributes: attrManager,\n        converters: converterManager,\n            \n        matchedElements: new Map(),\n\n        /**\n         * Unbind the element; unsubscribe from all updates on the relevant channels.\n         *\n         * @param {JQuery<HTMLElement> | HTMLElement} element The element to remove from the data binding.\n         * @param {Channel} channel (Optional) The channel from which to unsubscribe. Defaults to the [variables channel](../channels/variables-channel/).\n         * @returns {void}\n         */\n        unbindElement: function (element, channel) {\n            if (!channel) {\n                channel = this.options.channel;\n            }\n            const domEl = getElementOrError(element);\n            const $el = $(element);\n            const existingData = this.matchedElements.get(domEl);\n            if (!$el.is(':' + config.prefix) || !existingData) {\n                return;\n            }\n            this.matchedElements.delete(element);\n            const subscriptions = Object.keys(existingData).reduce((accum, a)=> {\n                const subsid = existingData[a].subscriptionId;\n                if (subsid) accum.push(subsid);\n                return accum;\n            }, []);\n\n            unbindAllNodeHandlers(domEl);\n            unbindAllAttributes(domEl);\n            removeAllSubscriptions(subscriptions, channel);\n            \n            const animAttrs = Object.keys(config.animation).join(' ');\n            $el.removeAttr(animAttrs);\n\n            Object.keys($el.data()).forEach(function (key) {\n                if (key.indexOf('f-') === 0 || key.match(/^f[A-Z]/)) {\n                    $el.removeData(key);\n                }\n            });\n        },\n\n        /**\n         * Bind the element: subscribe from updates on the relevant channels.\n         *\n         * @param {HTMLElement | JQuery<HTMLElement>} element The element to add to the data binding.\n         * @param {Channel} channel (Optional) The channel to subscribe to. Defaults to the [run channel](../channels/run-channel/).\n         * @returns {void}\n         */\n        bindElement: function (element, channel) {\n            if (!channel) {\n                channel = this.options.channel;\n            }\n            // this.unbindElement(element); //unbind actually removes the data,and jquery doesn't refetch when .data() is called..\n            const domEl = getElementOrError(element);\n            const $el = $(domEl);\n            if (!$el.is(`:${config.prefix}`)) {\n                return;\n            }\n\n            //Send to node manager to handle ui changes\n            const Handler = nodeManager.getHandler($el);\n            new Handler.handle({\n                el: domEl\n            });\n\n            const filterPrefix = `data-${config.prefix}-`;\n            const attrList = {};\n            $(domEl.attributes).each(function (index, nodeMap) {\n                let attr = nodeMap.nodeName;\n                if (attr.indexOf(filterPrefix) !== 0) {\n                    return;\n                } \n                attr = attr.replace(filterPrefix, '');\n\n                const attrVal = nodeMap.value;\n                let topics = parseTopicsFromAttributeValue(attrVal);\n                \n                const handler = attrManager.getHandler(attr, $el);\n                if (handler && handler.init) {\n                    handler.init(attr, topics, $el);\n                }\n                if (topics.length && handler && handler.parse) {\n                    topics = [].concat(handler.parse(topics));\n                }\n                \n                const channelPrefix = getChannelForAttribute($el, attr);\n                topics = addPrefixToTopics(topics, channelPrefix);\n\n                const converters = getConvertersForEl($el, attr);\n                attrList[attr] = {\n                    channelPrefix: channelPrefix,\n                    topics: topics,\n                    converters: converters, //Store once instead of calculating on demand. Avoids having to parse through dom every time\n                };\n            });\n            //Need this to be set before subscribing or callback maybe called before it's set\n            this.matchedElements.set(domEl, attrList);\n            \n            const channelConfig = getChannelConfigForElement(domEl);\n            const attrsWithSubscriptions = Object.keys(attrList).reduce((accum, name)=> {\n                const attr = attrList[name];\n                const { topics, channelPrefix } = attr;\n                if (!topics.length) {\n                    accum[name] = attr;\n                    return accum;\n                }\n\n                const subsOptions = $.extend({ \n                    batch: true,\n                    onError: (e)=> {\n                        console.error('DomManager: Subscription error for', domEl, e);\n                        let msg = e.message || e;\n                        if ($.isPlainObject(msg)) {\n                            msg = JSON.stringify(msg);\n                        }\n                        $el.attr(config.errorAttr, msg);\n                    }\n                }, channelConfig);\n                const subscribableTopics = topics.map((t)=> t.name);\n                const subsid = channel.subscribe(subscribableTopics, (data)=> {\n                    const toConvert = {};\n                    if (subscribableTopics.length === 1) { //If I'm only interested in 1 thing pass in value directly, else make a map;\n                        toConvert[name] = data[subscribableTopics[0]];\n                    } else {\n                        const dataForAttr = pick(data, subscribableTopics) || {};\n                        toConvert[name] = Object.keys(dataForAttr).reduce((accum, key)=> {\n                            //If this was through a auto-prefixed channel attr return what was bound\n                            const toReplace = new RegExp(`^${channelPrefix}:`);\n                            const k = channelPrefix ? key.replace(toReplace, '') : key;\n                            accum[k] = dataForAttr[key];\n                            return accum;\n                        }, {});\n                    }\n                    $el.removeAttr(config.errorAttr).trigger(config.events.convert, toConvert);\n                }, subsOptions);\n\n                accum[name] = Object.assign({}, attr, { subscriptionId: subsid });\n                return accum;\n            }, {});\n\n            this.matchedElements.set(domEl, attrsWithSubscriptions);\n        },\n\n        /**\n         * Bind all provided elements.\n         *\n         * @param  {JQuery<HTMLElement> | HTMLElement[]} [elementsToBind] (Optional) If not provided, binds all matching elements within default root provided at initialization.\n         * @returns {void}\n         */\n        bindAll: function (elementsToBind) {\n            if (!elementsToBind) {\n                elementsToBind = getMatchingElements(this.options.root);\n            } else if (!Array.isArray(elementsToBind)) {\n                elementsToBind = getMatchingElements(elementsToBind);\n            }\n\n            //parse through dom and find everything with matching attributes\n            $.each(elementsToBind, (index, element)=> {\n                this.bindElement(element, this.options.channel);\n            });\n        },\n        /**\n         * Unbind provided elements.\n         *\n         * @param  {JQuery<HTMLElement> | HTMLElement[]} [elementsToUnbind] (Optional) If not provided, unbinds everything.\n         * @returns {void}\n         */\n        unbindAll: function (elementsToUnbind) {\n            const me = this;\n            if (!elementsToUnbind) {\n                elementsToUnbind = [];\n                this.matchedElements.forEach((val, key)=> {\n                    elementsToUnbind.push(key);\n                });\n            } else if (!Array.isArray(elementsToUnbind)) {\n                elementsToUnbind = getMatchingElements(elementsToUnbind);\n            }\n            $.each(elementsToUnbind, function (index, element) {\n                me.unbindElement(element, me.options.channel);\n            });\n        },\n\n        plugins: {},\n\n        /**\n         * Initialize the DOM Manager to work with a particular HTML element and all elements within that root. Data bindings between individual HTML elements and the model variables specified in the attributes will happen via the channel.\n         *\n         * @param {Object} options (Optional) Overrides for the default options.\n         * @param {string} options.root The root HTML element being managed by this instance of the DOM Manager. Defaults to `body`.\n         * @param {Object} options.channel The channel to communicate with. Defaults to the Channel Manager from [Epicenter.js](../../../api_adapters/).\n         * @param {boolean} options.autoBind If `true` (default), any variables added to the DOM after `Flow.initialize()` has been called will be automatically parsed, and subscriptions added to channels. Note, this does not work in IE versions < 11.\n         * @returns {Promise}\n         */\n        initialize: function (options) {\n            const defaults = {\n                /**\n                 * Root of the element for flow.js to manage from.\n                 * @type {string} jQuery selector\n                 */\n                root: 'body',\n                channel: null,\n\n                /**\n                 * Any variables added to the DOM after `Flow.initialize()` has been called will be automatically parsed, and subscriptions added to channels. Note, this does not work in IE versions < 11.\n                 * @type {boolean}\n                 */\n                autoBind: true\n            };\n            $.extend(defaults, options);\n\n            const channel = defaults.channel;\n\n            this.options = defaults;\n\n            const me = this;\n            const $root = $(defaults.root);\n\n            function attachUIListeners($root) {\n                function parseValue(value, converters) {\n                    if (Array.isArray(value)) {\n                        const parsed = value.map(function (val) {\n                            return toImplicitType(val);\n                        });\n                        return converterManager.parse(parsed, converters);\n                    }\n                    return converterManager.parse(toImplicitType(value), converters);\n                }\n\n                $root.off(config.events.trigger).on(config.events.trigger, function (evt, params) {\n                    const elMeta = me.matchedElements.get(evt.target);\n                    const { data, source, options } = params;\n                    if (!elMeta || !data) {\n                        return;\n                    }\n                    const sourceMeta = elMeta[source] || {};\n                    const { channelPrefix, converters } = sourceMeta;\n                    const $el = $(evt.target);\n\n                    const parsed = ([].concat(data)).map(function (action) {\n                        const { name, value } = action;\n                        const parsedValue = parseValue(value, converters);\n                        const actualName = name.split('|')[0].trim(); //FIXME: this shouldn't know about the pipe syntax\n                        const prefixedName = addDefaultPrefix(actualName, source, channelPrefix);\n                        return { name: prefixedName, value: parsedValue };\n                    }, []);\n\n                    channel.publish(parsed, options).then((result)=> {\n                        if (!result || !result.length) {\n                            return;\n                        }\n                        const last = result[result.length - 1];\n                        $el.trigger(config.events.convert, { [source]: last.value });\n                    });\n                });\n            }\n\n            function attachConversionListner($root) {\n                // data = {proptoupdate: value}\n                $root.off(config.events.convert).on(config.events.convert, function (evt, data) {\n                    const $el = $(evt.target);\n\n                    const elMeta = me.matchedElements.get(evt.target);\n                    if (!elMeta) {\n                        return;\n                    }\n\n                    Object.keys(data).forEach((prop)=> {\n                        const val = data[prop];\n                        const { converters, topics } = elMeta[prop];\n                        const convertedValue = converterManager.convert(val, converters);\n\n                        const handler = attrManager.getHandler(prop, $el);\n                        handler.handle(convertedValue, prop, $el, topics);\n                    });\n                });\n            }\n            \n            const deferred = $.Deferred();\n            $(function () {\n                me.bindAll();\n            \n                attachUIListeners($root);\n                attachConversionListner($root);\n\n                me.plugins.autoBind = autoUpdatePlugin($root.get(0), me, me.options.autoBind);\n                \n                deferred.resolve($root);\n                $root.trigger('f.domready');\n            });\n\n            return deferred.promise();\n        }\n    };\n\n    return $.extend(this, publicAPI);\n}());\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/dom-manager.js","/**\n * @param {string} conv \n * @returns {string[]}\n */\nfunction convertersToArray(conv) {\n    if (!conv || !conv.trim()) return [];\n    return conv.split('|').map((v)=> v.trim());\n}\n\n/**\n * @param {JQuery<HTMLElement>} $el\n * @param {string} attribute \n * @returns {string[]}\n */\nfunction getConvertersFromAttr($el, attribute) {\n    const attrVal = $el.attr(`data-f-${attribute}`);\n    const withConv = convertersToArray(attrVal);\n    if (withConv.length > 1) {\n        return withConv.slice(1); //First item will be the topic\n    }\n    return [];\n}\nfunction getFConvertAttrVal($el, suffix) {\n    const baseAttr = 'data-f-convert';\n    const suffixAttr = suffix ? `-${suffix}` : '';\n    const conv = $el.attr(`${baseAttr}${suffixAttr}`); //.data shows value cached by jquery\n    return convertersToArray(conv);\n}\n\n/**\n * @param {JQuery<HTMLElement>} $el  \n * @param {string} attribute \n * @returns {string[]} converters\n */\nexport function getConvertersForEl($el, attribute) {\n    function getAllConverters($el, attribute) {\n        const convertersAsPipes = getConvertersFromAttr($el, attribute);\n        if (convertersAsPipes.length) {\n            return convertersAsPipes;\n        }\n\n        const whiteListedGenericAttributes = ['bind', 'foreach', 'repeat'];\n        const canUseFConvert = whiteListedGenericAttributes.indexOf(attribute) !== -1;\n        if (canUseFConvert) {\n            return getFConvertAttrVal($el, '');\n        }\n        return getFConvertAttrVal($el, attribute);\n    }\n   \n    const converters = getAllConverters($el, attribute);\n    const $parentEl = $el.parents('[data-f-convert]').eq(0);\n    const resolvedConverters = converters.reduce((accum, val)=> {\n        if (val === 'inherit') {\n            const parentConv = getConvertersForEl($parentEl, attribute);\n            accum = accum.concat(parentConv);\n        } else {\n            accum = accum.concat(val);\n        }\n        return accum;\n    }, []);\n\n    if (!resolvedConverters.length && $parentEl.length) {\n        return getConvertersForEl($parentEl, attribute);\n    }\n    return resolvedConverters;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/dom-manager-utils/dom-parse-helpers/parse-converters.js","/**\n * \n * @param {JQuery<HTMLElement>} $el  \n * @param {string} attr \n * @returns {string|undefined}\n */\nexport function getChannelForAttribute($el, attr) {\n    attr = attr.replace('data-f-', '');\n    let channel = $el.data('f-channel-' + attr);\n    if (channel === undefined) {\n        channel = $el.attr('data-f-channel'); //.data shows value cached by jquery\n    }\n    if (channel === undefined) {\n        const $parentEl = $el.closest('[data-f-channel]');\n        if ($parentEl) {\n            channel = $parentEl.attr('data-f-channel');\n        }\n    }\n    return channel;\n}\n\n/**\n * @param {HTMLElement} el\n * @return {object}\n */ \nexport function getChannelConfigForElement(el) {\n    //TODO: Should this look at parents too?\n    const attrs = el.attributes;\n    const config = {};\n    for (let i = 0; i < attrs.length; i++) {\n        const attrib = el.attributes[i];\n        if (attrib.specified && attrib.name.indexOf('data-f-channel-') === 0) {\n            const key = attrib.name.replace('data-f-channel-', '');\n            config[key] = attrib.value;\n        }\n    }\n    return config;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/dom-manager-utils/dom-parse-helpers/parse-channel.js","/**\n * @param {string} attrVal \n * @returns {NormalizedTopic[]} variables\n */\nexport function parseTopicsFromAttributeValue(attrVal) {\n    const commaRegex = /,(?![^[(]*[\\])])/; //split except on a[b,c] or a(v,c)\n    const topicsPart = attrVal.split('|')[0];\n    if (topicsPart.indexOf('<%') !== -1) { //Assume it's templated for later use\n        return [];\n    } \n    const split = topicsPart.split(commaRegex);\n    if (split.length > 1) {\n        return split.map((v)=> ({ name: v.trim() }));\n    } \n    return [{ name: topicsPart.trim() }];\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/dom-manager-utils/dom-parse-helpers/parse-topics.js","/**\n * \n * @param {NormalizedTopic[]} topics \n * @param {string} prefix \n * @returns {NormalizedTopic[]}\n */\nexport function addPrefixToTopics(topics, prefix) {\n    if (!prefix) {\n        return topics;\n    }\n    const mappedTopics = topics.map((topic)=> {\n        const currentName = topic.name;\n        const hasChannelDefined = currentName.indexOf(':') !== -1;\n        if (!hasChannelDefined) {\n            topic.name = `${prefix}:${currentName}`;\n        }\n        return topic;\n    });\n    return mappedTopics;\n}\n\nconst DEFAULT_OPERATIONS_PREFIX = 'operations:';\nconst DEFAULT_VARIABLES_PREFIX = 'variables:';\n\nexport function addDefaultPrefix(name, source, channelPrefix) {\n    const isUnprefixed = name.indexOf(':') === -1;\n\n    const defaultPrefix = source.indexOf('on-') === 0 ? DEFAULT_OPERATIONS_PREFIX : DEFAULT_VARIABLES_PREFIX;\n    const needsDefaultPrefix = defaultPrefix !== DEFAULT_VARIABLES_PREFIX;\n\n    if (isUnprefixed && needsDefaultPrefix) {\n        name = `${defaultPrefix}${name}`;\n    }\n    const hasDefaultPrefix = name.indexOf(defaultPrefix) === 0;\n    if ((isUnprefixed || hasDefaultPrefix) && channelPrefix) {\n        name = `${channelPrefix}:${name}`;\n    }\n    return name;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/dom-manager-utils/dom-channel-prefix-helpers/index.js","import { isFunction, isString, isRegExp, find, mapValues } from 'lodash';\nimport { splitNameArgs, toImplicitType } from '../utils/parse-utils';\n\nvar normalize = function (alias, converter, acceptList) {\n    var ret = [];\n    //nomalize('flip', fn)\n    if (isFunction(converter)) {\n        ret.push({\n            alias: alias,\n            convert: converter,\n            acceptList: acceptList\n        });\n    } else if ($.isPlainObject(converter) && converter.convert) {\n        converter.alias = alias;\n        converter.acceptList = acceptList;\n        ret.push(converter);\n    } else if ($.isPlainObject(alias)) {\n        //normalize({alias: 'flip', convert: function})\n        if (alias.convert) {\n            ret.push(alias);\n        } else {\n            // normalize({flip: fun})\n            $.each(alias, function (key, val) {\n                ret.push({\n                    alias: key,\n                    convert: val,\n                    acceptList: acceptList\n                });\n            });\n        }\n    }\n    return ret;\n};\n\nvar matchConverter = function (alias, converter) {\n    if (isString(converter.alias)) {\n        return alias === converter.alias;\n    } else if (isFunction(converter.alias)) {\n        return converter.alias(alias);\n    } else if (isRegExp(converter.alias)) {\n        return converter.alias.match(alias);\n    }\n    return false;\n};\n\nvar converterManager = {\n    private: {\n        matchConverter: matchConverter\n    },\n\n    list: [],\n    /**\n     * Add a new attribute converter to this instance of Flow.js.\n     *\n     * **Example**\n     *\n     *      Flow.dom.converters.register('max', function (value) {\n     *          return max(value);\n     *      }, true);\n     *\n     *      Flow.dom.converters.register({\n     *          alias: 'sig',\n     *          parse: $.noop,\n     *          convert: function (value) {\n     *              return value.firstName + ' ' + value.lastName + ', ' + value.jobTitle;\n     *      }, false);\n     *\n     *      <div>\n     *          The largest sales you had was <span data-f-bind=\"salesByYear | max | $#,###\"></span>.\n     *          The current sales manager is <span data-f-bind=\"salesMgr | sig\"></span>.\n     *      </div>\n     *\n     * @param  {string|function|RegExp} alias Formatter name.\n     * @param  {function|object} [converter] If a function, `converter` is called with the value. If an object, should include fields for `alias` (name), `parse` (function), and `convert` (function).\n     * @param {boolean} [acceptList] Determines if the converter is a 'list' converter or not. List converters take in arrays as inputs, others expect single values.\n     * @returns {void}\n     */\n    register: function (alias, converter, acceptList) {\n        var normalized = normalize(alias, converter, acceptList);\n        this.list = normalized.concat(this.list);\n    },\n\n    /**\n     * Replace an already registered converter with a new one of the same name.\n     *\n     * @param {string} alias Formatter name.\n     * @param {function|object} converter If a function, `converter` is called with the value. If an object, should include fields for `alias` (name), `parse` (function), and `convert` (function).\n     * @returns {void}\n     */\n    replace: function (alias, converter) {\n        var index;\n        this.list.forEach(function (currentConverter, i) {\n            if (matchConverter(alias, currentConverter)) {\n                index = i;\n                return false;\n            }\n        });\n        this.list.splice(index, 1, normalize(alias, converter)[0]);\n    },\n\n    getConverter: function (alias) {\n        var norm = splitNameArgs(alias);\n        norm.args = norm.args.map(toImplicitType);\n\n        var conv = find(this.list, function (converter) {\n            return matchConverter(norm.name, converter);\n        });\n        if (conv && norm.args) {\n            return $.extend({}, conv, { convert: Function.bind.apply(conv.convert, [null].concat(norm.args)) });\n        }\n        return conv;\n    },\n\n    /**\n     * Pipes the value sequentially through a list of provided converters.\n     *\n     * @param  {*} value Input for the converter to tag.\n     * @param  {string|string[]} list List of converters (maps to converter alias).\n     *\n     * @return {*} Converted value.\n     */\n    convert: function (value, list) {\n        if (!list || !list.length) {\n            return value;\n        }\n        list = ([].concat(list)).map((v)=> v.trim());\n\n        var currentValue = value;\n        var me = this;\n\n        var convertArray = function (converter, val, converterName) {\n            return val.map(function (v) {\n                return converter.convert(v, converterName);\n            });\n        };\n        var convert = function (converter, value, converterName) {\n            var converted;\n            if (Array.isArray(value) && converter.acceptList !== true) {\n                converted = convertArray(converter, value, converterName);\n            } else {\n                converted = converter.convert(value, converterName);\n            }\n            return converted;\n        };\n        var convertObject = function (converter, value, converterName) {\n            return mapValues(value, function (val) {\n                return convert(converter, val, converterName);\n            });\n        };\n        list.forEach(function (converterName) {\n            var converter = me.getConverter(converterName);\n            if (!converter) {\n                throw new Error('Could not find converter for ' + converterName);\n            }\n            if ($.isPlainObject(currentValue) && converter.acceptList !== true) {\n                currentValue = convertObject(converter, currentValue, converterName);\n            } else {\n                currentValue = convert(converter, currentValue, converterName);\n            }\n        });\n        return currentValue;\n    },\n\n    /**\n     * Counter-part to `convert()`. Translates converted values back to their original form.\n     *\n     * @param  {*} value Value to parse.\n     * @param  {string|string[]} list  List of parsers to run the value through. Outermost is invoked first.\n     * @return {*} Original value.\n     */\n    parse: function (value, list) {\n        if (!list || !list.length) {\n            return value;\n        }\n        list = [].concat(list).reverse().map((v)=> v.trim());\n\n        var currentValue = value;\n        var me = this;\n        list.forEach(function (converterName) {\n            var converter = me.getConverter(converterName);\n            if (!converter) {\n                throw new Error('parse: Could not find converter ' + converterName);\n            }\n            if (converter.parse) {\n                currentValue = converter.parse(currentValue, converterName);\n            }\n        });\n        return currentValue;\n    }\n};\n\n\n//Bootstrap\nvar defaultconverters = [\n    require('./number-converter'),\n    require('./string-converter'),\n    require('./array-converter'),\n    require('./general-util-converters'),\n    require('./numberformat-converter'),\n    require('./number-compare-converters'),\n    require('./bool-conditional-converters'),\n    require('./collection-converters')\n];\n\ndefaultconverters.reverse().forEach(function (converter) {\n    if (Array.isArray(converter)) {\n        converter.forEach(function (c) {\n            converterManager.register(c);\n        });\n    } else {\n        converterManager.register(converter);\n    }\n});\n\nexport default converterManager;\n\n\n\n// WEBPACK FOOTER //\n// ./src/converters/converter-manager.js","/**\n * ## Number Converters\n *\n * Converters allow you to change how data is displayed. They let you display the value of any model variable in a different format than it is stored in the model -- converting the output value from one format to another.\n *\n * There are two ways to specify conversion or formatting for the display output of a particular model variable:\n *\n * * Use the `|` (pipe) character within the value of any `data-f-` attribute. Converters are chainable, so you can apply several in a row to a particular variable.\n * * Add the attribute `data-f-convert` to any element to convert all of the model variables referenced within that element's scope.\n *\n */\n\n'use strict';\nmodule.exports = {\n    alias: 'i',\n    /**\n     * Convert the model variable to an integer. Often used for chaining to another converter.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          Your car has driven\n     *          <span data-f-bind=\"Odometer | i | s0.0\"></span> miles.\n     *      </div>\n     *\n     * @param {string} value The model variable.\n     * @return {number}\n     */\n    convert: function (value) {\n        return parseFloat(value);\n    }\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/converters/number-converter.js","/**\n * ## String Converters\n *\n * Converters allow you to change how data is displayed. They let you display the value of any model variable in a different format than it is stored in the model -- converting the output value from one format to another.\n *\n * There are two ways to specify conversion or formatting for the display output of a particular model variable:\n *\n * * Use the `|` (pipe) character within the value of any `data-f-` attribute. Converters are chainable, so you can apply several in a row to a particular variable.\n * * Add the attribute `data-f-convert` to any element to convert all of the model variables referenced within that element's scope.\n *\n * For model variables that are strings (or that have been converted to strings), there are several special string formats you can apply.\n */\n\n'use strict';\nmodule.exports = {\n\n    /**\n     * Convert the model variable to a string. Often used for chaining to another converter.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          This year you are in charge of sales for\n     *          <span data-f-bind=\"salesMgr.region | s | upperCase\"></span>.\n     *      </div>\n     *\n     * @param {Array} val The model variable.\n     * @returns {string} converted string\n     */\n    s: function (val) {\n        return val + '';\n    },\n\n    /**\n     * Convert the model variable to UPPER CASE.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          This year you are in charge of sales for\n     *          <span data-f-bind=\"salesMgr.region | s | upperCase\"></span>.\n     *      </div>\n     *\n     * @param {Array} val The model variable.\n     * @returns {string} converted string\n     */\n    upperCase: function (val) {\n        return (val + '').toUpperCase();\n    },\n\n    /**\n     * Convert the model variable to lower case.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          Enter your user name:\n     *          <input data-f-bind=\"userName | lowerCase\"></input>.\n     *      </div>\n     *\n     * @param {Array} val The model variable.\n     * @returns {string} converted string\n     */\n    lowerCase: function (val) {\n        return (val + '').toLowerCase();\n    },\n\n    /**\n     * Convert the model variable to Title Case.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          Congratulations on your promotion!\n     *          Your new title is: <span data-f-bind=\"currentRole | titleCase\"></span>.\n     *      </div>\n     *\n     * @param {string} val The model variable.\n     * @returns {string} converted string\n     */\n    titleCase: function (val) {\n        val = val + '';\n        return val.replace(/\\w\\S*/g, function (txt) {\n            return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();\n        });\n    },\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/converters/string-converter.js","/**\n * ## Array Converters\n *\n * Converters allow you to change how data is displayed. They let you display the value of any model variable in a different format than it is stored in the model -- converting the output value from one format to another.\n *\n * There are two ways to specify conversion or formatting for the display output of a particular model variable:\n *\n * * Use the `|` (pipe) character within the value of any `data-f-` attribute. Converters are chainable, so you can apply several in a row to a particular variable.\n * * Add the attribute `data-f-convert` to any element to convert all of the model variables referenced within that element's scope.\n *\n * In general, if the model variable is an array, the converter is applied to each element of the array. There are a few built in array converters which, rather than converting all elements of an array, select particular elements from within the array or otherwise treat array variables specially.\n *\n */\n\nconst _ = require('lodash');\n\nfunction parseLimitArgs(starting, limit, val) {\n    let toRet = {};\n    if (arguments.length === 3) { //eslint-disable-line\n        toRet = {\n            input: limit,\n            limit: starting\n        };\n    } else if (arguments.length === 2) {\n        toRet = {\n            input: starting\n        };\n    } else {\n        console.error('Too many arguments passed to last', arguments);\n        throw new Error('Too many arguments passed to last');\n    }\n\n    toRet.input = [].concat(toRet.input);\n    return toRet;\n}\n\nconst list = {\n    /**\n     * Convert the input into an array. \n     *\n     * @param {any[]} val The array model variable.\n     * @returns {any[]}\n     */\n    list: (val)=> [].concat(val),\n\n    /**\n     * Reverse the array.\n     *\n     * **Example**\n     *\n     *      <p>Show the history of our sales, starting with the last (most recent):</p>\n     *      <ul data-f-foreach=\"Sales | reverse\">\n     *          <li></li>\n     *      </ul>\n     *\n     * @param {any[]} val The array model variable.\n     * @returns {any[]} the reversed array\n     */\n    reverse: (val)=> ([].concat(val)).reverse(),\n\n    /**\n     * Select only the last element of the array.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          In the current year, we have <span data-f-bind=\"Sales | last\"></span> in sales.\n     *      </div>\n     *\n     * @param {number} n number of items to get\n     * @param {any[]} val The array model variable.\n     * @returns {any} last element of array\n     */\n    last: function (n, val) {\n        const parsed = parseLimitArgs.apply(null, arguments);\n        const stripped = parsed.input.slice(-(parsed.limit || 1));\n        if (stripped.length <= 1) {\n            return stripped[0];\n        }\n        return stripped;\n    },\n\n    /**\n     * Select only the first element of the array.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          Our initial investment was <span data-f-bind=\"Capital | first\"></span>.\n     *      </div>\n     *\n     * @param {number} n number of items to get\n     * @param {any[]} val The array model variable.\n     * @returns {any} first element of the array\n     */\n    first: function (n, val) {\n        const parsed = parseLimitArgs.apply(null, arguments);\n        const stripped = parsed.input.slice(0, (parsed.limit || 1));\n        if (stripped.length <= 1) {\n            return stripped[0];\n        }\n        return stripped;\n    },\n\n    /**\n     * Select only the previous (second to last) element of the array.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          Last year we had <span data-f-bind=\"Sales | previous\"></span> in sales.\n     *      </div>\n     *\n     * @param {any[]} val The array model variable.\n     * @returns {any} the previous (second to last) element of the array.\n     */\n    previous: (val)=> {\n        val = [].concat(val);\n        return (val.length <= 1) ? val[0] : val[val.length - 2];\n    },\n\n    /**\n     * Returns length of array\n     *\n     * **Example**\n     * Total Items: <h6 data-f-bind=\"items | size\"></h6>\n     * \n     * @param  {any[]} src array\n     * @return {number}     length of array\n     */\n    size: (src)=> [].concat(src).length,\n\n    /**\n     * Select every nth item from array\n     *\n     * **Example**\n     * <!-- select every 10th item starting from itself\n     * <ul data-f-foreach=\"Time | pickEvery(10)\"><li></li></ul>\n     * <!-- select every 10th item starting from the fifth\n     * <ul data-f-foreach=\"Time | pickEvery(10, 5)\"><li></li></ul>\n     * \n     * @param  {number} n          nth item to select\n     * @param  {number} [startIndex] index to start from\n     * @param  {any[]} [val]        source array\n     * @return {any[]}            shortened array\n     */\n    pickEvery: function (n, startIndex, val) {\n        if (arguments.length === 3) { //eslint-disable-line\n            //last item is match string\n            val = startIndex;\n            startIndex = n - 1;\n        }\n        val = [].concat(val);\n        val = val.slice(startIndex);\n        return val.filter((item, index)=> {\n            return (index % n) === 0;\n        });\n    },\n};\n\nconst mapped = Object.keys(list).map(function (alias) {\n    const fn = list[alias];\n    const newfn = function () {\n        const args = _.toArray(arguments);\n        const indexOfActualValue = args.length - 2; //last item is the matchstring\n        const val = args[indexOfActualValue];\n        if ($.isPlainObject(val)) {\n            return Object.keys(val).reduce((accum, key)=> {\n                const arr = val[key];\n                const newArgs = args.slice();\n                newArgs[indexOfActualValue] = arr;\n                accum[key] = fn.apply(fn, newArgs);\n                return accum;\n            }, {});\n        }\n        return fn.apply(fn, arguments);\n    };\n    return {\n        alias: alias,\n        acceptList: true,\n        convert: newfn,\n    };\n});\nmodule.exports = mapped;\n\n\n\n// WEBPACK FOOTER //\n// ./src/converters/array-converter.js","function parseArgs(toCompare, trueVal, falseVal, valueToCompare, matchString) {\n    const toReturn = { trueVal: true, falseVal: false };\n    switch (arguments.length) {\n        case 5: //eslint-disable-line\n            return $.extend(toReturn, { trueVal: trueVal, falseVal: falseVal, input: valueToCompare });\n        case 4: //eslint-disable-line\n            return $.extend(toReturn, { trueVal: trueVal, falseVal: falseVal, input: falseVal }); \n        case 3: //eslint-disable-line\n            return $.extend(toReturn, { input: trueVal, falseVal: trueVal }); \n        default:\n            return toReturn;\n    }\n}\n\nmodule.exports = [\n    {\n        alias: 'is',\n        acceptList: false,\n        convert: function (toCompare) {\n            const args = parseArgs.apply(null, arguments);\n            return args.input === toCompare ? args.trueVal : args.falseVal;\n        }\n    }\n];\n\n\n\n// WEBPACK FOOTER //\n// ./src/converters/general-util-converters.js","/**\n * ## Number Format Converters\n *\n * Converters allow you to change how data is displayed. They let you display the value of any model variable in a different format than it is stored in the model -- converting the output value from one format to another.\n *\n * There are two ways to specify conversion or formatting for the display output of a particular model variable:\n *\n * * Use the `|` (pipe) character within the value of any `data-f-` attribute. Converters are chainable, so you can apply several in a row to a particular variable.\n * * Add the attribute `data-f-convert` to any element to convert all of the model variables referenced within that element's scope.\n *\n * For model variables that are numbers (or that have been [converted to numbers](../number-converter/)), there are several special number formats you can apply.\n *\n * #### Currency Number Format\n *\n * After the `|` (pipe) character, use `$` (dollar sign), `0`, and `.` (decimal point) in your converter to describe how currency should appear. The specifications follow the Excel currency formatting conventions.\n *\n * **Example**\n *\n *      <!-- convert to dollars (include cents) -->\n *      <input type=\"text\" data-f-bind=\"price[car]\" data-f-convert=\"$0.00\" />\n *      <input type=\"text\" data-f-bind=\"price[car] | $0.00\" />\n *\n *      <!-- convert to dollars (truncate cents) -->\n *      <input type=\"text\" data-f-bind=\"price[car]\" data-f-convert=\"$0.\" />\n *      <input type=\"text\" data-f-bind=\"price[car] | $0.\" />\n *\n *\n * #### Specific Digits Number Format\n *\n * After the `|` (pipe) character, use `#` (pound) and `,` (comma) in your converter to describe how the number should appear. The specifications follow the Excel number formatting conventions.\n *\n * **Example**\n *\n *      <!-- convert to thousands -->\n *      <input type=\"text\" data-f-bind=\"sales[car]\" data-f-convert=\"#,###\" />\n *      <input type=\"text\" data-f-bind=\"sales[car] | #,###\" />\n *\n *\n * #### Percentage Number Format\n *\n * After the `|` (pipe) character, use `%` (percent) and `0` in your converter to display the number as a percent.\n *\n * **Example**\n *\n *      <!-- convert to percentage -->\n *      <input type=\"text\" data-f-bind=\"profitMargin[car]\" data-f-convert=\"0%\" />\n *      <input type=\"text\" data-f-bind=\"profitMargin[car] | 0%\" />\n *\n *\n * #### Short Number Format\n *\n * After the `|` (pipe) character, use `s` and `0` in your converter to describe how the number should appear.\n *\n * The `0`s describe the significant digits.\n *\n * The `s` describes the \"short format,\" which uses 'K' for thousands, 'M' for millions, 'B' for billions. For example, `2468` converted with `s0.0` displays as `2.5K`.\n *\n * **Example**\n *\n *      <!-- convert to thousands (show 12,468 as 12.5K) -->\n *      <span type=\"text\" data-f-bind=\"price[car] | s0.0\"></span>\n *\n */\n\nconst { isString, isNumber } = require('lodash');\n\nfunction isAllowedLeading(str) { \n    const validPrefixes = ['₹', '$', '£', '¥', '±', '’', '¢', '€'];\n    return validPrefixes.indexOf(str.trim()) !== -1;\n}\n\nmodule.exports = {\n    /**\n     * @param {string} name\n     * @returns {boolean}\n     */\n    alias: function (name) {\n        /**\n         * @param {string} v\n         * @returns {boolean}\n         */\n        function checkValMatch(v) {\n            const validStandalone = ['#', '0', '%'];\n            if (v.length === 1) {\n                return validStandalone.indexOf(v) !== -1;\n            }\n\n            const validFirstChars = ['s', '#', '0', '.'];\n            const validLastChars = ['%', '#', '0'];\n\n            if (isAllowedLeading(v.charAt(0))) {\n                v = v.slice(1);\n            }\n            const isValidFirstChar = validFirstChars.indexOf(v.charAt(0)) !== -1;\n            const isValidLastChar = validLastChars.indexOf(v.charAt(v.length - 1)) !== -1;\n\n            if (v.length === 2) {\n                return isValidFirstChar && isValidLastChar;\n            }\n            \n            const validRemainingChars = ['#', '0', '.', ','];\n            const areRemainingCharactersValid = v.substr(1, v.length - 2).split('').reduce((accum, char)=> {\n                const isMatch = validRemainingChars.indexOf(char) !== -1;\n                if (!isMatch) {\n                    accum = false;\n                }\n                return accum;\n            }, true);\n\n            return isValidFirstChar && isValidLastChar && areRemainingCharactersValid;\n        }\n\n        const parts = name.split(' ');\n        if (parts.length === 3) {\n            return checkValMatch(parts[1]); //prefix and suffix\n        } else if (parts.length === 1) {\n            return checkValMatch(parts[0]); //just the number\n        } else if (parts.length === 2) {\n            return checkValMatch(parts[0]) || checkValMatch(parts[1]); //either prefix or suffix\n        }\n        return false;\n    },\n\n    /**\n     * @param {string} val\n     * @returns {number}\n     */\n    parse: function (val) {\n        val += '';\n        var isNegative = val.charAt(0) === '-';\n\n        val = val.replace(/,/g, '');\n        var floatMatcher = /([-+]?[0-9]*\\.?[0-9]+)(K?M?B?%?)/i;\n        var results = floatMatcher.exec(val);\n        var number;\n        var suffix = '';\n        if (results && results[1]) {\n            number = results[1];\n        }\n        if (results && results[2]) {\n            suffix = results[2].toLowerCase();\n        }\n\n        /*eslint no-magic-numbers: 0 complexity: 0 */\n        switch (suffix) {\n            case '%':\n                number = number / 100;\n                break;\n            case 'k':\n                number = number * 1000;\n                break;\n            case 'm':\n                number = number * 1000000;\n                break;\n            case 'b':\n                number = number * 1000000000;\n                break;\n            default:\n        }\n        number = parseFloat(number);\n        if (isNegative && number > 0) {\n            number = number * -1;\n        }\n        return number;\n    },\n\n    convert: (function (value) {\n        var scales = ['', 'K', 'M', 'B', 'T'];\n        function roundTo(value, digits) {\n            return Math.round(value * Math.pow(10, digits)) / Math.pow(10, digits);\n        }\n\n        function getDigits(value, digits) {\n            value = value === 0 ? 0 : roundTo(value, Math.max(0, digits - Math.ceil(Math.log(value) / Math.LN10)));\n\n            var TXT = '';\n            var numberTXT = value.toString();\n            var decimalSet = false;\n\n            for (var iTXT = 0; iTXT < numberTXT.length; iTXT++) {\n                TXT += numberTXT.charAt(iTXT);\n                if (numberTXT.charAt(iTXT) === '.') {\n                    decimalSet = true;\n                } else {\n                    digits--;\n                }\n\n                if (digits <= 0) {\n                    return TXT;\n                }\n            }\n\n            if (!decimalSet) {\n                TXT += '.';\n            }\n            while (digits > 0) {\n                TXT += '0';\n                digits--;\n            }\n            return TXT;\n        }\n\n        function addDecimals(value, decimals, minDecimals, hasCommas) {\n            hasCommas = !!hasCommas;\n            var numberTXT = value.toString();\n            var hasDecimals = (numberTXT.split('.').length > 1);\n            var iDec = 0;\n\n            if (hasCommas) {\n                for (var iChar = numberTXT.length - 1; iChar > 0; iChar--) {\n                    if (hasDecimals) {\n                        hasDecimals = (numberTXT.charAt(iChar) !== '.');\n                    } else {\n                        iDec = (iDec + 1) % 3;\n                        if (iDec === 0) {\n                            numberTXT = numberTXT.substr(0, iChar) + ',' + numberTXT.substr(iChar);\n                        }\n                    }\n                }\n\n            }\n            if (decimals > 0) {\n                var toADD;\n                if (numberTXT.split('.').length <= 1) {\n                    toADD = minDecimals;\n                    if (toADD > 0) {\n                        numberTXT += '.';\n                    }\n                } else {\n                    toADD = minDecimals - numberTXT.split('.')[1].length;\n                }\n\n                while (toADD > 0) {\n                    numberTXT += '0';\n                    toADD--;\n                }\n            }\n            return numberTXT;\n        }\n\n        function getSuffix(formatTXT) {\n            formatTXT = formatTXT.replace('.', '');\n            var fixesTXT = formatTXT.split(new RegExp('[0|,|#]+', 'g'));\n            return (fixesTXT.length > 1) ? fixesTXT[1].toString() : '';\n        }\n\n        function format (number, formatTXT) { // eslint-disable-line\n            if (Array.isArray(number)) {\n                number = number[number.length - 1];\n            }\n            if (!isString(number) && !isNumber(number)) {\n                return number;\n            }\n\n            if (!formatTXT || formatTXT.toLowerCase() === 'default') {\n                return number.toString();\n            }\n\n            if (isNaN(number)) {\n                return '?';\n            }\n\n            //var formatTXT;\n            const entityCodeMapping = {\n                '&euro;': '€',\n                '&dollar;': '$',\n                '&cent;': '¢',\n                '&pound;': '£',\n                '&yen;': '¥',\n            };\n            Object.keys(entityCodeMapping).forEach((code)=> {\n                formatTXT = formatTXT.replace(code, entityCodeMapping[code]);\n            });\n\n            // Divide +/- Number Format\n            var formats = formatTXT.split(';');\n            if (formats.length > 1) {\n                return format(Math.abs(number), formats[((number >= 0) ? 0 : 1)]);\n            }\n\n            // Save Sign\n            var sign = (number >= 0) ? '' : '-';\n            number = Math.abs(number);\n\n\n            var leftOfDecimal = formatTXT;\n            var d = leftOfDecimal.indexOf('.');\n            if (d > -1) {\n                leftOfDecimal = leftOfDecimal.substring(0, d);\n            }\n\n            var normalized = leftOfDecimal.toLowerCase();\n            var index = normalized.lastIndexOf('s');\n            var isShortFormat = index > -1;\n\n            if (isShortFormat) {\n                var nextChar = leftOfDecimal.charAt(index + 1);\n                if (nextChar === ' ') {\n                    isShortFormat = false;\n                }\n            }\n\n            var leadingText = isShortFormat ? formatTXT.substring(0, index) : '';\n            var rightOfPrefix = isShortFormat ? formatTXT.substr(index + 1) : formatTXT.substr(index);\n\n            //first check to make sure 's' is actually short format and not part of some leading text\n            if (isShortFormat) {\n                var shortFormatTest = /[0-9#*]/;\n                var shortFormatTestResult = rightOfPrefix.match(shortFormatTest);\n                if (!shortFormatTestResult || shortFormatTestResult.length === 0) {\n                    //no short format characters so this must be leading text ie. 'weeks '\n                    isShortFormat = false;\n                    leadingText = '';\n                }\n            }\n\n            //if (formatTXT.charAt(0) == 's')\n            if (isShortFormat) {\n                var valScale = number === 0 ? 0 : Math.floor(Math.log(Math.abs(number)) / (3 * Math.LN10));\n                valScale = ((number / Math.pow(10, 3 * valScale)) < 1000) ? valScale : (valScale + 1);\n                valScale = Math.max(valScale, 0);\n                valScale = Math.min(valScale, 4);\n                number = number / Math.pow(10, 3 * valScale);\n                //if (!isNaN(Number(formatTXT.substr(1) ) ) )\n\n                if (!isNaN(Number(rightOfPrefix)) && rightOfPrefix.indexOf('.') === -1) {\n                    var limitDigits = Number(rightOfPrefix);\n                    if (number < Math.pow(10, limitDigits)) {\n                        if (isAllowedLeading(leadingText)) {\n                            return sign + leadingText + getDigits(number, Number(rightOfPrefix)) + scales[valScale];\n                        } else {\n                            return leadingText + sign + getDigits(number, Number(rightOfPrefix)) + scales[valScale];\n                        }\n                    } else if (isAllowedLeading(leadingText)) {\n                        return sign + leadingText + Math.round(number) + scales[valScale];\n                    } else {\n                        return leadingText + sign + Math.round(number) + scales[valScale];\n                    }\n                } else {\n                    //formatTXT = formatTXT.substr(1);\n                    formatTXT = formatTXT.substr(index + 1);\n                    var SUFFIX = getSuffix(formatTXT);\n                    formatTXT = formatTXT.substr(0, formatTXT.length - SUFFIX.length);\n\n                    var valWithoutLeading = format(((sign === '') ? 1 : -1) * number, formatTXT) + scales[valScale] + SUFFIX;\n                    if (isAllowedLeading(leadingText) && sign !== '') {\n                        valWithoutLeading = valWithoutLeading.substr(sign.length);\n                        return sign + leadingText + valWithoutLeading;\n                    }\n\n                    return leadingText + valWithoutLeading;\n                }\n            }\n\n            var subFormats = formatTXT.split('.');\n            var decimals;\n            var minDecimals;\n            if (subFormats.length > 1) {\n                decimals = subFormats[1].length - subFormats[1].replace(new RegExp('[0|#]+', 'g'), '').length;\n                minDecimals = subFormats[1].length - subFormats[1].replace(new RegExp('0+', 'g'), '').length;\n                formatTXT = subFormats[0] + subFormats[1].replace(new RegExp('[0|#]+', 'g'), '');\n            } else {\n                decimals = 0;\n            }\n\n            var fixesTXT = formatTXT.split(new RegExp('[0|,|#]+', 'g'));\n            var preffix = fixesTXT[0].toString();\n            var suffix = (fixesTXT.length > 1) ? fixesTXT[1].toString() : '';\n\n            number = number * ((formatTXT.split('%').length > 1) ? 100 : 1);\n            //            if (formatTXT.indexOf('%') !== -1) number = number * 100;\n            number = roundTo(number, decimals);\n\n            sign = (number === 0) ? '' : sign;\n\n            var hasCommas = (formatTXT.substr(formatTXT.length - 4 - suffix.length, 1) === ',');\n            var formatted = sign + preffix + addDecimals(number, decimals, minDecimals, hasCommas) + suffix;\n\n            //  console.log(originalNumber, originalFormat, formatted)\n            return formatted;\n        }\n\n        return format;\n    }())\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/converters/numberformat-converter.js","/**\n * ## Number Comparison Converters\n *\n * Converters allow you to change how data is displayed. They let you display the value of any model variable in a different format than it is stored in the model -- converting the output value from one format to another.\n *\n * For a number comparison converter, the original format is your model variable, and the resulting \"format\" is a (possibly unrelated) value of your choosing. This resulting value is selected based on how the value of the model variable compares to a reference value that you pass to the converter.\n *\n * There are two ways to specify conversion or formatting for the display output of a particular model variable:\n *\n * * Use the `|` (pipe) character within the value of any `data-f-` attribute. Converters are chainable, so you can apply several in a row to a particular variable.\n * * Add the attribute `data-f-convert` to any element to convert all of the model variables referenced within that element's scope.\n *\n * For example:\n *\n *      <!-- displays \"true\" or the number of widgets -->\n *      <span data-f-bind=\"widgets | greaterThan(50)\"></span>\n *\n *      <!-- displays the first string if true, the second if false -->\n *      <span data-f-bind=\"widgets | greaterThan(50, 'nice job!', 'not enough widgets')\"></span>\n *\n * You can also chain multiple converters to simulate evaluating multiple if\\else conditions; for e.g. the following logic\n *\n *      if (temperature > 80) {\n *          return 'hot';\n *      } else if (temperature > 60) {\n *          return 'pleasant';\n *      } else if (temperature >= 30) {\n *          return 'cold';\n *      } else {\n *          return 'freezing!';\n *      }\n *\n * can be represented as\n *\n *      <h4 data-f-bind=\"temperature | greaterThan(80, hot) | greaterThan(60, pleasant) | greaterThanEqual(30, cold, freezing!)\"></h4>\n */\n\n'use strict';\n\nfunction parseArgs(limit, trueVal, falseVal, valueToCompare, matchString) {\n    var toReturn = { trueVal: true, falseVal: false };\n    switch (arguments.length) {\n        case 5: //eslint-disable-line\n            return $.extend(toReturn, { trueVal: trueVal, falseVal: falseVal, input: valueToCompare });\n        case 4: //eslint-disable-line\n            return $.extend(toReturn, { trueVal: trueVal, falseVal: falseVal, input: falseVal }); \n        case 3: //eslint-disable-line\n            return $.extend(toReturn, { input: trueVal, falseVal: trueVal }); \n        default:\n            return toReturn;\n    }\n}\nmodule.exports = {\n    /**\n     * Convert the model variable to true, or other values passed to the converter, based on whether the model variable is greater than the limit.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          <!-- displays true or the number of widgets -->\n     *          <span data-f-bind=\"widgets | greaterThan(50)\"></span> \n     *\n     *          <!-- displays custom text -->\n     *          <span data-f-bind=\"widgets | greaterThan(50, 'Congratulations!', 'Better luck next year')\"></span>\n     *      </div>\n     *\n     * @param {Number} limit The reference value to compare the model variable against.\n     * @param {String} trueVal (Optional) The format (value) to display if the model variable is greater than `limit`. If not included, the display is `true`. If there are commas in this argument, they must be escaped with `\\`.\n     * @param {String} falseVal (Optional) The format (value) to display if the model variable is less than or equal to `limit`. If not included, the display is the value of the model variable. If there are commas in this argument, they must be escaped with `\\`.\n     * @return {Any} If the model variable is greater than `limit`, returns trueVal or `true`. Otherwise returns falseVal if provided, or echoes the input.\n     */\n    greaterThan: function (limit) {\n        var args = parseArgs.apply(null, arguments);\n        return Number(args.input) > Number(limit) ? args.trueVal : args.falseVal;\n    },\n\n    /**\n     * Convert the model variable to true, or other values passed to the converter, based on whether the model variable is greater than or equal to the limit.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          <!-- displays true or the number of widgets -->\n     *          <span data-f-bind=\"widgets | greaterThan(50)\"></span> \n     *\n     *          <!-- displays custom text -->\n     *          <span data-f-bind=\"widgets | greaterThan(50, 'Congratulations!', 'Better luck next year')\"></span>\n     *      </div>\n     *\n     * @param {Number} limit The reference value to compare the model variable against.\n     * @param {String} trueVal (Optional) The format (value) to display if the model variable is greater than or equal to `limit`. If not included, the display is `true`. If there are commas in this argument, they must be escaped with `\\`.\n     * @param {String} falseVal (Optional) The format (value) to display if the model variable is less than `limit`. If not included, the display is the value of the model variable. If there are commas in this argument, they must be escaped with `\\`.\n     * @return {Any} If the model variable is greater than or equal to `limit`, returns trueVal or `true`. Otherwise returns falseVal if provided, or echoes the input.\n     */    \n    greaterThanEqual: function (limit) {\n        var args = parseArgs.apply(null, arguments);\n        return Number(args.input) >= Number(limit) ? args.trueVal : args.falseVal;\n    },\n\n    /**\n     * Convert the model variable to true, or other values passed to the converter, based on whether the model variable is equal to the limit.\n     *\n     * \n     * **Example**\n     *\n     *      <div>\n     *          <!-- displays true or the number of widgets -->\n     *          <span data-f-bind=\"widgets | equalsNumber(50)\"></span> \n     *\n     *          <!-- display custom text -->\n     *          <span data-f-bind=\"widgets | equalsNumber(50, 'Met the goal exactly!', 'Not an exact match')\"></span>\n     *      </div>\n     *\n     * @param {Number} limit The reference value to compare the model variable against.\n     * @param {String} trueVal (Optional) The format (value) to display if the model variable is equal to `limit`. If not included, the display is `true`. If there are commas in this argument, they must be escaped with `\\`.\n     * @param {String} falseVal (Optional) The format (value) to display if the model variable is not equal to `limit`. If not included, the display is the value of the model variable. If there are commas in this argument, they must be escaped with `\\`.\n     * @return {Any} If the model variable equals `limit`, returns trueVal or `true`. Otherwise returns falseVal if provided, or echoes the input.\n     */\n    equalsNumber: function (limit) {\n        var args = parseArgs.apply(null, arguments);\n        return Number(args.input) === Number(limit) ? args.trueVal : args.falseVal;\n    },\n\n    /**\n     * Convert the model variable to true, or other values passed to the converter, based on whether the model variable is less than the limit.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          <!-- displays true or the number of widgets -->\n     *          <span data-f-bind=\"widgets | lessThan(50)\"></span> \n     *\n     *          <!-- display custom text -->\n     *          <span data-f-bind=\"widgets | lessThan(50, 'Oops didn't make quite enough!', 'Built a lot of widgets this year!')\"></span>\n     *      </div>\n     *\n     * @param {Number} limit The reference value to compare the model variable against.\n     * @param {String} trueVal (Optional) The format (value) to display if the model variable is less than `limit`. If not included, the display is `true`. If there are commas in this argument, they must be escaped with `\\`.\n     * @param {String} falseVal (Optional) The format (value) to display if the model variable is less than `limit`. If not included, the display is the value of the model variable. If there are commas in this argument, they must be escaped with `\\`.\n     * @return {Any} If the model variable is less than `limit`, returns trueVal or `true`. Otherwise returns falseVal if provided, or echoes the input.\n     */ \n    lessThan: function (limit) {\n        var args = parseArgs.apply(null, arguments);\n        return Number(args.input) < Number(limit) ? args.trueVal : args.falseVal;\n    },\n\n    /**\n     * Convert the model variable to true, or other values passed to the converter, based on whether the model variable is less than or equal to the limit.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          <!-- displays true or the number of widgets -->\n     *          <span data-f-bind=\"widgets | lessThanEqual(50)\"></span> \n     *\n     *          <!-- display custom text -->\n     *          <span data-f-bind=\"widgets | lessThanEqual(50, 'Oops didn't make quite enough!', 'Built a lot of widgets this year!')\"></span>\n     *      </div>\n     *\n     * @param {Number} limit The reference value to compare the model variable against.\n     * @param {String} trueVal (Optional) The format (value) to display if the model variable is less than or equal to `limit`. If not included, the display is `true`. If there are commas in this argument, they must be escaped with `\\`.\n     * @param {String} falseVal (Optional) The format (value) to display if the model variable is less than or equal to `limit`. If not included, the display is the value of the model variable. If there are commas in this argument, they must be escaped with `\\`.\n     * @return {Any} If the model variable is less than or equal to `limit`, returns trueVal or `true`. Otherwise returns falseVal if provided, or echoes the input.\n     */\n    lessThanEqual: function (limit) {\n        var args = parseArgs.apply(null, arguments);\n        return Number(args.input) <= Number(limit) ? args.trueVal : args.falseVal;\n    }\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/converters/number-compare-converters.js","/**\n * ## Boolean Conditional Converters\n *\n * Converters allow you to change how data is displayed. They let you display the value of any model variable in a different format than it is stored in the model -- converting the output value from one format to another.\n *\n * For a boolean conditional converter, the original format is your model variable, and the resulting \"format\" is a boolean value, or another value of your choosing.\n *\n * There are two ways to specify conversion or formatting for the display output of a particular model variable:\n *\n * * Use the `|` (pipe) character within the value of any `data-f-` attribute. Converters are chainable, so you can apply several in a row to a particular variable.\n * * Add the attribute `data-f-convert` to any element to convert all of the model variables referenced within that element's scope.\n *\n * For example:\n *\n *      <!-- displays \"true\" or \"false\" -->\n *      <!-- in particular, true if sampleVar is truthy (1, true, 'some string', [] etc.), \n *            false if sampleVar is falsy (0, false, '') -->\n *      <span data-f-bind=\"sampleVar | toBool\"></span>\n *\n */\n\nfunction parseArgs(trueVal, falseVal, input, matchString) {\n    var toReturn = { trueVal: true, falseVal: false };\n    switch (arguments.length) {\n        case 4: //eslint-disable-line\n            return $.extend(toReturn, { trueVal: trueVal, falseVal: falseVal, input: input });\n        case 3: //eslint-disable-line\n            return $.extend(toReturn, { trueVal: trueVal, falseVal: falseVal, input: falseVal }); \n        default:\n            return toReturn;\n    }\n}\n\nmodule.exports = {\n    /**\n     * Convert 'truthy' values to true and 'falsy' values to false.\n     *\n     * **Example**\n     *\n     *      <!-- displays \"true\" or \"false\" -->\n     *      <!-- in particular, true if sampleVar is truthy (1, true, 'some string', [] etc.), \n     *            false if sampleVar is falsy (0, false, '') -->\n     *      <span data-f-bind=\"sampleVar | toBool\"></span>\n     * \n     * @param {Any} value\n     * @return {Boolean}\n     */\n    toBool: (value)=> !!value,\n\n    /**\n     * Converts values to boolean and negates.\n     *\n     * **Example**\n     *\n     *      <!-- disables input if isGameInProgress is false -->\n     *      <input type=\"text\" data-f-disabled=\"isGameInProgress | not\" />\n     * \n     * @param {Any} value\n     * @return {Boolean}\n     */\n    not: (value)=> !value,\n\n    /**\n     * Convert the input to a new value (for example, some text), based on whether it is true or false.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          <span data-f-bind=\"sampleVar | ifTrue('yes! please move forward', 'not ready to proceed')\"></span> \n     *          <span data-f-bind=\"sampleVar | ifTrue('yes! please move forward')\"></span>\n     *      </div>\n     *\n     * @param {String} trueVal The value to display if the input is true. If there are commas in this argument, they must be escaped with `\\`.\n     * @param {String} falseVal (Optional) The value to display if the input is false. If not included, returns the input. If there are commas in this argument, they must be escaped with `\\`.\n     * @param {Any} input (Optional) The input to test. If not included, the output of the previous argument is used.\n     * @return {Any} If input is true, returns trueVal. If input is false, returns falseVal if provided, or echoes the input.\n     */\n    ifTrue: function () {\n        var args = parseArgs.apply(null, arguments);\n        return args.input ? args.trueVal : args.falseVal;\n    },\n    /**\n     * Convert the input to a new value (for example, some text), based on whether it is false or true.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          <span data-f-bind=\"sampleVar | ifFalse('not ready to proceed', 'actually this is still true')\"></span> \n     *          <span data-f-bind=\"sampleVar | ifFalse('not ready to proceed')\"></span>\n     *      </div>\n     *\n     * @param {String} trueVal The value to display if the input is false. If there are commas in this argument, they must be escaped with `\\`.\n     * @param {String} falseVal (Optional) The value to display if the input is true. If not included, returns the input. If there are commas in this argument, they must be escaped with `\\`.\n     * @param {Any} input (Optional) The input to test. If not included, the output of the previous argument is used.\n     * @return {Any} If input is false, returns trueVal. If input is true, returns falseVal if provided, or echoes the input.\n     */\n    ifFalse: function () {\n        var args = parseArgs.apply(null, arguments);\n        return !args.input ? args.trueVal : args.falseVal;\n    }\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/converters/bool-conditional-converters.js","const _ = require('lodash');\n\nconst list = {\n    /**\n     * Returns all values in array matching argument\n     *\n     * ** Example **\n     * <!-- list online users -->\n     * <ul data-f-foreach=\"users | filter(isOnline)\"><li></li></button>\n     * \n     * @param  {string|number|boolean} valueToFilterBy value to reject\n     * @param  {any[]} source The arrayed model variable\n     * @return {any[]}     filtered lsit\n     */\n    filter: function (valueToFilterBy, source) {\n        source = [].concat(source);\n        if ($.isPlainObject(source[0])) {\n            return _.filter(source, valueToFilterBy);\n        }\n        return source.filter((v)=> v === valueToFilterBy);\n    },\n\n    /**\n     * Returns all values in array excluding match\n     *\n     * ** Example **\n     * <!-- list offline users -->\n     * <ul data-f-foreach=\"users | except(isOnline)\"><li></li></button>\n     * \n     * @param  {string|number|boolean} valueToReject value to reject\n     * @param  {any[]} source The arrayed model variable\n     * @return {any[]}     filtered lsit\n     */\n    except: function (valueToReject, source) {\n        source = [].concat(source);\n        if ($.isPlainObject(source[0])) {\n            return _.reject(source, valueToReject);\n        }\n        return source.filter((v)=> v !== valueToReject);\n    },\n\n    /**\n     * Checks if array contains *any* item passing the test\n     *\n     * ** Example **\n     * <!-- hides button if any of the users are not online -->\n     * <button data-f-hideif=\"users | any(isOnline) | not\">Get Started</button>\n     * <button data-f-hideif=\"users | any({ isOnline: false })\">Get Started</button>\n     * \n     * @param  {string|object} value value to check for\n     * @param  {any[]} source The arrayed model variable\n     * @return {boolean}     True if match found in array\n     */\n    any: function (value, source) {\n        source = [].concat(source);\n        if ($.isPlainObject(source[0])) {\n            return _.some(source, value);\n        }\n        return source.indexOf(value) !== -1;\n    },\n\n    /**\n     * Checks if *every* item in the array passes the test\n     *\n     * ** Example **\n     * <!-- shows button if any of the users are not online -->\n     * <button data-f-showif=\"users | every(isOnline)\">Get Started</button>\n     * \n     * @param  {string|object} value value to check for\n     * @param  {any[]} source The arrayed model variable\n     * @return {boolean}     True if match found in array\n     */\n    every: function (value, source) {\n        source = [].concat(source);\n        if ($.isPlainObject(source[0])) {\n            return _.every(source, value);\n        }\n        return source.filter((v)=> v === value).length === source.length;\n    }\n};\nconst converters = Object.keys(list).map((name)=> {\n    return {\n        alias: name,\n        acceptList: true,\n        convert: list[name]\n    };\n});\n\nmodule.exports = converters;\n\n\n\n// WEBPACK FOOTER //\n// ./src/converters/collection-converters.js","import { isString, isFunction } from 'lodash';\n/**\n * @typedef NodeHandler\n * @property {string} selector\n * @property {Function} handle\n */ \n\n \n/**\n * @param {string | undefined} selector\n * @param {Function | NodeHandler } handler\n * @return {NodeHandler}\n */\nconst normalize = function (selector, handler) {\n    if (!selector) {\n        selector = '*';\n    }\n    if (isFunction(handler)) {\n        handler = {\n            selector: selector,\n            handle: handler\n        };\n    }\n   \n    handler.selector = selector;\n    return handler;\n};\n\n/**\n * @param {string|HTMLElement|JQuery<HTMLElement>} toMatch\n * @param { {selector:string} } node\n * @return {boolean}\n */ \nconst match = function (toMatch, node) {\n    if (isString(toMatch)) {\n        return toMatch === node.selector;\n    }\n    return $(toMatch).is(node.selector);\n};\n\nconst nodeManager = {\n    list: [],\n\n    /**\n     * Add a new node handler\n     * @param  {string} selector jQuery-compatible selector to use to match nodes\n     * @param  {function} handler  Handlers are new-able functions. They will be called with $el as context.? TODO: Think this through\n     * @returns {void}\n     */\n    register: function (selector, handler) {\n        this.list.unshift(normalize(selector, handler));\n    },\n\n    /**\n     * @param {string|HTMLElement|JQuery<HTMLElement>} selector\n     * @return NodeHandler\n     */ \n    getHandler: function (selector) {\n        return this.list.find(function (node) {\n            return match(selector, node);\n        });\n    },\n\n    replace: function (selector, handler) {\n        let index;\n        this.list.forEach(function (currentHandler, i) {\n            if (selector === currentHandler.selector) {\n                index = i;\n                return false;\n            }\n        });\n        this.list.splice(index, 1, normalize(selector, handler));\n    }\n};\n\n//bootstraps\nconst defaultHandlers = [\n    require('./input-checkbox-node').default,\n    require('./default-input-node'),\n    require('./default-node')\n];\ndefaultHandlers.reverse().forEach(function (handler) {\n    nodeManager.register(handler.selector, handler);\n});\n\nexport default nodeManager;\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/nodes/node-manager.js","import BaseView from './default-input-node';\nimport config from 'config';\n\nconst offAttr = config.attrs.checkboxOffValue;\n\nexport default BaseView.extend({\n    propertyHandlers: [\n\n    ],\n\n    getUIValue: function () {\n        const $el = this.$el;\n        const offAttrVal = $el.attr(offAttr);\n        const offVal = (offAttrVal && typeof offAttrVal !== 'undefined') ? offAttrVal : false;\n\n        const onAttrVal = $el.attr('value');\n        //attr = initial value, prop = current value\n        const onVal = (onAttrVal && typeof onAttrVal !== 'undefined') ? $el.prop('value') : true;\n\n        const val = ($el.is(':checked')) ? onVal : offVal;\n        return val;\n    },\n    initialize: function () {\n        BaseView.prototype.initialize.apply(this, arguments);\n    }\n}, { selector: ':checkbox,:radio' });\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/nodes/input-checkbox-node.js","/**\n * ## Attribute Manager\n *\n * Flow.js provides a set of custom DOM attributes that serve as a data binding between variables and operations in your project's model and HTML elements in your project's user interface. Under the hood, Flow.js is doing automatic conversion of these custom attributes, like `data-f-bind`, into HTML specific to the attribute's assigned value, like the current value of `myModelVar`.\n *\n * If you are looking for examples of using particular attributes, see the [specific attributes subpages](../../../../attributes-overview/).\n *\n * If you would like to extend Flow.js with your own custom attributes, you can add them to Flow.js using the Attribute Manager.\n *\n * The Attribute Manager is specific to adding custom attributes and describing their implementation (handlers). (The [Dom Manager](../../) contains the general implementation.)\n *\n *\n * **Examples**\n *\n * Built-in attribute handlers like `data-f-value` and `data-f-foreach` automatically bind variables in your project's model to particular HTML elements. However, your UI may sometimes require displaying only part of the variable (e.g. if it's an object), or \"doing something\" with the value of the variable, rather than simply displaying it.\n *\n * One example of when custom attribute handlers are useful is when your model variable is a complex object and you want to display the fields in a particular way, or you only want to display some of the fields. While the combination of the [`data-f-foreach` attribute](../loop-attrs/foreach-attr/) and [templating](../../../../#templates) can help with this, sometimes it's easier to write your own attribute handler. (This is especially true if you will be reusing the attribute handler -- you won't have to copy your templating code over and over.)\n *\n *      Flow.dom.attributes.register('showSched', '*', function (sched) {\n *            // display all the schedule milestones\n *            // sched is an object, each element is an array\n *            // of ['Formal Milestone Name', milestoneMonth, completionPercentage]\n *\n *            const schedStr = '<ul>';\n *            const sortedSched = sortBy(sched, function(el) { return el[1]; });\n *\n *            for (let i = 0; i < sortedSched.length; i++) {\n *                  schedStr += '<li><strong>' + sortedSched[i][0]\n *                        + '</strong> currently scheduled for <strong>Month '\n *                        + sortedSched[i][1] + '</strong></li>';\n *            }\n *            schedStr += '</ul>';\n *\n *            this.html(schedStr);\n *      });\n *\n * Then, you can use the attribute handler in your HTML just like other Flow.js attributes:\n *\n *      <div data-f-showSched=\"schedule\"></div>\n *\n */\n\nimport { isString, isFunction, isRegExp, each } from 'lodash';\n\nconst defaultHandlers = [\n    require('./no-op-attr').default,\n    require('./events/default-event-attr').default,\n    require('./loop-attrs/foreach-attr').default,\n    require('./loop-attrs/repeat-attr').default,\n    require('./class-attr').default,\n    require('./boolean-attr').default,\n    require('./toggles/show-if-attr').default,\n    require('./toggles/hide-if-attr').default,\n    require('./binds/checkbox-radio-bind-attr').default,\n    require('./binds/input-bind-attr').default,\n    require('./binds/default-bind-attr').default,\n    require('./default-attr').default\n];\n\nconst handlersList = [];\n\nconst normalize = function (attributeMatcher, nodeMatcher, handler) {\n    if (!nodeMatcher) {\n        nodeMatcher = '*';\n    }\n    if (isFunction(handler)) {\n        handler = {\n            handle: handler\n        };\n    }\n    return $.extend(handler, { test: attributeMatcher, target: nodeMatcher });\n};\n\ndefaultHandlers.forEach(function (handler) {\n    handlersList.push(normalize(handler.test, handler.target, handler));\n});\n\n\nconst matchAttr = function (matchExpr, attr, $el) {\n    let attrMatch;\n\n    if (isString(matchExpr)) {\n        attrMatch = (matchExpr === '*' || (matchExpr.toLowerCase() === attr.toLowerCase()));\n    } else if (isFunction(matchExpr)) {\n        //TODO: remove element selectors from attributes\n        attrMatch = matchExpr(attr, $el);\n    } else if (isRegExp(matchExpr)) {\n        attrMatch = attr.match(matchExpr);\n    }\n    return attrMatch;\n};\n\nconst matchNode = function (target, nodeFilter) {\n    return (isString(nodeFilter)) ? (nodeFilter === target) : nodeFilter.is(target);\n};\n\nconst attributeManager = {\n    list: handlersList,\n    /**\n     * Add a new attribute handler.\n     *\n     * @param  {string|Function|RegExp} attributeMatcher Description of which attributes to match.\n     * @param  {string|JQuery<HTMLElement>} nodeMatcher Which nodes to add attributes to. Use [jquery Selector syntax](https://api.jquery.com/category/selectors/).\n     * @param  {Function|object} handler If `handler` is a function, the function is called with `$element` as context, and attribute value + name. If `handler` is an object, it should include two functions, and have the form: `{ init: fn,  handle: fn }`. The `init` function is called when the page loads; use this to define event handlers. The `handle` function is called with `$element` as context, and attribute value + name.\n     * @returns {void}\n     */\n    register: function (attributeMatcher, nodeMatcher, handler) {\n        handlersList.unshift(normalize.apply(null, arguments));\n    },\n\n    /**\n     * Find an attribute matcher matching some criteria.\n     *\n     * @param  {string} attrFilter Attribute to match.\n     * @param  {string|JQuery<HTMLElement>} nodeFilter Node to match.\n     *\n     * @return {AttributeHandler[]} An array of matching attribute handlers, or null if no matches found.\n     */\n    filter: function (attrFilter, nodeFilter) {\n        let filtered = handlersList.filter(function (handler) {\n            return matchAttr(handler.test, attrFilter);\n        });\n        if (nodeFilter) {\n            filtered = filtered.filter(function (handler) {\n                return matchNode(handler.target, nodeFilter);\n            });\n        }\n        return filtered;\n    },\n\n    /**\n     * Replace an existing attribute handler.\n     *\n     * @param  {string} attrFilter Attribute to match.\n     * @param  {string|JQuery<HTMLElement>} nodeFilter Node to match.\n     * @param  {Function|object} handler The updated attribute handler. If `handler` is a function, the function is called with `$element` as context, and attribute value + name. If `handler` is an object, it should include two functions, and have the form: `{ init: fn,  handle: fn }`. The `init` function is called when the page loads; use this to define event handlers. The `handle` function is called with `$element` as context, and attribute value + name.\n     * @returns {void}\n     */\n    replace: function (attrFilter, nodeFilter, handler) {\n        let index;\n        each(handlersList, function (currentHandler, i) {\n            if (matchAttr(currentHandler.test, attrFilter) && matchNode(currentHandler.target, nodeFilter)) {\n                index = i;\n                return false;\n            }\n        });\n        handlersList.splice(index, 1, normalize(attrFilter, nodeFilter, handler));\n    },\n\n    /**\n     *  Retrieve the appropriate handler for a particular attribute. There may be multiple matching handlers, but the first (most exact) match is always used.\n     *\n     * @param {string} property The attribute.\n     * @param {string|JQuery<HTMLElement>} $el The DOM element.\n     *\n     * @return {AttributeHandler|undefined} The attribute handler, if a matching one is found\n     */\n    getHandler: function (property, $el) {\n        const filtered = this.filter(property, $el);\n        //There could be multiple matches, but the top first has the most priority\n        return filtered[0];\n    }\n};\n\nexport default attributeManager;\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attributes/attribute-manager.js","/**\n * ## No-op Attributes\n *\n * Flow.js provides special handling for both `data-f-model` (described [here](../../../../#using_in_project)) and `data-f-convert` (described [here](../../../../converter-overview/)). For these attributes, the default behavior is to do nothing, so that this additional special handling can take precendence.\n *\n */\n\n/**\n * @type AttributeHandler \n */\nconst noopAttr = {\n\n    target: '*',\n\n    test: /^(?:model|convert|channel|on-init)/i,\n\n    handle: ()=> {},\n    parse: ()=> []\n};\n\nexport default noopAttr;\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attributes/no-op-attr/index.js","import { events } from 'config';\nimport { toPublishableFormat } from 'utils/parse-utils';\n\n/**\n * @type AttributeHandler \n */\nconst defaultEventAttr = {\n\n    target: '*',\n\n    test: function (attr) {\n        return (attr.indexOf('on-') === 0);\n    },\n\n    unbind: function (attr, $el) {\n        const eventName = attr.replace('on-', '');\n        $el.off(eventName);\n    },\n\n    parse: ()=> ([]), //There's nothing to subscribe to on an event\n    handle: ()=> {},\n\n    init: function (attr, topics, $el) {\n        const eventName = attr.replace('on-', '');\n        const matching = topics[0] && topics[0].name; //multiple topics aren't really relevant here\n        $el.off(eventName).on(eventName, function (evt) {\n            evt.preventDefault();\n            var listOfOperations = toPublishableFormat(matching);\n            $el.trigger(events.trigger, { data: listOfOperations, source: attr });\n        });\n    }\n};\n\nexport default defaultEventAttr;\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attributes/events/default-event-attr/index.js","import { toImplicitType } from 'utils/parse-utils';\nimport { animation } from '../../../../config';\n\nimport { aliasesFromTopics, parseTopics } from '../loop-attr-utils';\nimport { addChangeClassesToList } from 'utils/animation';\nimport { each, template } from 'lodash';\n\nimport { getKnownDataForEl, updateKnownDataForEl, removeKnownData, findMissingReferences, stubMissingReferences, addBackMissingReferences, getOriginalContents, clearOriginalContents } from '../../attr-template-utils';\n\nconst elAnimatedMap = new WeakMap(); //TODO: Can probably get rid of this if we make subscribe a promise and distinguish between initial value\n\n/**\n * @type AttributeHandler\n */\nconst foreachAttr = {\n\n    test: 'foreach',\n\n    target: '*',\n\n    unbind: function (attr, $el) {\n        const el = $el.get(0);\n        elAnimatedMap.delete(el);\n        \n        const template = getOriginalContents($el);\n        const current = $el.html();\n        if (template && current !== template) {\n            $el.html(template);\n        }\n        clearOriginalContents($el);\n        removeKnownData($el);\n    },\n\n    parse: function (topics) {\n        return parseTopics(topics);\n    },\n\n    handle: function (value, prop, $el, topics) {\n        value = ($.isPlainObject(value) ? value : [].concat(value));\n\n        const { keyAlias, valueAlias } = aliasesFromTopics(topics, value);\n\n        const originalHTML = getOriginalContents($el, ($el)=> $el.html());\n        const knownData = getKnownDataForEl($el);\n        const missingReferences = findMissingReferences(originalHTML, [keyAlias, valueAlias].concat(Object.keys(knownData)));\n        const stubbedTemplate = stubMissingReferences(originalHTML, missingReferences);\n\n        const templateFn = template(stubbedTemplate);\n        const $dummyEl = $('<div></div>');\n        each(value, function (dataval, datakey) {\n            if (dataval === undefined || dataval === null) {\n                dataval = dataval + ''; //convert undefineds to strings\n            }\n            const templateData = $.extend(true, {}, knownData, {\n                [keyAlias]: datakey,\n                [valueAlias]: dataval\n            });\n\n            let nodes;\n            let isTemplated;\n            try {\n                const templated = templateFn(templateData);\n                const templatedWithReferences = addBackMissingReferences(templated, missingReferences);\n                isTemplated = templatedWithReferences !== stubbedTemplate;\n                nodes = $(templatedWithReferences);\n            } catch (e) { //you don't have all the references you need;\n                nodes = $(stubbedTemplate);\n                isTemplated = true;\n                updateKnownDataForEl($(nodes), templateData);\n            }\n\n            nodes.each(function (i, newNode) {\n                const $newNode = $(newNode);\n                each($newNode.data(), function (val, key) {\n                    $newNode.data(key, toImplicitType(val));\n                });\n                if (!isTemplated && !$newNode.html().trim()) {\n                    $newNode.html(dataval);\n                }\n            });\n            $dummyEl.append(nodes);\n        });\n        \n        const el = $el.get(0);\n        const isInitialAnim = !elAnimatedMap.get(el);\n        const $withAnimAttrs = addChangeClassesToList($el.children(), $dummyEl.children(), isInitialAnim, animation);\n        $el.empty().append($withAnimAttrs);\n\n        elAnimatedMap.set(el, true);\n    }\n};\n\nexport default foreachAttr;\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attributes/loop-attrs/foreach-attr/index.js","import { template, each } from 'lodash';\nimport { toImplicitType } from 'utils/parse-utils';\nimport { random } from 'utils/general';\nimport { attrs, animation } from '../../../../config';\n\nconst templateIdAttr = attrs.repeat.templateId;\n\nimport { addChangeClassesToList } from 'utils/animation';\n\nconst elAnimatedMap = new WeakMap(); //TODO: Can probably get rid of this if we make subscribe a promise and distinguish between initial value\n\nimport { getKnownDataForEl, updateKnownDataForEl, removeKnownData, findMissingReferences, stubMissingReferences, addBackMissingReferences, getOriginalContents, clearOriginalContents } from '../../attr-template-utils';\n\nimport { aliasesFromTopics, parseTopics } from '../loop-attr-utils';\n\n/**\n * @type AttributeHandler \n */\nconst loopAttrHandler = {\n    test: 'repeat',\n\n    target: '*',\n\n    unbind: function (attr, $el) {\n        var id = $el.data(templateIdAttr);\n        if (id) {\n            $el.nextUntil(':not([data-' + id + '])').remove();\n            // $el.removeAttr('data-' + templateIdAttr); //FIXME: Something about calling rebind multiple times in IB makes this happen without the removal\n        }\n\n        const el = $el.get(0);\n        elAnimatedMap.delete(el);\n\n        const originalHTML = getOriginalContents($el);\n        const current = $el.get(0).outerHTML;\n        if (originalHTML && current !== originalHTML) {\n            $el.replaceWith(originalHTML);\n        }\n        clearOriginalContents($el);\n        removeKnownData($el);\n    },\n\n    parse: function (topics) {\n        return parseTopics(topics);\n    },\n\n    handle: function (value, prop, $el, topics) {\n        value = ($.isPlainObject(value) ? value : [].concat(value));\n        var id = $el.data(templateIdAttr);\n        \n        const originalHTML = getOriginalContents($el, ($el)=> $el.get(0).outerHTML);\n\n        const $dummyOldDiv = $('<div></div>');\n        if (id) {\n            const $removed = $el.nextUntil(':not([data-' + id + '])').remove();\n            $dummyOldDiv.append($removed);\n        } else {\n            id = random('repeat-');\n            $el.attr('data-' + templateIdAttr, id);\n        }\n\n        const { keyAlias, valueAlias } = aliasesFromTopics(topics, value);\n\n        const knownData = getKnownDataForEl($el);\n        const missingReferences = findMissingReferences(originalHTML, [keyAlias, valueAlias].concat(Object.keys(knownData)));\n        const stubbedTemplate = stubMissingReferences(originalHTML, missingReferences);\n\n        const templateFn = template(stubbedTemplate);\n        var last;\n        each(value, function (dataval, datakey) {\n            if (dataval === undefined || dataval === null) {\n                dataval = dataval + ''; //convert undefineds to strings\n            }\n            const templateData = $.extend(true, {}, knownData, {\n                [keyAlias]: datakey,\n                [valueAlias]: dataval\n            });\n\n            let nodes;\n            let isTemplated;\n            try {\n                const templated = templateFn(templateData);\n                const templatedWithReferences = addBackMissingReferences(templated, missingReferences);\n                isTemplated = templatedWithReferences !== stubbedTemplate;\n                nodes = $(templatedWithReferences);\n            } catch (e) { //you don't have all the references you need;\n                nodes = $(stubbedTemplate);\n                isTemplated = true;\n                updateKnownDataForEl($(nodes), templateData);\n            }\n\n            var hasData = (dataval !== null && dataval !== undefined);\n            nodes.each(function (i, newNode) {\n                const $newNode = $(newNode);\n                $newNode.removeAttr('data-f-repeat').removeAttr('data-' + templateIdAttr);\n                each($newNode.data(), function (val, key) {\n                    if (!last) {\n                        $el.data(key, toImplicitType(val));\n                    } else {\n                        $newNode.data(key, toImplicitType(val));\n                    }\n                });\n                $newNode.attr('data-' + id, true);\n                if (!isTemplated && !$newNode.children().length && hasData) {\n                    $newNode.html(dataval + '');\n                }\n            });\n            if (!last) {\n                last = $el.html(nodes.html());\n            } else {\n                last = nodes.insertAfter(last);\n            }\n        });\n\n        const $newEls = $el.nextUntil(`:not('[data-${id}]')`);\n\n        const el = $el.get(0);\n        const isInitialAnim = !elAnimatedMap.get(el);\n        addChangeClassesToList($dummyOldDiv.children(), $newEls, isInitialAnim, animation);\n\n        elAnimatedMap.set(el, true);\n    }\n};\n\nexport default loopAttrHandler;\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attributes/loop-attrs/repeat-attr/index.js","import { isFunction } from 'lodash';\n\n/**\n * @param {any} val \n * @returns {Promise}\n */\nexport default function makePromise(val) {\n    //Can be replaced with Promise.resolve when we drop IE11;\n    // if (isFunction(val)) {\n    //     return Promise.resolve(val());\n    // }\n    // return Promise.resolve(val);\n    if (val.then) {\n        return val;\n    }\n    const $def = $.Deferred();\n    if (isFunction(val)) {\n        try {\n            const toReturn = val();\n            if (toReturn && toReturn.then) {\n                return toReturn.then((r)=> $def.resolve(r)).catch(((e)=> $def.reject(e)));\n            }\n            $def.resolve(toReturn);\n        } catch (e) {\n            $def.reject(e);\n        }\n    } else {\n        $def.resolve(val);\n    }\n    return $def.promise();\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils/general/make-promise.js","import { toArray } from 'lodash';\n\n/**\n * Returns debounced version of original (optionally promise returning) function\n * \n * @param {Function} fn function to debounce\n * @param {number} debounceInterval \n * @param {Function[]} [argumentsReducers] pass in 1 reducer for each option your function takes\n * @return {Function} debounced function\n */\nexport default function debounceAndMerge(fn, debounceInterval, argumentsReducers) {\n    var timer = null;\n    var $def = null;\n    var prom = null;\n\n    var argsToPass = [];\n    if (!argumentsReducers) {\n        var arrayReducer = function (accum, newVal) {\n            if (!accum) {\n                accum = [];\n            }\n            return accum.concat(newVal);\n        };\n        argumentsReducers = [\n            arrayReducer\n        ];\n    }\n\n    /**\n     * @returns {Promise}\n     */\n    return function debouncedFunction() {\n        var newArgs = toArray(arguments);\n        argsToPass = newArgs.map(function (arg, index) {\n            var reducer = argumentsReducers[index];\n            if (reducer) {\n                return reducer(argsToPass[index], arg);\n            } else {\n                return arg;\n            }\n        });\n        if (timer) {\n            clearTimeout(timer);\n        }\n\n        if (!$def) {\n            $def = $.Deferred();\n            prom = $def.promise();\n        }\n        timer = setTimeout(function () {\n            timer = null;\n            var res;\n            try {\n                res = fn.apply(fn, argsToPass);\n            } catch (e) {\n                argsToPass = [];\n                $def.reject(e);\n            }\n            if (res && res.then) {\n                return res.then(function (arg) {\n                    argsToPass = [];\n                    $def.resolve(arg);\n                }, (e)=> {\n                    argsToPass = [];\n                    $def.reject(e);\n                });\n            } else {\n                argsToPass = [];\n                $def.resolve(res);\n            }\n        }, debounceInterval);\n        prom.then((r)=> {\n            $def = prom = null; \n            return r; \n        }, (err)=> {\n            $def = prom = null;\n            throw err;\n        });\n        return prom;\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils/general/debounce-and-merge.js","import { isNumber } from 'lodash';\n\nconst elClassesMap = new WeakMap();\nfunction deleteAddedClasses($el) {\n    const el = $el.get(0);\n    const addedClasses = elClassesMap.get(el);\n    if (addedClasses) {\n        $el.removeClass(addedClasses);\n    }\n}\n/**\n * @type AttributeHandler\n */\nconst classAttr = {\n    test: 'class',\n\n    target: '*',\n\n\n    unbind: function (attr, $el) {\n        const el = $el.get(0);\n        deleteAddedClasses($el);\n        elClassesMap.delete(el);\n    },\n\n    handle: function (value, prop, $el) {\n        if (Array.isArray(value)) {\n            value = value[value.length - 1];\n        }\n\n        const el = $el.get(0);\n        deleteAddedClasses($el);\n\n        if (isNumber(value)) {\n            value = 'value-' + value;\n        }\n        setTimeout(()=> {\n            $el.addClass(value); //If the classes have an animation set, removing with a timeout will trigger it\n        }, 0);\n        elClassesMap.set(el, value);\n    }\n};\n\nexport default classAttr;\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attributes/class-attr/index.js","/**\n * @type AttributeHandler \n */\nconst booleanAttrHandler = {\n    target: '*',\n\n    test: /^(?:checked|selected|async|autofocus|autoplay|controls|defer|ismap|loop|multiple|open|required|scoped|disabled|hidden|readonly)$/i,\n\n    handle: function (value, prop, $el) {\n        if (Array.isArray(value)) {\n            value = value[value.length - 1];\n        }\n        const val = ($el.attr('value')) ? (value == $el.prop('value')) : !!value; //eslint-disable-line eqeqeq\n        $el.prop(prop, val);\n    }\n};\n\nexport default booleanAttrHandler;\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attributes/boolean-attr/index.js","/**\n  * @type AttributeHandler\n  */\nconst showifHandler = {\n    test: 'showif',\n\n    target: '*',\n\n    init: function (attr, value, $el) {\n        $el.hide(); //hide by default; if not this shows text until data is fetched\n    },\n\n    handle: function (value, prop, $el) {\n        if (Array.isArray(value)) {\n            value = value[value.length - 1];\n        }\n        return (value && `${value}`.trim()) ? $el.show() : $el.hide();\n    }\n};\n\nexport default showifHandler;\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attributes/toggles/show-if-attr/index.js","/**\n  * @type AttributeHandler\n  */\nconst hideifHandler = {\n    test: 'hideif',\n\n    target: '*',\n\n    init: function (attr, value, $el) {\n        $el.hide(); //hide by default; if not this shows text until data is fetched\n    },\n    handle: function (value, prop, $el) {\n        if (Array.isArray(value)) {\n            value = value[value.length - 1];\n        }\n        if (value && `${value}`.trim()) {\n            $el.hide();\n        } else {\n            $el.show();\n        }\n    }\n};\n\nexport default hideifHandler;\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attributes/toggles/hide-if-attr/index.js","/**\n  * @type {AttributeHandler}\n  */\nconst checkboxAttrHandler = {\n\n    target: ':checkbox,:radio',\n\n    test: 'bind',\n\n    handle: function (value, prop, $el) {\n        if (Array.isArray(value)) {\n            value = value[value.length - 1];\n        }\n        const settableValue = $el.attr('value'); //initial value\n        const isChecked = (typeof settableValue !== 'undefined') ? (settableValue == value) : !!value; //eslint-disable-line eqeqeq\n        $el.prop('checked', isChecked);\n    }\n};\n\nexport default checkboxAttrHandler;\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attributes/binds/checkbox-radio-bind-attr/index.js","/**\n * @type AttributeHandler \n */\nconst inputBindAttr = {\n    target: 'input, select, textarea',\n\n    test: 'bind',\n\n    handle: function (value, prop, $el) {\n        if (value === undefined) {\n            value = '';\n        } else if (Array.isArray(value)) {\n            value = value[value.length - 1];\n        }\n        $el.val(value + '');\n    }\n};\n\nexport default inputBindAttr;\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attributes/binds/input-bind-attr/index.js","import { template } from 'lodash';\nimport { addContentAndAnimate } from 'utils/animation';\nimport { animation } from 'config';\n\nimport { extractVariableName, extractAlias, translateDataToTemplatable, translateDataToInsertable } from '../bind-utils';\n\nimport { getKnownDataForEl, updateKnownDataForEl, removeKnownData, findMissingReferences, stubMissingReferences, addBackMissingReferences, isTemplated, getOriginalContents, clearOriginalContents } from '../../attr-template-utils';\n\nconst elAnimatedMap = new WeakMap(); //TODO: Can probably get rid of this if we make subscribe a promise and distinguish between initial value\n\nfunction toAliasMap(topics) {\n    return (topics || []).reduce((accum, topic)=> {\n        accum[topic.name] = topic.alias;   \n        return accum;\n    }, {});\n}\n\nfunction getNewContent(currentContents, value, $el, topics) {\n    if (!isTemplated(currentContents)) {\n        return translateDataToInsertable(value);\n    }\n\n    const templateData = translateDataToTemplatable(value, toAliasMap(topics));\n    const knownData = getKnownDataForEl($el);\n    $.extend(templateData, knownData);\n\n    const missingReferences = findMissingReferences(currentContents, Object.keys(templateData));\n    const stubbedTemplate = stubMissingReferences(currentContents, missingReferences);\n\n    const templateFn = template(stubbedTemplate);\n    try {\n        const templatedHTML = templateFn(templateData);\n        const templatedWithReferences = addBackMissingReferences(templatedHTML, missingReferences);\n        return templatedWithReferences;\n    } catch (e) { //you don't have all the references you need;\n        updateKnownDataForEl($el, templateData);\n        return currentContents;\n    }\n}\n\n/**\n * @type AttributeHandler \n */\nconst bindAttrHandler = {\n\n    target: '*',\n\n    test: 'bind',\n\n    parse: function (topics) {\n        return topics.map((topic)=> {\n            const attrVal = topic.name;\n            return {\n                name: extractVariableName(attrVal),\n                alias: extractAlias(attrVal),\n            };\n        });\n    },\n\n    //FIXME: Can't do this because if you have a bind within a foreach, foreach overwrites the old el with a new el, and at that points contents are lost\n    // But if i don't do this the <%= %> is going to show up\n    // init: function (attr, value, $el) {\n    //     const contents = getOriginalContents($el, ($el)=> $el.html());\n    //     if (isTemplated(contents)) {\n    //         $el.empty();\n    //     }\n    // },\n\n    unbind: function (attr, $el) {\n        const el = $el.get(0);\n        elAnimatedMap.delete(el);\n\n        const bindTemplate = getOriginalContents($el);\n        const current = $el.html();\n        if (bindTemplate && current !== bindTemplate) {\n            $el.html(bindTemplate);\n        }\n        clearOriginalContents($el);\n        removeKnownData($el);\n    },\n\n    handle: function (value, prop, $el, topics) {\n        const el = $el.get(0);\n        const originalContents = getOriginalContents($el, ($el)=> $el.html());\n        const contents = getNewContent(originalContents, value, $el, topics);\n\n        addContentAndAnimate($el, contents, !elAnimatedMap.has(el), animation);\n        elAnimatedMap.set(el, true);\n    }\n};\n\nexport default bindAttrHandler;\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attributes/binds/default-bind-attr/index.js","export function translateDataToInsertable(value) {\n    if (Array.isArray(value)) {\n        value = value[value.length - 1];\n    }\n    value = ($.isPlainObject(value)) ? JSON.stringify(value) : value + '';\n    return value;\n}\n\n/**\n * @param {any} value\n * @param {object} aliasMap\n * @returns {{value: any}}\n */\nexport function translateDataToTemplatable(value, aliasMap) {\n    const templateData = { value: value };\n    if ($.isPlainObject(value)) {\n        Object.keys(value).forEach((originalName)=> {\n            const alias = aliasMap[originalName] || originalName;\n            templateData[alias] = value[originalName];\n        });\n    } else {\n        Object.keys(aliasMap).forEach((originalName)=> {\n            const alias = aliasMap[originalName] || originalName;\n            templateData[alias] = value;\n        });\n    }\n    \n    return templateData;\n}\n\nconst AS_REGEX = /(.*) (?:as)\\s+\\((.*)\\)/;\n\n/**\n * @param {string} attrVal \n * @returns {string}\n */\nexport function extractVariableName(attrVal) {\n    const asMatch = attrVal.trim().match(AS_REGEX);\n    const varName = asMatch && asMatch[1] ? asMatch[1] : attrVal;\n    return varName.trim();\n}\n\n/**\n * @param {string} attrVal \n * @returns {string}\n */\nexport function extractAlias(attrVal) {\n    const asMatch = attrVal.trim().match(AS_REGEX);\n    const alias = asMatch && asMatch[2] ? asMatch[2] : attrVal;\n    return alias.trim();\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attributes/binds/bind-utils/index.js","/**\n * @type AttributeHandler \n */\nconst defaultAttr = {\n    test: '*',\n\n    target: '*',\n\n    handle: function (value, prop, $el) {\n        //FIXME: The _right_ way to do this would be to set attr, not prop. \n        //However Polymer 1.0 doesn't link attrs with stringified JSON, and that's really the primary use-case for this, so, ignoring\n        //However Polymer is fine with 'data-X' attrs having stringified JSON. Eventually we should make this attr and fix polymer\n        //but can't do that for backwards comptability reason. See commit bbc4a49039fb73faf1ef591a07b371d7d667cf57\n        $el.prop(prop, value);\n    }\n};\n\nexport default defaultAttr;\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attributes/default-attr/index.js","/**\n * Hooks up dom elements to mutation observer\n * @param  {HTMLElement} target     root to start observing from\n * @param  {object} domManager \n * @param  {boolean} isEnabled Determines if it's enabled by default\n * @return {object}\n */\nexport default function (target, domManager, isEnabled) {\n    if (typeof MutationObserver === 'undefined') {\n        return;\n    }\n    // Create an observer instance\n    var observer = new MutationObserver(function (mutations) {\n        mutations.forEach(function (mutation) {\n            var added = $(mutation.addedNodes).find(':f');\n            added = added.add($(mutation.addedNodes).filter(':f'));\n            var removed = $(mutation.removedNodes).find(':f');\n            removed = removed.add($(mutation.removedNodes).filter(':f'));\n            if (added && added.length) {\n                domManager.bindAll(added);\n            }\n            if (removed && removed.length) {\n                domManager.unbindAll(removed);\n            }\n            if (mutation.attributeName === 'data-f-channel') {\n                domManager.unbindAll(mutation.target);\n                domManager.bindAll(mutation.target);\n            }\n        });\n    });\n    var mutconfig = {\n        attributes: true,\n        attributeFilter: ['data-f-channel'],\n        childList: true,\n        subtree: true,\n        characterData: false\n    };\n    var publicApi = {\n        enable: function () {\n            observer.observe(target, mutconfig);\n        },\n        disable: function () {\n            observer.disconnect();\n        }\n    };\n    if (isEnabled) {\n        publicApi.enable();\n    }\n    return publicApi;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/plugins/auto-update-bindings.js","import DefaultChannelManager from './channel-manager';\n\nimport router from 'channels/channel-router';\nimport { JSONRouteHandler, EpicenterRouteHandler } from './route-handlers';\nimport { interpolatable, routable } from './channel-manager-enhancements';\n\n//Moving connecting glue here so channel-manager can be tested in isolation\nconst InterpolatableRoutableChannelManager = interpolatable(routable(DefaultChannelManager, router));\nexport default function ChannelManager(opts) {\n    const defaultRouteHandlers = [JSONRouteHandler, EpicenterRouteHandler];\n    const routes = opts && opts.routes ? opts.routes : [];\n    const cm = new InterpolatableRoutableChannelManager($.extend(true, {}, {\n        routes: [].concat(routes, defaultRouteHandlers)\n    }, opts));\n    return cm;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/configured-channel-manager.js","import $ from 'jquery';\nimport { normalizeParamOptions, publishableToObject } from './channel-utils';\nimport { uniqueId, isFunction, intersection, includes, uniq, isEqual } from 'lodash';\n/**\n * \n * @param {String[]|String} topics \n * @param {Function} callback \n * @param {Object} options\n * @return {Subscription}\n */\nfunction makeSubs(topics, callback, options) {\n    var id = uniqueId('subs-');\n    var defaults = {\n        batch: false,\n\n        /**\n         * Determines if the last published data should be cached for future notifications. For e.g.,\n         *\n         * channel.subscribe(['price', 'cost'], callback1, { batch: true, cache: false });\n         * channel.subscribe(['price', 'cost'], callback2, { batch: true, cache: true });\n         *\n         * channel.publish({ price: 1 });\n         * channel.publish({ cost: 1 });\n         *\n         * callback1 will have been called once, and callback2 will not have been called. i.e., the channel caches the first publish value and notifies after all dependent topics have data\n         * If we'd done channel.publish({ price: 1, cost: 1 }) would have called both callback1 and callback2\n         *\n         * `cache: true` is useful if you know if your topics will can published individually, but you still want to handle them together.\n         * `cache: false` is useful if you know if your topics will *always* be published together and they'll be called at the same time.\n         *\n         * Note this has no discernible effect if batch is false\n         * @type {Boolean}\n         */\n        cache: true,\n    };\n    var opts = $.extend({}, defaults, options);\n    if (!callback || !isFunction(callback)) {\n        throw new Error('subscribe callback should be a function');\n    }\n    return $.extend(true, {\n        id: id,\n        topics: [].concat(topics),\n        callback: callback,\n    }, opts);\n}\n\nvar cacheBySubsId = {};\nvar sentDataBySubsId = {};\n\nfunction copy(data) {\n    if (Array.isArray(data)) {\n        return data.map((d)=> copy(d));\n    } else if ($.isPlainObject(data)) {\n        return Object.keys(data).reduce((accum, key)=> {\n            accum[key] = copy(data[key]);\n            return accum;\n        }, {});\n    }\n    return data;\n}\n/**\n* @param {Subscription} subscription \n* @param {*} data\n*/\nfunction callbackIfChanged(subscription, data) {\n    var id = subscription.id;\n    // if (!isEqual(sentDataBySubsId[id], data)) { //This won't work for operations; reset for e.g., will only be called once\n    // sentDataBySubsId[id] = copy(data);\n    subscription.callback(data, { id: id });\n    // }\n}\n\n/**\n* @param {Publishable[]} topics\n* @param {Subscription} subscription \n*/\nfunction checkAndNotifyBatch(topics, subscription) {\n    const publishData = publishableToObject(topics);\n    const matchingTopics = intersection(Object.keys(publishData), subscription.topics);\n    if (!matchingTopics.length) {\n        return;\n    }\n    const relevantDataFromPublish = matchingTopics.reduce((accum, topic)=> {\n        accum[topic] = publishData[topic];\n        return accum;\n    }, {});\n\n    const cachedDataForSubs = cacheBySubsId[subscription.id] || {};\n    const knownDataForSubs = $.extend(true, {}, cachedDataForSubs, relevantDataFromPublish);\n\n    if (subscription.cache) {\n        cacheBySubsId[subscription.id] = knownDataForSubs;\n    }\n    const hasDataForAllTopics = intersection(Object.keys(knownDataForSubs), subscription.topics).length === subscription.topics.length;\n    if (hasDataForAllTopics) {\n        callbackIfChanged(subscription, knownDataForSubs);\n    }\n}\n\n\n/**\n * @param {Publishable[]} topics\n * @param {Subscription} subscription \n */\nfunction checkAndNotify(topics, subscription) {\n    topics.forEach(function (topic) {\n        if (includes(subscription.topics, topic.name) || includes(subscription.topics, '*')) {\n            var toSend = {};\n            toSend[topic.name] = topic.value;\n            callbackIfChanged(subscription, toSend);\n        }\n    });\n}\n\n/**\n* @param {Subscription[]} subcriptionList\n* @return {String[]}\n*/\nfunction getTopicsFromSubsList(subcriptionList) {\n    return subcriptionList.reduce(function (accum, subs) {\n        accum = accum.concat(subs.topics);\n        return accum;\n    }, []);\n}\n\n/**\n * @class ChannelManager\n */\nclass ChannelManager {\n    constructor(options) {\n        this.subscriptions = [];\n    }\n\n    /**\n     * @param {String | Publishable } topic\n     * @param {any} [value] item to publish\n     * @param {PublishOptions} [options]\n     * @return {Promise}\n     */\n    publish(topic, value, options) {\n        var normalized = normalizeParamOptions(topic, value, options);\n        var prom = $.Deferred().resolve(normalized.params).promise();\n        prom = prom.then((publishResponses)=> {\n            this.notify(publishResponses, options);\n            return publishResponses;\n        });\n        return prom;\n    }\n\n    notify(topic, value, options) {\n        var normalized = normalizeParamOptions(topic, value, options);\n        // console.log('notify', normalized.params);\n        return this.subscriptions.forEach(function (subs) {\n            var fn = subs.batch ? checkAndNotifyBatch : checkAndNotify;\n            fn(normalized.params, subs);\n        });\n    }\n\n    /**\n     * @param {String[] | String} topics\n     * @param {Function} cb\n     * @param {Object} [options]\n     * @return {String}\n     */\n    subscribe(topics, cb, options) {\n        var subs = makeSubs(topics, cb, options);\n        delete cacheBySubsId[subs.id];\n        delete sentDataBySubsId[subs.id];\n        this.subscriptions = this.subscriptions.concat(subs);\n        return subs.id;\n    }\n        \n\n    /**\n     * @param {String} token\n     */\n    unsubscribe(token) {\n        var olderLength = this.subscriptions.length;\n        var remaining = this.subscriptions.filter(function (subs) {\n            return subs.id !== token;\n        });\n        if (remaining.length === olderLength) {\n            throw new Error('No subscription found for token ' + token);\n        }\n        delete cacheBySubsId[token];\n        delete sentDataBySubsId[token];\n        this.subscriptions = remaining;\n    }\n    unsubscribeAll() {\n        cacheBySubsId = {};\n        sentDataBySubsId = {};\n        this.subscriptions = [];\n    }\n\n    /**\n     * @return {String[]}\n     */\n    getSubscribedTopics() {\n        var list = uniq(getTopicsFromSubsList(this.subscriptions));\n        return list;\n    }\n\n    /**\n     * @param {String} [topic] optional topic to filter by\n     * @return {Subscription[]}\n     */\n    getSubscribers(topic) {\n        if (topic) {\n            return this.subscriptions.filter(function (subs) {\n                return includes(subs.topics, topic);\n            });\n        }\n        return this.subscriptions;\n    }\n}\n\nexport default ChannelManager;\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/channel-manager.js","module.exports = jQuery;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"jQuery\"\n// module id = 53\n// module chunks = 0","import _ from 'lodash';\n\n/**\n * @param {String} topic\n * @param {Handler[]} handlers\n * @param {any} [matchOptions] options to pass on to matcher\n * @return {Handler | undefined}\n */\nexport function findBestHandler(topic, handlers, matchOptions) {\n    for (var i = 0; i < handlers.length; i++) {\n        var thishandler = handlers[i];\n        var match = thishandler.match(topic, matchOptions);\n        if (match !== false) {\n            return $.extend(true, {}, thishandler, { matched: match });\n        }\n    }\n    return undefined;\n}\n\n/**\n * [groupByHandlers description]\n * @param  {String[]} topics   List of topics to match. Format can be anything your handler.match function handles\n * @param  {Handler[]} handlers Handlers of type [{ match: func }]\n * @return {HandlerWithTopics[]} The handler array with each item now having an additional 'data' attr added to it with the matching topics\n */\nexport function groupByHandlers(topics, handlers) {\n    handlers = handlers.map(function (h, index) {\n        h.key = index;\n        return h;\n    });\n    var topicMapping = ([].concat(topics)).reduce(function (accum, topic) {\n        var bestHandler = findBestHandler(topic, handlers);\n        if (bestHandler) {\n            //if handler matches different strings treat both as different handlers\n            var key = bestHandler.key + bestHandler.matched;\n            if (!accum[key]) {\n                bestHandler.data = [];\n                accum[key] = bestHandler;\n            }\n            accum[key].data.push(topic);\n        }\n        return accum;\n    }, {});\n    return _.values(topicMapping);\n}\n\n/**\n * Takes a `publish` dataset and groups it by handler maintaining the data sequence\n * @param  {Publishable[]} data     Of the form [{ name: 'X', }]\n * @param  {Handler[]} handlers Handlers of type [{ match: func }]\n * @return {HandlerWithData[]} The handler array with each item now having an additional 'data' attr added to it with the publishable data\n */\nexport function groupSequentiallyByHandlers(data, handlers) {\n    handlers = handlers.map(function (h, index) {\n        h.key = index;\n        return h;\n    });\n    var grouped = data.reduce(function (accum, dataPt) {\n        var lastHandler = accum[accum.length - 1];\n        var bestHandler = findBestHandler(dataPt.name, handlers, true);\n        if (bestHandler) {\n            if (lastHandler && bestHandler.key === lastHandler.key) {\n                lastHandler.data.push(dataPt);\n            } else {\n                accum.push($.extend({}, bestHandler, { data: [dataPt] }));\n            }\n        } else {\n            accum.push({ data: [dataPt], matched: false });\n        }\n        return accum;\n    }, []);\n    return grouped;\n}\n\n\n/**\n * @param {any} response \n * @param {string[]} topics \n * @returns {Publishable[]}\n */\nexport function normalizeSubscribeResponse(response, topics) {\n    // @ts-ignore\n    if (response === undefined) {\n        return [];\n    }\n    const isAlreadyInPublishableFormat = Array.isArray(response) && (!response.length || response[0].name !== undefined);\n    if (isAlreadyInPublishableFormat) {\n        return response; \n    }\n    if (typeof response === 'object' && !Array.isArray(response)) {\n        return topics.reduce((accum, t)=> {\n            accum.push({ name: t, value: response[t] });\n            return accum; \n        }, []);\n    }\n    if (topics.length === 1) { //it's not in a publishable format, so someone just returned a string or something\n        const name = topics[0];\n        return [{ name: name, value: response }];\n    }\n    throw new Error('unrecognized subscribe response format');\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/channel-router/utils/handler-utils.js","/**\n * @param {Publishable[]} published \n * @param {boolean|String[]|{except: String[]}} [silentOptions]\n * @return {Publishable[]} filtered list\n */\nexport default function silencable(published, silentOptions) {\n    if (silentOptions === true || !published) {\n        return [];\n    } else if (Array.isArray(silentOptions)) {\n        return published.filter((data)=> {\n            const found = silentOptions.indexOf(data.name) !== -1;\n            return !found;\n        });\n    } else if (silentOptions && silentOptions.except) {\n        return published.filter((data)=> {\n            const found = (silentOptions.except || []).indexOf(data.name) !== -1;\n            return found;\n        });\n    }\n    return published;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/channel-router/utils/silencable.js","import { isFunction } from 'lodash';\n\n/**\n * \n * @param {Publishable[]} publishable \n * @param {boolean|string[]|Function} readOnlyOptions \n * @return {Publishable[]} filtered list\n */\nexport default function excludeReadOnly(publishable, readOnlyOptions) {\n    if (isFunction(readOnlyOptions)) {\n        readOnlyOptions = readOnlyOptions();\n    }\n    if (readOnlyOptions === true) {\n        console.error('Tried to publish to a readonly channel', publishable);\n        return [];\n    }  \n    if (Array.isArray(readOnlyOptions)) {\n        const split = publishable.reduce((accum, data)=> {\n            const isReadonly = readOnlyOptions.indexOf(data.name) !== -1;\n            if (isReadonly) {\n                accum.readOnly.push(data);\n            } else {\n                accum.remaining.push(data);\n            }\n            return accum;\n        }, { readOnly: [], remaining: [] });\n        \n        if (split.readOnly.length) {\n            console.warn('Ignoring readonly publishes', split.readOnly);\n        }\n        return split.remaining;\n    }\n    return publishable;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/channel-router/utils/exclude-read-only.js","import { toImplicitType } from 'utils/parse-utils';\n\nexport function match(topic) {\n    var parsed = toImplicitType(topic);\n    return typeof parsed !== 'string' ? '' : false;\n}\n\nexport default {\n    match: match,\n    name: 'JSON Route',\n    subscribeHandler: function (topics) {\n        const parsed = topics.map((t)=> {\n            return {\n                name: t,\n                value: toImplicitType(t)\n            };\n        });\n        return parsed;\n    }\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/json-router/index.js","import RunManagerRouter from './run-manager-router';\nimport ScenarioRouter from './scenario-manager-router';\nimport CustomRunRouter from './custom-run-router';\nimport WorldManagerRouter from './world-manager-router';\n\nimport RunsRouter from './runs-router';\n\n// import UserRouter from './user-router/current-user-channel';\n\nimport { withPrefix } from 'channels/channel-router/utils';\nimport { matchPrefix, matchDefaultPrefix, matchRegex } from 'channels/route-handlers/route-matchers';\n\nimport router from 'channels/channel-router';\n\nfunction getOptions(opts, key) {\n    var serviceOptions = $.extend(true, {}, opts.defaults, opts[key]);\n    var channelOptions = $.extend(true, {}, serviceOptions.channelOptions);\n    delete serviceOptions.channelOptions;\n\n    return { serviceOptions: serviceOptions, channelOptions: channelOptions };\n}\n\nvar SCENARIO_PREFIX = 'sm:';\nvar RUN_PREFIX = 'rm:';\nconst WORLD_PREFIX = 'world:';\n\nvar sampleRunidLength = '000001593dd81950d4ee4f3df14841769a0b'.length;\nvar runidRegex = '(?:.{' + sampleRunidLength + '})';\n\nexport default function (config, notifier, channelManagerContext) {\n    var opts = $.extend(true, {}, config);\n\n    var customRunChannelOpts = getOptions(opts, 'runid');\n    var customRunChannel = new CustomRunRouter(customRunChannelOpts, notifier);\n    var runsChannel = new RunsRouter(customRunChannelOpts, withPrefix(notifier, 'runs'), channelManagerContext);\n    // var userChannel = new UserRouter(getOptions(opts, 'runManager').run, withPrefix(notifier, 'user:'), channelManagerContext);\n    \n    /** @type {Handler[]} **/\n    var handlers = [\n        $.extend({}, customRunChannel, { \n            name: 'customRun',\n            match: matchRegex(runidRegex),\n            options: customRunChannelOpts.channelOptions,\n        }), \n        $.extend({}, runsChannel, {\n            name: 'archiveRuns',\n            match: matchPrefix('runs:'),\n            options: customRunChannelOpts.channelOptions,\n        }),  \n        // $.extend({}, userChannel, {\n        //     name: 'User Channel',\n        //     match: matchPrefix('user:'),\n        // })\n    ];\n    var exposable = {};\n\n    var runManagerOpts = getOptions(opts, 'runManager');\n    if (opts.runManager || (!opts.scenarioManager && runManagerOpts.serviceOptions.run)) {\n        var rm;\n        const isMultiplayer = runManagerOpts.serviceOptions.strategy === 'multiplayer';\n        if (opts.scenarioManager) {\n            rm = new RunManagerRouter(runManagerOpts, withPrefix(notifier, RUN_PREFIX));\n            handlers.push($.extend({}, rm, { \n                name: 'run',\n                match: matchPrefix(RUN_PREFIX), //if both scenario manager and run manager are being used, require a prefix\n                options: runManagerOpts.channelOptions,\n            }));\n        } else if (isMultiplayer) {\n            //Ignore case where both scenario manager and multiplayer are being used\n            rm = new WorldManagerRouter(runManagerOpts, withPrefix(notifier, [WORLD_PREFIX, '']));\n            handlers.push($.extend({}, rm, { \n                name: 'World run',\n                match: matchDefaultPrefix(WORLD_PREFIX),\n                isDefault: true,\n                options: runManagerOpts.channelOptions,\n            }));\n        } else {\n            rm = new RunManagerRouter(runManagerOpts, withPrefix(notifier, [RUN_PREFIX, '']));\n            handlers.push($.extend({}, rm, { \n                name: 'run',\n                match: matchDefaultPrefix(RUN_PREFIX),\n                isDefault: true,\n                options: runManagerOpts.channelOptions,\n            }));\n        }\n\n        $.extend(exposable, rm.expose);\n    }\n\n    if (opts.scenarioManager) {\n        var scenarioManagerOpts = getOptions(opts, 'scenarioManager');\n        var sm = new ScenarioRouter(scenarioManagerOpts, withPrefix(notifier, [SCENARIO_PREFIX, '']));\n        handlers.push($.extend({}, sm, { \n            name: 'scenario',\n            match: matchDefaultPrefix(SCENARIO_PREFIX),\n            options: scenarioManagerOpts.channelOptions,\n            isDefault: true,\n        }));\n\n        $.extend(exposable, sm.expose);\n    }\n\n    var epicenterRouter = router(handlers, notifier);\n    epicenterRouter.expose = exposable;\n    \n    return epicenterRouter;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/epicenter-router/index.js","import RunChannel from './run-router';\n\nimport { withPrefix } from 'channels/channel-router/utils';\nimport router from 'channels/channel-router';\nimport { matchDefaultPrefix } from 'channels/route-handlers/route-matchers';\n\nconst { F } = window;\n\nconst RUN_PREFIX = 'current:';\n\nexport default function (config, notifier) {\n    const defaults = {\n        serviceOptions: {},\n        channelOptions: {}\n    };\n    const opts = $.extend(true, {}, defaults, config);\n\n    const rmOptions = opts.serviceOptions;\n    const rm = new F.manager.RunManager(rmOptions);\n\n    const $creationPromise = rm.getRun().then((run)=> {\n        return rm.run;\n    });\n    const currentChannelOpts = $.extend(true, \n        { serviceOptions: $creationPromise }, opts.defaults, opts.current);\n    const currentRunChannel = new RunChannel(currentChannelOpts, withPrefix(notifier, [RUN_PREFIX, '']));\n\n    const runRouteHandler = $.extend(currentRunChannel, { \n        match: matchDefaultPrefix(RUN_PREFIX), //TODO: Just remove prefix?\n        name: 'Current Run',\n        isDefault: true,\n        options: currentChannelOpts.channelOptions,\n    });\n    const handlers = [\n        runRouteHandler\n    ];\n\n    const runMangerRouter = router(handlers);\n    runMangerRouter.expose = { runManager: rm };\n\n    return runMangerRouter;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/epicenter-router/run-manager-router.js","import { objectToPublishable, publishableToObject } from 'channels/channel-utils';\nimport { intersection } from 'lodash';\n\nexport default function RunMetaChannel($runServicePromise, notifier) {\n\n    function mergeAndSend(runMeta, requestedTopics) {\n        var toSend = ([].concat(requestedTopics)).reduce(function (accum, meta) {\n            accum.push({ name: meta, value: runMeta[meta] });\n            return accum;\n        }, []);\n        return toSend;\n        // return notifier(toSend);\n    }\n    return {\n        subscribeHandler: function (topics, options) {\n            topics = [].concat(topics);\n            \n            return $runServicePromise.then(function (runService) {\n                var cachedValues = intersection(Object.keys(runService.runMeta || {}), topics);\n                if (options.autoFetch === false) {\n                    return $.Deferred().resolve({}).promise();\n                } else if (cachedValues.length === topics.length) {\n                    //FIXME: Add 'updated time' to meta, and fetch if that's < debounce interval -- use the custom debounce fn with the custom merge (debounce save as well?)\n                    //Make run service factory return patched run-service?\n                    return $.Deferred().resolve(mergeAndSend(runService.runMeta, topics)).promise();\n                } if (!runService.loadPromise) {\n                    runService.loadPromise = runService.load().then(function (data) {\n                        runService.runMeta = data;\n                        return data;\n                    });\n                } \n                return runService.loadPromise.then(function (data) {\n                    return mergeAndSend(data, topics);\n                });\n            });\n        },\n        publishHandler: function (topics, options) {\n            return $runServicePromise.then(function (runService) {\n                var toSave = publishableToObject(topics);\n                return runService.save(toSave).then(function (res) {\n                    runService.runMeta = $.extend({}, true, runService.runMeta, res);\n                    return objectToPublishable(res);\n                });\n            });\n        }\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/epicenter-router/run-router/run-meta-channel.js","import { debounceAndMerge } from 'utils/general';\nimport { objectToPublishable, publishableToObject } from 'channels/channel-utils';\nimport { uniqueId, uniq, difference } from 'lodash';\nimport { retriableFetch } from './retriable-variable-fetch';\n// import { optimizedFetch } from './optimized-variables-fetch';\n\nexport default function RunVariablesChannel($runServicePromise, notifier) {\n    const id = uniqueId('variable-channel');\n\n    function debouncedVariableQuery(runService, debounceInterval) {\n        if (!runService.debouncedFetchers) {\n            runService.debouncedFetchers = {};\n        }\n        if (!runService.debouncedFetchers[id]) {\n            runService.debouncedFetchers[id] = debounceAndMerge(function (variables) {\n                return retriableFetch(runService, variables);\n            }, debounceInterval, [function mergeVariables(accum, newval) {\n                if (!accum) {\n                    accum = [];\n                }\n                return uniq(accum.concat(newval)).filter((v)=> !!(v && v.trim()));\n            }]);\n        }\n        return runService.debouncedFetchers[id];\n    }\n\n    let knownTopics = [];\n    return { \n        fetch: function () {\n            return $runServicePromise.then(function (runService) {\n                return retriableFetch(runService, [].concat(knownTopics)).then(objectToPublishable).then(notifier);\n            });\n        },\n\n        unsubscribeHandler: function (unsubscribedTopics, remainingTopics) {\n            knownTopics = knownTopics.filter((t)=> unsubscribedTopics.indexOf(t) === -1);\n        },\n        subscribeHandler: function (topics, options) {\n            const isAutoFetchEnabled = options.autoFetch;\n            const debounceInterval = options.debounce;\n\n            return $runServicePromise.then(function (runService) {\n                knownTopics = uniq(knownTopics.concat(topics));\n                if (!knownTopics.length) {\n                    return $.Deferred().resolve([]).promise();\n                } else if (!isAutoFetchEnabled) {\n                    return $.Deferred().resolve(topics).promise();\n                }\n                return debouncedVariableQuery(runService, debounceInterval)(topics).then((response)=> {\n                    const missingVariables = difference(topics, Object.keys(response));\n                    if (missingVariables.length) {\n                        return $.Deferred().reject({\n                            context: missingVariables,\n                            message: `Missing variables: ${missingVariables.join(',')}`\n                        }).promise();\n                    }\n                    return response;\n                });\n            });\n        },\n        notify: function (variableObj) {\n            return $runServicePromise.then(function (runService) {\n                const variables = Object.keys(variableObj); \n                return retriableFetch(runService, variables).then(objectToPublishable).then(notifier);\n            });\n        },\n        publishHandler: function (topics, options) {\n            return $runServicePromise.then(function (runService) {\n                const toSave = publishableToObject(topics);\n                return runService.variables().save(toSave).then(function (response) {\n                    const variables = Object.keys(toSave); \n                    //Get the latest from the server because what you think you saved may not be what was saved\n                    //bool -> 1, scalar to array for time-based models etc\n                    //FIXME: This causes dupe requests, one here and one after fetch by the run-variables channel\n                    //FIXME: Other publish can't do anything till this is done, so debouncing won't help. Only way out is caching\n                    return retriableFetch(runService, variables).then(objectToPublishable);\n                });\n            });\n        }\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/epicenter-router/run-router/run-variables-channel.js","import { difference } from 'lodash';\n\nexport function retriableFetch(runService, variables) {\n    if (!variables || !variables.length) {\n        return $.Deferred().resolve({}).promise();\n    }\n    return runService.variables().query(variables).catch((e)=> {\n        const response = e.responseJSON;\n        const info = response.information;\n        if (info.code !== 'VARIABLE_NOT_FOUND') {\n            throw e;\n        }\n        const goodVariables = difference(variables, info.context.names);\n        return retriableFetch(runService, goodVariables);\n    });\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/epicenter-router/run-router/retriable-variable-fetch.js","export default function RunOperationsChannel($runServicePromise, notifier) {\n    return {\n        notify: function (operationsResponse) {\n            const parsed = [{ name: operationsResponse.name, value: operationsResponse.result }];\n            return notifier(parsed);\n        },\n\n        subscribeHandler: function () {\n            return [];\n        },\n        publishHandler: function (topics, options) {\n            return $runServicePromise.then(function (runService) {\n                const toSave = topics.map(function (topic) {\n                    return { name: topic.name, params: topic.value };\n                });\n                return runService.serial(toSave).then(function (result) {\n                    const toReturn = result.map(function (response, index) {\n                        return { name: topics[index].name, value: response.result };\n                    });\n                    return toReturn;\n                });\n            });\n        }\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/epicenter-router/run-router/run-operations-channel.js","import RunRouter from './run-router';\nimport { withPrefix } from 'channels/channel-router/utils';\nimport router from 'channels/channel-router';\nimport { matchPrefix, matchDefaultPrefix, } from 'channels/route-handlers/route-matchers';\n\n\nexport default function (config, notifier) {\n    var defaults = {\n        serviceOptions: {},\n        channelOptions: {},\n    };\n    var opts = $.extend(true, {}, defaults, config);\n\n    var sm = new window.F.manager.ScenarioManager(opts.serviceOptions);\n\n    var baselinePromise = sm.baseline.getRun().then(()=> sm.baseline.run);\n    var baselineOptions = $.extend(true, {\n        serviceOptions: baselinePromise,\n        channelOptions: {\n            meta: {\n                readOnly: true\n            },\n            variables: {\n                readOnly: true\n            }\n        }\n    }, opts.defaults, opts.baseline);\n    var currentRunPromise = sm.current.getRun().then(()=> sm.current.run);\n\n    var runOptions = $.extend(true, {\n        serviceOptions: currentRunPromise,\n    }, opts.defaults, opts.current);\n\n    var baselineChannel = new RunRouter(baselineOptions, withPrefix(notifier, 'baseline:'));\n    var currentRunChannel = new RunRouter(runOptions, withPrefix(notifier, ['current:', '']));\n    var handlers = [\n        $.extend(baselineChannel, {\n            name: 'baseline',\n            match: matchPrefix('baseline:'),\n            options: baselineOptions.channelOptions,\n        }),\n        $.extend(currentRunChannel, { \n            isDefault: true, \n            name: 'current',\n            match: matchDefaultPrefix('current:'),\n            options: runOptions.channelOptions,\n        }),\n\n    ];\n    \n    var scenarioManagerRouter = router(handlers, notifier);\n    scenarioManagerRouter.expose = { scenarioManager: sm };\n    return scenarioManagerRouter;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/epicenter-router/scenario-manager-router.js","import runChannelFactory from './run-router-factory';\nimport { withPrefix, stripSuffixDelimiter } from 'channels/channel-router/utils';\n\nexport default function (options, notifier) {\n    if (!options) options = {};\n\n    var opts = {};\n    opts.serviceOptions = options.serviceOptions && options.serviceOptions.run ? options.serviceOptions.run : {};\n    opts.channelOptions = options.channelOptions;\n\n    return {\n        subscribeHandler: function (topics, options, prefix) {\n            var runid = stripSuffixDelimiter(prefix);\n            //FIXME: Should i merge options here?\n            var channel = runChannelFactory(runid, opts, withPrefix(notifier, prefix));\n            return channel.subscribeHandler(topics, options, prefix);\n        },\n        publishHandler: function (topics, options, prefix) {\n            var runid = stripSuffixDelimiter(prefix);\n            var channel = runChannelFactory(runid, opts, withPrefix(notifier, prefix));\n            return channel.publishHandler(topics);\n        }\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/epicenter-router/custom-run-router.js","import RunChannel from './run-router';\nvar knownRunIDServiceChannels = {};\n\nexport default function (runid, options, notifier) {\n    var runChannel = knownRunIDServiceChannels[runid];\n    if (!runChannel) {\n        var runOptions = $.extend(true, {}, options, { serviceOptions: { id: runid } });\n        runChannel = new RunChannel(runOptions, notifier);\n        knownRunIDServiceChannels[runid] = runChannel;\n    }\n    return runChannel;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/epicenter-router/run-router-factory.js","import WorldUsersChannel from './world-users-channel';\nimport WorldCurrentUserChannel from './world-current-user-channel';\n\nimport { withPrefix } from 'channels/channel-router/utils';\nimport { matchPrefix, matchDefaultPrefix } from 'channels/route-handlers/route-matchers';\n\nimport RunChannel from '../run-router';\nimport router from 'channels/channel-router';\n\nconst { F } = window;\n\n//TODO: Add custom worldid channel as well\n//\nexport default function (config, notifier) {\n    const defaults = {\n        serviceOptions: {},\n        channelOptions: {}\n    };\n    const opts = $.extend(true, {}, defaults, config);\n\n    const rmOptions = opts.serviceOptions;\n    const rm = new F.manager.RunManager(rmOptions);\n    \n    const getRunPromise = rm.getRun().then((run)=> {\n        if (!run.world) {\n            console.error('No world found in run. Make sure you\\'re using EpicenterJS version > 2.7');\n            throw new Error('Could not find world');\n        }\n        return run;\n    }, (err)=> {\n        console.error('Run manager get run error', err);\n        throw err;\n    });\n    const $runPromise = getRunPromise.then((run)=> {\n        if (rm.run.channel) {\n            return rm.run;\n        }\n        const channelManager = new F.manager.ChannelManager();\n        const worldChannel = channelManager.getWorldChannel(run.world);\n\n        worldChannel.subscribe(worldChannel.TOPICS.RUN_RESET, (run)=> {\n            rm.run.updateConfig({ filter: run.id });\n        }, this, { includeMine: false });\n        rm.run.channel = worldChannel;\n        return rm.run;\n    });\n\n    const currentRunChannelOpts = $.extend(true, { serviceOptions: $runPromise }, opts.defaults, opts.current);\n    const currentRunChannel = new RunChannel(currentRunChannelOpts, withPrefix(notifier, ['run:', '']));\n\n    const handlers = [];\n\n    const runRouteHandler = $.extend(currentRunChannel, { \n        match: matchDefaultPrefix('run:'),\n        name: 'World Run',\n        isDefault: true,\n        options: currentRunChannelOpts.channelOptions,\n    });\n    handlers.unshift(runRouteHandler);\n\n    const worldPromise = getRunPromise.then((run)=> {\n        return run.world;\n    });\n    const multiUserChannel = new WorldUsersChannel(worldPromise, withPrefix(notifier, 'users:'));\n    const multiUserHandler = $.extend(multiUserChannel, { \n        match: matchPrefix('users:'),\n        name: 'world users',\n    });\n    handlers.unshift(multiUserHandler);\n    \n    const userChannel = new WorldCurrentUserChannel(worldPromise, withPrefix(notifier, 'user:'));\n    const userHandler = $.extend(userChannel, {\n        match: matchPrefix('user:'),\n        name: 'current user',\n    });\n    handlers.unshift(userHandler);\n\n    const runMangerRouter = router(handlers);\n    runMangerRouter.expose = { runManager: rm };\n\n    return runMangerRouter;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/epicenter-router/world-manager-router/index.js","const F = window.F;\n\nexport default function WorldUsersChanngel(worldPromise, notifier) {\n    let presenceSubsId;\n\n    const store = {\n        users: [],\n        mark: (userid, isOnline)=> {\n            store.users = store.users.map((u)=> {\n                if (u.userId === userid) {\n                    u.isOnline = isOnline;\n                }\n                return u;\n            });\n            return store.users;\n        }\n    };\n    const channelManager = new F.manager.ChannelManager();\n\n    const parsedUsersPromise = worldPromise.then((world)=> {\n        const am = new F.manager.AuthManager();\n        const session = am.getCurrentUserSessionInfo();\n        const parsed = world.users.map((u)=> {\n            u.name = u.lastName;\n            u.isMe = u.userId === session.userId;\n            u.isOnline = u.isMe; //Assume i'm the only online one by default\n            return u;\n        });\n        store.users = parsed;\n        return parsed;\n    });\n    \n    return { \n        unsubscribeHandler: function (knownTopics, remainingTopics) {\n            if (remainingTopics.length || !presenceSubsId) {\n                return;\n            }\n            worldPromise.then((world)=> {\n                const worldChannel = channelManager.getWorldChannel(world);\n                worldChannel.unsubscribe(presenceSubsId);\n                presenceSubsId = null;\n            });\n\n        },\n        subscribeHandler: function (userids) {\n            if (!presenceSubsId) {\n                //TODO: Also listen to roles channel to update users\n                worldPromise.then((world)=> {\n                    const worldChannel = channelManager.getWorldChannel(world);\n                    presenceSubsId = worldChannel.subscribe(worldChannel.TOPICS.PRESENCE, (user, meta)=> {\n                        const userid = user.id;\n                        store.mark(userid, user.isOnline);\n                        return notifier([{ name: '', value: store.users }]);\n                    }, { includeMine: false });\n                });\n            }\n            return parsedUsersPromise.then((users)=> {\n                return [{ name: '', value: users }];\n            });\n        },\n        publishHandler: function (topics, options) {\n            const ps = new F.service.Presence();\n            topics.forEach((topic)=> {\n                const split = topic.name.split(':');\n                if (split[1]) {\n                    if (split[1] === 'markOnline') {\n                        ps.markOnline(split[0]);\n                    } else if (split[1] === 'markOffline') {\n                        ps.markOffline(split[0]);\n                    }\n                }\n            });\n            return topics;\n        }\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/epicenter-router/world-manager-router/world-users-channel/index.js","const F = window.F;\n\nexport default function WorldUsersChanngel(worldPromise, notifier) {\n    let subsid;\n\n    const am = new F.manager.AuthManager();\n    const store = $.extend(true, {\n        isMe: true,\n        isOnline: true,\n    }, am.getCurrentUserSessionInfo());\n    const channelManager = new F.manager.ChannelManager();\n\n    return { \n        unsubscribeHandler: function (unsubscribedTopics, remainingTopics) {\n            const stillNeedRoles = remainingTopics.indexOf('role') !== -1;\n            if (!stillNeedRoles && subsid) {\n                worldPromise.then((world)=> {\n                    const worldChannel = channelManager.getWorldChannel(world);\n                    worldChannel.unsubscribe(subsid);\n                });\n                subsid = null;\n            }\n        },\n        subscribeHandler: function (userFields) {\n            return worldPromise.then((world)=> {\n                const session = am.getCurrentUserSessionInfo();\n                const myUser = world.users.find((user)=> {\n                    return user.userId === session.userId;\n                });\n                $.extend(store, myUser);\n                \n                const toNotify = userFields.reduce((accum, field)=> {\n                    if (field === '') { //the entire user object\n                        accum.push({ name: field, value: store });\n                    } else if (store[field] !== undefined) {\n                        accum.push({ name: field, value: store[field] });\n                    }\n                    return accum;\n                }, []);\n                \n                const isSubscribingToRole = userFields.indexOf('role') !== -1;\n                if (isSubscribingToRole && !subsid) {\n                    const worldChannel = channelManager.getWorldChannel(world);\n                    subsid = worldChannel.subscribe(worldChannel.TOPICS.ROLES, (users, meta)=> {\n                        const myUser = users.find((u)=> {\n                            return u.userId === session.userId;\n                        });\n                        if (myUser && myUser.role !== store.role) {\n                            store.role = myUser.role;\n                            notifier([{ name: 'role', value: myUser.role }]);\n                        }\n                    });\n                }\n                return toNotify;\n            });\n        }\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/epicenter-router/world-manager-router/world-current-user-channel.js","import { debounceAndMerge } from 'utils/general';\nvar { F } = window;\n\nexport default function RunsRouter(options, notifier, channelManagerContext) {\n    var runService = new F.service.Run(options.serviceOptions.run);\n\n    var topicParamMap = {};\n\n    function extractFiltersFromTopic(topicString) {\n        var filters = topicString.replace('(', '').replace(')', '');\n        var filterParam = filters.split(';').reduce((accum, filter)=> {\n            var [key, val] = filter.split('=');\n            if (val) {\n                val = true;\n            }\n            accum[key] = val;\n            return accum;\n        }, {});\n        return filterParam;\n    }\n\n    function fetch(topic, variables) {\n        var filters = extractFiltersFromTopic(topic);\n        return runService.query(filters, { include: variables }).then((runs)=> {\n            notifier([{ name: topic, value: runs }]);\n\n            // if (topicParamMap[topic]) {\n            //     Object.keys(topicParamMap[topic]).forEach((runid)=> {\n            //         channelManagerContext.unsubscribe(topicParamMap[topic][runid]);\n            //     });\n            // }\n\n            return runs;\n        });\n    }\n\n    return {\n        fetch: fetch,\n\n        unsubscribeHandler: function (unsubscribedTopics, remainingTopics) {\n            console.log('unsubs');\n            // knownTopics = remainingTopics;\n        },\n        subscribeHandler: function (topics, options) {\n            var topic = ([].concat(topics))[0];\n\n            var filters = extractFiltersFromTopic(topic);\n            var variables = options && options.include;\n\n            var debounceInterval = 300;\n            var debouncedFetch = debounceAndMerge(fetch, debounceInterval, (accum, newval)=> newval);\n            return fetch(topic, variables).then(function (runs) {\n                var subsMap = {};\n                //TODO: Provide this meta information to runs-factory so it doesn't trigger a fetch to get meta for each run\n                runs.forEach((run)=> {\n                    var subscriptions = Object.keys(filters).map((filter)=> run.id + ':meta:' + filter);\n                    var subsid = channelManagerContext.subscribe(subscriptions, function () {\n                        debouncedFetch(topic, variables);\n                    }, { batch: false, autoFetch: false, cache: false });\n                    subsMap[run.id] = subsid;\n                });\n\n                topicParamMap[topic] = subsMap;\n                return runs;\n            });\n        }\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/epicenter-router/runs-router/index.js","import subscribeInterpolator from './subscribe-interpolator';\nimport publishInterpolator from './publish-interpolator';\n\n/**\n * Decorates passed channel manager with interpolation functionality\n * @param  {ChannelManager} ChannelManager\n * @return {ChannelManager}                wrapped channel manager\n */\nexport default function interpolatable(ChannelManager) {\n    var subsidMap = {};\n\n    /**\n     * @implements {ChannelManager}\n     */\n    return class InterpolatedChannelManager extends ChannelManager {\n        constructor(options) {\n            super(options);\n            //FIXME: Add on-error (from routable) here?\n            this.subscribe = subscribeInterpolator(this.subscribe.bind(this), (dependencySubsId, newDependentId)=> {\n                var existing = subsidMap[dependencySubsId];\n                if (existing) {\n                    this.unsubscribe(existing);\n                }\n                subsidMap[dependencySubsId] = newDependentId;\n            });\n\n            this.publish = publishInterpolator(this.publish.bind(this), (variables, cb)=> {\n                super.subscribe(variables, (response, meta)=> {\n                    this.unsubscribe(meta.id);\n                    cb(response);\n                }, { autoFetch: true, batch: true, onError: (e)=> {\n                    throw e;\n                } });\n            });\n        }\n        unsubscribe(token) {\n            var existing = subsidMap[token];\n            if (existing) {\n                super.unsubscribe(existing);\n            }\n            super.unsubscribe(token);\n            delete subsidMap[token];\n        }\n        unsubscribeAll() {\n            subsidMap = {};\n            super.unsubscribeAll();\n        }\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/channel-manager-enhancements/interpolatable/index.js","import { extractDependencies, interpolateWithValues } from './interpolatable-utils';\nimport { uniq } from 'lodash';\n\n/**\n * @param {String[]} topics\n * @return {String[]} interpolated\n */\nexport function getDependencies(topics) {\n    var deps = topics.reduce((accum, topic)=> {\n        var inner = extractDependencies(topic);\n        accum = accum.concat(inner);\n        return accum;\n    }, []);\n    return uniq(deps);\n}\n\n/**\n * @param {String[]} topics\n * @param {Object} data\n * @return {String[]}\n */\nexport function interpolateWithDependencies(topics, data) {\n    return topics.map((topic)=> {\n        return interpolateWithValues(topic, data);\n    });\n}\n\n/**\n * @param  {String[]} originalTopics     \n * @param  {String[]} interpolatedTopics \n * @param  {Object} data               \n * @return {Object}                    Interpolated\n */\nexport function mergeInterpolatedTopicsWithData(originalTopics, interpolatedTopics, data) {\n    return interpolatedTopics.reduce((accum, interpolatedTopic, index)=> {\n        var original = originalTopics[index];\n        var val = data[interpolatedTopic];\n        if (val !== undefined) {\n            accum[original] = data[interpolatedTopic];\n        }\n        return accum;\n    }, {});\n}\n\n/**\n * Takes a subscribe function and resolves any interpolated inputs\n * @param  {Function} subscribeFn        function to wrap\n * @param  {Function} onDependencyChange callback function when any dependencies change\n * @return {Function}                    wrapped function\n */\nexport default function subscribeInterpolator(subscribeFn, onDependencyChange) {\n    return function interpolatedSubscribe(topics, cb, options) {\n        topics = [].concat(topics);\n        var dependencies = getDependencies(topics);\n        if (!dependencies.length) {\n            return subscribeFn(topics, cb, options);\n        }\n        var innerSubsId = subscribeFn(dependencies, function handleDependencyValueChange(data, dependenciesMeta) {\n            var interpolatedTopics = interpolateWithDependencies(topics, data);\n\n            var outerSubsId = subscribeFn(interpolatedTopics, function handleInterpolatedValueChange(actualData, actualMeta) {\n                var toSendback = mergeInterpolatedTopicsWithData(topics, interpolatedTopics, actualData);\n\n                cb(toSendback, actualMeta);\n            }, options);\n\n            (onDependencyChange || $.noop)(dependenciesMeta.id, outerSubsId);\n            return outerSubsId;\n        }, $.extend(options, { autoFetch: true, batch: true }));\n\n        return innerSubsId;\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/channel-manager-enhancements/interpolatable/subscribe-interpolator.js","import { extractDependencies, interpolateWithValues } from './interpolatable-utils';\nimport { normalizeParamOptions } from 'channels/channel-utils';\n\nimport { uniq } from 'lodash';\n\n/**\n * @param {Publishable[]} publishInputs\n * @returns {String[]} dependencies for inputs\n */\nexport function getDependencies(publishInputs) {\n    var deps = publishInputs.reduce((accum, input)=> {\n        var inner = extractDependencies(input.name);\n        accum = accum.concat(inner);\n        return accum;\n    }, []);\n    return uniq(deps);\n}\n\n/**\n * @param {Publishable[]} publishInputs\n * @param {Object} valuesToInterpolate\n * @returns {Publishable[]} inputs with resolved dependencies\n */\nexport function interpolateWithDependencies(publishInputs, valuesToInterpolate) {\n    return publishInputs.map((ip)=> {\n        return {\n            name: interpolateWithValues(ip.name, valuesToInterpolate),\n            value: ip.value,\n        };\n    });\n}\n\n/**\n * Publish function to wrap\n * @param  {Function} publishFunction\n * @param  {Function} fetchFn         function to get interpolated values from\n * @return {Function}                 wrapped function\n */\nexport default function publishInterpolator(publishFunction, fetchFn) {\n    return function interpolatedPublishfunction(topic, value, options) {\n        var normalizedPublishInputs = normalizeParamOptions(topic, value, options);\n        var dependencies = getDependencies(normalizedPublishInputs.params);\n        if (!dependencies.length) {\n            return publishFunction(topic, value, options);\n        }\n        \n        var prom = $.Deferred();\n        fetchFn(dependencies, function handleDependencyChange(resolvedDependencies) {\n            var interpolated = interpolateWithDependencies(normalizedPublishInputs.params, resolvedDependencies);\n            var newPublishProm = publishFunction(interpolated, normalizedPublishInputs.options);\n            newPublishProm.then(prom.resolve, prom.reject);\n        });\n        return prom.promise();\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/channel-manager-enhancements/interpolatable/publish-interpolator.js","import { normalizeParamOptions } from '../../channel-utils';\nimport { omit, difference, uniq } from 'lodash';\n\nfunction getTopicsFromSubsList(subcriptionList) {\n    const allTopics = subcriptionList.reduce(function (accum, subs) {\n        accum = accum.concat(subs.topics);\n        return accum;\n    }, []);\n    return uniq(allTopics);\n}\n\n/**\n * Decorates passed channel manager with middleware functionality\n * @param  {ChannelManager} ChannelManager\n * @return {ChannelManager} wrapped channel manager\n */\nexport default function withRouter(ChannelManager, router) {\n    /**\n     * @augments ChannelManager\n     */\n    return class ChannelWithRouter extends ChannelManager {\n        constructor(options) {\n            super(options);\n            const defaults = {\n                routes: []\n            };\n            const opts = $.extend(true, {}, defaults, options);\n            const optsToPassOn = omit(opts, Object.keys(defaults));\n\n            this.router = router(opts.routes, optsToPassOn, this.notify.bind(this));\n        }\n\n        /**\n         * Allow intercepting and excluding topics from by subsequent middlewares\n         * @param  {string | string[]}   topics\n         * @param  {Function} cb\n         * @param  {Object}   options\n         * @return {string}           subscription id\n         */\n        subscribe(topics, cb, options) {\n            const subsid = super.subscribe(topics, cb, options);\n            this.router.subscribeHandler([].concat(topics), options).then((topicsWithData)=> {\n                if (topicsWithData.length) {\n                    this.notify([].concat(topicsWithData));\n                }\n            }, (err)=> {\n                this.unsubscribe(subsid);\n                if (options && options.onError) {\n                    options.onError(err);\n                }\n            });\n            return subsid;\n        }\n\n        /**\n         * Allow intercepting and handling/suppressing data to publish calls.\n         * @param {string | Publishable } topic\n         * @param {any} [value] item to publish\n         * @param {Object} [options]\n         * @return {Promise}\n         */\n        publish(topic, value, options) {\n            const publishData = normalizeParamOptions(topic, value, options);\n            return this.router.publishHandler(publishData.params, publishData.options).then((published)=> {\n                return super.publish(published, publishData.options);\n            });\n        }\n        \n\n        /**\n         * Calls unsubscribe middleware *after* unsubscription with a list of recently unsubscribed topics\n         * @param  {string} token\n         * @return {void}\n         */\n        unsubscribe(token) {\n            const originalTopics = getTopicsFromSubsList(this.subscriptions);\n            super.unsubscribe(token);\n            const remainingTopics = getTopicsFromSubsList(this.subscriptions);\n            const unsubscribedTopics = difference(originalTopics, remainingTopics);\n\n            this.router.unsubscribeHandler(unsubscribedTopics, remainingTopics);\n        }\n\n        /**\n         * Calls unsubscribe middleware after unsubscribeAll on the channel\n         * @return {void}\n         */\n        unsubscribeAll() {\n            const originalTopics = getTopicsFromSubsList(this.subscriptions);\n            super.unsubscribeAll();\n\n            return this.router.unsubscribeHandler(originalTopics, []);\n        }\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/channel-manager-enhancements/routable/index.js"],"sourceRoot":""}