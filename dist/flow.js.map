{"version":3,"sources":["webpack:///webpack/bootstrap ffe692c186d940ff333c","webpack:///external \"_\"","webpack:///./src/config.js","webpack:///./src/channels/channel-router/utils/index.js","webpack:///./src/utils/parse-utils.js","webpack:///./src/channels/channel-utils.js","webpack:///./src/channels/channel-router/index.js","webpack:///./src/channels/route-handlers/route-matchers.js","webpack:///./src/utils/general/index.js","webpack:///./src/channels/route-handlers/epicenter-route-handlers/run-route-handler/index.js","webpack:///./src/utils/animation.js","webpack:///./src/dom/attribute-manager/attr-template-utils.js","webpack:///./src/dom/node-manager/default-input-node.js","webpack:///./src/dom/node-manager/default-node.js","webpack:///./src/dom/attribute-manager/attributes/loop-attrs/loop-attr-utils.js","webpack:///./src/utils/general/promise-utils.js","webpack:///./src/channels/route-handlers/epicenter-route-handlers/world-route-handler/consensus-route-handler/consensus-utils.js","webpack:///./src/channels/channel-manager-enhancements/interpolatable/interpolatable-utils.js","webpack:///./src/flow.js","webpack:///./src/dom/dom-manager.js","webpack:///./src/dom/dom-manager-utils/dom-parse-helpers/index.js","webpack:///./src/dom/dom-manager-utils/dom-parse-helpers/parse-converters.js","webpack:///./src/dom/dom-manager-utils/dom-parse-helpers/parse-channel.js","webpack:///./src/dom/dom-manager-utils/dom-parse-helpers/parse-topics.js","webpack:///./src/dom/dom-manager-utils/dom-channel-prefix-helpers/index.js","webpack:///./src/dom/converter-manager/index.js","webpack:///./src/dom/converter-manager/converters/number-converters/index.js","webpack:///./src/dom/converter-manager/converters/string-converters/index.js","webpack:///./src/dom/converter-manager/converters/array-converters/index.js","webpack:///./src/dom/converter-manager/converters/general-util-converters/index.js","webpack:///./src/dom/converter-manager/converters/numberformat-converter/index.js","webpack:///./src/dom/converter-manager/converters/number-compare-converters/index.js","webpack:///./src/dom/converter-manager/converters/boolean-conditional-converters/index.js","webpack:///./src/dom/converter-manager/converters/collection-converters/index.js","webpack:///./src/dom/node-manager/index.js","webpack:///./src/dom/node-manager/input-checkbox-node.js","webpack:///./src/utils/base-view.js","webpack:///./src/dom/attribute-manager/index.js","webpack:///./src/dom/attribute-manager/attributes/no-op-attr/index.js","webpack:///./src/dom/attribute-manager/attributes/events/default-event-attr/index.js","webpack:///./src/dom/attribute-manager/attributes/loop-attrs/foreach-attr/index.js","webpack:///./src/dom/attribute-manager/attributes/loop-attrs/repeat-attr/index.js","webpack:///./src/utils/general/debounce-and-merge.js","webpack:///./src/dom/attribute-manager/attributes/class-attr/index.js","webpack:///./src/dom/attribute-manager/attributes/boolean-attr/index.js","webpack:///./src/dom/attribute-manager/attributes/toggles/show-if-attr/index.js","webpack:///./src/dom/attribute-manager/attributes/toggles/hide-if-attr/index.js","webpack:///./src/dom/attribute-manager/attributes/binds/checkbox-radio-bind-attr/index.js","webpack:///./src/dom/attribute-manager/attributes/binds/input-bind-attr/index.js","webpack:///./src/dom/attribute-manager/attributes/binds/default-bind-attr/index.js","webpack:///./src/dom/attribute-manager/attributes/binds/bind-utils/index.js","webpack:///./src/dom/attribute-manager/attributes/default-attr/index.js","webpack:///./src/dom/plugins/auto-update-bindings.js","webpack:///./src/channels/configured-channel-manager.js","webpack:///./src/channels/channel-manager.js","webpack:///external \"jQuery\"","webpack:///./src/channels/channel-router/utils/handler-utils.js","webpack:///./src/channels/channel-router/utils/silencable.js","webpack:///./src/channels/channel-router/utils/exclude-read-only.js","webpack:///./src/channels/route-handlers/index.js","webpack:///./src/channels/route-handlers/json-route-handler/index.js","webpack:///./src/channels/route-handlers/epicenter-route-handlers/index.js","webpack:///./src/channels/route-handlers/epicenter-route-handlers/default-run-route-handler/index.js","webpack:///./src/channels/route-handlers/epicenter-route-handlers/run-route-handler/run-meta-route-handler/index.js","webpack:///./src/channels/route-handlers/epicenter-route-handlers/run-route-handler/run-variables-route-handler/index.js","webpack:///./src/channels/route-handlers/epicenter-route-handlers/run-route-handler/run-variables-route-handler/retriable-variable-fetch.js","webpack:///./src/channels/route-handlers/epicenter-route-handlers/run-route-handler/run-operations-route-handler/index.js","webpack:///./src/channels/route-handlers/epicenter-route-handlers/scenario-route-handler/index.js","webpack:///./src/channels/route-handlers/epicenter-route-handlers/runid-route-handler/index.js","webpack:///./src/channels/route-handlers/epicenter-route-handlers/run-router-factory.js","webpack:///./src/channels/route-handlers/epicenter-route-handlers/world-route-handler/index.js","webpack:///./src/channels/route-handlers/epicenter-route-handlers/world-route-handler/world-users-route-handler/index.js","webpack:///./src/channels/route-handlers/epicenter-route-handlers/world-route-handler/world-current-user-route-handler/index.js","webpack:///./src/channels/route-handlers/epicenter-route-handlers/world-route-handler/consensus-route-handler/index.js","webpack:///./src/channels/route-handlers/epicenter-route-handlers/world-route-handler/consensus-route-handler/consensus-operations-handler.js","webpack:///./src/channels/route-handlers/epicenter-route-handlers/world-route-handler/consensus-route-handler/consensus-status-handler.js","webpack:///./src/channels/route-handlers/epicenter-route-handlers/multi-run-route-handler/index.js","webpack:///./src/channels/route-handlers/dom-route-handler/index.js","webpack:///./src/channels/channel-manager-enhancements/index.js","webpack:///./src/channels/channel-manager-enhancements/interpolatable/index.js","webpack:///./src/channels/channel-manager-enhancements/interpolatable/subscribe-interpolator.js","webpack:///./src/channels/channel-manager-enhancements/interpolatable/publish-interpolator.js","webpack:///./src/channels/channel-manager-enhancements/routable/index.js","webpack:///./src/utils/index.js"],"names":["module","exports","prefix","binderAttr","events","trigger","convert","error","attrs","checkboxOffValue","repeat","templateId","errorAttr","animation","addAttr","changeAttr","initialAttr","CHANNEL_DELIMITER","stripSuffixDelimiter","text","indexOf","length","replace","mapWithPrefix","dataArray","map","datapt","name","$","extend","withPrefix","callback","prefixList","arr","concat","data","forEach","mapped","unprefixTopics","list","unprefixed","item","unprefix","toImplicitType","objRegex","arrRegex","converted","trim","charAt","substring","isNumeric","test","bracketReplaced","parsed","split","val","JSON","parse","e","console","splitUnescapedCommas","str","regex","m","op","exec","index","lastIndex","match","groupIndex","push","splitNameArgs","value","fnName","params","args","p","toPublishableFormat","OPERATIONS_SEPERATOR","listOfOperations","objectToPublishable","obj","Object","keys","t","publishableToObject","mergeWith","result","reduce","accum","topic","normalizeParamOptions","publishValue","options","isPlainObject","Array","isArray","notifySubscribeHandlers","handlers","topics","grouped","groupByHandlers","promises","filter","handler","subscribeHandler","mergedOptions","matched","promise","makePromise","subsResponse","then","topicsWithData","normalized","normalizeSubscribeResponse","prefixed","when","apply","arguments","notifyUnsubscribeHandlers","recentlyUnsubscribedTopics","remainingTopics","h","unsubsKey","unsubsGrouped","remainingGrouped","unsubscribeHandler","unprefixedUnsubs","matchingRemainingHandler","_","find","remainingHandler","matchingTopicsRemaining","unprefixedRemaining","passthroughPublishInterceptors","publishData","groupSequentiallyByHandlers","$initialProm","Deferred","resolve","dataSoFar","publishableData","excludeReadOnly","readOnly","publishHandler","publishProm","published","silencable","silent","isDefault","router","notifier","myHandlers","Handler","isFunction","expose","matchString","addRoute","Error","id","uniqueId","unshift","removeRoute","routeid","ROUTE_DELIMITER","matchPrefix","prefixMatcher","hasPrefix","isOnlyPrefix","matchDefaultPrefix","defaultPrefixMatcher","forcePrefix","matchRegex","toMatch","RegExp","regexMatcher","random","min","max","parseInt","rnd","_random","VARIABLES_PREFIX","META_PREFIX","OPERATIONS_PREFIX","_shouldFetch","ignoreOperations","filtered","r","isIgnored","isVariable","isOperation","RunService","F","service","Run","GenericRunRouteHandler","config","defaults","serviceOptions","channelOptions","variables","autoFetch","debounce","operations","meta","opts","rs","operationNotifier","variableNotifier","metaHandler","MetaRouteHandler","operationsHandler","OperationsRouteHandler","variablesHandler","VariablesRouteHandler","subscribed","channel","TOPICS","subscribeOpts","includeMine","subscribe","RUN_VARIABLES","publishable","excludingSilenced","notify","fetch","RUN_OPERATIONS","CONSENSUS_UPDATE","consensus","closed","RUN_RESET","runRouter","oldhandler","prom","shouldFetch","excludeFromFetch","exclude","_findMostConsequtive","reduced","prev","count","maxCount","Math","buildDiffArray","currentcontents","newContents","contents","isSame","fill","a","i","elToContents","el","outerHTML","elementsToContents","$els","child","get","addChangeClassesToList","$currentEls","$newEls","isInitial","reversedContents","diffFromEnd","diffFromBeginning","slice","reverse","endMatches","beginningMatches","placeHoldersCount","placeHolders","undefined","$el","eq","curr","removeAttr","attr","addContentAndAnimate","newValue","current","html","setTimeout","CURRENT_INDEX_KEY","CURRENT_INDEX_ATTR","getKnownDataForEl","closestKnownDataEl","closest","knownData","updateKnownDataForEl","stringify","removeKnownData","getTemplateTags","template","templateTagsUsed","isTemplated","findMissingReferences","knownDataKeys","isKnownTag","tag","knownTags","key","missingReferences","refKey","refToMarkup","stubMissingReferences","refId","addBackMissingReferences","originalTemplateVal","commentRef","elTemplateMap","WeakMap","getOriginalContents","resolver","originalHTML","set","clearOriginalContents","delete","BaseView","propertyHandlers","uiChangeEvent","getUIValue","removeEvents","off","initialize","propName","triggerChangeOn","changeHandler","payload","source","restoreOriginal","bind","handlerDebounceTime","debouncedHandler","on","prototype","selector","require","IN_OF_REGEX","KEY_VALUE_REGEX","extractVariableName","attrVal","inMatch","varName","parseKeyAlias","itMatch","alias","parseValueAlias","aliasesFromTopics","relevantTopic","defaultKey","keyAlias","valueAlias","parseTopics","$def","toReturn","reject","promisify","fn","promisifiedFunction","makeConsensusService","consensisAPIResponse","window","Consensus","stage","consensusGroup","worldId","interpolationRegex","extractDependencies","deps","interpolateWithValues","interpolatedTopic","dependency","toReplace","Flow","dom","domManager","utils","model","run","root","autoBind","ChannelManager","unbindAll","bindAll","constants","RELEASE_VERSION","version","expr","pseudos","attributes","nodeName","getMatchingElements","$root","matchedElements","is","add","getElementOrError","element","context","triggerError","msg","message","unbindAllAttributes","domEl","each","nodeMap","wantedPrefix","attrManager","getHandler","unbind","unbindAllNodeHandlers","nodeManager","handle","removeAllSubscriptions","subscriptions","subs","unsubscribe","publicAPI","nodes","converters","converterManager","Map","unbindElement","existingData","subsid","subscriptionId","animAttrs","join","removeData","bindElement","isExcluded","changeEventOverrides","uiChangeEvents","triggerSelector","matchingEvent","filterPrefix","attrList","parseTopicsFromAttributeValue","init","channelPrefix","getChannelForAttribute","addPrefixToTopics","getConvertersForEl","channelConfig","getChannelConfigForElement","attrsWithSubscriptions","subsOptions","batch","onError","subscribableTopics","isEqual","previousData","toConvert","dataForAttr","pick","k","assign","elementsToBind","elementsToUnbind","me","plugins","attachUIListeners","parseValue","evt","elMeta","target","sourceMeta","action","parsedValue","actualName","prefixedName","addDefaultPrefix","publish","last","attachConversionListner","prop","convertedValue","deferred","autoUpdatePlugin","convertersToArray","conv","v","getConvertersFromAttr","attribute","withConv","getFConvertAttrVal","suffix","baseAttr","suffixAttr","getAllConverters","convertersAsPipes","whiteListedGenericAttributes","canUseFConvert","$parentEl","parents","resolvedConverters","parentConv","attrib","specified","commaRegex","topicsPart","mappedTopics","currentName","hasChannelDefined","DEFAULT_OPERATIONS_PREFIX","DEFAULT_VARIABLES_PREFIX","isUnprefixed","defaultPrefix","needsDefaultPrefix","hasDefaultPrefix","normalize","converter","acceptList","ret","matchConverter","isString","isRegExp","private","register","currentConverter","splice","getConverter","norm","Function","currentValue","convertArray","converterName","convertObject","mapValues","defaultconverters","c","parseFloat","plus","operand","Number","minus","multiplyBy","divideBy","s","upperCase","toUpperCase","lowerCase","toLowerCase","titleCase","txt","substr","parseLimitArgs","starting","limit","toRet","input","n","stripped","first","previous","size","src","pickEvery","startIndex","newfn","toArray","indexOfActualValue","newArgs","parseArgs","toCompare","trueVal","falseVal","valueToCompare","isNumber","isAllowedLeading","validPrefixes","checkValMatch","validStandalone","validFirstChars","validLastChars","isValidFirstChar","isValidLastChar","validRemainingChars","areRemainingCharactersValid","char","isMatch","parts","isNegative","floatMatcher","results","number","scales","roundTo","digits","round","pow","getDigits","ceil","log","LN10","TXT","numberTXT","toString","decimalSet","iTXT","addDecimals","decimals","minDecimals","hasCommas","hasDecimals","iDec","iChar","toADD","getSuffix","formatTXT","fixesTXT","format","isNaN","entityCodeMapping","code","formats","abs","sign","leftOfDecimal","d","lastIndexOf","isShortFormat","nextChar","leadingText","rightOfPrefix","shortFormatTest","shortFormatTestResult","valScale","floor","limitDigits","SUFFIX","valWithoutLeading","subFormats","preffix","formatted","greaterThan","greaterThanEqual","equalsNumber","lessThan","lessThanEqual","toBool","not","ifTrue","ifFalse","valueToFilterBy","except","valueToReject","any","some","every","node","currentHandler","defaultHandlers","default","offAttr","offAttrVal","offVal","onAttrVal","onVal","has","extendView","protoProps","staticProps","constructor","Surrogate","__super__","View","handlersList","attributeMatcher","nodeMatcher","matchAttr","matchExpr","attrMatch","matchNode","nodeFilter","attributeManager","attrFilter","noopAttr","eventNameFromAttr","eventName","nameSpacedEvent","defaultEventAttr","matching","preventDefault","elAnimatedMap","foreachAttr","stubbedTemplate","templateFn","$dummyEl","dataval","datakey","templateData","templated","templatedWithReferences","newNode","$newNode","append","isInitialAnim","$withAnimAttrs","children","empty","templateIdAttr","loopAttrHandler","nextUntil","remove","replaceWith","$dummyOldDiv","$removed","isEmpty","hasData","insertAfter","executeAndResolve","promisifiedFn","debounceAndMerge","debounceInterval","argumentsReducers","arrayReducer","newVal","queue","timer","mergeArgs","oldArgs","merged","newArg","reducer","debouncedFunction","call","clearTimeout","mergedArgs","pop","elClassesMap","deleteAddedClasses","addedClasses","removeClass","classAttr","addClass","booleanAttrHandler","showifHandler","hide","show","hideifHandler","checkboxAttrHandler","settableValue","isChecked","inputBindAttr","toAliasMap","getNewContent","currentContents","translateDataToInsertable","translateDataToTemplatable","templatedHTML","bindAttrHandler","extractAlias","bindTemplate","originalContents","aliasMap","originalName","AS_REGEX","asMatch","defaultAttr","isEnabled","MutationObserver","observer","mutations","mutation","added","addedNodes","removed","removedNodes","attributeName","mutconfig","attributeFilter","childList","subtree","characterData","publicApi","enable","observe","disable","disconnect","InterpolatableRoutableChannelManager","interpolatable","routable","DefaultChannelManager","defaultRouteHandlers","JSONRouteHandler","DomRouteHandler","EpicenterRouteHandler","routes","cm","makeSubs","cache","cacheBySubsId","sentDataBySubsId","copy","callbackSubscriber","subscription","checkAndNotifyBatch","matchingTopics","intersection","relevantDataFromPublish","cachedDataForSubs","knownDataForSubs","hasDataForAllTopics","checkAndNotify","needsThisTopic","isWildCard","getTopicsFromSubsList","subcriptionList","publishResponses","cb","token","olderLength","remaining","uniq","findBestHandler","matchOptions","thishandler","topicMapping","bestHandler","values","dataPt","lastHandler","response","isAlreadyInPublishableFormat","silentOptions","found","readOnlyOptions","isReadonly","warn","getOptions","SCENARIO_PREFIX","RUN_PREFIX","WORLD_PREFIX","sampleRunidLength","runidRegex","channelManagerContext","runidHandlerOpts","runidHandler","RunidRouteHandler","multiRunHandler","MultiRunRouteHandler","exposable","runManagerOpts","runManager","scenarioManager","rm","hasEnoughInfo","isMultiplayer","strategy","DefaultRunRouteHandler","WorldRouteHandler","scenarioManagerOpts","sm","ScenarioRouteHandler","epicenterRouter","RunManagerRouteHandler","rmOptions","manager","RunManager","$creationPromise","getRun","currentChannelOpts","currentRunChannel","RunRouteHandler","runRouteHandler","runMangerRouter","RunMetaRouteHandler","$runServicePromise","mergeAndSend","runMeta","requestedTopics","toSend","runService","cachedValues","loadPromise","load","toSave","save","res","mergeVariables","newval","RunVariablesRouteHandler","debouncedVariableQuery","debouncedFetchers","retriableFetch","knownTopics","variablesToFetch","difference","unsubscribedTopics","isUnsubscribed","isRemaining","isAutoFetchEnabled","missingVariables","variableData","query","catch","responseJSON","info","information","goodVariables","vName","baseName","isBad","names","RunOperationsRouteHandler","operationsResponse","serial","ScenarioManagerRouteHandler","ScenarioManager","baselinePromise","baseline","baselineOptions","currentRunPromise","runOptions","baselineHandler","currentRunHandler","scenarioManagerRouter","runid","runChannelFactory","knownRunIDServiceChannels","runChannel","MULTI_USER_PREFIX","USER_PREFIX","CONSENSUS_PREFIX","WorldRoutesHandler","runPromise","world","err","$runPromise","alreadyStubbedRunChannel","channelManager","worldChannel","getWorldChannel","updateConfig","currentRunHandlerOpts","$worldProm","getWorld","worldChannelMap","getChannelForWorld","worldid","am","AuthManager","handlerOptions","getSession","getCurrentUserSessionInfo","getChannel","usersRouteHandler","WorldUsersRouteHandler","usersHandler","currentUserRouteHandler","WorldCurrentUserRouteHandler","currentUserHandler","ConsensusManager","consensusRouteHandler","ConsensusRouteHandler","consensusHandler","worldRouteHandler","store","users","mark","userid","isOnline","u","userId","parsedUsersPromise","session","lastName","isMe","presenceSubsId","userids","PRESENCE","user","ps","Presence","markOnline","markOffline","stillNeedRoles","userFields","myUser","toNotify","field","isSubscribingToRole","ROLES","role","consensusProm","getConsensus","force","getCurrent","opnHandler","OperationsHandler","statusHandler","StatusHandler","status","isComplete","consensusManager","ConsensusOperationsHandler","actions","cs","submitActions","ConsensusStatusHandler","normalizePlayers","rolePlayerMap","playersForRole","playersWithRole","player","userName","normalizeConsensus","submitted","amWaiting","pending","normalizedConsensus","dataForTopics","TypeError","forceClose","topicParamMap","extractFiltersFromTopic","topicString","filters","filterParam","include","runs","debouncedFetch","subsMap","DOMRouteHandler","knownEls","domOptions","debouncedChangeHandler","elID","overrides","matchingEventOverride","changeEvent","toKill","subsidMap","subscribeInterpolator","dependencySubsId","newDependentId","existing","publishInterpolator","getDependencies","inner","interpolateWithDependencies","mergeInterpolatedTopicsWithData","originalTopics","interpolatedTopics","original","subscribeFn","onDependencyChange","interpolatedSubscribe","dependencies","innerSubsId","handleDependencyValueChange","dependenciesMeta","isSameData","outerSubsId","handleInterpolatedValueChange","actualData","actualMeta","toSendback","noop","publishInputs","valuesToInterpolate","ip","publishFunction","fetchFn","interpolatedPublishfunction","normalizedPublishInputs","handleDependencyChange","resolvedDependencies","interpolated","newPublishProm","allTopics","withRouter","BaseChannelManager","optsToPassOn","omit","rt"],"mappings":"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","file":"flow.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 17);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap ffe692c186d940ff333c","module.exports = _;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"_\"\n// module id = 0\n// module chunks = 0","module.exports = {\n    prefix: 'f',\n    binderAttr: 'f-bind',\n\n    events: {\n        /** UI Change to publish to the channel. */\n        trigger: 'update.f.ui',\n\n        /** Trigger with payload '{attrToUpdate: value}', for e.g. { bind: 34 }. This will run this through all the converts and pass it to attr handler. Useful to by-pass getting this from the model directly.  */\n        convert: 'f.convert',\n\n        /** On a bind or other flow-related error  */\n        error: 'f.error',\n    },\n\n    attrs: {\n        checkboxOffValue: 'data-off-value',\n        //Used by repeat attr handler to keep track of template after first evaluation\n        repeat: {\n            templateId: 'repeat-template-id' //don't prefix by f or dom-manager unbind will kill it\n        },\n    },\n\n    errorAttr: 'data-flow-error',\n    animation: {\n        addAttr: 'data-add',\n        changeAttr: 'data-update',\n        initialAttr: 'data-initial',\n    }\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/config.js","const CHANNEL_DELIMITER = ':';\n\nexport { default as silencable } from './silencable';\nexport { default as excludeReadOnly } from './exclude-read-only';\n\n/**\n * \n * @param {string} text\n * @returns {string}\n */\nexport function stripSuffixDelimiter(text) {\n    if (text && text.indexOf(CHANNEL_DELIMITER) === (text.length - 1)) {\n        text = text.replace(CHANNEL_DELIMITER, '');\n    }\n    return text;\n}\n\n/**\n * \n * @param {Publishable[]} dataArray \n * @param {string} prefix \n * @returns {Publishable[]} array with name prefixed\n */\nexport function mapWithPrefix(dataArray, prefix) {\n    if (!prefix) return dataArray;\n    return (dataArray || []).map(function (datapt) {\n        const name = (prefix + datapt.name).replace(/:$/, ''); //replace trailing delimiters\n        return $.extend(true, {}, datapt, { name: name });\n    });\n}\n\n/**\n * \n * @param {Function} callback \n * @param {string|string[]} prefixList\n * @returns {Function}\n */\nexport function withPrefix(callback, prefixList) {\n    const arr = [].concat(prefixList);\n\n    /**\n     * @param {Publishable[]} data\n     */\n    return function (data) {\n        arr.forEach(function (prefix) {\n            const mapped = mapWithPrefix(data, prefix);\n            callback(mapped);\n        });\n    };\n}\n\n/**\n * \n * @param {string[]} list \n * @param {string} prefix\n * @returns {string[]} Item with prefix removed\n */\nexport function unprefixTopics(list, prefix) {\n    if (!prefix) return list;\n    const unprefixed = list.map(function (item) {\n        return item.replace(prefix, '');\n    });\n    return unprefixed;\n}\n\n/**\n * \n * @param {Publishable[]} list \n * @param {string} prefix\n * @returns {Publishable[]} Item with prefix removed\n */\nexport function unprefix(list, prefix) {\n    if (!prefix) return list;\n    const unprefixed = list.map(function (item) {\n        if (item.name) {\n            return $.extend(true, {}, item, { name: item.name.replace(prefix, '') });\n        }\n        return item.replace(prefix, '');\n    });\n    return unprefixed;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/channel-router/utils/index.js","/* eslint-disable complexity */\nfunction toImplicitType(data) {\n    const objRegex = /^(?:\\{.*\\})$/;\n    const arrRegex = /^(?:\\[.*])$/;\n\n    let converted = data;\n    if (typeof data === 'string') {\n        converted = data.trim();\n\n        if (converted === 'true') {\n            converted = true;\n        } else if (converted === 'false') {\n            converted = false;\n        } else if (converted === 'null') {\n            converted = null;\n        } else if (converted === 'undefined') {\n            converted = '';\n        } else if (converted.charAt(0) === '\\'' || converted.charAt(0) === '\"') {\n            converted = converted.substring(1, converted.length - 1);\n        } else if ($.isNumeric(converted)) {\n            converted = +converted;\n        } else if (arrRegex.test(converted)) {\n            const bracketReplaced = converted.replace(/[[\\]]/g, '');\n            if (!bracketReplaced) return [];\n            const parsed = bracketReplaced.split(/,(?![^[]*])/).map((val)=> {\n                return toImplicitType(val);\n            });\n            return parsed;\n        } else if (objRegex.test(converted)) {\n            try {\n                converted = JSON.parse(converted);\n            } catch (e) {\n                console.error('toImplicitType: couldn\\'t convert', converted);\n            }\n        }\n    }\n    return converted;\n}\n\nfunction splitUnescapedCommas(str) {\n    const regex = /(\\\\.|[^,])+/g;\n    let m;\n\n    const op = [];\n    while ((m = regex.exec(str)) !== null) { //eslint-disable-line\n        // This is necessary to avoid infinite loops with zero-width matches\n        if (m.index === regex.lastIndex) {\n            regex.lastIndex++;\n        }\n        m.forEach(function (match, groupIndex) {\n            if (groupIndex === 0) {\n                op.push(match.replace('\\\\', ''));\n            }\n        });\n    }\n    return op;\n}\n\nfunction splitNameArgs(value) {\n    value = value.trim();\n    const fnName = value.split('(')[0];\n    const params = value.substring(value.indexOf('(') + 1, value.indexOf(')'));\n    const args = splitUnescapedCommas(params).map((p)=> p.trim());\n    return { name: fnName, args: args };\n}\n\n/**\n * @param  {string} value\n * @returns {{ name: string, value: any}[]}       [description]\n */\nfunction toPublishableFormat(value) {\n    const OPERATIONS_SEPERATOR = '&&';\n    const split = (value || '').split(OPERATIONS_SEPERATOR);\n    const listOfOperations = split.map(function (value) {\n        if (value && value.indexOf('=') !== -1) {\n            const split = value.split('=');\n            return { name: split[0].trim(), value: split[1].trim() };\n        }\n        const parsed = splitNameArgs(value);\n        return { name: parsed.name, value: parsed.args };\n    });\n    return listOfOperations;\n}\n\nexport { toImplicitType, toPublishableFormat, splitNameArgs };\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils/parse-utils.js","/**\n * \n * @param {Object} obj\n * @returns {Publishable[]}\n */\nexport function objectToPublishable(obj) {\n    var mapped = Object.keys(obj || {}).map(function (t) {\n        return { name: t, value: obj[t] };\n    });\n    return mapped;\n}\n\n/**\n * Converts arrays of the form [{ name: '', value: ''}] to {[name]: value}\n * @param {Publishable[]} arr\n * @param {Object} [mergeWith]\n * @returns {Object}\n */\nexport function publishableToObject(arr, mergeWith) {\n    var result = (arr || []).reduce(function (accum, topic) {\n        accum[topic.name] = topic.value;\n        return accum;\n    }, $.extend(true, {}, mergeWith));\n    return result;\n}\n\n/**\n * @typedef NormalizedParam\n * @property {Publishable[]} params\n * @property {Object} options\n */\n\n/**\n *\n * @param {string|Object|Array} topic \n * @param {*} publishValue \n * @param {Object} [options]\n * @returns {NormalizedParam}\n */\nexport function normalizeParamOptions(topic, publishValue, options) {\n    if (!topic) {\n        return { params: [], options: {} };\n    }\n    if ($.isPlainObject(topic)) {\n        return { params: objectToPublishable(topic), options: publishValue };\n    }\n    if (Array.isArray(topic)) {\n        return { params: topic, options: publishValue };\n    }\n    return { params: [{ name: topic, value: publishValue }], options: options };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/channel-utils.js","import { groupByHandlers, groupSequentiallyByHandlers, normalizeSubscribeResponse } from './utils/handler-utils';\nimport { unprefix, unprefixTopics, mapWithPrefix, silencable, excludeReadOnly } from './utils';\nimport { makePromise } from 'utils/general';\nimport _ from 'lodash';\n\n\n/**\n * Handle subscriptions\n * @param  {Handler[]} handlers Array of the form [{ match: function (){}, }]\n * @param  {Array<string>} topics   Array of strings\n * @param  {SubscribeOptions} [options]\n * @returns {Promise<Publishable[]>} Returns populated topics if available\n */\nexport function notifySubscribeHandlers(handlers, topics, options) {\n    const grouped = groupByHandlers(topics, handlers);\n    const promises = [];\n    grouped.filter((handler)=> handler.subscribeHandler).forEach(function (handler) {\n        const mergedOptions = $.extend(true, {}, handler.options, options);\n        const unprefixed = unprefixTopics(handler.data, handler.matched);\n        const promise = makePromise(()=> {\n            const subsResponse = handler.subscribeHandler(unprefixed, mergedOptions, handler.matched);\n            return subsResponse;\n        }).then((topicsWithData)=> {\n            const normalized = normalizeSubscribeResponse(topicsWithData, unprefixed);\n            const prefixed = mapWithPrefix(normalized, handler.matched);\n            return prefixed;\n        });\n        promises.push(promise);\n    });\n    return $.when.apply(null, promises).then(function () {\n        const arr = [].concat.apply([], arguments);\n        return arr;\n    });\n}\n\n/**\n * \n * @param {Handler[]} handlers \n * @param {Array<string>} recentlyUnsubscribedTopics\n * @param {Array<string>} remainingTopics \n */\nexport function notifyUnsubscribeHandlers(handlers, recentlyUnsubscribedTopics, remainingTopics) {\n    handlers = handlers.map(function (h, index) {\n        h.unsubsKey = index;\n        return h;\n    });\n\n    const unsubsGrouped = groupByHandlers(recentlyUnsubscribedTopics, handlers);\n    const remainingGrouped = groupByHandlers(remainingTopics, handlers);\n\n    unsubsGrouped.filter((h)=> h.unsubscribeHandler).forEach(function (handler) {\n        const unprefixedUnsubs = unprefixTopics(handler.data, handler.matched);\n        const matchingRemainingHandler = _.find(remainingGrouped, function (remainingHandler) {\n            return remainingHandler.unsubsKey === handler.unsubsKey;\n        });\n        const matchingTopicsRemaining = matchingRemainingHandler ? matchingRemainingHandler.data : [];\n        const unprefixedRemaining = unprefixTopics(matchingTopicsRemaining || [], handler.matched);\n        handler.unsubscribeHandler(unprefixedUnsubs, unprefixedRemaining);\n    });\n}\n/**\n * \n * @param {Handler[]} handlers \n * @param {Publishable[]} publishData \n * @param {PublishOptions} [options]\n * @returns {Promise}\n */\nexport function passthroughPublishInterceptors(handlers, publishData, options) {\n    const grouped = groupSequentiallyByHandlers(publishData, handlers);\n    let $initialProm = $.Deferred().resolve([]).promise();\n    grouped.forEach(function (handler) {\n        $initialProm = $initialProm.then(function (dataSoFar) {\n            const mergedOptions = $.extend(true, {}, handler.options, options);\n            const unprefixed = unprefix(handler.data, handler.matched);\n\n            const publishableData = excludeReadOnly(unprefixed, mergedOptions.readOnly);\n            if (!publishableData.length) {\n                return dataSoFar;\n            }\n\n            const result = handler.publishHandler ? handler.publishHandler(publishableData, mergedOptions, handler.matched) : publishableData;\n            const publishProm = $.Deferred().resolve(result).promise();\n            return publishProm.then(function (published) {\n                return silencable(published, mergedOptions.silent);\n            }).then(function (published) {\n                let mapped = mapWithPrefix(published, handler.matched);\n                if (handler.isDefault && handler.matched) {\n                    mapped = mapped.concat(published);\n                }\n                return mapped;\n            }).then(function (mapped) {\n                return [].concat(dataSoFar, mapped);\n            });\n        });\n    });\n    return $initialProm;\n}\n\n/**\n * Router\n * @param  {Handler[]} handlers\n * @param {Object} [options]\n * @param {Function} [notifier]\n * @returns {Router}\n */\nexport default function router(handlers, options, notifier) {\n    let myHandlers = (handlers || []).map((Handler)=> {\n        let handler = Handler;\n        if (_.isFunction(Handler)) {\n            handler = new Handler(options, notifier);\n            $.extend(this, handler.expose);\n        }\n        if (typeof handler.match === 'string') {\n            const matchString = handler.match;\n            handler.name = matchString;\n            handler.match = (t)=> t === matchString ? '' : false;\n        }\n        return handler;\n    });\n\n    const expose = myHandlers.reduce((accum, h)=> {\n        $.extend(true, accum, h.expose);\n        return accum;\n    }, {});\n\n    return {\n        expose: expose,\n        match: (topic)=> {\n            return myHandlers.reduce((match, handler)=> {\n                const matched = handler.match(topic);\n                if (match === false && matched !== false) {\n                    return '';\n                }\n                return match;\n            }, false);\n        },\n\n        /**\n         * @param {Array<string>} topics\n         * @param {SubscribeOptions} [options]\n         * @returns {Promise<Publishable[]>} Returns populated topics if available\n         */\n        subscribeHandler: function (topics, options) {\n            return notifySubscribeHandlers(myHandlers, topics, options);\n        },\n        /**\n         * @param {Array<string>} recentlyUnsubscribedTopics\n         * @param {Array<string>} remainingTopics\n         * @returns {void}\n         */\n        unsubscribeHandler: function (recentlyUnsubscribedTopics, remainingTopics) {\n            return notifyUnsubscribeHandlers(myHandlers, recentlyUnsubscribedTopics, remainingTopics);\n        },\n\n        /**\n         * @param {Publishable[]} data\n         * @param {PublishOptions} [options]\n         * @returns {Promise}\n         */\n        publishHandler: function (data, options) {\n            return passthroughPublishInterceptors(myHandlers, data, options);\n        },\n\n        addRoute: function (handler) {\n            if (!handler || !handler.match) {\n                throw Error('Handler does not have a valid `match` property');\n            }\n            handler.id = _.uniqueId('routehandler-');\n            myHandlers.unshift(handler);\n            return handler.id;\n        },\n        removeRoute: function (routeid) {\n            myHandlers = myHandlers.filter((handler)=> {\n                return handler.id !== routeid;\n            });\n        }\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/channel-router/index.js","const ROUTE_DELIMITER = ':';\n\n/**\n * \n * @param {string} prefix\n * @returns {matchFunction}\n */\nexport function matchPrefix(prefix) {\n    return function prefixMatcher(topic) {\n        const hasPrefix = topic.indexOf(prefix) === 0;\n        if (hasPrefix) return prefix;\n\n        const isOnlyPrefix = prefix.replace(/:/g, '') === topic;\n        if (isOnlyPrefix) return topic;\n\n        return false;\n    };\n}\n\n/**\n* \n* @param {string} prefix\n* @returns {matchFunction}\n*/\nexport function matchDefaultPrefix(prefix) {\n    return function defaultPrefixMatcher(topic, forcePrefix) {\n        const hasPrefix = topic.indexOf(prefix) === 0;\n        return (hasPrefix || forcePrefix) ? prefix : '';\n    };\n}\n\n/**\n * \n * @param {string} regex\n * @returns {matchFunction}\n */\nexport function matchRegex(regex) {\n    var toMatch = new RegExp('^' + regex + ROUTE_DELIMITER);\n    return function regexMatcher(topic) {\n        var match = topic.match(toMatch);\n        if (match && match.length) {\n            return match[0];\n        }\n        return false;\n    };\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/route-matchers.js","import { uniqueId, random as _random } from 'lodash';\n\nexport { makePromise, promisify } from './promise-utils';\nexport { default as debounceAndMerge } from './debounce-and-merge';\n\nexport function random(prefix, min, max) {\n    if (!min) {\n        min = parseInt(uniqueId(), 10);\n    }\n    if (!max) {\n        max = 100000; //eslint-disable-line no-magic-numbers\n    }\n    var rnd = _random(min, max, false) + '';\n    if (prefix) {\n        rnd = prefix + rnd;\n    }\n    return rnd;\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils/general/index.js","import MetaRouteHandler from './run-meta-route-handler';\nimport VariablesRouteHandler from './run-variables-route-handler';\nimport OperationsRouteHandler from './run-operations-route-handler';\n\nimport router from 'channels/channel-router';\nimport { withPrefix, silencable } from 'channels/channel-router/utils';\nimport { matchPrefix, matchDefaultPrefix } from 'channels/route-handlers/route-matchers';\n\nimport _ from 'lodash';\nimport { objectToPublishable } from 'channels/channel-utils';\n\nexport const VARIABLES_PREFIX = 'variables:';\nexport const META_PREFIX = 'meta:';\nexport const OPERATIONS_PREFIX = 'operations:';\n\n/**\n * \n * @param {Publishable[]} result \n * @param {string[]} ignoreOperations \n * @returns {boolean}\n */\nexport function _shouldFetch(result, ignoreOperations) {\n    const filtered = (result || []).filter((r)=> {\n        const name = r.name || '';\n        const isIgnored = (ignoreOperations || []).indexOf(name.replace(OPERATIONS_PREFIX, '')) !== -1;\n        const isVariable = name.indexOf(VARIABLES_PREFIX) === 0;\n        const isOperation = name.indexOf(OPERATIONS_PREFIX) === 0;\n\n        return isVariable || (isOperation && !isIgnored);\n    });\n    return filtered.length > 0;\n}\n\nconst RunService = F.service.Run;\nexport default function GenericRunRouteHandler(config, notifier) {\n    const defaults = {\n        serviceOptions: {},\n        channelOptions: {\n            variables: {\n                autoFetch: true,\n                debounce: 200,\n                silent: false,\n                readOnly: false,\n            },\n            operations: {\n                readOnly: false,\n                silent: false,\n            },\n            meta: {\n                silent: false,\n                autoFetch: true,\n                readOnly: ['id', 'created', 'account', 'project', 'model', 'lastModified']\n            },\n        }\n    };\n    const opts = $.extend(true, {}, defaults, config);\n\n    const serviceOptions = _.result(opts, 'serviceOptions');\n\n    let $initialProm = null;\n    if (serviceOptions instanceof RunService) {\n        $initialProm = $.Deferred().resolve(serviceOptions).promise();\n    } else if (serviceOptions.then) {\n        $initialProm = serviceOptions;\n    } else {\n        const rs = new RunService(serviceOptions);\n        $initialProm = $.Deferred().resolve(rs).promise();\n    }\n\n    const operationNotifier = withPrefix(notifier, OPERATIONS_PREFIX);\n    const variableNotifier = withPrefix(notifier, [VARIABLES_PREFIX, '']);\n\n    const metaHandler = new MetaRouteHandler($initialProm, withPrefix(notifier, META_PREFIX));\n    const operationsHandler = new OperationsRouteHandler($initialProm, operationNotifier);\n    const variablesHandler = new VariablesRouteHandler($initialProm, variableNotifier);\n\n    let subscribed = false;\n    const channelOptions = opts.channelOptions;\n    $initialProm.then((rs)=> {\n        if (rs.channel && !subscribed) {\n            subscribed = true;\n            const { TOPICS } = rs.channel;\n            const subscribeOpts = { includeMine: false };\n            //TODO: Provide subscription fn to individual channels and let them handle it?\n            rs.channel.subscribe(TOPICS.RUN_VARIABLES, (data, meta)=> {\n                const publishable = objectToPublishable(data);\n                const excludingSilenced = silencable(publishable, channelOptions.variables.silent);\n                if (!excludingSilenced.length) {\n                    return;\n                }\n                variablesHandler.notify(excludingSilenced, meta);\n                variablesHandler.fetch();//Variables channel #notify also does a fetch, but this is not supposed to know about that. Debouncing will take care of duplicate fetches anyway.\n            }, this, subscribeOpts);\n            rs.channel.subscribe(TOPICS.RUN_OPERATIONS, (data, meta)=> {\n                const publishable = [{ name: data.name, value: data.result }];\n                const excludingSilenced = silencable(publishable, channelOptions.operations.silent);\n                if (!excludingSilenced.length) {\n                    return;\n                }\n                operationsHandler.notify(excludingSilenced, meta);\n                variablesHandler.fetch();\n            }, this, subscribeOpts);\n            rs.channel.subscribe(TOPICS.CONSENSUS_UPDATE, (consensus, meta)=> {\n                if (consensus.closed) {\n                    variablesHandler.fetch(); \n                    // I should also do operationsHandler.notify but I don't know what to notify them about\n                    //Just remove the 'include Mine' check for operations? That's just cached anyway\n                }\n            }, this, { includeMine: true });\n            rs.channel.subscribe(TOPICS.RUN_RESET, (data, meta)=> {\n                const publishable = [{ name: 'reset', value: data }];\n                const excludingSilenced = silencable(publishable, channelOptions.operations.silent);\n                if (!excludingSilenced.length) {\n                    return;\n                }\n                operationsHandler.notify(excludingSilenced, meta);\n            }, this, subscribeOpts);\n\n            // rs.channel.subscribe('', (data, meta)=> {\n            //     console.log('everything', data, meta);\n            // });\n        }\n    });\n\n    const handlers = [\n        $.extend({}, metaHandler, { \n            name: 'meta',\n            match: matchPrefix(META_PREFIX),\n            options: opts.channelOptions.meta,\n        }),\n        $.extend({}, operationsHandler, { \n            name: 'operations',\n            match: matchPrefix(OPERATIONS_PREFIX),\n            options: opts.channelOptions.operations,\n        }),\n        $.extend({}, variablesHandler, { \n            isDefault: true,\n            name: 'variables',\n            match: matchDefaultPrefix(VARIABLES_PREFIX),\n            options: opts.channelOptions.variables,\n        }),\n    ];\n\n    // router.addRoute(prefix('meta:'), metaChannel, opts.channelOptions.meta);\n\n    const runRouter = router(handlers);\n    const oldhandler = runRouter.publishHandler;\n    runRouter.publishHandler = function (publishable) {\n        const prom = oldhandler.apply(router, arguments);\n        return prom.then(function (result) { //all the silencing will be taken care of by the router\n            const shouldFetch = _shouldFetch(result, ['reset']);\n            if (shouldFetch) {\n                const excludeFromFetch = result.map((r)=> r.name); //This was just published, no need to get the value again\n                variablesHandler.fetch({ exclude: excludeFromFetch });\n            }\n            return result;\n        });\n    };\n    return runRouter;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/epicenter-route-handlers/run-route-handler/index.js","export function _findMostConsequtive(arr, match) {\n    const reduced = arr.reduce((accum, val)=> {\n        if (val === match) {\n            if (accum.prev === match) {\n                accum.count = accum.count + 1;\n            } else {\n                accum.count = 1;\n            }\n        }\n        accum.maxCount = Math.max(accum.maxCount, accum.count);\n        accum.prev = val;\n        return accum;\n    }, { prev: null, count: 0, maxCount: 0 });\n    return reduced.maxCount;\n}\n\nfunction buildDiffArray(currentcontents, newContents) {\n    return newContents.map((contents, index)=> {\n        const isSame = contents === currentcontents[index]; \n        return isSame;\n    });\n}\n\nfunction fill(count, val) {\n    const a = [];\n    for (let i = 0; i < count; i++) {\n        a.push(val);\n    }\n    return a;\n}\n\nfunction elToContents(el) {\n    //ignore data attributes for comparison\n    return el.outerHTML\n        .replace(/\\s?data-[a-zA-Z]*=['\"][a-zA-Z0-9]*['\"]/g, '')\n        .replace(/\\s\\s/g, ' ').trim();\n}\n\nfunction elementsToContents($els) {\n    return $els.map((index, child)=> {\n        return elToContents(child);\n    }).get();\n}\n\nconst defaults = {\n    addAttr: 'data-add',\n    changeAttr: 'data-update',\n    initialAttr: 'data-initial',\n};\n\n/**\n * Compares 2 lists and Adds add or update classes\n * @param {JQuery<HTMLElement>} $currentEls existing elements\n * @param {JQuery<HTMLElement>} $newEls   new elements\n * @param {boolean} isInitial check if this is initial data or it's updating\n * @param {{ addAttr: string, changeAttr: string}} [options]\n * @returns {JQuery<HTMLElement>} elements with updated attributes\n */\nexport function addChangeClassesToList($currentEls, $newEls, isInitial, options) {\n    const opts = $.extend({}, defaults, options);\n\n    let currentcontents = elementsToContents($currentEls);\n    const newContents = elementsToContents($newEls);\n    const reversedContents = currentcontents;\n\n    //Guess if data was added to end or beginning of array\n    const diffFromEnd = buildDiffArray(currentcontents, newContents);\n    const diffFromBeginning = buildDiffArray(reversedContents.slice().reverse(), newContents.slice().reverse());\n\n    const endMatches = _findMostConsequtive(diffFromEnd, true);\n    const beginningMatches = _findMostConsequtive(diffFromBeginning, true);\n\n    const placeHoldersCount = newContents.length - currentcontents.length;\n    const placeHolders = fill(placeHoldersCount, undefined);\n\n    if (beginningMatches <= endMatches) {\n        currentcontents = currentcontents.concat(placeHolders);\n    } else {\n        currentcontents = placeHolders.concat(currentcontents);\n    }\n\n    for (let i = 0; i < newContents.length; i++) {\n        const $el = $newEls.eq(i);\n        const curr = currentcontents[i];\n        $el.removeAttr(opts.initialAttr);\n\n        const contents = elToContents($el.get(0));\n        if (curr === undefined) {\n            $el.attr({\n                [opts.addAttr]: true,\n                [opts.initialAttr]: isInitial || null\n            });\n            $el.removeAttr(opts.changeAttr);\n        } else if (curr !== contents) {\n            $el.attr({\n                [opts.changeAttr]: true,\n                [opts.initialAttr]: isInitial || null\n            });\n            $el.removeAttr(opts.addAttr);\n        } else {\n            $el.removeAttr(`${opts.addAttr} ${opts.changeAttr}`);\n        }\n    }\n\n    return $newEls;\n}\n\nexport function addContentAndAnimate($el, newValue, isInitial, options) {\n    const opts = $.extend({}, defaults, options);\n    const current = $el.html().trim();\n\n    $el.removeAttr(`${opts.changeAttr} ${opts.initialAttr}`);\n    if (current === `${newValue}`.trim()) {\n        return $el;\n    }\n\n    $el.html(newValue);\n    setTimeout(function () {\n        $el.attr({\n            [opts.changeAttr]: true,\n            [opts.initialAttr]: isInitial || null //jquery removes if set to null\n        });\n    }, 0); //need this to trigger animation\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils/animation.js","import { uniqueId } from 'lodash';\n\nconst CURRENT_INDEX_KEY = 'current-index';\nconst CURRENT_INDEX_ATTR = `data-${CURRENT_INDEX_KEY}`;\n\nexport function getKnownDataForEl($el) {\n    const closestKnownDataEl = $el.closest(`[${CURRENT_INDEX_ATTR}]`);\n    let knownData = {};\n    if (closestKnownDataEl.length) {\n        knownData = closestKnownDataEl.data(CURRENT_INDEX_KEY);\n    }\n    return knownData;\n}\nexport function updateKnownDataForEl($el, data) {\n    $el.attr(CURRENT_INDEX_ATTR, JSON.stringify(data));\n}\nexport function removeKnownData($el) {\n    $el.removeAttr(CURRENT_INDEX_ATTR);\n}\n\nexport function getTemplateTags(template) {\n    template = template.replace(/&lt;/g, '<').replace(/&gt;/g, '>');\n    const templateTagsUsed = template.match(/<%[=-]?([\\s\\S]+?)%>/g);\n    return templateTagsUsed || [];\n}\nexport function isTemplated(template) {\n    return getTemplateTags(template).length > 0;\n}\n\n\nexport function findMissingReferences(template, knownDataKeys) {\n    function isKnownTag(tag, knownTags) {\n        const match = knownDataKeys.find((key)=> {\n            const regex = new RegExp('\\\\b' + key + '\\\\b');\n            return regex.test(tag);\n        });\n        return match;\n    }\n\n    template = template.replace(/&lt;/g, '<').replace(/&gt;/g, '>');\n    const missingReferences = {};\n    const templateTagsUsed = getTemplateTags(template);\n    if (templateTagsUsed) {\n        templateTagsUsed.forEach(function (tag) {\n            if (tag.match(/\\w+/) && !isKnownTag(tag, knownDataKeys)) {\n                let refKey = missingReferences[tag];\n                if (!refKey) {\n                    refKey = uniqueId('no-ref');\n                    missingReferences[tag] = refKey;\n                }\n            }\n        });\n    }\n    return missingReferences;\n}\n\nfunction refToMarkup(refKey) {\n    return '<!--' + refKey + '-->';\n}\n\nexport function stubMissingReferences(template, missingReferences) {\n    template = template.replace(/&lt;/g, '<').replace(/&gt;/g, '>');\n\n    Object.keys(missingReferences).forEach((tag)=> {\n        const refId = missingReferences[tag];\n        const r = new RegExp(tag, 'g');\n        template = template.replace(r, refToMarkup(refId));\n    });\n    return template;\n}\n\nexport function addBackMissingReferences(template, missingReferences) {\n    Object.keys(missingReferences).forEach((originalTemplateVal)=> {\n        const commentRef = missingReferences[originalTemplateVal];\n        const r = new RegExp(refToMarkup(commentRef), 'g');\n        template = template.replace(r, originalTemplateVal);\n    });\n\n    return template;\n}\n\n\nconst elTemplateMap = new WeakMap();\nexport function getOriginalContents($el, resolver) {\n    const el = $el.get(0);\n    let originalHTML = elTemplateMap.get(el);\n    if (!originalHTML && resolver) {\n        originalHTML = resolver($el).replace(/&lt;/g, '<').replace(/&gt;/g, '>');\n        elTemplateMap.set(el, originalHTML);\n    }\n    return originalHTML;\n}\nexport function clearOriginalContents($el) {\n    const el = $el.get(0);\n    elTemplateMap.delete(el);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attribute-manager/attr-template-utils.js","/*eslint no-undef: 0*/\nimport { binderAttr, events } from '../../config';\nimport BaseView from './default-node';\n\nexport default BaseView.extend({\n    propertyHandlers: [],\n\n    uiChangeEvent: 'change.f-node-event',\n    getUIValue: function () {\n        return this.$el.val();\n    },\n\n    removeEvents: function () {\n        this.$el.off(this.uiChangeEvent);\n    },\n\n    initialize: function (options) {\n        const propName = this.$el.data(binderAttr);\n        if (options && options.triggerChangeOn) {\n            this.uiChangeEvent = options.triggerChangeOn;\n        }\n        if (propName) {\n            const changeHandler = function () {\n                const val = this.getUIValue();\n                const payload = [{ name: propName, value: val }];\n                \n                this.$el.trigger(events.trigger, { data: payload, source: 'bind', restoreOriginal: val.length === 0 });\n            }.bind(this);\n\n            const handlerDebounceTime = 200;\n            const debouncedHandler = _.debounce(changeHandler, handlerDebounceTime);\n            const handler = this.uiChangeEvent.indexOf('key') !== -1 ? debouncedHandler : changeHandler;\n            this.$el.off(this.uiChangeEvent).on(this.uiChangeEvent, handler);\n        }\n        BaseView.prototype.initialize.apply(this, arguments);\n    }\n}, { selector: 'input, select, textarea' });\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/node-manager/default-input-node.js","'use strict';\n\nvar BaseView = require('../../utils/base-view');\n\nmodule.exports = BaseView.extend({\n    propertyHandlers: [\n\n    ],\n\n    initialize: function () {\n    }\n}, { selector: '*' });\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/node-manager/default-node.js","const IN_OF_REGEX = /\\((.*)\\) (?:in|of)\\s+(.*)/;\nconst KEY_VALUE_REGEX = /(.*),(.*)/;\n\n/**\n * @param {string} attrVal \n * @returns {string}\n */\nexport function extractVariableName(attrVal) {\n    const inMatch = attrVal.trim().match(IN_OF_REGEX);\n    const varName = inMatch ? inMatch[2] : attrVal;\n    return varName.trim();\n}\n\n/**\n * @param {string} attrVal \n * @returns {string}\n */\nexport function parseKeyAlias(attrVal) {\n    const inMatch = attrVal.match(IN_OF_REGEX);\n    if (!inMatch) {\n        return undefined;\n    }\n    const itMatch = inMatch[1].match(KEY_VALUE_REGEX);\n    const alias = itMatch ? itMatch[1].trim() : undefined;\n    return alias;\n}\n\n/**\n * @param {string} attrVal \n * @returns {string}\n */\nexport function parseValueAlias(attrVal) {\n    const inMatch = attrVal.match(IN_OF_REGEX);\n    if (!inMatch) {\n        return undefined;\n    }\n    const itMatch = inMatch[1].match(KEY_VALUE_REGEX);\n    const alias = itMatch ? itMatch[2] : inMatch[1];\n    return alias.trim();\n}\n\n\n//Public exports\n\nexport function aliasesFromTopics(topics, value) {\n    const relevantTopic = topics[0]; //doesn't support multiple topics\n\n    const defaultKey = $.isPlainObject(value) ? 'key' : 'index';\n    const keyAlias = relevantTopic.keyAlias || defaultKey;\n    const valueAlias = relevantTopic.valueAlias || 'value';\n\n    return { keyAlias: keyAlias, valueAlias: valueAlias };\n}\nexport function parseTopics(topics) {\n    const attrVal = topics[0].name; //doesn't support multiple topics\n    return [{\n        name: extractVariableName(attrVal),\n        keyAlias: parseKeyAlias(attrVal),\n        valueAlias: parseValueAlias(attrVal),\n    }];\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attribute-manager/attributes/loop-attrs/loop-attr-utils.js","import { isFunction } from 'lodash';\n\n/**\n * @param {any} val \n * @returns {Promise}\n */\nexport function makePromise(val) {\n    //Can be replaced with Promise.resolve when we drop IE11;\n    // if (isFunction(val)) {\n    //     return Promise.resolve(val());\n    // }\n    // return Promise.resolve(val);\n    if (val && val.then) {\n        return val;\n    }\n    const $def = $.Deferred();\n    if (isFunction(val)) {\n        try {\n            const toReturn = val();\n            if (toReturn && toReturn.then) {\n                return toReturn.then((r)=> $def.resolve(r), ((e)=> $def.reject(e)));\n            }\n            $def.resolve(toReturn);\n        } catch (e) {\n            $def.reject(e);\n        }\n    } else {\n        $def.resolve(val);\n    }\n    return $def.promise();\n}\n\n/**\n * \n * @param {function(*)} fn \n * @returns {function(...any): Promise}\n */\nexport function promisify(fn) {\n    if (!isFunction(fn)) {\n        throw new Error(`Promisify requires a function, received ${typeof fn}`);\n    }\n    /**\n     * @param {...*} args \n     * @returns {Promise}\n     */\n    return function promisifiedFunction(args) {\n        const $def = $.Deferred();\n        try {\n            const toReturn = fn.apply(fn, arguments);\n            if (toReturn && toReturn.then) {\n                return toReturn.then((r)=> {\n                    return $def.resolve(r);\n                }, (e)=> {\n                    return $def.reject(e);\n                });\n            } else {\n                $def.resolve(toReturn);\n            }\n        } catch (e) {\n            $def.reject(e);\n        }\n        return $def.promise();\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils/general/promise-utils.js","export function makeConsensusService(consensisAPIResponse) {\n    return new window.F.service.Consensus({\n        name: consensisAPIResponse.stage,\n        consensusGroup: consensisAPIResponse.name,\n        worldId: consensisAPIResponse.worldId,\n    });\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/epicenter-route-handlers/world-route-handler/consensus-route-handler/consensus-utils.js","var interpolationRegex = /<(.*?)>/g;\n/**\n *  \n * @param {string} topic topic to extract dependencies from\n * @returns {string[]} dependencies\n */\nexport function extractDependencies(topic) {\n    var deps = (topic.match(interpolationRegex) || []).map((val)=> {\n        return val.substring(1, val.length - 1); \n    });\n    return deps;\n}\n\n/**\n * @param {string} topic topic with dependencies\n * @param {{string: any}} data object with values of dependencies\n * @returns {string} interpolated string\n */\nexport function interpolateWithValues(topic, data) {\n    var interpolatedTopic = topic.replace(interpolationRegex, (match, dependency)=> {\n        var val = data[dependency];\n        var toReplace = Array.isArray(val) ? val[val.length - 1] : val;\n        return toReplace;\n    });\n    return interpolatedTopic;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/channel-manager-enhancements/interpolatable/interpolatable-utils.js","import domManager from './dom/dom-manager';\n\nimport ChannelManager from 'channels/configured-channel-manager';\nimport config from 'config';\n\nimport * as utils from './utils';\n\nconst Flow = {\n    dom: domManager,\n    utils: utils,\n    initialize: function (config) {\n        const model = $('body').data('f-model');\n        const defaults = {\n            channel: {\n                //FIXME: Defaults can't be here..\n                defaults: {\n                    run: {\n                        model: model,\n                    }\n                },\n            },\n            dom: {\n                root: 'body',\n                autoBind: true\n            }\n        };\n\n        const options = $.extend(true, {}, defaults, config);\n   \n        if (config && config.channel && (config.channel instanceof ChannelManager)) {\n            this.channel = config.channel;\n        } else {\n            this.channel = new ChannelManager(options.channel);\n        }\n\n        const prom = domManager.initialize($.extend(true, {\n            channel: this.channel\n        }, options.dom));\n        \n        this.channel.subscribe('operations:reset', function () {\n            domManager.unbindAll();\n            domManager.bindAll();\n        });\n\n        return prom;\n    }\n};\nFlow.ChannelManager = ChannelManager;\nFlow.constants = config;\n//set by grunt\nif (RELEASE_VERSION) Flow.version = RELEASE_VERSION; //eslint-disable-line no-undef\nexport default Flow;\n\n\n\n// WEBPACK FOOTER //\n// ./src/flow.js","import { getConvertersForEl, getChannelForAttribute, getChannelConfigForElement, parseTopicsFromAttributeValue } from './dom-manager-utils/dom-parse-helpers';\n\nimport { addPrefixToTopics, addDefaultPrefix } from './dom-manager-utils/dom-channel-prefix-helpers';\nimport { toImplicitType } from 'utils/parse-utils';\n\nimport { pick, isEqual } from 'lodash';\n\nimport { prefix, errorAttr, events, animation } from '../config';\n\nimport converterManager from './converter-manager';\nimport nodeManager from './node-manager';\nimport attrManager from './attribute-manager';\nimport autoUpdatePlugin from './plugins/auto-update-bindings';\n\nexport default (function () {\n    //Jquery selector to return everything which has a f- property set\n    $.expr.pseudos[prefix] = function (el) {\n        if (!el || !el.attributes) {\n            return false;\n        }\n        for (let i = 0; i < el.attributes.length; i++) {\n            const attr = el.attributes[i].nodeName;\n            if (attr.indexOf('data-' + prefix) === 0) {\n                return true;\n            }\n        }\n        return false;\n    };\n\n    /**\n     * @param {JQuery<HTMLElement>} root\n     * @returns {JQuery<HTMLElement>}\n     */\n    function getMatchingElements(root) {\n        const $root = $(root);\n        let matchedElements = $root.find(':' + prefix);\n        if ($root.is(':' + prefix)) {\n            matchedElements = matchedElements.add($root);\n        }\n        return matchedElements;\n    }\n\n    /**\n     * @param {JQuery<HTMLElement> | HTMLElement} element\n     * @param {*} [context]\n     * @returns {HTMLElement}\n     */\n    function getElementOrError(element, context) {\n        const el = (element instanceof $) ? element.get(0) : element;\n        if (!el || !el.nodeName) {\n            console.error(context, 'Expected to get DOM Element, got ', element);\n            throw new Error(context + ': Expected to get DOM Element, got' + (typeof element));\n        }\n        return el;\n    }\n\n    //Unbind utils\n    function triggerError($el, e) {\n        let msg = e.message || e;\n        if ($.isPlainObject(msg)) {\n            msg = JSON.stringify(msg);\n        }\n        $el.attr(errorAttr, msg).trigger(events.error, e);\n    }\n    function unbindAllAttributes(domEl) {\n        const $el = $(domEl);\n        $(domEl.attributes).each(function (index, nodeMap) {\n            let attr = nodeMap.nodeName;\n            const wantedPrefix = 'data-f-';\n            if (attr.indexOf(wantedPrefix) === 0) {\n                attr = attr.replace(wantedPrefix, '');\n                const handler = attrManager.getHandler(attr, $el);\n                if (handler.unbind) {\n                    handler.unbind(attr, $el);\n                }\n            }\n        });\n    }\n    function unbindAllNodeHandlers(domEl) {\n        const $el = $(domEl);\n        //FIXME: have to readd events to be able to remove them. Ugly\n        const Handler = nodeManager.getHandler($el);\n        const h = new Handler.handle({\n            el: domEl\n        });\n        if (h.removeEvents) {\n            h.removeEvents();\n        }\n    }\n    function removeAllSubscriptions(subscriptions, channel, el) {\n        [].concat(subscriptions).forEach(function (subs) {\n            try {\n                channel.unsubscribe(subs);\n            } catch (e) {\n                triggerError(el, e);\n            }\n        });\n    }\n\n\n    const publicAPI = {\n\n        nodes: nodeManager,\n        attributes: attrManager,\n        converters: converterManager,\n\n        matchedElements: new Map(),\n\n        /**\n         * Unbind the element; unsubscribe from all updates on the relevant channels.\n         *\n         * @param {JQuery<HTMLElement> | HTMLElement} element The element to remove from the data binding.\n         * @param {Channel} channel (Optional) The channel from which to unsubscribe. Defaults to the [variables channel](../channels/variables-channel/).\n         * @returns {void}\n         */\n        unbindElement: function (element, channel) {\n            if (!channel) {\n                channel = this.options.channel;\n            }\n            const domEl = getElementOrError(element);\n            const $el = $(element);\n            const existingData = this.matchedElements.get(domEl);\n            if (!$el.is(':' + prefix) || !existingData) {\n                return;\n            }\n            this.matchedElements.delete(element);\n            const subscriptions = Object.keys(existingData).reduce((accum, a)=> {\n                const subsid = existingData[a].subscriptionId;\n                if (subsid) accum.push(subsid);\n                return accum;\n            }, []);\n\n            unbindAllNodeHandlers(domEl);\n            unbindAllAttributes(domEl);\n            removeAllSubscriptions(subscriptions, channel, $el);\n\n            const animAttrs = Object.keys(animation).join(' ');\n            $el.removeAttr(animAttrs);\n\n            Object.keys($el.data()).forEach(function (key) {\n                if (key.indexOf('f-') === 0 || key.match(/^f[A-Z]/)) {\n                    $el.removeData(key);\n                }\n            });\n        },\n\n        /**\n         * Bind the element: subscribe from updates on the relevant channels.\n         *\n         * @param {HTMLElement | JQuery<HTMLElement>} element The element to add to the data binding.\n         * @param {Channel} channel (Optional) The channel to subscribe to. Defaults to the [run channel](../channels/run-channel/).\n         * @returns {void}\n         */\n        bindElement: function (element, channel) {\n            const opts = this.options || {};\n            if (!channel) {\n                channel = opts.channel;\n            }\n            // this.unbindElement(element); //unbind actually removes the data,and jquery doesn't refetch when .data() is called..\n            const domEl = getElementOrError(element);\n            const $el = $(domEl);\n            const isExcluded = opts.exclude && $el.is(opts.exclude);\n            if (!$el.is(`:${prefix}`) || isExcluded) {\n                return;\n            }\n\n            //Send to node manager to handle ui changes\n            const changeEventOverrides = opts.uiChangeEvents || {};\n            const triggerSelector = Object.keys(changeEventOverrides).find((selector)=> {\n                return $el.is(selector);\n            });\n            const matchingEvent = triggerSelector && changeEventOverrides[triggerSelector];\n            const Handler = nodeManager.getHandler($el);\n            new Handler.handle({\n                el: domEl,\n                triggerChangeOn: matchingEvent\n            });\n\n            const filterPrefix = `data-${prefix}-`;\n            const attrList = {};\n            $(domEl.attributes).each(function (index, nodeMap) {\n                let attr = nodeMap.nodeName;\n                if (attr.indexOf(filterPrefix) !== 0) {\n                    return;\n                }\n                attr = attr.replace(filterPrefix, '');\n\n                const attrVal = nodeMap.value;\n                let topics = parseTopicsFromAttributeValue(attrVal);\n\n                const handler = attrManager.getHandler(attr, $el);\n                if (handler && handler.init) {\n                    handler.init(attr, topics, $el);\n                }\n                if (topics.length && handler && handler.parse) {\n                    topics = [].concat(handler.parse(topics));\n                }\n\n                const channelPrefix = getChannelForAttribute($el, attr);\n                topics = addPrefixToTopics(topics, channelPrefix);\n\n                const converters = getConvertersForEl($el, attr);\n                attrList[attr] = {\n                    channelPrefix: channelPrefix,\n                    topics: topics,\n                    converters: converters, //Store once instead of calculating on demand. Avoids having to parse through dom every time\n                };\n            });\n            //Need this to be set before subscribing or callback maybe called before it's set\n            this.matchedElements.set(domEl, attrList);\n\n            const channelConfig = getChannelConfigForElement(domEl);\n            const attrsWithSubscriptions = Object.keys(attrList).reduce((accum, name)=> {\n                const attr = attrList[name];\n                const { topics, channelPrefix } = attr;\n                if (!topics.length) {\n                    accum[name] = attr;\n                    return accum;\n                }\n\n                const subsOptions = $.extend({\n                    batch: true,\n                    onError: (e)=> {\n                        console.error('DomManager: Subscription error', domEl, e);\n                        triggerError($el, e);\n                    }\n                }, channelConfig);\n                const subscribableTopics = topics.map((t)=> t.name);\n                const subsid = channel.subscribe(subscribableTopics, (data, meta)=> {\n                    if (meta && isEqual(data, meta.previousData)) {\n                        return;\n                    }\n                    const toConvert = {};\n                    if (subscribableTopics.length === 1) { //If I'm only interested in 1 thing pass in value directly, else make a map;\n                        toConvert[name] = data[subscribableTopics[0]];\n                    } else {\n                        const dataForAttr = pick(data, subscribableTopics) || {};\n                        toConvert[name] = Object.keys(dataForAttr).reduce((accum, key)=> {\n                            //If this was through a auto-prefixed channel attr return what was bound\n                            const toReplace = new RegExp(`^${channelPrefix}:`);\n                            const k = channelPrefix ? key.replace(toReplace, '') : key;\n                            accum[k] = dataForAttr[key];\n                            return accum;\n                        }, {});\n                    }\n                    $el.removeAttr(errorAttr).trigger(events.convert, toConvert);\n                }, subsOptions);\n\n                accum[name] = Object.assign({}, attr, { subscriptionId: subsid });\n                return accum;\n            }, {});\n\n            this.matchedElements.set(domEl, attrsWithSubscriptions);\n        },\n\n        /**\n         * Bind all provided elements.\n         *\n         * @param  {JQuery<HTMLElement> | HTMLElement[]} [elementsToBind] (Optional) If not provided, binds all matching elements within default root provided at initialization.\n         * @returns {void}\n         */\n        bindAll: function (elementsToBind) {\n            if (!elementsToBind) {\n                elementsToBind = getMatchingElements(this.options.root);\n            } else if (!Array.isArray(elementsToBind)) {\n                elementsToBind = getMatchingElements(elementsToBind);\n            }\n\n            //parse through dom and find everything with matching attributes\n            $.each(elementsToBind, (index, element)=> {\n                this.bindElement(element, this.options.channel);\n            });\n        },\n        /**\n         * Unbind provided elements.\n         *\n         * @param  {JQuery<HTMLElement> | HTMLElement[]} [elementsToUnbind] (Optional) If not provided, unbinds everything.\n         * @returns {void}\n         */\n        unbindAll: function (elementsToUnbind) {\n            const me = this;\n            if (!elementsToUnbind) {\n                elementsToUnbind = [];\n                this.matchedElements.forEach((val, key)=> {\n                    elementsToUnbind.push(key);\n                });\n            } else if (!Array.isArray(elementsToUnbind)) {\n                elementsToUnbind = getMatchingElements(elementsToUnbind);\n            }\n            $.each(elementsToUnbind, function (index, element) {\n                me.unbindElement(element, me.options.channel);\n            });\n        },\n\n        plugins: {},\n\n        /**\n         * Initialize the DOM Manager to work with a particular HTML element and all elements within that root. Data bindings between individual HTML elements and the model variables specified in the attributes will happen via the channel.\n         *\n         * @param {Object} options (Optional) Overrides for the default options.\n         * @param {string} options.root The root HTML element being managed by this instance of the DOM Manager. Defaults to `body`.\n         * @param {Object} options.channel The channel to communicate with. Defaults to the Channel Manager from [Epicenter.js](../../../api_adapters/).\n         * @param {boolean} options.autoBind If `true` (default), any variables added to the DOM after `Flow.initialize()` has been called will be automatically parsed, and subscriptions added to channels. Note, this does not work in IE versions < 11.\n         * @returns {Promise}\n         */\n        initialize: function (options) {\n            const defaults = {\n                /**\n                 * Root of the element for flow.js to manage from.\n                 * @type {string} jQuery selector\n                 */\n                root: 'body',\n                channel: null,\n\n                /**\n                 * Exclude elements matching these selectors from being bound\n                 */\n                exclude: 'pre *',\n\n                /**\n                 * Any elements added to the DOM after `Flow.initialize()` has been called will be automatically bound, and subscriptions added to channels.\n                 * @type {boolean}\n                 */\n                autoBind: true,\n\n                /**\n                 * By default Flow triggers events on 'change', but you may want to trigger on, say, 'keypress' for specific inputs. Set { uiChangeEvents: { [selector]: 'keypress' } } for such cases\n                 */\n                uiChangeEvents: {\n\n                }\n            };\n            $.extend(defaults, options);\n\n            const channel = defaults.channel;\n\n            this.options = defaults;\n\n            const me = this;\n            const $root = $(defaults.root);\n\n            function attachUIListeners($root) {\n                function parseValue(value, converters) {\n                    if (Array.isArray(value)) {\n                        const parsed = value.map(function (val) {\n                            return toImplicitType(val);\n                        });\n                        return converterManager.parse(parsed, converters);\n                    }\n                    return converterManager.parse(toImplicitType(value), converters);\n                }\n\n                $root.off(events.trigger).on(events.trigger, function (evt, params) {\n                    const elMeta = me.matchedElements.get(evt.target);\n                    const { data, source, options, restoreOriginal } = params;\n\n                    if (!elMeta || !data) {\n                        return;\n                    }\n                    const sourceMeta = elMeta[source] || {};\n                    const { channelPrefix, converters } = sourceMeta;\n                    const $el = $(evt.target);\n\n                    const parsed = ([].concat(data)).map(function (action) {\n                        const { name, value } = action;\n                        const parsedValue = parseValue(value, converters);\n                        const actualName = name.split('|')[0].trim(); //FIXME: this shouldn't know about the pipe syntax\n                        const prefixedName = addDefaultPrefix(actualName, source, channelPrefix);\n                        return { name: prefixedName, value: parsedValue };\n                    }, []);\n\n                    if (restoreOriginal) {\n                        //Ideally this should simply be a fetch to the previous version of the variable to use that.\n                        me.unbindElement($el, channel);\n                        me.bindElement($el, channel);\n                        return;\n                    }\n\n                    channel.publish(parsed, options).then((result)=> {\n                        if (!result || !result.length) {\n                            return;\n                        }\n                        const last = result[result.length - 1];\n                        $el.trigger(events.convert, { [source]: last.value });\n                    }, (e)=> {\n                        triggerError($el, e);\n                    });\n                });\n            }\n\n            function attachConversionListner($root) {\n                // data = {proptoupdate: value}\n                $root.off(events.convert).on(events.convert, function (evt, data) {\n                    const $el = $(evt.target);\n\n                    const elMeta = me.matchedElements.get(evt.target);\n                    if (!elMeta) {\n                        return;\n                    }\n\n                    Object.keys(data).forEach((prop)=> {\n                        const val = data[prop];\n                        const { converters, topics } = elMeta[prop];\n                        const convertedValue = converterManager.convert(val, converters);\n\n                        const handler = attrManager.getHandler(prop, $el);\n                        handler.handle(convertedValue, prop, $el, topics);\n                    });\n                });\n            }\n\n            const deferred = $.Deferred();\n            $(function () {\n                me.bindAll();\n\n                attachUIListeners($root);\n                attachConversionListner($root);\n\n                me.plugins.autoBind = autoUpdatePlugin($root.get(0), me, me.options.autoBind);\n\n                deferred.resolve($root);\n                $root.trigger('f.domready');\n            });\n\n            return deferred.promise();\n        }\n    };\n\n    return $.extend(this, publicAPI);\n}());\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/dom-manager.js","import { getConvertersForEl } from './parse-converters';\nimport { getChannelForAttribute, getChannelConfigForElement } from './parse-channel';\nimport { parseTopicsFromAttributeValue } from './parse-topics';\n\nexport { \n    getConvertersForEl,\n    getChannelForAttribute,\n    getChannelConfigForElement,\n    parseTopicsFromAttributeValue,\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/dom-manager-utils/dom-parse-helpers/index.js","/**\n * @param {string} conv \n * @returns {string[]}\n */\nfunction convertersToArray(conv) {\n    if (!conv || !conv.trim()) return [];\n    return conv.split('|').map((v)=> v.trim());\n}\n\n/**\n * @param {JQuery<HTMLElement>} $el\n * @param {string} attribute \n * @returns {string[]}\n */\nfunction getConvertersFromAttr($el, attribute) {\n    const attrVal = $el.attr(`data-f-${attribute}`);\n    const withConv = convertersToArray(attrVal);\n    if (withConv.length > 1) {\n        return withConv.slice(1); //First item will be the topic\n    }\n    return [];\n}\nfunction getFConvertAttrVal($el, suffix) {\n    const baseAttr = 'data-f-convert';\n    const suffixAttr = suffix ? `-${suffix}` : '';\n    const conv = $el.attr(`${baseAttr}${suffixAttr}`); //.data shows value cached by jquery\n    return convertersToArray(conv);\n}\n\n/**\n * @param {JQuery<HTMLElement>} $el  \n * @param {string} attribute \n * @returns {string[]} converters\n */\nexport function getConvertersForEl($el, attribute) {\n    function getAllConverters($el, attribute) {\n        const convertersAsPipes = getConvertersFromAttr($el, attribute);\n        if (convertersAsPipes.length) {\n            return convertersAsPipes;\n        }\n\n        const whiteListedGenericAttributes = ['bind', 'foreach', 'repeat'];\n        const canUseFConvert = whiteListedGenericAttributes.indexOf(attribute) !== -1;\n        if (canUseFConvert) {\n            return getFConvertAttrVal($el, '');\n        }\n        return getFConvertAttrVal($el, attribute);\n    }\n   \n    const converters = getAllConverters($el, attribute);\n    const $parentEl = $el.parents('[data-f-convert]').eq(0);\n    const resolvedConverters = converters.reduce((accum, val)=> {\n        if (val === 'inherit') {\n            const parentConv = getConvertersForEl($parentEl, attribute);\n            accum = accum.concat(parentConv);\n        } else {\n            accum = accum.concat(val);\n        }\n        return accum;\n    }, []);\n\n    if (!resolvedConverters.length && $parentEl.length) {\n        return getConvertersForEl($parentEl, attribute);\n    }\n    return resolvedConverters;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/dom-manager-utils/dom-parse-helpers/parse-converters.js","/**\n * \n * @param {JQuery<HTMLElement>} $el  \n * @param {string} attr \n * @returns {string|undefined}\n */\nexport function getChannelForAttribute($el, attr) {\n    attr = attr.replace('data-f-', '');\n    let channel = $el.data('f-channel-' + attr);\n    if (channel === undefined) {\n        channel = $el.attr('data-f-channel'); //.data shows value cached by jquery\n    }\n    if (channel === undefined) {\n        const $parentEl = $el.closest('[data-f-channel]');\n        if ($parentEl) {\n            channel = $parentEl.attr('data-f-channel');\n        }\n    }\n    return channel;\n}\n\n/**\n * @param {HTMLElement} el\n * @returns {Object}\n */ \nexport function getChannelConfigForElement(el) {\n    //TODO: Should this look at parents too?\n    const attrs = el.attributes;\n    const config = {};\n    for (let i = 0; i < attrs.length; i++) {\n        const attrib = el.attributes[i];\n        if (attrib.specified && attrib.name.indexOf('data-f-channel-') === 0) {\n            const key = attrib.name.replace('data-f-channel-', '');\n            config[key] = attrib.value;\n        }\n    }\n    return config;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/dom-manager-utils/dom-parse-helpers/parse-channel.js","/**\n * @param {string} attrVal \n * @returns {NormalizedTopic[]} variables\n */\nexport function parseTopicsFromAttributeValue(attrVal) {\n    const commaRegex = /,(?![^[(]*[\\])])/; //split except on a[b,c] or a(v,c)\n    const topicsPart = attrVal.split('|')[0];\n    if (topicsPart.indexOf('<%') !== -1) { //Assume it's templated for later use\n        return [];\n    } \n    const split = topicsPart.split(commaRegex);\n    if (split.length > 1) {\n        return split.map((v)=> ({ name: v.trim() }));\n    } \n    return [{ name: topicsPart.trim() }];\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/dom-manager-utils/dom-parse-helpers/parse-topics.js","/**\n * \n * @param {NormalizedTopic[]} topics \n * @param {string} prefix \n * @returns {NormalizedTopic[]}\n */\nexport function addPrefixToTopics(topics, prefix) {\n    if (!prefix) {\n        return topics;\n    }\n    const mappedTopics = topics.map((topic)=> {\n        const currentName = topic.name;\n        const hasChannelDefined = currentName.indexOf(':') !== -1;\n        if (!hasChannelDefined) {\n            topic.name = `${prefix}:${currentName}`;\n        }\n        return topic;\n    });\n    return mappedTopics;\n}\n\nconst DEFAULT_OPERATIONS_PREFIX = 'operations:';\nconst DEFAULT_VARIABLES_PREFIX = 'variables:';\n\nexport function addDefaultPrefix(name, source, channelPrefix) {\n    const isUnprefixed = name.indexOf(':') === -1;\n\n    const defaultPrefix = source.indexOf('on-') === 0 ? DEFAULT_OPERATIONS_PREFIX : DEFAULT_VARIABLES_PREFIX;\n    const needsDefaultPrefix = defaultPrefix !== DEFAULT_VARIABLES_PREFIX;\n\n    if (isUnprefixed && needsDefaultPrefix) {\n        name = `${defaultPrefix}${name}`;\n    }\n    const hasDefaultPrefix = name.indexOf(defaultPrefix) === 0;\n    if ((isUnprefixed || hasDefaultPrefix) && channelPrefix) {\n        name = `${channelPrefix}:${name}`;\n    }\n    return name;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/dom-manager-utils/dom-channel-prefix-helpers/index.js","import { isFunction, isString, isRegExp, find, mapValues } from 'lodash';\nimport { splitNameArgs, toImplicitType } from 'utils/parse-utils';\n\nvar normalize = function (alias, converter, acceptList) {\n    var ret = [];\n    //nomalize('flip', fn)\n    if (isFunction(converter)) {\n        ret.push({\n            alias: alias,\n            convert: converter,\n            acceptList: acceptList\n        });\n    } else if ($.isPlainObject(converter) && converter.convert) {\n        converter.alias = alias;\n        converter.acceptList = acceptList;\n        ret.push(converter);\n    } else if ($.isPlainObject(alias)) {\n        //normalize({alias: 'flip', convert: function})\n        if (alias.convert) {\n            ret.push(alias);\n        } else {\n            // normalize({flip: fun})\n            $.each(alias, function (key, val) {\n                ret.push({\n                    alias: key,\n                    convert: val,\n                    acceptList: acceptList\n                });\n            });\n        }\n    }\n    return ret;\n};\n\nvar matchConverter = function (alias, converter) {\n    if (isString(converter.alias)) {\n        return alias === converter.alias;\n    } else if (isFunction(converter.alias)) {\n        return converter.alias(alias);\n    } else if (isRegExp(converter.alias)) {\n        return converter.alias.match(alias);\n    }\n    return false;\n};\n\nvar converterManager = {\n    private: {\n        matchConverter: matchConverter\n    },\n\n    list: [],\n    /**\n     * Add a new attribute converter to this instance of Flow.js.\n     *\n     * **Example**\n     *\n     *      Flow.dom.converters.register('max', function (value) {\n     *          return max(value);\n     *      }, true);\n     *\n     *      Flow.dom.converters.register({\n     *          alias: 'sig',\n     *          parse: $.noop,\n     *          convert: function (value) {\n     *              return value.firstName + ' ' + value.lastName + ', ' + value.jobTitle;\n     *      }, false);\n     *\n     *      <div>\n     *          The largest sales you had was <span data-f-bind=\"salesByYear | max | $#,###\"></span>.\n     *          The current sales manager is <span data-f-bind=\"salesMgr | sig\"></span>.\n     *      </div>\n     *\n     * @param  {string|Function|RegExp} alias Formatter name.\n     * @param  {Function|Object} [converter] If a function, `converter` is called with the value. If an object, should include fields for `alias` (name), `parse` (function), and `convert` (function).\n     * @param {boolean} [acceptList] Determines if the converter is a 'list' converter or not. List converters take in arrays as inputs, others expect single values.\n     * @returns {void}\n     */\n    register: function (alias, converter, acceptList) {\n        var normalized = normalize(alias, converter, acceptList);\n        this.list = normalized.concat(this.list);\n    },\n\n    /**\n     * Replace an already registered converter with a new one of the same name.\n     *\n     * @param {string} alias Formatter name.\n     * @param {Function|Object} converter If a function, `converter` is called with the value. If an object, should include fields for `alias` (name), `parse` (function), and `convert` (function).\n     * @returns {void}\n     */\n    replace: function (alias, converter) {\n        var index;\n        this.list.forEach(function (currentConverter, i) {\n            if (matchConverter(alias, currentConverter)) {\n                index = i;\n                return false;\n            }\n        });\n        this.list.splice(index, 1, normalize(alias, converter)[0]);\n    },\n\n    getConverter: function (alias) {\n        var norm = splitNameArgs(alias);\n        norm.args = norm.args.map(toImplicitType);\n\n        var conv = find(this.list, function (converter) {\n            return matchConverter(norm.name, converter);\n        });\n        if (conv && norm.args) {\n            return $.extend({}, conv, { convert: Function.bind.apply(conv.convert, [null].concat(norm.args)) });\n        }\n        return conv;\n    },\n\n    /**\n     * Pipes the value sequentially through a list of provided converters.\n     *\n     * @param  {*} value Input for the converter to tag.\n     * @param  {string|string[]} list List of converters (maps to converter alias).\n     *\n     * @returns {*} Converted value.\n     */\n    convert: function (value, list) {\n        if (!list || !list.length) {\n            return value;\n        }\n        list = ([].concat(list)).map((v)=> v.trim());\n\n        var currentValue = value;\n        var me = this;\n\n        var convertArray = function (converter, val, converterName) {\n            return val.map(function (v) {\n                return converter.convert(v, converterName);\n            });\n        };\n        var convert = function (converter, value, converterName) {\n            var converted;\n            if (Array.isArray(value) && converter.acceptList !== true) {\n                converted = convertArray(converter, value, converterName);\n            } else {\n                converted = converter.convert(value, converterName);\n            }\n            return converted;\n        };\n        var convertObject = function (converter, value, converterName) {\n            return mapValues(value, function (val) {\n                return convert(converter, val, converterName);\n            });\n        };\n        list.forEach(function (converterName) {\n            var converter = me.getConverter(converterName);\n            if (!converter) {\n                throw new Error('Could not find converter for ' + converterName);\n            }\n            if ($.isPlainObject(currentValue) && converter.acceptList !== true) {\n                currentValue = convertObject(converter, currentValue, converterName);\n            } else {\n                currentValue = convert(converter, currentValue, converterName);\n            }\n        });\n        return currentValue;\n    },\n\n    /**\n     * Counter-part to `convert()`. Translates converted values back to their original form.\n     *\n     * @param  {*} value Value to parse.\n     * @param  {string|string[]} list  List of parsers to run the value through. Outermost is invoked first.\n     * @returns {*} Original value.\n     */\n    parse: function (value, list) {\n        if (!list || !list.length) {\n            return value;\n        }\n        list = [].concat(list).reverse().map((v)=> v.trim());\n\n        var currentValue = value;\n        var me = this;\n        list.forEach(function (converterName) {\n            var converter = me.getConverter(converterName);\n            if (!converter) {\n                throw new Error('parse: Could not find converter ' + converterName);\n            }\n            if (converter.parse) {\n                currentValue = converter.parse(currentValue, converterName);\n            }\n        });\n        return currentValue;\n    }\n};\n\n\n//Bootstrap\nvar defaultconverters = [\n    require('./converters/number-converters'),\n    require('./converters/string-converters'),\n    require('./converters/array-converters'),\n    require('./converters/general-util-converters'),\n    require('./converters/numberformat-converter'),\n    require('./converters/number-compare-converters'),\n    require('./converters/boolean-conditional-converters'),\n    require('./converters/collection-converters')\n];\n\ndefaultconverters.reverse().forEach(function (converter) {\n    if (Array.isArray(converter)) {\n        converter.forEach(function (c) {\n            converterManager.register(c);\n        });\n    } else {\n        converterManager.register(converter);\n    }\n});\n\nexport default converterManager;\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/converter-manager/index.js","module.exports = {\n    /**\n     * Convert source value to an integer. Often used for chaining to another converter.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          Your car has driven\n     *          <span data-f-bind=\"Odometer | i | s0.0\"></span> miles.\n     *      </div>\n     *\n     * @param {string} value Source value.\n     * @returns {number}\n     */\n    i: function (value) {\n        return parseFloat(value);\n    },\n\n    /**\n     * Add value to source number.\n     *\n     * **Example**\n     *      <div>\n     *          Next year is <span data-f-bind=\"Year | plus(1)\"></span>.\n     *      </div>\n     *\n     * @param {string} operand Value to add\n     * @param {string} value Source value\n     * @returns {number}\n     */\n    plus: function (operand, val) {\n        return Number(val) + Number(operand);\n    },\n\n    /**\n     * Subtract value from source number.\n     *\n     * **Example**\n     *      <div>\n     *          Last year was <span data-f-bind=\"Year | minus(1)\"></span>.\n     *      </div>\n     *\n     * @param {string} operand Value to add\n     * @param {string} value Source value\n     * @returns {number}\n     */\n    minus: function (operand, val) {\n        return Number(val) - Number(operand);\n    },\n\n    /**\n     * Multiply value with source number.\n     *\n     * **Example**\n     *      <div>\n     *          Total cost is <span data-f-bind=\"Units | multiplyBy(10)\"></span>.\n     *      </div>\n     *\n     * @param {string} operand Value to add\n     * @param {string} value Source value\n     * @returns {number}\n     */\n    multiplyBy: function (operand, val) {\n        return Number(val) * Number(operand);\n    },\n\n    /**\n     * Divide value by source number.\n     *\n     * **Example**\n     *      <div>\n     *          Unit cost is <span data-f-bind=\"Total Cost | divideBy(10)\"></span>.\n     *      </div>\n     *\n     * @param {string} operand Value to add\n     * @param {string} value Source value\n     * @returns {number}\n     */\n    divideBy: function (operand, val) {\n        return Number(val) / Number(operand);\n    },\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/converter-manager/converters/number-converters/index.js","module.exports = {\n\n    /**\n     * Convert the model variable to a string. Often used for chaining to another converter.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          This year you are in charge of sales for\n     *          <span data-f-bind=\"salesMgr.region | s | upperCase\"></span>.\n     *      </div>\n     *\n     * @param {Array} val The model variable.\n     * @returns {string} converted string\n     */\n    s: function (val) {\n        return val + '';\n    },\n\n    /**\n     * Convert the model variable to UPPER CASE.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          This year you are in charge of sales for\n     *          <span data-f-bind=\"salesMgr.region | s | upperCase\"></span>.\n     *      </div>\n     *\n     * @param {Array} val The model variable.\n     * @returns {string} converted string\n     */\n    upperCase: function (val) {\n        return (val + '').toUpperCase();\n    },\n\n    /**\n     * Convert the model variable to lower case.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          Enter your user name:\n     *          <input data-f-bind=\"userName | lowerCase\"></input>.\n     *      </div>\n     *\n     * @param {Array} val The model variable.\n     * @returns {string} converted string\n     */\n    lowerCase: function (val) {\n        return (val + '').toLowerCase();\n    },\n\n    /**\n     * Convert the model variable to Title Case.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          Congratulations on your promotion!\n     *          Your new title is: <span data-f-bind=\"currentRole | titleCase\"></span>.\n     *      </div>\n     *\n     * @param {string} val The model variable.\n     * @returns {string} converted string\n     */\n    titleCase: function (val) {\n        val = val + '';\n        return val.replace(/\\w\\S*/g, function (txt) {\n            return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();\n        });\n    },\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/converter-manager/converters/string-converters/index.js","const _ = require('lodash');\n\nfunction parseLimitArgs(starting, limit, val) {\n    let toRet = {};\n    if (arguments.length === 3) { //eslint-disable-line\n        toRet = {\n            input: limit,\n            limit: starting\n        };\n    } else if (arguments.length === 2) {\n        toRet = {\n            input: starting\n        };\n    } else {\n        console.error('Too many arguments passed to last', arguments);\n        throw new Error('Too many arguments passed to last');\n    }\n\n    toRet.input = [].concat(toRet.input);\n    return toRet;\n}\n\nconst list = {\n    /**\n     * Convert the input into an array. \n     *\n     * @param {any[]} val The array model variable.\n     * @returns {any[]}\n     */\n    list: (val)=> [].concat(val),\n\n    /**\n     * Reverse the array.\n     *\n     * **Example**\n     *\n     *      <p>Show the history of our sales, starting with the last (most recent):</p>\n     *      <ul data-f-foreach=\"Sales | reverse\">\n     *          <li></li>\n     *      </ul>\n     *\n     * @param {any[]} val The array model variable.\n     * @returns {any[]} the reversed array\n     */\n    reverse: (val)=> ([].concat(val)).reverse(),\n\n    /**\n     * Select only the last element of the array.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          In the current year, we have <span data-f-bind=\"Sales | last\"></span> in sales.\n     *      </div>\n     *\n     * @param {number} n number of items to get\n     * @param {any[]} val The array model variable.\n     * @returns {any} last element of array\n     */\n    last: function (n, val) {\n        const parsed = parseLimitArgs.apply(null, arguments);\n        const stripped = parsed.input.slice(-(parsed.limit || 1));\n        if (stripped.length <= 1) {\n            return stripped[0];\n        }\n        return stripped;\n    },\n\n    /**\n     * Select only the first element of the array.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          Our initial investment was <span data-f-bind=\"Capital | first\"></span>.\n     *      </div>\n     *\n     * @param {number} n number of items to get\n     * @param {any[]} val The array model variable.\n     * @returns {any} first element of the array\n     */\n    first: function (n, val) {\n        const parsed = parseLimitArgs.apply(null, arguments);\n        const stripped = parsed.input.slice(0, (parsed.limit || 1));\n        if (stripped.length <= 1) {\n            return stripped[0];\n        }\n        return stripped;\n    },\n\n    /**\n     * Select only the previous (second to last) element of the array.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          Last year we had <span data-f-bind=\"Sales | previous\"></span> in sales.\n     *      </div>\n     *\n     * @param {any[]} val The array model variable.\n     * @returns {any} the previous (second to last) element of the array.\n     */\n    previous: (val)=> {\n        val = [].concat(val);\n        return (val.length <= 1) ? val[0] : val[val.length - 2];\n    },\n\n    /**\n     * Returns length of array\n     *\n     * **Example**\n     * Total Items: <h6 data-f-bind=\"items | size\"></h6>\n     * \n     * @param  {any[]} src array\n     * @returns {number}     length of array\n     */\n    size: (src)=> [].concat(src).length,\n\n    /**\n     * Select every nth item from array\n     *\n     * **Example**\n     * <!-- select every 10th item starting from itself\n     * <ul data-f-foreach=\"Time | pickEvery(10)\"><li></li></ul>\n     * <!-- select every 10th item starting from the fifth\n     * <ul data-f-foreach=\"Time | pickEvery(10, 5)\"><li></li></ul>\n     * \n     * @param  {number} n          nth item to select\n     * @param  {number} [startIndex] index to start from\n     * @param  {any[]} [val]        source array\n     * @returns {any[]}            shortened array\n     */\n    pickEvery: function (n, startIndex, val) {\n        if (arguments.length === 3) { //eslint-disable-line\n            //last item is match string\n            val = startIndex;\n            startIndex = 0;\n        }\n        val = [].concat(val);\n        val = val.slice(startIndex);\n        return val.filter((item, index)=> {\n            return (index % n) === 0;\n        });\n    },\n};\n\nconst mapped = Object.keys(list).map(function (alias) {\n    const fn = list[alias];\n    const newfn = function () {\n        const args = _.toArray(arguments);\n        const indexOfActualValue = args.length - 2; //last item is the matchstring\n        const val = args[indexOfActualValue];\n        if ($.isPlainObject(val)) {\n            return Object.keys(val).reduce((accum, key)=> {\n                const arr = val[key];\n                const newArgs = args.slice();\n                newArgs[indexOfActualValue] = arr;\n                accum[key] = fn.apply(fn, newArgs);\n                return accum;\n            }, {});\n        }\n        return fn.apply(fn, arguments);\n    };\n    return {\n        alias: alias,\n        acceptList: true,\n        convert: newfn,\n    };\n});\nmodule.exports = mapped;\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/converter-manager/converters/array-converters/index.js","function parseArgs(toCompare, trueVal, falseVal, valueToCompare, matchString) {\n    const toReturn = { trueVal: true, falseVal: false };\n    switch (arguments.length) {\n        case 5: //eslint-disable-line\n            return $.extend(toReturn, { trueVal: trueVal, falseVal: falseVal, input: valueToCompare });\n        case 4: //eslint-disable-line\n            return $.extend(toReturn, { trueVal: trueVal, falseVal: falseVal, input: falseVal }); \n        case 3: //eslint-disable-line\n            return $.extend(toReturn, { input: trueVal, falseVal: trueVal }); \n        default:\n            return toReturn;\n    }\n}\n\nmodule.exports = [\n    {\n        alias: 'is',\n        acceptList: false,\n        convert: function (toCompare) {\n            const args = parseArgs.apply(null, arguments);\n            return args.input === toCompare ? args.trueVal : args.falseVal;\n        }\n    }\n];\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/converter-manager/converters/general-util-converters/index.js","const { isString, isNumber } = require('lodash');\n\nfunction isAllowedLeading(str) { \n    const validPrefixes = ['₹', '$', '£', '¥', '±', '’', '¢', '€'];\n    return validPrefixes.indexOf(str.trim()) !== -1;\n}\n\nmodule.exports = {\n    /**\n     * @param {string} name\n     * @returns {boolean}\n     */\n    alias: function (name) {\n        /**\n         * @param {string} v\n         * @returns {boolean}\n         */\n        function checkValMatch(v) {\n            const validStandalone = ['#', '0', '%'];\n            if (v.length === 1) {\n                return validStandalone.indexOf(v) !== -1;\n            }\n\n            const validFirstChars = ['s', '#', '0', '.'];\n            const validLastChars = ['%', '#', '0'];\n\n            if (isAllowedLeading(v.charAt(0))) {\n                v = v.slice(1);\n            }\n            const isValidFirstChar = validFirstChars.indexOf(v.charAt(0)) !== -1;\n            const isValidLastChar = validLastChars.indexOf(v.charAt(v.length - 1)) !== -1;\n\n            if (v.length === 2) {\n                return isValidFirstChar && isValidLastChar;\n            }\n            \n            const validRemainingChars = ['#', '0', '.', ','];\n            const areRemainingCharactersValid = v.substr(1, v.length - 2).split('').reduce((accum, char)=> {\n                const isMatch = validRemainingChars.indexOf(char) !== -1;\n                if (!isMatch) {\n                    accum = false;\n                }\n                return accum;\n            }, true);\n\n            return isValidFirstChar && isValidLastChar && areRemainingCharactersValid;\n        }\n\n        const parts = name.split(' ');\n        if (parts.length === 3) {\n            return checkValMatch(parts[1]); //prefix and suffix\n        } else if (parts.length === 1) {\n            return checkValMatch(parts[0]); //just the number\n        } else if (parts.length === 2) {\n            return checkValMatch(parts[0]) || checkValMatch(parts[1]); //either prefix or suffix\n        }\n        return false;\n    },\n\n    /**\n     * @param {string} val\n     * @returns {number}\n     */\n    parse: function (val) {\n        val += '';\n        var isNegative = val.charAt(0) === '-';\n\n        val = val.replace(/,/g, '');\n        var floatMatcher = /([-+]?[0-9]*\\.?[0-9]+)(K?M?B?%?)/i;\n        var results = floatMatcher.exec(val);\n        var number;\n        var suffix = '';\n        if (results && results[1]) {\n            number = results[1];\n        }\n        if (results && results[2]) {\n            suffix = results[2].toLowerCase();\n        }\n\n        /*eslint no-magic-numbers: 0 complexity: 0 */\n        switch (suffix) {\n            case '%':\n                number = number / 100;\n                break;\n            case 'k':\n                number = number * 1000;\n                break;\n            case 'm':\n                number = number * 1000000;\n                break;\n            case 'b':\n                number = number * 1000000000;\n                break;\n            default:\n        }\n        number = parseFloat(number);\n        if (isNegative && number > 0) {\n            number = number * -1;\n        }\n        return number;\n    },\n\n    convert: (function (value) {\n        var scales = ['', 'K', 'M', 'B', 'T'];\n        function roundTo(value, digits) {\n            return Math.round(value * Math.pow(10, digits)) / Math.pow(10, digits);\n        }\n\n        function getDigits(value, digits) {\n            value = value === 0 ? 0 : roundTo(value, Math.max(0, digits - Math.ceil(Math.log(value) / Math.LN10)));\n\n            var TXT = '';\n            var numberTXT = value.toString();\n            var decimalSet = false;\n\n            for (var iTXT = 0; iTXT < numberTXT.length; iTXT++) {\n                TXT += numberTXT.charAt(iTXT);\n                if (numberTXT.charAt(iTXT) === '.') {\n                    decimalSet = true;\n                } else {\n                    digits--;\n                }\n\n                if (digits <= 0) {\n                    return TXT;\n                }\n            }\n\n            if (!decimalSet) {\n                TXT += '.';\n            }\n            while (digits > 0) {\n                TXT += '0';\n                digits--;\n            }\n            return TXT;\n        }\n\n        function addDecimals(value, decimals, minDecimals, hasCommas) {\n            hasCommas = !!hasCommas;\n            var numberTXT = value.toString();\n            var hasDecimals = (numberTXT.split('.').length > 1);\n            var iDec = 0;\n\n            if (hasCommas) {\n                for (var iChar = numberTXT.length - 1; iChar > 0; iChar--) {\n                    if (hasDecimals) {\n                        hasDecimals = (numberTXT.charAt(iChar) !== '.');\n                    } else {\n                        iDec = (iDec + 1) % 3;\n                        if (iDec === 0) {\n                            numberTXT = numberTXT.substr(0, iChar) + ',' + numberTXT.substr(iChar);\n                        }\n                    }\n                }\n\n            }\n            if (decimals > 0) {\n                var toADD;\n                if (numberTXT.split('.').length <= 1) {\n                    toADD = minDecimals;\n                    if (toADD > 0) {\n                        numberTXT += '.';\n                    }\n                } else {\n                    toADD = minDecimals - numberTXT.split('.')[1].length;\n                }\n\n                while (toADD > 0) {\n                    numberTXT += '0';\n                    toADD--;\n                }\n            }\n            return numberTXT;\n        }\n\n        function getSuffix(formatTXT) {\n            formatTXT = formatTXT.replace('.', '');\n            var fixesTXT = formatTXT.split(new RegExp('[0|,|#]+', 'g'));\n            return (fixesTXT.length > 1) ? fixesTXT[1].toString() : '';\n        }\n\n        function format (number, formatTXT) { // eslint-disable-line\n            if (Array.isArray(number)) {\n                number = number[number.length - 1];\n            }\n            if (!isString(number) && !isNumber(number)) {\n                return number;\n            }\n\n            if (!formatTXT || formatTXT.toLowerCase() === 'default') {\n                return number.toString();\n            }\n\n            if (isNaN(number)) {\n                return '?';\n            }\n\n            //var formatTXT;\n            const entityCodeMapping = {\n                '&euro;': '€',\n                '&dollar;': '$',\n                '&cent;': '¢',\n                '&pound;': '£',\n                '&yen;': '¥',\n            };\n            Object.keys(entityCodeMapping).forEach((code)=> {\n                formatTXT = formatTXT.replace(code, entityCodeMapping[code]);\n            });\n\n            // Divide +/- Number Format\n            var formats = formatTXT.split(';');\n            if (formats.length > 1) {\n                return format(Math.abs(number), formats[((number >= 0) ? 0 : 1)]);\n            }\n\n            // Save Sign\n            var sign = (number >= 0) ? '' : '-';\n            number = Math.abs(number);\n\n\n            var leftOfDecimal = formatTXT;\n            var d = leftOfDecimal.indexOf('.');\n            if (d > -1) {\n                leftOfDecimal = leftOfDecimal.substring(0, d);\n            }\n\n            var normalized = leftOfDecimal.toLowerCase();\n            var index = normalized.lastIndexOf('s');\n            var isShortFormat = index > -1;\n\n            if (isShortFormat) {\n                var nextChar = leftOfDecimal.charAt(index + 1);\n                if (nextChar === ' ') {\n                    isShortFormat = false;\n                }\n            }\n\n            var leadingText = isShortFormat ? formatTXT.substring(0, index) : '';\n            var rightOfPrefix = isShortFormat ? formatTXT.substr(index + 1) : formatTXT.substr(index);\n\n            //first check to make sure 's' is actually short format and not part of some leading text\n            if (isShortFormat) {\n                var shortFormatTest = /[0-9#*]/;\n                var shortFormatTestResult = rightOfPrefix.match(shortFormatTest);\n                if (!shortFormatTestResult || shortFormatTestResult.length === 0) {\n                    //no short format characters so this must be leading text ie. 'weeks '\n                    isShortFormat = false;\n                    leadingText = '';\n                }\n            }\n\n            //if (formatTXT.charAt(0) == 's')\n            if (isShortFormat) {\n                var valScale = number === 0 ? 0 : Math.floor(Math.log(Math.abs(number)) / (3 * Math.LN10));\n                valScale = ((number / Math.pow(10, 3 * valScale)) < 1000) ? valScale : (valScale + 1);\n                valScale = Math.max(valScale, 0);\n                valScale = Math.min(valScale, 4);\n                number = number / Math.pow(10, 3 * valScale);\n                //if (!isNaN(Number(formatTXT.substr(1) ) ) )\n\n                if (!isNaN(Number(rightOfPrefix)) && rightOfPrefix.indexOf('.') === -1) {\n                    var limitDigits = Number(rightOfPrefix);\n                    if (number < Math.pow(10, limitDigits)) {\n                        if (isAllowedLeading(leadingText)) {\n                            return sign + leadingText + getDigits(number, Number(rightOfPrefix)) + scales[valScale];\n                        } else {\n                            return leadingText + sign + getDigits(number, Number(rightOfPrefix)) + scales[valScale];\n                        }\n                    } else if (isAllowedLeading(leadingText)) {\n                        return sign + leadingText + Math.round(number) + scales[valScale];\n                    } else {\n                        return leadingText + sign + Math.round(number) + scales[valScale];\n                    }\n                } else {\n                    //formatTXT = formatTXT.substr(1);\n                    formatTXT = formatTXT.substr(index + 1);\n                    var SUFFIX = getSuffix(formatTXT);\n                    formatTXT = formatTXT.substr(0, formatTXT.length - SUFFIX.length);\n\n                    var valWithoutLeading = format(((sign === '') ? 1 : -1) * number, formatTXT) + scales[valScale] + SUFFIX;\n                    if (isAllowedLeading(leadingText) && sign !== '') {\n                        valWithoutLeading = valWithoutLeading.substr(sign.length);\n                        return sign + leadingText + valWithoutLeading;\n                    }\n\n                    return leadingText + valWithoutLeading;\n                }\n            }\n\n            var subFormats = formatTXT.split('.');\n            var decimals;\n            var minDecimals;\n            if (subFormats.length > 1) {\n                decimals = subFormats[1].length - subFormats[1].replace(new RegExp('[0|#]+', 'g'), '').length;\n                minDecimals = subFormats[1].length - subFormats[1].replace(new RegExp('0+', 'g'), '').length;\n                formatTXT = subFormats[0] + subFormats[1].replace(new RegExp('[0|#]+', 'g'), '');\n            } else {\n                decimals = 0;\n            }\n\n            var fixesTXT = formatTXT.split(new RegExp('[0|,|#]+', 'g'));\n            var preffix = fixesTXT[0].toString();\n            var suffix = (fixesTXT.length > 1) ? fixesTXT[1].toString() : '';\n\n            number = number * ((formatTXT.split('%').length > 1) ? 100 : 1);\n            //            if (formatTXT.indexOf('%') !== -1) number = number * 100;\n            number = roundTo(number, decimals);\n\n            sign = (number === 0) ? '' : sign;\n\n            var hasCommas = (formatTXT.substr(formatTXT.length - 4 - suffix.length, 1) === ',');\n            var formatted = sign + preffix + addDecimals(number, decimals, minDecimals, hasCommas) + suffix;\n\n            //  console.log(originalNumber, originalFormat, formatted)\n            return formatted;\n        }\n\n        return format;\n    }())\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/converter-manager/converters/numberformat-converter/index.js","function parseArgs(limit, trueVal, falseVal, valueToCompare, matchString) {\n    var toReturn = { trueVal: true, falseVal: false };\n    switch (arguments.length) {\n        case 5: //eslint-disable-line\n            return $.extend(toReturn, { trueVal: trueVal, falseVal: falseVal, input: valueToCompare });\n        case 4: //eslint-disable-line\n            return $.extend(toReturn, { trueVal: trueVal, falseVal: falseVal, input: falseVal }); \n        case 3: //eslint-disable-line\n            return $.extend(toReturn, { input: trueVal, falseVal: trueVal }); \n        default:\n            return toReturn;\n    }\n}\nmodule.exports = {\n    /**\n     * Convert the model variable to true, or other values passed to the converter, based on whether the model variable is greater than the limit.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          <!-- displays true or the number of widgets -->\n     *          <span data-f-bind=\"widgets | greaterThan(50)\"></span> \n     *\n     *          <!-- displays custom text -->\n     *          <span data-f-bind=\"widgets | greaterThan(50, 'Congratulations!', 'Better luck next year')\"></span>\n     *      </div>\n     *\n     * @param {number} limit The reference value to compare the model variable against.\n     * @param {string} trueVal (Optional) The format (value) to display if the model variable is greater than `limit`. If not included, the display is `true`. If there are commas in this argument, they must be escaped with `\\`.\n     * @param {string} falseVal (Optional) The format (value) to display if the model variable is less than or equal to `limit`. If not included, the display is the value of the model variable. If there are commas in this argument, they must be escaped with `\\`.\n     * @returns {*} If the model variable is greater than `limit`, returns trueVal or `true`. Otherwise returns falseVal if provided, or echoes the input.\n     */\n    greaterThan: function (limit) {\n        var args = parseArgs.apply(null, arguments);\n        return Number(args.input) > Number(limit) ? args.trueVal : args.falseVal;\n    },\n\n    /**\n     * Convert the model variable to true, or other values passed to the converter, based on whether the model variable is greater than or equal to the limit.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          <!-- displays true or the number of widgets -->\n     *          <span data-f-bind=\"widgets | greaterThan(50)\"></span> \n     *\n     *          <!-- displays custom text -->\n     *          <span data-f-bind=\"widgets | greaterThan(50, 'Congratulations!', 'Better luck next year')\"></span>\n     *      </div>\n     *\n     * @param {number} limit The reference value to compare the model variable against.\n     * @param {string} trueVal (Optional) The format (value) to display if the model variable is greater than or equal to `limit`. If not included, the display is `true`. If there are commas in this argument, they must be escaped with `\\`.\n     * @param {string} falseVal (Optional) The format (value) to display if the model variable is less than `limit`. If not included, the display is the value of the model variable. If there are commas in this argument, they must be escaped with `\\`.\n     * @returns {*} If the model variable is greater than or equal to `limit`, returns trueVal or `true`. Otherwise returns falseVal if provided, or echoes the input.\n     */    \n    greaterThanEqual: function (limit) {\n        var args = parseArgs.apply(null, arguments);\n        return Number(args.input) >= Number(limit) ? args.trueVal : args.falseVal;\n    },\n\n    /**\n     * Convert the model variable to true, or other values passed to the converter, based on whether the model variable is equal to the limit.\n     *\n     * \n     * **Example**\n     *\n     *      <div>\n     *          <!-- displays true or the number of widgets -->\n     *          <span data-f-bind=\"widgets | equalsNumber(50)\"></span> \n     *\n     *          <!-- display custom text -->\n     *          <span data-f-bind=\"widgets | equalsNumber(50, 'Met the goal exactly!', 'Not an exact match')\"></span>\n     *      </div>\n     *\n     * @param {number} limit The reference value to compare the model variable against.\n     * @param {string} trueVal (Optional) The format (value) to display if the model variable is equal to `limit`. If not included, the display is `true`. If there are commas in this argument, they must be escaped with `\\`.\n     * @param {string} falseVal (Optional) The format (value) to display if the model variable is not equal to `limit`. If not included, the display is the value of the model variable. If there are commas in this argument, they must be escaped with `\\`.\n     * @returns {*} If the model variable equals `limit`, returns trueVal or `true`. Otherwise returns falseVal if provided, or echoes the input.\n     */\n    equalsNumber: function (limit) {\n        var args = parseArgs.apply(null, arguments);\n        return Number(args.input) === Number(limit) ? args.trueVal : args.falseVal;\n    },\n\n    /**\n     * Convert the model variable to true, or other values passed to the converter, based on whether the model variable is less than the limit.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          <!-- displays true or the number of widgets -->\n     *          <span data-f-bind=\"widgets | lessThan(50)\"></span> \n     *\n     *          <!-- display custom text -->\n     *          <span data-f-bind=\"widgets | lessThan(50, 'Oops didn't make quite enough!', 'Built a lot of widgets this year!')\"></span>\n     *      </div>\n     *\n     * @param {number} limit The reference value to compare the model variable against.\n     * @param {string} trueVal (Optional) The format (value) to display if the model variable is less than `limit`. If not included, the display is `true`. If there are commas in this argument, they must be escaped with `\\`.\n     * @param {string} falseVal (Optional) The format (value) to display if the model variable is less than `limit`. If not included, the display is the value of the model variable. If there are commas in this argument, they must be escaped with `\\`.\n     * @returns {*} If the model variable is less than `limit`, returns trueVal or `true`. Otherwise returns falseVal if provided, or echoes the input.\n     */ \n    lessThan: function (limit) {\n        var args = parseArgs.apply(null, arguments);\n        return Number(args.input) < Number(limit) ? args.trueVal : args.falseVal;\n    },\n\n    /**\n     * Convert the model variable to true, or other values passed to the converter, based on whether the model variable is less than or equal to the limit.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          <!-- displays true or the number of widgets -->\n     *          <span data-f-bind=\"widgets | lessThanEqual(50)\"></span> \n     *\n     *          <!-- display custom text -->\n     *          <span data-f-bind=\"widgets | lessThanEqual(50, 'Oops didn't make quite enough!', 'Built a lot of widgets this year!')\"></span>\n     *      </div>\n     *\n     * @param {number} limit The reference value to compare the model variable against.\n     * @param {string} trueVal (Optional) The format (value) to display if the model variable is less than or equal to `limit`. If not included, the display is `true`. If there are commas in this argument, they must be escaped with `\\`.\n     * @param {string} falseVal (Optional) The format (value) to display if the model variable is less than or equal to `limit`. If not included, the display is the value of the model variable. If there are commas in this argument, they must be escaped with `\\`.\n     * @returns {*} If the model variable is less than or equal to `limit`, returns trueVal or `true`. Otherwise returns falseVal if provided, or echoes the input.\n     */\n    lessThanEqual: function (limit) {\n        var args = parseArgs.apply(null, arguments);\n        return Number(args.input) <= Number(limit) ? args.trueVal : args.falseVal;\n    }\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/converter-manager/converters/number-compare-converters/index.js","function parseArgs(trueVal, falseVal, input, matchString) {\n    var toReturn = { trueVal: true, falseVal: false };\n    switch (arguments.length) {\n        case 4: //eslint-disable-line\n            return $.extend(toReturn, { trueVal: trueVal, falseVal: falseVal, input: input });\n        case 3: //eslint-disable-line\n            return $.extend(toReturn, { trueVal: trueVal, falseVal: falseVal, input: falseVal }); \n        default:\n            return toReturn;\n    }\n}\n\nmodule.exports = {\n    /**\n     * Convert 'truthy' values to true and 'falsy' values to false.\n     *\n     * **Example**\n     *\n     *      <!-- displays \"true\" or \"false\" -->\n     *      <!-- in particular, true if sampleVar is truthy (1, true, 'some string', [] etc.), \n     *            false if sampleVar is falsy (0, false, '') -->\n     *      <span data-f-bind=\"sampleVar | toBool\"></span>\n     * \n     * @param {Any} value\n     * @returns {boolean}\n     */\n    toBool: (value)=> !!value,\n\n    /**\n     * Converts values to boolean and negates.\n     *\n     * **Example**\n     *\n     *      <!-- disables input if isGameInProgress is false -->\n     *      <input type=\"text\" data-f-disabled=\"isGameInProgress | not\" />\n     * \n     * @param {Any} value\n     * @returns {boolean}\n     */\n    not: (value)=> !value,\n\n    /**\n     * Convert the input to a new value (for example, some text), based on whether it is true or false.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          <span data-f-bind=\"sampleVar | ifTrue('yes! please move forward', 'not ready to proceed')\"></span> \n     *          <span data-f-bind=\"sampleVar | ifTrue('yes! please move forward')\"></span>\n     *      </div>\n     *\n     * @param {string} trueVal The value to display if the input is true. If there are commas in this argument, they must be escaped with `\\`.\n     * @param {string} falseVal (Optional) The value to display if the input is false. If not included, returns the input. If there are commas in this argument, they must be escaped with `\\`.\n     * @param {Any} input (Optional) The input to test. If not included, the output of the previous argument is used.\n     * @returns {Any} If input is true, returns trueVal. If input is false, returns falseVal if provided, or echoes the input.\n     */\n    ifTrue: function () {\n        var args = parseArgs.apply(null, arguments);\n        return args.input ? args.trueVal : args.falseVal;\n    },\n    /**\n     * Convert the input to a new value (for example, some text), based on whether it is false or true.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          <span data-f-bind=\"sampleVar | ifFalse('not ready to proceed', 'actually this is still true')\"></span> \n     *          <span data-f-bind=\"sampleVar | ifFalse('not ready to proceed')\"></span>\n     *      </div>\n     *\n     * @param {string} trueVal The value to display if the input is false. If there are commas in this argument, they must be escaped with `\\`.\n     * @param {string} falseVal (Optional) The value to display if the input is true. If not included, returns the input. If there are commas in this argument, they must be escaped with `\\`.\n     * @param {Any} input (Optional) The input to test. If not included, the output of the previous argument is used.\n     * @returns {Any} If input is false, returns trueVal. If input is true, returns falseVal if provided, or echoes the input.\n     */\n    ifFalse: function () {\n        var args = parseArgs.apply(null, arguments);\n        return !args.input ? args.trueVal : args.falseVal;\n    }\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/converter-manager/converters/boolean-conditional-converters/index.js","const _ = require('lodash');\n\nconst list = {\n    /**\n     * Returns all values in array matching argument\n     *\n     * ** Example **\n     * <!-- list online users -->\n     * <ul data-f-foreach=\"users | filter(isOnline)\"><li></li></button>\n     * \n     * @param  {string|number|boolean} valueToFilterBy value to reject\n     * @param  {any[]} source The arrayed model variable\n     * @returns {any[]}     filtered lsit\n     */\n    filter: function (valueToFilterBy, source) {\n        source = [].concat(source);\n        if ($.isPlainObject(source[0])) {\n            return _.filter(source, valueToFilterBy);\n        }\n        return source.filter((v)=> v === valueToFilterBy);\n    },\n\n    /**\n     * Returns all values in array excluding match\n     *\n     * ** Example **\n     * <!-- list offline users -->\n     * <ul data-f-foreach=\"users | except(isOnline)\"><li></li></button>\n     * \n     * @param  {string|number|boolean} valueToReject value to reject\n     * @param  {any[]} source The arrayed model variable\n     * @returns {any[]}     filtered lsit\n     */\n    except: function (valueToReject, source) {\n        source = [].concat(source);\n        if ($.isPlainObject(source[0])) {\n            return _.reject(source, valueToReject);\n        }\n        return source.filter((v)=> v !== valueToReject);\n    },\n\n    /**\n     * Checks if array contains *any* item passing the test\n     *\n     * ** Example **\n     * <!-- hides button if any of the users are not online -->\n     * <button data-f-hideif=\"users | any(isOnline) | not\">Get Started</button>\n     * <button data-f-hideif=\"users | any({ isOnline: false })\">Get Started</button>\n     * \n     * @param  {string|Object} value value to check for\n     * @param  {any[]} source The arrayed model variable\n     * @returns {boolean}     True if match found in array\n     */\n    any: function (value, source) {\n        source = [].concat(source);\n        if ($.isPlainObject(source[0])) {\n            return _.some(source, value);\n        }\n        return source.indexOf(value) !== -1;\n    },\n\n    /**\n     * Checks if *every* item in the array passes the test\n     *\n     * ** Example **\n     * <!-- shows button if any of the users are not online -->\n     * <button data-f-showif=\"users | every(isOnline)\">Get Started</button>\n     * \n     * @param  {string|Object} value value to check for\n     * @param  {any[]} source The arrayed model variable\n     * @returns {boolean}     True if match found in array\n     */\n    every: function (value, source) {\n        source = [].concat(source);\n        if ($.isPlainObject(source[0])) {\n            return _.every(source, value);\n        }\n        return source.filter((v)=> v === value).length === source.length;\n    }\n};\nconst converters = Object.keys(list).map((name)=> {\n    return {\n        alias: name,\n        acceptList: true,\n        convert: list[name]\n    };\n});\n\nmodule.exports = converters;\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/converter-manager/converters/collection-converters/index.js","import { isString, isFunction } from 'lodash';\n/**\n * @typedef NodeHandler\n * @property {string} selector\n * @property {Function} handle\n */ \n\n \n/**\n * @param {string | undefined} selector\n * @param {Function | NodeHandler } handler\n * @returns {NodeHandler}\n */\nconst normalize = function (selector, handler) {\n    if (!selector) {\n        selector = '*';\n    }\n    if (isFunction(handler)) {\n        handler = {\n            selector: selector,\n            handle: handler\n        };\n    }\n   \n    handler.selector = selector;\n    return handler;\n};\n\n/**\n * @param {string|HTMLElement|JQuery<HTMLElement>} toMatch\n * @param { {selector:string} } node\n * @returns {boolean}\n */ \nconst match = function (toMatch, node) {\n    if (isString(toMatch)) {\n        return toMatch === node.selector;\n    }\n    return $(toMatch).is(node.selector);\n};\n\nconst nodeManager = {\n    list: [],\n\n    /**\n     * Add a new node handler\n     * @param  {string} selector jQuery-compatible selector to use to match nodes\n     * @param  {Function} handler  Handlers are new-able functions. They will be called with $el as context.? TODO: Think this through\n     * @returns {void}\n     */\n    register: function (selector, handler) {\n        this.list.unshift(normalize(selector, handler));\n    },\n\n    /**\n     * @param {string|HTMLElement|JQuery<HTMLElement>} selector\n     * @returns NodeHandler\n     */ \n    getHandler: function (selector) {\n        return this.list.find(function (node) {\n            return match(selector, node);\n        });\n    },\n\n    replace: function (selector, handler) {\n        let index;\n        this.list.forEach(function (currentHandler, i) {\n            if (selector === currentHandler.selector) {\n                index = i;\n                return false;\n            }\n        });\n        this.list.splice(index, 1, normalize(selector, handler));\n    }\n};\n\n//bootstraps\nconst defaultHandlers = [\n    require('./input-checkbox-node').default,\n    require('./default-input-node').default,\n    require('./default-node')\n];\ndefaultHandlers.reverse().forEach(function (handler) {\n    nodeManager.register(handler.selector, handler);\n});\n\nexport default nodeManager;\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/node-manager/index.js","import BaseView from './default-input-node';\nimport config from 'config';\n\nconst offAttr = config.attrs.checkboxOffValue;\n\nexport default BaseView.extend({\n    propertyHandlers: [\n\n    ],\n\n    getUIValue: function () {\n        const $el = this.$el;\n        const offAttrVal = $el.attr(offAttr);\n        const offVal = (offAttrVal && typeof offAttrVal !== 'undefined') ? offAttrVal : false;\n\n        const onAttrVal = $el.attr('value');\n        //attr = initial value, prop = current value\n        const onVal = (onAttrVal && typeof onAttrVal !== 'undefined') ? $el.prop('value') : true;\n\n        const val = ($el.is(':checked')) ? onVal : offVal;\n        return val;\n    },\n    initialize: function () {\n        BaseView.prototype.initialize.apply(this, arguments);\n    }\n}, { selector: ':checkbox,:radio' });\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/node-manager/input-checkbox-node.js","const { extend, has } = require('lodash');\n\nvar extendView = function (protoProps, staticProps) {\n    var me = this;\n    var child;\n\n    // The constructor function for the new subclass is either defined by you\n    // (the \"constructor\" property in your `extend` definition), or defaulted\n    // by us to simply call the parent's constructor.\n    if (protoProps && has(protoProps, 'constructor')) {\n        child = protoProps.constructor;\n    } else {\n        child = function () { return me.apply(this, arguments); };\n    }\n\n    // Add static properties to the constructor function, if supplied.\n    extend(child, me, staticProps);\n\n    // Set the prototype chain to inherit from `parent`, without calling\n    // `parent`'s constructor function.\n    var Surrogate = function () { this.constructor = child; };\n    Surrogate.prototype = me.prototype;\n    child.prototype = new Surrogate();\n\n    // Add prototype properties (instance properties) to the subclass,\n    // if supplied.\n    if (protoProps) {\n        extend(child.prototype, protoProps);\n    }\n\n    // Set a convenience property in case the parent's prototype is needed\n    // later.\n    child.__super__ = me.prototype; //eslint-disable-line no-underscore-dangle\n\n    return child;\n};\n\nvar View = function (options) {\n    this.$el = (options.$el) || $(options.el);\n    this.el = options.el;\n    this.initialize.apply(this, arguments);\n\n};\nextend(View.prototype, {\n    initialize: function () {},\n});\n\nView.extend = extendView;\n\nmodule.exports = View;\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils/base-view.js","import { isString, isFunction, isRegExp, each } from 'lodash';\n\nconst defaultHandlers = [\n    require('./attributes/no-op-attr').default,\n    require('./attributes/events/default-event-attr').default,\n    require('./attributes/loop-attrs/foreach-attr').default,\n    require('./attributes/loop-attrs/repeat-attr').default,\n    require('./attributes/class-attr').default,\n    require('./attributes/boolean-attr').default,\n    require('./attributes/toggles/show-if-attr').default,\n    require('./attributes/toggles/hide-if-attr').default,\n    require('./attributes/binds/checkbox-radio-bind-attr').default,\n    require('./attributes/binds/input-bind-attr').default,\n    require('./attributes/binds/default-bind-attr').default,\n    require('./attributes/default-attr').default\n];\n\nconst handlersList = [];\n\nconst normalize = function (attributeMatcher, nodeMatcher, handler) {\n    if (!nodeMatcher) {\n        nodeMatcher = '*';\n    }\n    if (isFunction(handler)) {\n        handler = {\n            handle: handler\n        };\n    }\n    return $.extend(handler, { test: attributeMatcher, target: nodeMatcher });\n};\n\ndefaultHandlers.forEach(function (handler) {\n    handlersList.push(normalize(handler.test, handler.target, handler));\n});\n\n\nconst matchAttr = function (matchExpr, attr, $el) {\n    let attrMatch;\n\n    if (isString(matchExpr)) {\n        attrMatch = (matchExpr === '*' || (matchExpr.toLowerCase() === attr.toLowerCase()));\n    } else if (isFunction(matchExpr)) {\n        //TODO: remove element selectors from attributes\n        attrMatch = matchExpr(attr, $el);\n    } else if (isRegExp(matchExpr)) {\n        attrMatch = attr.match(matchExpr);\n    }\n    return attrMatch;\n};\n\nconst matchNode = function (target, nodeFilter) {\n    return (isString(nodeFilter)) ? (nodeFilter === target) : nodeFilter.is(target);\n};\n\nconst attributeManager = {\n    list: handlersList,\n    /**\n     * Add a new attribute handler.\n     *\n     * @param  {string|Function|RegExp} attributeMatcher Description of which attributes to match.\n     * @param  {string|JQuery<HTMLElement>} nodeMatcher Which nodes to add attributes to. Use [jquery Selector syntax](https://api.jquery.com/category/selectors/).\n     * @param  {Function|Object} handler If `handler` is a function, the function is called with `$element` as context, and attribute value + name. If `handler` is an object, it should include two functions, and have the form: `{ init: fn,  handle: fn }`. The `init` function is called when the page loads; use this to define event handlers. The `handle` function is called with `$element` as context, and attribute value + name.\n     * @returns {void}\n     */\n    register: function (attributeMatcher, nodeMatcher, handler) {\n        handlersList.unshift(normalize.apply(null, arguments));\n    },\n\n    /**\n     * Find an attribute matcher matching some criteria.\n     *\n     * @param  {string} attrFilter Attribute to match.\n     * @param  {string|JQuery<HTMLElement>} nodeFilter Node to match.\n     *\n     * @returns {AttributeHandler[]} An array of matching attribute handlers, or null if no matches found.\n     */\n    filter: function (attrFilter, nodeFilter) {\n        let filtered = handlersList.filter(function (handler) {\n            return matchAttr(handler.test, attrFilter);\n        });\n        if (nodeFilter) {\n            filtered = filtered.filter(function (handler) {\n                return matchNode(handler.target, nodeFilter);\n            });\n        }\n        return filtered;\n    },\n\n    /**\n     * Replace an existing attribute handler.\n     *\n     * @param  {string} attrFilter Attribute to match.\n     * @param  {string|JQuery<HTMLElement>} nodeFilter Node to match.\n     * @param  {Function|Object} handler The updated attribute handler. If `handler` is a function, the function is called with `$element` as context, and attribute value + name. If `handler` is an object, it should include two functions, and have the form: `{ init: fn,  handle: fn }`. The `init` function is called when the page loads; use this to define event handlers. The `handle` function is called with `$element` as context, and attribute value + name.\n     * @returns {void}\n     */\n    replace: function (attrFilter, nodeFilter, handler) {\n        let index;\n        each(handlersList, function (currentHandler, i) {\n            if (matchAttr(currentHandler.test, attrFilter) && matchNode(currentHandler.target, nodeFilter)) {\n                index = i;\n                return false;\n            }\n        });\n        handlersList.splice(index, 1, normalize(attrFilter, nodeFilter, handler));\n    },\n\n    /**\n     *  Retrieve the appropriate handler for a particular attribute. There may be multiple matching handlers, but the first (most exact) match is always used.\n     *\n     * @param {string} attr The attribute.\n     * @param {string|JQuery<HTMLElement>} $el The DOM element.\n     *\n     * @returns {AttributeHandler|undefined} The attribute handler, if a matching one is found\n     */\n    getHandler: function (attr, $el) {\n        const filtered = this.filter(attr, $el);\n        //There could be multiple matches, but the top first has the most priority\n        return filtered[0];\n    }\n};\n\nexport default attributeManager;\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attribute-manager/index.js","/**\n * @type AttributeHandler \n */\nconst noopAttr = {\n\n    target: '*',\n\n    test: /^(?:model|convert|channel|on-init)/i,\n\n    handle: ()=> {},\n    parse: ()=> []\n};\n\nexport default noopAttr;\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attribute-manager/attributes/no-op-attr/index.js","import { events } from 'config';\nimport { toPublishableFormat } from 'utils/parse-utils';\n\nfunction eventNameFromAttr(attr) {\n    const eventName = attr.replace('on-', '');\n    const nameSpacedEvent = `${eventName}.f-event`;\n    return nameSpacedEvent;\n}\n/**\n * @type AttributeHandler \n */\nconst defaultEventAttr = {\n\n    target: '*',\n\n    test: function (attr) {\n        return (attr.indexOf('on-') === 0);\n    },\n\n    unbind: function (attr, $el) {\n        const eventName = eventNameFromAttr(attr);\n        $el.off(eventName);\n    },\n\n    parse: ()=> ([]), //There's nothing to subscribe to on an event\n    handle: ()=> {},\n\n    init: function (attr, topics, $el) {\n        const matching = topics[0] && topics[0].name; //multiple topics aren't really relevant here\n        const eventName = eventNameFromAttr(attr);\n        $el.off(eventName).on(eventName, function (evt) {\n            evt.preventDefault();\n            var listOfOperations = toPublishableFormat(matching);\n            $el.trigger(events.trigger, { data: listOfOperations, source: attr });\n        });\n    }\n};\n\nexport default defaultEventAttr;\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attribute-manager/attributes/events/default-event-attr/index.js","import { toImplicitType } from 'utils/parse-utils';\nimport { animation } from 'config';\n\nimport { aliasesFromTopics, parseTopics } from '../loop-attr-utils';\nimport { addChangeClassesToList } from 'utils/animation';\nimport { each, template } from 'lodash';\n\nimport { getKnownDataForEl, updateKnownDataForEl, removeKnownData, findMissingReferences, stubMissingReferences, addBackMissingReferences, getOriginalContents, clearOriginalContents } from 'dom/attribute-manager/attr-template-utils';\n\nconst elAnimatedMap = new WeakMap(); //TODO: Can probably get rid of this if we make subscribe a promise and distinguish between initial value\n\n/**\n * @type AttributeHandler\n */\nconst foreachAttr = {\n\n    test: 'foreach',\n\n    target: '*',\n\n    unbind: function (attr, $el) {\n        const el = $el.get(0);\n        elAnimatedMap.delete(el);\n        \n        const template = getOriginalContents($el);\n        const current = $el.html();\n        if (template && current !== template) {\n            $el.html(template);\n        }\n        clearOriginalContents($el);\n        removeKnownData($el);\n    },\n\n    parse: function (topics) {\n        return parseTopics(topics);\n    },\n\n    handle: function (value, prop, $el, topics) {\n        value = ($.isPlainObject(value) ? value : [].concat(value));\n\n        const { keyAlias, valueAlias } = aliasesFromTopics(topics, value);\n\n        const originalHTML = getOriginalContents($el, ($el)=> $el.html());\n        const knownData = getKnownDataForEl($el);\n        const missingReferences = findMissingReferences(originalHTML, [keyAlias, valueAlias].concat(Object.keys(knownData)));\n        const stubbedTemplate = stubMissingReferences(originalHTML, missingReferences);\n\n        const templateFn = template(stubbedTemplate);\n        const $dummyEl = $('<div></div>');\n        each(value, function (dataval, datakey) {\n            if (dataval === undefined || dataval === null) {\n                dataval = dataval + ''; //convert undefineds to strings\n            }\n            const templateData = $.extend(true, {}, knownData, {\n                [keyAlias]: datakey,\n                [valueAlias]: dataval\n            });\n\n            let nodes;\n            let isTemplated;\n            try {\n                const templated = templateFn(templateData);\n                const templatedWithReferences = addBackMissingReferences(templated, missingReferences);\n                isTemplated = templatedWithReferences !== stubbedTemplate;\n                nodes = $(templatedWithReferences);\n            } catch (e) { //you don't have all the references you need;\n                nodes = $(stubbedTemplate);\n                isTemplated = true;\n                updateKnownDataForEl($(nodes), templateData);\n            }\n\n            nodes.each(function (i, newNode) {\n                const $newNode = $(newNode);\n                each($newNode.data(), function (val, key) {\n                    $newNode.data(key, toImplicitType(val));\n                });\n                if (!isTemplated && !$newNode.html().trim()) {\n                    $newNode.html(dataval);\n                }\n            });\n            $dummyEl.append(nodes);\n        });\n        \n        const el = $el.get(0);\n        const isInitialAnim = !elAnimatedMap.get(el);\n        const $withAnimAttrs = addChangeClassesToList($el.children(), $dummyEl.children(), isInitialAnim, animation);\n        $el.empty().append($withAnimAttrs);\n\n        elAnimatedMap.set(el, true);\n    }\n};\n\nexport default foreachAttr;\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attribute-manager/attributes/loop-attrs/foreach-attr/index.js","import { template, each, isEmpty } from 'lodash';\nimport { toImplicitType } from 'utils/parse-utils';\nimport { random } from 'utils/general';\nimport { attrs, animation } from 'config';\n\nconst templateIdAttr = attrs.repeat.templateId;\n\nimport { addChangeClassesToList } from 'utils/animation';\n\nconst elAnimatedMap = new WeakMap(); //TODO: Can probably get rid of this if we make subscribe a promise and distinguish between initial value\n\nimport { getKnownDataForEl, updateKnownDataForEl, removeKnownData, findMissingReferences, stubMissingReferences, addBackMissingReferences, getOriginalContents, clearOriginalContents } from 'dom/attribute-manager/attr-template-utils';\n\nimport { aliasesFromTopics, parseTopics } from '../loop-attr-utils';\n\n/**\n * @type AttributeHandler \n */\nconst loopAttrHandler = {\n    test: 'repeat',\n\n    target: '*',\n\n    unbind: function (attr, $el) {\n        var id = $el.data(templateIdAttr);\n        if (id) {\n            $el.nextUntil(':not([data-' + id + '])').remove();\n            // $el.removeAttr('data-' + templateIdAttr); //FIXME: Something about calling rebind multiple times in IB makes this happen without the removal\n        }\n\n        const el = $el.get(0);\n        elAnimatedMap.delete(el);\n\n        const originalHTML = getOriginalContents($el);\n        const current = $el.get(0).outerHTML;\n        if (originalHTML && current !== originalHTML) {\n            $el.replaceWith(originalHTML);\n        }\n        clearOriginalContents($el);\n        removeKnownData($el);\n    },\n\n    parse: function (topics) {\n        return parseTopics(topics);\n    },\n\n    init: function (attr, value, $el) {\n        \n    },\n\n    handle: function (value, prop, $el, topics) {\n        value = ($.isPlainObject(value) ? value : [].concat(value));\n        let id = $el.data(templateIdAttr);\n        \n        $el.removeAttr('hidden');\n        const originalHTML = getOriginalContents($el, ($el)=> $el.get(0).outerHTML);\n\n        const $dummyOldDiv = $('<div></div>');\n        if (id) {\n            const $removed = $el.nextUntil(':not([data-' + id + '])').remove();\n            $dummyOldDiv.append($removed);\n        } else {\n            id = random('repeat-');\n            $el.attr('data-' + templateIdAttr, id);\n        }\n\n        const { keyAlias, valueAlias } = aliasesFromTopics(topics, value);\n\n        const knownData = getKnownDataForEl($el);\n        const missingReferences = findMissingReferences(originalHTML, [keyAlias, valueAlias].concat(Object.keys(knownData)));\n        const stubbedTemplate = stubMissingReferences(originalHTML, missingReferences);\n\n        if (isEmpty(value)) {\n            $el.attr('hidden', true); //There's always going to be 1 el otherwise\n            return;\n        }\n\n        const templateFn = template(stubbedTemplate);\n        let last;\n        each(value, function (dataval, datakey) {\n            if (dataval === undefined || dataval === null) {\n                dataval = dataval + ''; //convert undefineds to strings\n            }\n            const templateData = $.extend(true, {}, knownData, {\n                [keyAlias]: datakey,\n                [valueAlias]: dataval\n            });\n\n            let nodes;\n            let isTemplated;\n            try {\n                const templated = templateFn(templateData);\n                const templatedWithReferences = addBackMissingReferences(templated, missingReferences);\n                isTemplated = templatedWithReferences !== stubbedTemplate;\n                nodes = $(templatedWithReferences);\n            } catch (e) { //you don't have all the references you need;\n                nodes = $(stubbedTemplate);\n                isTemplated = true;\n                updateKnownDataForEl($(nodes), templateData);\n            }\n\n            var hasData = (dataval !== null && dataval !== undefined);\n            nodes.each(function (i, newNode) {\n                const $newNode = $(newNode);\n                $newNode.removeAttr('data-f-repeat').removeAttr('data-' + templateIdAttr);\n                each($newNode.data(), function (val, key) {\n                    if (!last) {\n                        $el.data(key, toImplicitType(val));\n                    } else {\n                        $newNode.data(key, toImplicitType(val));\n                    }\n                });\n                $newNode.attr('data-' + id, true);\n                if (!isTemplated && !$newNode.children().length && hasData) {\n                    $newNode.html(dataval + '');\n                }\n            });\n            if (!last) {\n                last = $el.html(nodes.html());\n            } else {\n                last = nodes.insertAfter(last);\n            }\n        });\n\n        const $newEls = $el.nextUntil(`:not('[data-${id}]')`);\n\n        const el = $el.get(0);\n        const isInitialAnim = !elAnimatedMap.get(el);\n        addChangeClassesToList($dummyOldDiv.children(), $newEls, isInitialAnim, animation);\n\n        elAnimatedMap.set(el, true);\n    }\n};\n\nexport default loopAttrHandler;\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attribute-manager/attributes/loop-attrs/repeat-attr/index.js","import { promisify } from './promise-utils';\n\nfunction executeAndResolve(fn, args, $def) {\n    const promisifiedFn = promisify(fn);\n    return promisifiedFn.apply(fn, args).then((result)=> {\n        $def.resolve(result);\n    }, (e)=> {\n        $def.reject(e);\n    });\n}\n\n/**\n * Returns debounced version of original (optionally promise returning) function\n * \n * @param {function(*):Promise} fn function to debounce\n * @param {number} debounceInterval \n * @param {Function[]} [argumentsReducers] pass in 1 reducer for each option your function takes\n * @returns {Function} debounced function\n */\nexport default function debounceAndMerge(fn, debounceInterval, argumentsReducers) {\n    if (!argumentsReducers) {\n        var arrayReducer = function (accum, newVal) {\n            return (accum || []).concat(newVal);\n        };\n        argumentsReducers = [arrayReducer];\n    }\n\n    const queue = [];\n    let timer = null;\n\n    function mergeArgs(oldArgs, newArgs) {\n        const merged = newArgs.map(function (newArg, index) {\n            var reducer = argumentsReducers[index];\n            if (reducer) {\n                return reducer(oldArgs[index], newArg);\n            }\n            return newArg;\n        });\n        return merged;\n    }\n\n    /**\n     * @returns {Promise}\n     */\n    return function debouncedFunction() {\n        const newArgs = Array.prototype.slice.call(arguments);\n        if (timer) {\n            clearTimeout(timer);\n            const mergedArgs = mergeArgs(queue[0].args, newArgs);\n            queue[0].args = mergedArgs;\n        } else {\n            const args = mergeArgs([], newArgs);\n            queue.push({\n                $def: $.Deferred(),\n                args: args\n            });\n        }\n\n        timer = setTimeout(()=> {\n            timer = null;\n            const item = queue.pop();\n            executeAndResolve(fn, item.args, item.$def);\n        }, debounceInterval);\n\n        return queue[0].$def.promise();\n    };\n}\n\n\n// WEBPACK FOOTER //\n// ./src/utils/general/debounce-and-merge.js","import { isNumber } from 'lodash';\n\nconst elClassesMap = new WeakMap();\nfunction deleteAddedClasses($el) {\n    const el = $el.get(0);\n    const addedClasses = elClassesMap.get(el);\n    if (addedClasses) {\n        $el.removeClass(addedClasses);\n    }\n}\n/**\n * @type AttributeHandler\n */\nconst classAttr = {\n    test: 'class',\n\n    target: '*',\n\n\n    unbind: function (attr, $el) {\n        const el = $el.get(0);\n        deleteAddedClasses($el);\n        elClassesMap.delete(el);\n    },\n\n    handle: function (value, prop, $el) {\n        if (Array.isArray(value)) {\n            value = value[value.length - 1];\n        }\n\n        const el = $el.get(0);\n        deleteAddedClasses($el);\n\n        if (isNumber(value)) {\n            value = 'value-' + value;\n        }\n        setTimeout(()=> {\n            $el.addClass(value); //If the classes have an animation set, removing with a timeout will trigger it\n        }, 0);\n        elClassesMap.set(el, value);\n    }\n};\n\nexport default classAttr;\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attribute-manager/attributes/class-attr/index.js","/**\n * @type AttributeHandler \n */\nconst booleanAttrHandler = {\n    target: '*',\n\n    test: /^(?:checked|selected|async|autofocus|autoplay|controls|defer|ismap|loop|multiple|open|required|scoped|disabled|hidden|readonly)$/i,\n\n    handle: function (value, prop, $el) {\n        if (Array.isArray(value)) {\n            value = value[value.length - 1];\n        }\n        const val = ($el.attr('value')) ? (value == $el.prop('value')) : !!value; //eslint-disable-line eqeqeq\n        $el.prop(prop, val);\n    }\n};\n\nexport default booleanAttrHandler;\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attribute-manager/attributes/boolean-attr/index.js","/**\n  * @type AttributeHandler\n  */\nconst showifHandler = {\n    test: 'showif',\n\n    target: '*',\n\n    init: function (attr, value, $el) {\n        $el.hide(); //hide by default; if not this shows text until data is fetched\n    },\n\n    handle: function (value, prop, $el) {\n        if (Array.isArray(value)) {\n            value = value[value.length - 1];\n        }\n        return (value && `${value}`.trim()) ? $el.show() : $el.hide();\n    }\n};\n\nexport default showifHandler;\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attribute-manager/attributes/toggles/show-if-attr/index.js","/**\n  * @type AttributeHandler\n  */\nconst hideifHandler = {\n    test: 'hideif',\n\n    target: '*',\n\n    init: function (attr, value, $el) {\n        $el.hide(); //hide by default; if not this shows text until data is fetched\n    },\n    handle: function (value, prop, $el) {\n        if (Array.isArray(value)) {\n            value = value[value.length - 1];\n        }\n        if (value && `${value}`.trim()) {\n            $el.hide();\n        } else {\n            $el.show();\n        }\n    }\n};\n\nexport default hideifHandler;\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attribute-manager/attributes/toggles/hide-if-attr/index.js","/**\n  * @type {AttributeHandler}\n  */\nconst checkboxAttrHandler = {\n\n    target: ':checkbox,:radio',\n\n    test: 'bind',\n\n    handle: function (value, prop, $el) {\n        if (Array.isArray(value)) {\n            value = value[value.length - 1];\n        }\n        const settableValue = $el.attr('value'); //initial value\n        const isChecked = (typeof settableValue !== 'undefined') ? (settableValue == value) : !!value; //eslint-disable-line eqeqeq\n        $el.prop('checked', isChecked);\n    }\n};\n\nexport default checkboxAttrHandler;\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attribute-manager/attributes/binds/checkbox-radio-bind-attr/index.js","/**\n * @type AttributeHandler \n */\nconst inputBindAttr = {\n    target: 'input, select, textarea',\n\n    test: 'bind',\n\n    handle: function (value, prop, $el) {\n        if ($el.is(':focus')) {\n            return; //If an user is actively typing in a value, don't overwrite it\n        }\n        if (value === undefined) {\n            value = '';\n        } else if (Array.isArray(value)) {\n            value = value[value.length - 1];\n        }\n        $el.val(value + '');\n    }\n};\n\nexport default inputBindAttr;\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attribute-manager/attributes/binds/input-bind-attr/index.js","import { template } from 'lodash';\nimport { addContentAndAnimate } from 'utils/animation';\nimport { animation } from 'config';\n\nimport { extractVariableName, extractAlias, translateDataToTemplatable, translateDataToInsertable } from '../bind-utils';\n\nimport { getKnownDataForEl, updateKnownDataForEl, removeKnownData, findMissingReferences, stubMissingReferences, addBackMissingReferences, isTemplated, getOriginalContents, clearOriginalContents } from 'dom/attribute-manager/attr-template-utils';\n\nconst elAnimatedMap = new WeakMap(); //TODO: Can probably get rid of this if we make subscribe a promise and distinguish between initial value\n\nfunction toAliasMap(topics) {\n    return (topics || []).reduce((accum, topic)=> {\n        accum[topic.name] = topic.alias;   \n        return accum;\n    }, {});\n}\n\nfunction getNewContent(currentContents, value, $el, topics) {\n    if (!isTemplated(currentContents)) {\n        return translateDataToInsertable(value);\n    }\n\n    const templateData = translateDataToTemplatable(value, toAliasMap(topics));\n    const knownData = getKnownDataForEl($el);\n    $.extend(templateData, knownData);\n\n    const missingReferences = findMissingReferences(currentContents, Object.keys(templateData));\n    const stubbedTemplate = stubMissingReferences(currentContents, missingReferences);\n\n    const templateFn = template(stubbedTemplate);\n    try {\n        const templatedHTML = templateFn(templateData);\n        const templatedWithReferences = addBackMissingReferences(templatedHTML, missingReferences);\n        return templatedWithReferences;\n    } catch (e) { //you don't have all the references you need;\n        updateKnownDataForEl($el, templateData);\n        return currentContents;\n    }\n}\n\n/**\n * @type AttributeHandler \n */\nconst bindAttrHandler = {\n\n    target: '*',\n\n    test: 'bind',\n\n    parse: function (topics) {\n        return topics.map((topic)=> {\n            const attrVal = topic.name;\n            return {\n                name: extractVariableName(attrVal),\n                alias: extractAlias(attrVal),\n            };\n        });\n    },\n\n    //FIXME: Can't do this because if you have a bind within a foreach, foreach overwrites the old el with a new el, and at that points contents are lost\n    // But if i don't do this the <%= %> is going to show up\n    // init: function (attr, value, $el) {\n    //     const contents = getOriginalContents($el, ($el)=> $el.html());\n    //     if (isTemplated(contents)) {\n    //         $el.empty();\n    //     }\n    // },\n\n    unbind: function (attr, $el) {\n        const el = $el.get(0);\n        elAnimatedMap.delete(el);\n\n        const bindTemplate = getOriginalContents($el);\n        const current = $el.html();\n        if (bindTemplate && current !== bindTemplate) {\n            $el.html(bindTemplate);\n        }\n        clearOriginalContents($el);\n        removeKnownData($el);\n    },\n\n    handle: function (value, prop, $el, topics) {\n        const el = $el.get(0);\n        const originalContents = getOriginalContents($el, ($el)=> $el.html());\n        const contents = getNewContent(originalContents, value, $el, topics);\n\n        addContentAndAnimate($el, contents, !elAnimatedMap.has(el), animation);\n        elAnimatedMap.set(el, true);\n    }\n};\n\nexport default bindAttrHandler;\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attribute-manager/attributes/binds/default-bind-attr/index.js","export function translateDataToInsertable(value) {\n    if (Array.isArray(value)) {\n        value = value[value.length - 1];\n    }\n    value = ($.isPlainObject(value)) ? JSON.stringify(value) : value + '';\n    return value;\n}\n\n/**\n * @param {any} value\n * @param {Object} aliasMap\n * @returns {{value: any}}\n */\nexport function translateDataToTemplatable(value, aliasMap) {\n    const templateData = { value: value };\n    if ($.isPlainObject(value)) {\n        Object.keys(value).forEach((originalName)=> {\n            const alias = aliasMap[originalName] || originalName;\n            templateData[alias] = value[originalName];\n        });\n    } else {\n        Object.keys(aliasMap).forEach((originalName)=> {\n            const alias = aliasMap[originalName] || originalName;\n            templateData[alias] = value;\n        });\n    }\n    \n    return templateData;\n}\n\nconst AS_REGEX = /(.*) (?:as)\\s+\\((.*)\\)/;\n\n/**\n * @param {string} attrVal \n * @returns {string}\n */\nexport function extractVariableName(attrVal) {\n    const asMatch = attrVal.trim().match(AS_REGEX);\n    const varName = asMatch && asMatch[1] ? asMatch[1] : attrVal;\n    return varName.trim();\n}\n\n/**\n * @param {string} attrVal \n * @returns {string}\n */\nexport function extractAlias(attrVal) {\n    const asMatch = attrVal.trim().match(AS_REGEX);\n    const alias = asMatch && asMatch[2] ? asMatch[2] : attrVal;\n    return alias.trim();\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attribute-manager/attributes/binds/bind-utils/index.js","/**\n * @type AttributeHandler \n */\nconst defaultAttr = {\n    test: '*',\n\n    target: '*',\n\n    handle: function (value, prop, $el) {\n        //FIXME: The _right_ way to do this would be to set attr, not prop. \n        //However Polymer 1.0 doesn't link attrs with stringified JSON, and that's really the primary use-case for this, so, ignoring\n        //However Polymer is fine with 'data-X' attrs having stringified JSON. Eventually we should make this attr and fix polymer\n        //but can't do that for backwards comptability reason. See commit bbc4a49039fb73faf1ef591a07b371d7d667cf57\n        $el.prop(prop, value);\n    }\n};\n\nexport default defaultAttr;\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attribute-manager/attributes/default-attr/index.js","/**\n * Hooks up dom elements to mutation observer\n * @param  {HTMLElement} target     root to start observing from\n * @param  {Object} domManager \n * @param  {boolean} isEnabled Determines if it's enabled by default\n * @returns {Object}\n */\nexport default function (target, domManager, isEnabled) {\n    if (typeof MutationObserver === 'undefined') {\n        return;\n    }\n    // Create an observer instance\n    var observer = new MutationObserver(function (mutations) {\n        mutations.forEach(function (mutation) {\n            var added = $(mutation.addedNodes).find(':f');\n            added = added.add($(mutation.addedNodes).filter(':f'));\n            var removed = $(mutation.removedNodes).find(':f');\n            removed = removed.add($(mutation.removedNodes).filter(':f'));\n            if (added && added.length) {\n                domManager.bindAll(added);\n            }\n            if (removed && removed.length) {\n                domManager.unbindAll(removed);\n            }\n            if (mutation.attributeName === 'data-f-channel') {\n                domManager.unbindAll(mutation.target);\n                domManager.bindAll(mutation.target);\n            }\n        });\n    });\n    var mutconfig = {\n        attributes: true,\n        attributeFilter: ['data-f-channel'],\n        childList: true,\n        subtree: true,\n        characterData: false\n    };\n    var publicApi = {\n        enable: function () {\n            observer.observe(target, mutconfig);\n        },\n        disable: function () {\n            observer.disconnect();\n        }\n    };\n    if (isEnabled) {\n        publicApi.enable();\n    }\n    return publicApi;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/plugins/auto-update-bindings.js","import DefaultChannelManager from './channel-manager';\n\nimport router from 'channels/channel-router';\nimport { JSONRouteHandler, EpicenterRouteHandler, DomRouteHandler } from './route-handlers';\nimport { interpolatable, routable } from './channel-manager-enhancements';\n\n//Moving connecting glue here so channel-manager can be tested in isolation\nconst InterpolatableRoutableChannelManager = interpolatable(routable(DefaultChannelManager, router));\nexport default function ChannelManager(opts) {\n    const defaultRouteHandlers = [JSONRouteHandler, DomRouteHandler, EpicenterRouteHandler];\n    const routes = opts && opts.routes ? opts.routes : [];\n    const cm = new InterpolatableRoutableChannelManager($.extend(true, {}, {\n        routes: [].concat(routes, defaultRouteHandlers)\n    }, opts));\n    return cm;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/configured-channel-manager.js","import $ from 'jquery';\nimport { normalizeParamOptions, publishableToObject } from './channel-utils';\nimport { uniqueId, isFunction, intersection, uniq } from 'lodash';\n/**\n * \n * @param {Array<string>|string} topics \n * @param {Function} callback \n * @param {Object} options\n * @returns {Subscription}\n */\nfunction makeSubs(topics, callback, options) {\n    const id = uniqueId('subs-');\n    const defaults = {\n        /**\n         * Determines if the callback function is called per item or per subscription.\n         *\n         * If `false`, the callback function is called once for each item to which you are subscribing. If `true`, the callback function is called only once, no matter how many items you have subscribed to. Defaults to `false`.\n         * @type {Boolean}\n         */\n        batch: false,\n\n\n        /**\n         * Determines if the last published data should be cached for future notifications. For example:\n         *\n         *      channel.subscribe(['price', 'cost'], callback1, { batch: true, cache: false });\n         *      channel.subscribe(['price', 'cost'], callback2, { batch: true, cache: true });\n         *\n         *      channel.publish({ 'price': 1 });\n         *      channel.publish({ 'cost': 1 });\n         *\n         * Here, `callback2` is called once, and `callback1` is not called: The channel caches the first publish value and notifies after all dependent topics have data.\n         *\n         * If the `publish()` call was instead:\n         *\n         *      channel.publish({ price: 1, cost: 1 })\n         *\n         * Then both `callback1` and `callback2` are called.\n         *\n         * Setting `cache: true` is useful if you know if your topics will be published individually, but you still want to handle them together. As a concrete example, consider a slider with a chart: the input values, determined by the slider, should not cause the chart to redraw immediately. The chart could wait until all sliders have been updated a checkbox is checked, for example.\n         * Setting `cache: false` is useful if you know if your topics will *always* be published together and they'll be called at the same time.\n         *\n         * Note this has no discernible effect if `batch` is `false`. Additionally, this has no discernible effect if `variables` are \"noisy\" (`silent: true`).\n         * @type {Boolean}\n         */\n        cache: true,\n    };\n    const opts = $.extend({}, defaults, options);\n    if (!callback || !isFunction(callback)) {\n        throw new Error('subscribe callback should be a function');\n    }\n    return $.extend(true, {\n        id: id,\n        topics: [].concat(topics),\n        callback: callback,\n    }, opts);\n}\n\nlet cacheBySubsId = {};\nlet sentDataBySubsId = {};\n\nfunction copy(data) {\n    if (Array.isArray(data)) {\n        return data.map((d)=> copy(d));\n    } else if ($.isPlainObject(data)) {\n        return Object.keys(data).reduce((accum, key)=> {\n            accum[key] = copy(data[key]);\n            return accum;\n        }, {});\n    }\n    return data;\n}\n/**\n* @param {Subscription} subscription \n* @param {*} data\n*/\nfunction callbackSubscriber(subscription, data) {\n    const id = subscription.id;\n    subscription.callback(data, { id: id, previousData: sentDataBySubsId[id] });\n    sentDataBySubsId[id] = copy(data);\n}\n\n/**\n* @param {Publishable[]} topics\n* @param {Subscription} subscription \n*/\nfunction checkAndNotifyBatch(topics, subscription) {\n    const publishData = publishableToObject(topics);\n    const matchingTopics = intersection(Object.keys(publishData), subscription.topics);\n    if (!matchingTopics.length) {\n        return;\n    }\n\n    const relevantDataFromPublish = matchingTopics.reduce((accum, topic)=> {\n        accum[topic] = publishData[topic];\n        return accum;\n    }, {});\n    const cachedDataForSubs = cacheBySubsId[subscription.id] || {};\n    const knownDataForSubs = $.extend({}, cachedDataForSubs, relevantDataFromPublish);//jQ Deep clone here will also concat arrays.\n\n    if (subscription.cache) {\n        cacheBySubsId[subscription.id] = knownDataForSubs;\n    }\n    const hasDataForAllTopics = intersection(Object.keys(knownDataForSubs), subscription.topics).length === subscription.topics.length;\n    if (hasDataForAllTopics) {\n        callbackSubscriber(subscription, knownDataForSubs);\n    }\n}\n\n\n/**\n * @param {Publishable[]} topics\n * @param {Subscription} subscription \n */\nfunction checkAndNotify(topics, subscription) {\n    topics.forEach(function (topic) {\n        const needsThisTopic = subscription.topics.indexOf(topic.name) !== -1;\n        const isWildCard = subscription.topics.indexOf('*') !== -1;\n        if (needsThisTopic || isWildCard) {\n            callbackSubscriber(subscription, { [topic.name]: topic.value });\n        }\n    });\n}\n\n/**\n* @param {Subscription[]} subcriptionList\n* @returns {Array<string>}\n*/\nfunction getTopicsFromSubsList(subcriptionList) {\n    return subcriptionList.reduce(function (accum, subs) {\n        accum = accum.concat(subs.topics);\n        return accum;\n    }, []);\n}\n\n/**\n * @class ChannelManager\n */\nclass ChannelManager {\n    constructor(options) {\n        this.subscriptions = [];\n    }\n\n    /**\n     * Perform the action (for example, update the variables or call the operation), and alert subscribers.\n     *\n     * **Examples**\n     *\n     *      Flow.channel.publish('operations:myOperation', myOperParam);\n     *      Flow.channel.publish({ name: 'operations:operName', value: [operParam1, operParam2] });\n     *\n     *      Flow.channel.publish('variables:myVariable', newValue);\n     *      Flow.channel.publish({ myVar1: newVal1, myVar2: newVal2 });\n     *\n     * @param {string|Publishable} topic\n     * @param {any} [value] item to publish\n     * @param {PublishOptions} [options]\n     * @returns {Promise}\n     */\n    publish(topic, value, options) {\n        const normalized = normalizeParamOptions(topic, value, options);\n        let prom = $.Deferred().resolve(normalized.params).promise();\n        prom = prom.then((publishResponses)=> {\n            this.notify(publishResponses, options);\n            return publishResponses;\n        });\n        return prom;\n    }\n\n    /**\n     * Alert each subscriber about the operation and its parameters. This can be used to provide an update without a round trip to the server. However, it is rarely used: you almost always want to `subscribe()` instead so that the model is actually changed (has a variable update or an operation called).\n     *\n     * **Example**\n     *\n     *      Flow.channel.notify('variables:myVariable', newValue);\n     *      Flow.channel.notify('operations:myOperation', myOperParam);\n     *\n     * @param {string|Publishable} topic\n     * @param {any} [value] item to publish\n     * @param {PublishOptions} [options]\n     * @returns {void}\n     */\n    notify(topic, value, options) {\n        const normalized = normalizeParamOptions(topic, value, options);\n        // console.log('notify', normalized.params);\n        this.subscriptions.forEach(function (subs) {\n            const fn = subs.batch ? checkAndNotifyBatch : checkAndNotify;\n            fn(normalized.params, subs);\n        });\n    }\n\n    /**\n     * Subscribe to changes on a channel: Ask for notification when variables are updated, or when operations are called.\n     *\n     * **Examples**\n     *       Flow.channel.subscribe('variables:myVariable',\n     *          function() { console.log('updated!'); } );\n     *\n     *       Flow.channel.subscribe('operations:myOperation',\n     *          function() { console.log('called!'); } );\n     *\n     * @param {Array<string>|string} topics\n     * @param {Function} cb\n     * @param {Object} [options]\n     * @returns {string}\n     */\n    subscribe(topics, cb, options) {\n        const subs = makeSubs(topics, cb, options);\n        delete cacheBySubsId[subs.id]; //Just in case subsid is being reused\n        delete sentDataBySubsId[subs.id];\n        this.subscriptions = this.subscriptions.concat(subs);\n        return subs.id;\n    }\n        \n\n    /**\n     * Stop receiving notification when a variable is updated or an operation is called.\n     *\n     * @param {string} token The identifying token for this subscription. (Created and returned by the `subscribe()` call.)\n     */\n    unsubscribe(token) {\n        const olderLength = this.subscriptions.length;\n        const remaining = this.subscriptions.filter(function (subs) {\n            return subs.id !== token;\n        });\n        if (remaining.length === olderLength) {\n            throw new Error('No subscription found for token ' + token);\n        }\n        delete cacheBySubsId[token];\n        delete sentDataBySubsId[token];\n        this.subscriptions = remaining;\n    }\n\n    /**\n     * Stop receiving notifications for all operations. No parameters.\n     *\n     * @returns {void} No return value.\n     */ \n    unsubscribeAll() {\n        cacheBySubsId = {};\n        sentDataBySubsId = {};\n        this.subscriptions = [];\n    }\n\n    /**\n     * View all topics currently subscribed to for this channel.\n     * @returns {Array<string>} List of topics. \n     */\n    getSubscribedTopics() {\n        const list = uniq(getTopicsFromSubsList(this.subscriptions));\n        return list;\n    }\n\n    /**\n     *  View everything currently subscribed to this topic.\n     * \n     * @param {string} [topic] topic to filter by\n     * @returns {Subscription[]}\n     */\n    getSubscribers(topic) {\n        if (!topic) {\n            return this.subscriptions;\n        }\n        return this.subscriptions.filter(function (subs) {\n            return subs.topics.indexOf(topic) !== -1;\n        });\n    }\n}\n\nexport default ChannelManager;\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/channel-manager.js","module.exports = jQuery;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"jQuery\"\n// module id = 54\n// module chunks = 0","import _ from 'lodash';\n\n/**\n * @param {string} topic\n * @param {Handler[]} handlers\n * @param {any} [matchOptions] options to pass on to matcher\n * @returns {Handler | undefined}\n */\nexport function findBestHandler(topic, handlers, matchOptions) {\n    for (var i = 0; i < handlers.length; i++) {\n        var thishandler = handlers[i];\n        var match = thishandler.match(topic, matchOptions);\n        if (match !== false) {\n            return $.extend(true, {}, thishandler, { matched: match });\n        }\n    }\n    return undefined;\n}\n\n/**\n * [groupByHandlers description]\n * @param  {Array<string>} topics   List of topics to match. Format can be anything your handler.match function handles\n * @param  {Handler[]} handlers Handlers of type [{ match: func }]\n * @returns {HandlerWithTopics[]} The handler array with each item now having an additional 'data' attr added to it with the matching topics\n */\nexport function groupByHandlers(topics, handlers) {\n    handlers = handlers.map(function (h, index) {\n        h.key = index;\n        return h;\n    });\n    var topicMapping = ([].concat(topics)).reduce(function (accum, topic) {\n        var bestHandler = findBestHandler(topic, handlers);\n        if (bestHandler) {\n            //if handler matches different strings treat both as different handlers\n            var key = bestHandler.key + bestHandler.matched;\n            if (!accum[key]) {\n                bestHandler.data = [];\n                accum[key] = bestHandler;\n            }\n            accum[key].data.push(topic);\n        }\n        return accum;\n    }, {});\n    return _.values(topicMapping);\n}\n\n/**\n * Takes a `publish` dataset and groups it by handler maintaining the data sequence\n * @param  {Publishable[]} data     Of the form [{ name: 'X', }]\n * @param  {Handler[]} handlers Handlers of type [{ match: func }]\n * @returns {HandlerWithData[]} The handler array with each item now having an additional 'data' attr added to it with the publishable data\n */\nexport function groupSequentiallyByHandlers(data, handlers) {\n    handlers = handlers.map(function (h, index) {\n        h.key = index;\n        return h;\n    });\n    var grouped = data.reduce(function (accum, dataPt) {\n        var lastHandler = accum[accum.length - 1];\n        var bestHandler = findBestHandler(dataPt.name, handlers, true);\n        if (bestHandler) {\n            if (lastHandler && bestHandler.key === lastHandler.key) {\n                lastHandler.data.push(dataPt);\n            } else {\n                accum.push($.extend({}, bestHandler, { data: [dataPt] }));\n            }\n        } else {\n            accum.push({ data: [dataPt], matched: false });\n        }\n        return accum;\n    }, []);\n    return grouped;\n}\n\n\n/**\n * @param {any} response \n * @param {string[]} topics \n * @returns {Publishable[]}\n */\nexport function normalizeSubscribeResponse(response, topics) {\n    // @ts-ignore\n    if (response === undefined) {\n        return [];\n    }\n    const isAlreadyInPublishableFormat = Array.isArray(response) && (!response.length || response[0].name !== undefined);\n    if (isAlreadyInPublishableFormat) {\n        return response; \n    }\n    if (typeof response === 'object' && !Array.isArray(response)) {\n        return topics.reduce((accum, t)=> {\n            accum.push({ name: t, value: response[t] });\n            return accum; \n        }, []);\n    }\n    if (topics.length === 1) { //it's not in a publishable format, so someone just returned a string or something\n        const name = topics[0];\n        return [{ name: name, value: response }];\n    }\n    throw new Error('unrecognized subscribe response format');\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/channel-router/utils/handler-utils.js","/**\n * @param {Publishable[]} published \n * @param {boolean|Array<string>|{except: Array<string>}} [silentOptions]\n * @returns {Publishable[]} filtered list\n */\nexport default function silencable(published, silentOptions) {\n    if (silentOptions === true || !published) {\n        return [];\n    } else if (Array.isArray(silentOptions)) {\n        return published.filter((data)=> {\n            const found = silentOptions.indexOf(data.name) !== -1;\n            return !found;\n        });\n    } else if (silentOptions && silentOptions.except) {\n        return published.filter((data)=> {\n            const found = (silentOptions.except || []).indexOf(data.name) !== -1;\n            return found;\n        });\n    }\n    return published;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/channel-router/utils/silencable.js","import { isFunction } from 'lodash';\n\n/**\n * \n * @param {Publishable[]} publishable \n * @param {boolean|string[]|Function} readOnlyOptions \n * @returns {Publishable[]} filtered list\n */\nexport default function excludeReadOnly(publishable, readOnlyOptions) {\n    if (isFunction(readOnlyOptions)) {\n        readOnlyOptions = readOnlyOptions();\n    }\n    if (readOnlyOptions === true) {\n        console.error('Tried to publish to a readonly channel', publishable);\n        return [];\n    }  \n    if (Array.isArray(readOnlyOptions)) {\n        const split = publishable.reduce((accum, data)=> {\n            const isReadonly = readOnlyOptions.indexOf(data.name) !== -1;\n            if (isReadonly) {\n                accum.readOnly.push(data);\n            } else {\n                accum.remaining.push(data);\n            }\n            return accum;\n        }, { readOnly: [], remaining: [] });\n        \n        if (split.readOnly.length) {\n            console.warn('Ignoring readonly publishes', split.readOnly);\n        }\n        return split.remaining;\n    }\n    return publishable;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/channel-router/utils/exclude-read-only.js","export { default as JSONRouteHandler } from './json-route-handler';\nexport { default as EpicenterRouteHandler } from './epicenter-route-handlers';\nexport { default as DomRouteHandler } from './dom-route-handler';\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/index.js","import { toImplicitType } from 'utils/parse-utils';\n\nexport function match(topic) {\n    var parsed = toImplicitType(topic);\n    return typeof parsed !== 'string' ? '' : false;\n}\n\nexport default {\n    match: match,\n    name: 'JSON Route',\n    subscribeHandler: function (topics) {\n        const parsed = topics.map((t)=> {\n            return {\n                name: t,\n                value: toImplicitType(t)\n            };\n        });\n        return parsed;\n    }\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/json-route-handler/index.js","import DefaultRunRouteHandler from './default-run-route-handler';\nimport ScenarioRouteHandler from './scenario-route-handler';\nimport RunidRouteHandler from './runid-route-handler';\nimport WorldRouteHandler from './world-route-handler';\n\nimport MultiRunRouteHandler from './multi-run-route-handler';\n\n\nimport { withPrefix } from 'channels/channel-router/utils';\nimport { matchPrefix, matchDefaultPrefix, matchRegex } from 'channels/route-handlers/route-matchers';\n\nimport router from 'channels/channel-router';\n\nfunction getOptions(opts, key) {\n    var serviceOptions = $.extend(true, {}, opts.defaults, opts[key]);\n    var channelOptions = $.extend(true, {}, serviceOptions.channelOptions);\n    delete serviceOptions.channelOptions;\n\n    return { serviceOptions: serviceOptions, channelOptions: channelOptions };\n}\n\nvar SCENARIO_PREFIX = 'sm:';\nvar RUN_PREFIX = 'rm:';\nconst WORLD_PREFIX = 'world:';\n\nvar sampleRunidLength = '000001593dd81950d4ee4f3df14841769a0b'.length;\nvar runidRegex = '(?:.{' + sampleRunidLength + '})';\n\n/* eslint-disable complexity */\nexport default function EpicenterRouteHandler(config, notifier, channelManagerContext) {\n    var opts = $.extend(true, {}, config);\n\n    var runidHandlerOpts = getOptions(opts, 'runid');\n    var runidHandler = new RunidRouteHandler(runidHandlerOpts, notifier);\n    var multiRunHandler = new MultiRunRouteHandler(runidHandlerOpts, withPrefix(notifier, 'runs'), channelManagerContext);\n    // var userChannel = new UserRouter(getOptions(opts, 'runManager').run, withPrefix(notifier, 'user:'), channelManagerContext);\n    \n    /** @type {Handler[]} **/\n    var handlers = [\n        $.extend({}, runidHandler, { \n            name: 'customRun',\n            match: matchRegex(runidRegex),\n            options: runidHandlerOpts.channelOptions,\n        }), \n        $.extend({}, multiRunHandler, {\n            name: 'archiveRuns',\n            match: matchPrefix('runs:'),\n            options: runidHandlerOpts.channelOptions,\n        }),  \n        // $.extend({}, userChannel, {\n        //     name: 'User Channel',\n        //     match: matchPrefix('user:'),\n        // })\n    ];\n    var exposable = {};\n\n    var runManagerOpts = getOptions(opts, 'runManager');\n    if (opts.runManager || (!opts.scenarioManager && runManagerOpts.serviceOptions.run)) {\n        var rm;\n        const hasEnoughInfo = runManagerOpts.serviceOptions.run && runManagerOpts.serviceOptions.run.model;\n        const isMultiplayer = runManagerOpts.serviceOptions.strategy === 'multiplayer' || runManagerOpts.serviceOptions.isMultiplayer;\n        \n        if (!hasEnoughInfo) {\n            console.warn('No model specified, not initializing run manager channel', opts);\n            rm = { expose: {} };\n        } else if (opts.scenarioManager) {\n            rm = new DefaultRunRouteHandler(runManagerOpts, withPrefix(notifier, RUN_PREFIX));\n            handlers.push($.extend({}, rm, { \n                name: 'run',\n                match: matchPrefix(RUN_PREFIX), //if both scenario manager and run manager are being used, require a prefix\n                options: runManagerOpts.channelOptions,\n            }));\n        } else if (isMultiplayer) {\n            //Ignore case where both scenario manager and multiplayer are being used\n            rm = new WorldRouteHandler(runManagerOpts, withPrefix(notifier, [WORLD_PREFIX, '']));\n            handlers.push($.extend({}, rm, { \n                name: 'World run',\n                match: matchDefaultPrefix(WORLD_PREFIX),\n                isDefault: true,\n                options: runManagerOpts.channelOptions,\n            }));\n        } else {\n            rm = new DefaultRunRouteHandler(runManagerOpts, withPrefix(notifier, [RUN_PREFIX, '']));\n            handlers.push($.extend({}, rm, { \n                name: 'run',\n                match: matchDefaultPrefix(RUN_PREFIX),\n                isDefault: true,\n                options: runManagerOpts.channelOptions,\n            }));\n        }\n\n        $.extend(exposable, rm.expose);\n    }\n\n    if (opts.scenarioManager) {\n        var scenarioManagerOpts = getOptions(opts, 'scenarioManager');\n        var sm = new ScenarioRouteHandler(scenarioManagerOpts, withPrefix(notifier, [SCENARIO_PREFIX, '']));\n        handlers.push($.extend({}, sm, { \n            name: 'scenario',\n            match: matchDefaultPrefix(SCENARIO_PREFIX),\n            options: scenarioManagerOpts.channelOptions,\n            isDefault: true,\n        }));\n\n        $.extend(exposable, sm.expose);\n    }\n\n    var epicenterRouter = router(handlers, notifier);\n    epicenterRouter.expose = exposable;\n    \n    return epicenterRouter;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/epicenter-route-handlers/index.js","import RunRouteHandler from '../run-route-handler';\n\nimport { withPrefix } from 'channels/channel-router/utils';\nimport router from 'channels/channel-router';\nimport { matchDefaultPrefix } from 'channels/route-handlers/route-matchers';\n\nconst { F } = window;\n\nconst RUN_PREFIX = 'current:';\n\nexport default function RunManagerRouteHandler(config, notifier) {\n    const defaults = {\n        serviceOptions: {},\n        channelOptions: {}\n    };\n    const opts = $.extend(true, {}, defaults, config);\n\n    const rmOptions = opts.serviceOptions;\n    const rm = new F.manager.RunManager(rmOptions);\n\n    const $creationPromise = rm.getRun().then((run)=> {\n        return rm.run;\n    });\n    const currentChannelOpts = $.extend(true, \n        { serviceOptions: $creationPromise, channelOptions: opts.channelOptions }, opts.defaults, opts.current);\n    const currentRunChannel = new RunRouteHandler(currentChannelOpts, withPrefix(notifier, [RUN_PREFIX, '']));\n\n    const runRouteHandler = $.extend(currentRunChannel, { \n        match: matchDefaultPrefix(RUN_PREFIX), //TODO: Just remove prefix?\n        name: 'Current Run',\n        isDefault: true,\n        options: currentChannelOpts.channelOptions,\n    });\n    const handlers = [\n        runRouteHandler\n    ];\n\n    const runMangerRouter = router(handlers);\n    runMangerRouter.expose = { runManager: rm };\n\n    return runMangerRouter;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/epicenter-route-handlers/default-run-route-handler/index.js","import { objectToPublishable, publishableToObject } from 'channels/channel-utils';\nimport { intersection } from 'lodash';\n\nexport default function RunMetaRouteHandler($runServicePromise, notifier) {\n\n    function mergeAndSend(runMeta, requestedTopics) {\n        var toSend = ([].concat(requestedTopics)).reduce(function (accum, meta) {\n            accum.push({ name: meta, value: runMeta[meta] });\n            return accum;\n        }, []);\n        return toSend;\n        // return notifier(toSend);\n    }\n    return {\n        subscribeHandler: function (topics, options) {\n            topics = [].concat(topics);\n            \n            return $runServicePromise.then(function (runService) {\n                var cachedValues = intersection(Object.keys(runService.runMeta || {}), topics);\n                if (options.autoFetch === false) {\n                    return $.Deferred().resolve({}).promise();\n                } else if (cachedValues.length === topics.length) {\n                    //FIXME: Add 'updated time' to meta, and fetch if that's < debounce interval -- use the custom debounce fn with the custom merge (debounce save as well?)\n                    //Make run service factory return patched run-service?\n                    return $.Deferred().resolve(mergeAndSend(runService.runMeta, topics)).promise();\n                } if (!runService.loadPromise) {\n                    runService.loadPromise = runService.load().then(function (data) {\n                        runService.runMeta = data;\n                        return data;\n                    });\n                } \n                return runService.loadPromise.then(function (data) {\n                    return mergeAndSend(data, topics);\n                });\n            });\n        },\n        publishHandler: function (topics, options) {\n            return $runServicePromise.then(function (runService) {\n                var toSave = publishableToObject(topics);\n                return runService.save(toSave).then(function (res) {\n                    runService.runMeta = $.extend({}, true, runService.runMeta, res);\n                    return objectToPublishable(res);\n                });\n            });\n        }\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/epicenter-route-handlers/run-route-handler/run-meta-route-handler/index.js","import { debounceAndMerge } from 'utils/general';\nimport { objectToPublishable, publishableToObject } from 'channels/channel-utils';\nimport { uniqueId, uniq, difference } from 'lodash';\nimport { retriableFetch } from './retriable-variable-fetch';\n// import { optimizedFetch } from './optimized-variables-fetch';\n\nfunction mergeVariables(accum, newval) {\n    if (!accum) {\n        accum = [];\n    }\n    const merged = uniq(accum.concat(newval)).filter((v)=> !!(v && v.trim()));\n    // console.log(merged, 'merged');\n    return merged;\n}\n\nexport default function RunVariablesRouteHandler($runServicePromise, notifier) {\n    const id = uniqueId('variable-route-handler');\n\n    function debouncedVariableQuery(runService, debounceInterval) {\n        if (!runService.debouncedFetchers) {\n            runService.debouncedFetchers = {};\n        }\n        if (!runService.debouncedFetchers[id]) {\n            runService.debouncedFetchers[id] = debounceAndMerge(function (variables) {\n                return retriableFetch(runService, variables);\n            }, debounceInterval, [mergeVariables]);\n        }\n        return runService.debouncedFetchers[id];\n    }\n\n    let knownTopics = [];\n    return { \n        /**\n         * @param {{exclude:? boolean}} options \n         * @returns {Promise}\n         */\n        fetch: function (options) {\n            const opts = $.extend({ exclude: [] }, options);\n            return $runServicePromise.then(function (runService) {\n                const variablesToFetch = difference([].concat(knownTopics), opts.exclude);\n                if (!variablesToFetch.length) {\n                    return [];\n                }\n                return retriableFetch(runService, [].concat(variablesToFetch)).then(objectToPublishable).then(notifier);\n            });\n        },\n\n        unsubscribeHandler: function (unsubscribedTopics, remainingTopics) {\n            knownTopics = knownTopics.filter((t)=> {\n                const isUnsubscribed = unsubscribedTopics.indexOf(t) !== -1;\n                const isRemaining = remainingTopics.indexOf(t) !== -1;\n                return !isUnsubscribed || isRemaining;\n            });\n        },\n        subscribeHandler: function (topics, options) {\n            // console.log('subscribe', JSON.stringify(topics));\n            const isAutoFetchEnabled = options.autoFetch;\n            const debounceInterval = options.debounce;\n\n            return $runServicePromise.then(function (runService) {\n                knownTopics = uniq(knownTopics.concat(topics));\n                if (!knownTopics.length) {\n                    return $.Deferred().resolve([]).promise();\n                } else if (!isAutoFetchEnabled) {\n                    return $.Deferred().resolve(topics).promise();\n                }\n                return debouncedVariableQuery(runService, debounceInterval)(topics).then((response)=> {\n                    const missingVariables = difference(topics, Object.keys(response));\n                    if (missingVariables.length) {\n                        return $.Deferred().reject({\n                            context: missingVariables,\n                            message: `Missing variables: ${missingVariables.join(',')}`\n                        }).promise();\n                    }\n                    return response;\n                });\n            });\n        },\n        /**\n         * \n         * @param {Publishable[]} variableData\n         */\n        notify: function (variableData) {\n            return $runServicePromise.then(function (runService) {\n                const variables = variableData.map((v)=> v.name);\n                //Need to fetch again because for Vensim, i'm notified about the Current value, while i need the value over time\n                return retriableFetch(runService, variables).then(objectToPublishable).then(notifier);\n            });\n        },\n        publishHandler: function (topics, options) {\n            return $runServicePromise.then(function (runService) {\n                const toSave = publishableToObject(topics);\n                return runService.variables().save(toSave).then(function (response) {\n                    const variables = Object.keys(toSave); \n                    //Get the latest from the server because what you think you saved may not be what was saved\n                    //bool -> 1, scalar to array for time-based models etc\n                    return retriableFetch(runService, variables).then(objectToPublishable);\n                });\n            });\n        }\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/epicenter-route-handlers/run-route-handler/run-variables-route-handler/index.js","//Opaquely handle missing variables\nexport function retriableFetch(runService, variables) {\n    if (!variables || !variables.length) {\n        return $.Deferred().resolve({}).promise();\n    }\n    return runService.variables().query(variables).catch((e)=> {\n        const response = e.responseJSON;\n        const info = response.information;\n        if (info.code !== 'VARIABLE_NOT_FOUND') {\n            throw e;\n        }\n        const goodVariables = variables.filter((vName)=> {\n            const baseName = vName.split('[')[0];\n            const isBad = info.context.names.indexOf(baseName) !== -1;\n            return !isBad;\n        });\n        return retriableFetch(runService, goodVariables);\n    });\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/epicenter-route-handlers/run-route-handler/run-variables-route-handler/retriable-variable-fetch.js","export default function RunOperationsRouteHandler($runServicePromise, notifier) {\n    return {\n        /**\n         * \n         * @param {Publishable[]} operationsResponse \n         */\n        notify: function (operationsResponse) {\n            return notifier([].concat(operationsResponse));\n        },\n\n        subscribeHandler: function () {\n            return []; //Cannot subscribe to operations\n        },\n        publishHandler: function (topics, options) {\n            return $runServicePromise.then(function (runService) {\n                const toSave = topics.map(function (topic) {\n                    return { name: topic.name, params: topic.value };\n                });\n                return runService.serial(toSave).then(function (result) {\n                    const toReturn = result.map(function (response, index) {\n                        return { name: topics[index].name, value: response.result };\n                    });\n                    return toReturn;\n                });\n            });\n        }\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/epicenter-route-handlers/run-route-handler/run-operations-route-handler/index.js","import RunRouteHandler from '../run-route-handler';\nimport { withPrefix } from 'channels/channel-router/utils';\nimport router from 'channels/channel-router';\nimport { matchPrefix, matchDefaultPrefix, } from 'channels/route-handlers/route-matchers';\n\n\nexport default function ScenarioManagerRouteHandler(config, notifier) {\n    var defaults = {\n        serviceOptions: {},\n        channelOptions: {},\n    };\n    var opts = $.extend(true, {}, defaults, config);\n\n    var sm = new window.F.manager.ScenarioManager(opts.serviceOptions);\n\n    var baselinePromise = sm.baseline.getRun().then(()=> sm.baseline.run);\n    var baselineOptions = $.extend(true, {\n        serviceOptions: baselinePromise,\n        channelOptions: {\n            meta: {\n                readOnly: true\n            },\n            variables: {\n                readOnly: true\n            }\n        }\n    }, opts.defaults, opts.baseline);\n    var currentRunPromise = sm.current.getRun().then(()=> sm.current.run);\n\n    var runOptions = $.extend(true, {\n        serviceOptions: currentRunPromise,\n    }, opts.defaults, opts.current);\n\n    var baselineHandler = new RunRouteHandler(baselineOptions, withPrefix(notifier, 'baseline:'));\n    var currentRunHandler = new RunRouteHandler(runOptions, withPrefix(notifier, ['current:', '']));\n    var handlers = [\n        $.extend(baselineHandler, {\n            name: 'baseline',\n            match: matchPrefix('baseline:'),\n            options: baselineOptions.channelOptions,\n        }),\n        $.extend(currentRunHandler, { \n            isDefault: true, \n            name: 'current',\n            match: matchDefaultPrefix('current:'),\n            options: runOptions.channelOptions,\n        }),\n\n    ];\n    \n    var scenarioManagerRouter = router(handlers, notifier);\n    scenarioManagerRouter.expose = { scenarioManager: sm };\n    return scenarioManagerRouter;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/epicenter-route-handlers/scenario-route-handler/index.js","import runChannelFactory from '../run-router-factory';\nimport { withPrefix, stripSuffixDelimiter } from 'channels/channel-router/utils';\n\nexport default function RunidRouteHandler(options, notifier) {\n    if (!options) options = {};\n\n    var opts = {};\n    opts.serviceOptions = options.serviceOptions && options.serviceOptions.run ? options.serviceOptions.run : {};\n    opts.channelOptions = options.channelOptions;\n\n    return {\n        subscribeHandler: function (topics, options, prefix) {\n            var runid = stripSuffixDelimiter(prefix);\n            //FIXME: Should i merge options here?\n            var channel = runChannelFactory(runid, opts, withPrefix(notifier, prefix));\n            return channel.subscribeHandler(topics, options, prefix);\n        },\n        publishHandler: function (topics, options, prefix) {\n            var runid = stripSuffixDelimiter(prefix);\n            var channel = runChannelFactory(runid, opts, withPrefix(notifier, prefix));\n            return channel.publishHandler(topics);\n        }\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/epicenter-route-handlers/runid-route-handler/index.js","import RunRouteHandler from './run-route-handler';\nvar knownRunIDServiceChannels = {};\n\nexport default function (runid, options, notifier) {\n    var runChannel = knownRunIDServiceChannels[runid];\n    if (!runChannel) {\n        var runOptions = $.extend(true, {}, options, { serviceOptions: { id: runid } });\n        runChannel = new RunRouteHandler(runOptions, notifier);\n        knownRunIDServiceChannels[runid] = runChannel;\n    }\n    return runChannel;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/epicenter-route-handlers/run-router-factory.js","import WorldUsersRouteHandler from './world-users-route-handler';\nimport WorldCurrentUserRouteHandler from './world-current-user-route-handler';\nimport ConsensusRouteHandler from './consensus-route-handler';\n\nimport { withPrefix } from 'channels/channel-router/utils';\nimport { matchPrefix, matchDefaultPrefix } from 'channels/route-handlers/route-matchers';\n\nimport RunRouteHandler from '../run-route-handler';\nimport router from 'channels/channel-router';\n\nconst { F } = window;\n\nconst RUN_PREFIX = 'run:';\nconst MULTI_USER_PREFIX = 'users:';\nconst USER_PREFIX = 'user:';\nconst CONSENSUS_PREFIX = 'consensus:';\n\n//TODO: Add custom worldid channel as well\nexport default function WorldRoutesHandler(config, notifier) {\n    const defaults = {\n        serviceOptions: {},\n        channelOptions: {}\n    };\n    const opts = $.extend(true, {}, defaults, config);\n\n    const rmOptions = opts.serviceOptions;\n    const rm = new F.manager.RunManager(rmOptions);\n    \n    let runPromise = null;\n    function getRun() {\n        if (!runPromise) {\n            runPromise = rm.getRun().then((run)=> {\n                if (!run.world) {\n                    console.error('No world found in run. Make sure you\\'re using EpicenterJS version > 2.7');\n                    throw new Error('Could not find world');\n                }\n                return run;\n            }, (err)=> {\n                console.error('Run manager get run error', err);\n                throw err;\n            });\n        }\n        return runPromise;\n    }\n    const $runPromise = getRun().then((run)=> {\n        const alreadyStubbedRunChannel = rm.run.channel; //FIXME: Explicitly pass instead of stubbing on a channel\n        if (alreadyStubbedRunChannel) {\n            return rm.run;\n        }\n        const channelManager = new F.manager.ChannelManager();\n        const worldChannel = channelManager.getWorldChannel(run.world);\n\n        worldChannel.subscribe(worldChannel.TOPICS.RUN_RESET, (run)=> {\n            rm.run.updateConfig({ filter: run.id });//Run handler is also listening on the run and will take care of notifying\n        }, this, { includeMine: false });\n        rm.run.channel = worldChannel;\n        return rm.run;\n    });\n\n    const currentRunHandlerOpts = $.extend(true, { serviceOptions: $runPromise, channelOptions: opts.channelOptions }, opts.defaults, opts.current);\n    const currentRunHandler = new RunRouteHandler(currentRunHandlerOpts, withPrefix(notifier, [RUN_PREFIX, '']));\n\n    const handlers = [];\n\n    const runRouteHandler = $.extend(currentRunHandler, { \n        match: matchDefaultPrefix(RUN_PREFIX),\n        name: 'World Run',\n        isDefault: true,\n        options: currentRunHandlerOpts.channelOptions,\n    });\n    handlers.unshift(runRouteHandler);\n\n    let $worldProm = null;\n    function getWorld() {\n        if (!$worldProm) {\n            $worldProm = getRun().then((run)=> {\n                return run.world;\n            });\n        }\n        return $worldProm;\n    }\n\n    const worldChannelMap = {};\n    const channelManager = new F.manager.ChannelManager();\n    function getChannelForWorld(worldid) {\n        if (!worldChannelMap[worldid]) {\n            worldChannelMap[worldid] = channelManager.getWorldChannel(worldid);\n        }\n        return worldChannelMap[worldid];\n    }\n\n    const am = new F.manager.AuthManager();\n    const handlerOptions = {\n        serviceOptions: {\n            getRun: getRun,\n            getWorld: getWorld,\n            getSession: ()=> am.getCurrentUserSessionInfo(),\n            getChannel: getChannelForWorld,\n        },\n        channelOptions: opts.channelOptions\n    };\n    \n    const usersRouteHandler = new WorldUsersRouteHandler(handlerOptions, withPrefix(notifier, MULTI_USER_PREFIX));\n    const usersHandler = $.extend(usersRouteHandler, { \n        match: matchPrefix(MULTI_USER_PREFIX),\n        name: 'world users',\n    });\n    handlers.unshift(usersHandler);\n    \n    const currentUserRouteHandler = new WorldCurrentUserRouteHandler(handlerOptions, withPrefix(notifier, USER_PREFIX));\n    const currentUserHandler = $.extend(currentUserRouteHandler, {\n        match: matchPrefix(USER_PREFIX),\n        name: 'world current user',\n    });\n    handlers.unshift(currentUserHandler);\n\n    const ConsensusManager = window.F.manager.ConsensusManager;\n    if (ConsensusManager) { //epijs < 2.80 did not have this\n        const consensusRouteHandler = new ConsensusRouteHandler(handlerOptions, withPrefix(notifier, CONSENSUS_PREFIX));\n        const consensusHandler = $.extend(consensusRouteHandler, {\n            match: matchPrefix(CONSENSUS_PREFIX),\n            name: 'consensus',\n        });\n        handlers.unshift(consensusHandler);\n    }\n\n    const worldRouteHandler = router(handlers);\n    worldRouteHandler.expose = { runManager: rm };\n\n    return worldRouteHandler;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/epicenter-route-handlers/world-route-handler/index.js","const F = window.F;\n\nexport default function WorldUsersRouteHandler(config, notifier) {\n    const options = $.extend(true, {\n        serviceOptions: {},\n        channelOptions: {},\n    }, config);\n\n    const { getWorld, getSession, getChannel } = options.serviceOptions;\n\n    const store = {\n        users: [],\n        mark: (userid, isOnline)=> {\n            store.users = store.users.map((u)=> {\n                if (u.userId === userid) {\n                    u.isOnline = isOnline;\n                }\n                return u;\n            });\n            return store.users;\n        }\n    };\n    \n    const parsedUsersPromise = getWorld().then((world)=> {\n        const session = getSession();\n        const parsed = world.users.map((u)=> {\n            u.name = u.lastName;\n            u.isMe = u.userId === session.userId;\n            u.isOnline = u.isMe; //Assume i'm the only online one by default\n            return u;\n        });\n        store.users = parsed;\n        return parsed;\n    });\n    \n    let presenceSubsId;\n    return { \n        unsubscribeHandler: function (knownTopics, remainingTopics) {\n            if (remainingTopics.length || !presenceSubsId) {\n                return;\n            }\n            getWorld().then((world)=> {\n                const worldChannel = getChannel(world.id);\n                worldChannel.unsubscribe(presenceSubsId);\n                presenceSubsId = null;\n            });\n\n        },\n        subscribeHandler: function (userids) {\n            if (!presenceSubsId) {\n                //TODO: Also listen to roles channel to update users\n                getWorld().then((world)=> {\n                    const worldChannel = getChannel(world.id);\n                    presenceSubsId = worldChannel.subscribe(worldChannel.TOPICS.PRESENCE, (user, meta)=> {\n                        const userid = user.id;\n                        store.mark(userid, user.isOnline);\n                        return notifier([{ name: '', value: store.users }]);\n                    }, { includeMine: false });\n                });\n            }\n            return parsedUsersPromise.then((users)=> {\n                return [{ name: '', value: users }];\n            });\n        },\n        publishHandler: function (topics, options) {\n            const ps = new F.service.Presence();\n            topics.forEach((topic)=> {\n                const split = topic.name.split(':');\n                if (split[1]) {\n                    if (split[1] === 'markOnline') {\n                        ps.markOnline(split[0]);\n                    } else if (split[1] === 'markOffline') {\n                        ps.markOffline(split[0]);\n                    }\n                }\n            });\n            return topics;\n        }\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/epicenter-route-handlers/world-route-handler/world-users-route-handler/index.js","export default function WorldCurrentUserRouteHandler(config, notifier) {\n    const options = $.extend(true, {\n        serviceOptions: {},\n        channelOptions: {},\n    }, config);\n\n    const { getWorld, getSession, getChannel } = options.serviceOptions;\n\n    \n    let subsid;\n\n    const store = $.extend(true, {\n        isMe: true,\n        isOnline: true,\n    }, getSession());\n\n    return { \n        unsubscribeHandler: function (unsubscribedTopics, remainingTopics) {\n            const stillNeedRoles = remainingTopics.indexOf('role') !== -1;\n            if (!stillNeedRoles && subsid) {\n                getWorld().then((world)=> {\n                    const worldChannel = getChannel(world.id);\n                    worldChannel.unsubscribe(subsid);\n                });\n                subsid = null;\n            }\n        },\n        subscribeHandler: function (userFields) {\n            return getWorld().then((world)=> {\n                const session = getSession();\n                const myUser = world.users.find((user)=> {\n                    return user.userId === session.userId;\n                });\n                $.extend(store, myUser);\n                \n                const toNotify = userFields.reduce((accum, field)=> {\n                    if (field === '') { //the entire user object\n                        accum.push({ name: field, value: store });\n                    } else if (store[field] !== undefined) {\n                        accum.push({ name: field, value: store[field] });\n                    }\n                    return accum;\n                }, []);\n                \n                const isSubscribingToRole = userFields.indexOf('role') !== -1;\n                if (isSubscribingToRole && !subsid) {\n                    const worldChannel = getChannel(world.id);\n                    subsid = worldChannel.subscribe(worldChannel.TOPICS.ROLES, (users, meta)=> {\n                        const myUser = users.find((u)=> {\n                            return u.userId === session.userId;\n                        });\n                        if (myUser && myUser.role !== store.role) {\n                            store.role = myUser.role;\n                            notifier([{ name: 'role', value: myUser.role }]);\n                        }\n                    });\n                }\n                return toNotify;\n            });\n        }\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/epicenter-route-handlers/world-route-handler/world-current-user-route-handler/index.js","import OperationsHandler from './consensus-operations-handler';\nimport StatusHandler from './consensus-status-handler';\nimport router from 'channels/channel-router';\nimport { matchPrefix } from 'channels/route-handlers/route-matchers';\nimport { withPrefix } from 'channels/channel-router/utils';\n\nconst ConsensusManager = window.F.manager.ConsensusManager;\n\nconst OPERATIONS_PREFIX = 'operations:';\n\nexport default function ConsensusRouteHandler(config, notifier) {\n    const options = $.extend(true, {\n        serviceOptions: {},\n        channelOptions: {},\n    }, config);\n\n    const { getWorld, getRun, getSession, getChannel } = options.serviceOptions;\n\n    const cm = new ConsensusManager();\n\n    let consensusProm = null;\n    function getConsensus(force) {\n        if (!consensusProm || force) {\n            consensusProm = getRun().then(()=> {\n                return cm.getCurrent(); //TODO: GetRun deletes the barrier if it overlaps with this call, so synchronize them\n            });\n        }\n        return consensusProm;\n    }\n\n    const handlerOptions = {\n        serviceOptions: {\n            getConsensus: getConsensus,\n            getSession: getSession\n        },\n        channelOptions: {}\n    };\n\n    const opnHandler = OperationsHandler(handlerOptions, withPrefix(notifier, OPERATIONS_PREFIX));\n    const statusHandler = StatusHandler(handlerOptions, notifier);\n\n    const handlers = [\n        $.extend({}, opnHandler, { \n            name: 'consensus operations',\n            match: matchPrefix(OPERATIONS_PREFIX),\n            options: handlerOptions.channelOptions.operations,\n        }),\n        $.extend({}, statusHandler, { \n            name: 'consensus status',\n            match: matchPrefix(''),\n            isDefault: true,\n            options: handlerOptions.channelOptions.status,\n        }),\n    ];\n\n    getWorld().then((world)=> {\n        const channel = getChannel(world.id);\n        channel.subscribe(channel.TOPICS.RUN_RESET, ()=> {\n            getConsensus(true).then((consensus)=> {\n                statusHandler.notify(consensus);\n            });\n        });\n        // FIXME: Filter by stage here\n        channel.subscribe(channel.TOPICS.CONSENSUS_UPDATE, (consensus)=> {\n            const isComplete = consensus.closed;\n            if (isComplete) {\n                getConsensus(true).then((consensus)=> {\n                    statusHandler.notify(consensus);\n                });\n            } else {\n                statusHandler.notify(consensus);\n            }\n        });\n    });\n\n    var consensusRouteHandler = router(handlers, notifier);\n    consensusRouteHandler.expose = { consensusManager: cm };\n    \n    return consensusRouteHandler;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/epicenter-route-handlers/world-route-handler/consensus-route-handler/index.js","import { makeConsensusService } from './consensus-utils';\n\nexport default function ConsensusOperationsHandler(config, notifier) {\n    const options = $.extend(true, {\n        serviceOptions: {},\n        channelOptions: {},\n    }, config);\n\n    const { getConsensus } = options.serviceOptions;\n\n    return {\n        subscribeHandler: function () {\n            return [];\n        },\n        publishHandler: function (topics, options) {\n            return getConsensus().then((consensus)=> {\n                const actions = topics.map(function (topic) {\n                    return { name: topic.name, arguments: topic.value };\n                });\n                const cs = makeConsensusService(consensus);\n                return cs.submitActions(actions).then(()=> {\n                    return topics;\n                });\n            });\n        }\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/epicenter-route-handlers/world-route-handler/consensus-route-handler/consensus-operations-handler.js","import { makeConsensusService } from './consensus-utils';\nimport { objectToPublishable } from 'channels/channel-utils';\nimport { pick } from 'lodash';\n\nexport default function ConsensusStatusHandler(config, notifier) {\n    const options = $.extend(true, {\n        serviceOptions: {},\n        channelOptions: {},\n    }, config);\n\n    const { getConsensus, getSession } = options.serviceOptions;\n\n    function normalizePlayers(rolePlayerMap) {\n        const session = getSession();\n        const normalized = Object.keys(rolePlayerMap).reduce((accum, role)=> {\n            const playersForRole = rolePlayerMap[role];\n            const playersWithRole = playersForRole.map((p)=> {\n                const player = p.user || p; //submitted puts user under an extra object because of course\n                return Object.assign({}, player, {\n                    role: role,\n                    userName: player.userName.split('/')[0], //API adds user/project because of course\n                    name: player.lastName,\n                    isMe: player.userName === session.userName, // so you can do :submitted:users | reject('isMe')\n                });\n            });\n            accum = accum.concat(playersWithRole);\n            return accum;\n        }, []);\n        return normalized;\n    }\n    function normalizeConsensus(consensus) {\n        const session = getSession();\n        const submitted = normalizePlayers(consensus.submitted);\n        const amWaiting = submitted.find((u)=> u.userName === session.userName);\n        const normalized = $.extend(true, {}, consensus, {\n            amWaiting: !!amWaiting,\n            submitted: submitted,\n            pending: normalizePlayers(consensus.pending),\n        });\n        return normalized;\n    }\n\n    return {\n        notify: function (consensus) {\n            const normalizedConsensus = normalizeConsensus(consensus);\n            notifier(objectToPublishable(normalizedConsensus));\n        },\n        subscribeHandler: function (topics) {\n            return getConsensus().then((consensus)=> {\n                const normalized = normalizeConsensus(consensus);\n                const dataForTopics = pick(normalized, topics);\n                return objectToPublishable(dataForTopics);\n            });\n        },\n        publishHandler: function (topics) {\n            return getConsensus().then((consensus)=> {\n                if (topics.length > 1 || topics[0].name !== 'close') {\n                    throw new TypeError('Can only publish `close` on consensus:status');\n                }\n                const cs = makeConsensusService(consensus);\n                return cs.forceClose().then(()=> topics);\n            });\n        }\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/epicenter-route-handlers/world-route-handler/consensus-route-handler/consensus-status-handler.js","import { debounceAndMerge } from 'utils/general';\nvar { F } = window;\n\nexport default function MultiRunRouteHandler(options, notifier, channelManagerContext) {\n    var runService = new F.service.Run(options.serviceOptions.run);\n\n    var topicParamMap = {};\n\n    function extractFiltersFromTopic(topicString) {\n        var filters = topicString.replace('(', '').replace(')', '');\n        var filterParam = filters.split(';').reduce((accum, filter)=> {\n            var [key, val] = filter.split('=');\n            if (val) {\n                val = true;\n            }\n            accum[key] = val;\n            return accum;\n        }, {});\n        return filterParam;\n    }\n\n    function fetch(topic, variables) {\n        var filters = extractFiltersFromTopic(topic);\n        return runService.query(filters, { include: variables }).then((runs)=> {\n            notifier([{ name: topic, value: runs }]);\n\n            // if (topicParamMap[topic]) {\n            //     Object.keys(topicParamMap[topic]).forEach((runid)=> {\n            //         channelManagerContext.unsubscribe(topicParamMap[topic][runid]);\n            //     });\n            // }\n\n            return runs;\n        });\n    }\n\n    return {\n        fetch: fetch,\n\n        unsubscribeHandler: function (unsubscribedTopics, remainingTopics) {\n            // knownTopics = remainingTopics;\n        },\n        subscribeHandler: function (topics, options) {\n            var topic = ([].concat(topics))[0];\n\n            var filters = extractFiltersFromTopic(topic);\n            var variables = options && options.include;\n\n            var debounceInterval = 300;\n            var debouncedFetch = debounceAndMerge(fetch, debounceInterval, [(accum, newval)=> newval]);\n            return fetch(topic, variables).then(function (runs) {\n                var subsMap = {};\n                //TODO: Provide this meta information to runs-factory so it doesn't trigger a fetch to get meta for each run\n                runs.forEach((run)=> {\n                    var subscriptions = Object.keys(filters).map((filter)=> run.id + ':meta:' + filter);\n                    var subsid = channelManagerContext.subscribe(subscriptions, function () {\n                        debouncedFetch(topic, variables);\n                    }, { batch: false, autoFetch: false, cache: false });\n                    subsMap[run.id] = subsid;\n                });\n\n                topicParamMap[topic] = subsMap;\n                return runs;\n            });\n        }\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/epicenter-route-handlers/multi-run-route-handler/index.js","import { toImplicitType } from 'utils/parse-utils';\nimport _ from 'lodash';\n\nexport function match(topic) {\n    return (topic.indexOf('#') === 0) ? '' : false;\n} \n\n\nexport default function DOMRouteHandler(options, notifier) {\n    \n    const knownEls = new WeakMap();\n    const domOptions = $.extend(true, {\n        uiChangeEvents: {\n\n        },\n        debounceInterval: 200\n    }, options.defaults, options.dom);\n\n    function changeHandler($el, id, evt) {\n        const val = toImplicitType($el.val());\n        notifier([{ name: id, value: val }]);\n    }\n    const debouncedChangeHandler = _.debounce(changeHandler, domOptions.debounceInterval);\n    return {\n        match: match,\n        name: 'DOM Route',\n        subscribeHandler: function (topics) {\n            const parsed = topics.map((elID)=> {\n                const $el = $(elID);\n                if (!knownEls.has($el)) {\n                    knownEls.set($el, true);\n                    const overrides = domOptions.uiChangeEvents || {};\n                    const matchingEventOverride = Object.keys(overrides).find((selector)=> {\n                        return $el.is(selector);\n                    });\n                    const changeEvent = matchingEventOverride ? overrides[matchingEventOverride] : 'change';\n                    const handler = changeEvent.indexOf('key') !== -1 ? debouncedChangeHandler : changeHandler;\n                    $el.on(`${changeEvent}.dom-handler`, handler.bind(this, $el, elID));\n                }\n\n                const val = toImplicitType($el.val());\n                return {\n                    name: elID,\n                    value: val\n                };\n            });\n            return parsed;\n        },\n        unsubscribeHandler: function (unsubscribedTopics, remainingTopics) {\n            const toKill = unsubscribedTopics.filter((t)=> {\n                const isRemaining = remainingTopics.indexOf(t) !== -1;\n                return !isRemaining;\n            });\n            toKill.forEach((elID)=> {\n                const $el = $(elID);\n\n                $el.off('change.dom-handler');\n                knownEls.delete($el);\n            });\n        },\n        /**\n         * \n         * @param {Publishable[]} publishable \n         */\n        publishHandler: function (publishable) {\n            publishable.forEach((p)=> {\n                $(p.name).val(p.value);\n            });\n            return publishable;\n        }\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/dom-route-handler/index.js","export { default as interpolatable } from './interpolatable';\nexport { default as routable } from './routable';\n// export { default as withMiddleware } from './with-middleware';\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/channel-manager-enhancements/index.js","import subscribeInterpolator from './subscribe-interpolator';\nimport publishInterpolator from './publish-interpolator';\n\n/**\n * Decorates passed channel manager with interpolation functionality\n * @param  {ChannelManager} ChannelManager\n * @returns {ChannelManager}                wrapped channel manager\n */\nexport default function interpolatable(ChannelManager) {\n    var subsidMap = {};\n\n    /**\n     * @implements {ChannelManager}\n     */\n    return class InterpolatedChannelManager extends ChannelManager {\n        constructor(options) {\n            super(options);\n            //FIXME: Add on-error (from routable) here?\n            this.subscribe = subscribeInterpolator(this.subscribe.bind(this), (dependencySubsId, newDependentId)=> {\n                var existing = subsidMap[dependencySubsId];\n                if (existing) {\n                    this.unsubscribe(existing);\n                }\n                subsidMap[dependencySubsId] = newDependentId;\n            });\n\n            this.publish = publishInterpolator(this.publish.bind(this), (variables, cb)=> {\n                super.subscribe(variables, (response, meta)=> {\n                    this.unsubscribe(meta.id);\n                    cb(response);\n                }, { autoFetch: true, batch: true, onError: (e)=> {\n                    throw e;\n                } });\n            });\n        }\n        unsubscribe(token) {\n            var existing = subsidMap[token];\n            if (existing) {\n                super.unsubscribe(existing);\n            }\n            super.unsubscribe(token);\n            delete subsidMap[token];\n        }\n        unsubscribeAll() {\n            subsidMap = {};\n            super.unsubscribeAll();\n        }\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/channel-manager-enhancements/interpolatable/index.js","import { extractDependencies, interpolateWithValues } from './interpolatable-utils';\nimport { uniq, isEqual } from 'lodash';\n\n/**\n * @param {string[]} topics\n * @returns {string[]} interpolated\n */\nexport function getDependencies(topics) {\n    var deps = topics.reduce((accum, topic)=> {\n        var inner = extractDependencies(topic);\n        accum = accum.concat(inner);\n        return accum;\n    }, []);\n    return uniq(deps);\n}\n\n/**\n * @param {string[]} topics\n * @param {Object} data\n * @returns {string[]}\n */\nexport function interpolateWithDependencies(topics, data) {\n    return topics.map((topic)=> {\n        return interpolateWithValues(topic, data);\n    });\n}\n\n/**\n * @param  {string[]} originalTopics     \n * @param  {string[]} interpolatedTopics \n * @param  {Object} data               \n * @returns {Object}                    Interpolated\n */\nexport function mergeInterpolatedTopicsWithData(originalTopics, interpolatedTopics, data) {\n    return interpolatedTopics.reduce((accum, interpolatedTopic, index)=> {\n        var original = originalTopics[index];\n        var val = data[interpolatedTopic];\n        if (val !== undefined) {\n            accum[original] = data[interpolatedTopic];\n        }\n        return accum;\n    }, {});\n}\n\n/**\n * Takes a subscribe function and resolves any interpolated inputs\n * @param  {Function} subscribeFn        function to wrap\n * @param  {Function} onDependencyChange callback function when any dependencies change\n * @returns {Function}                    wrapped function\n */\nexport default function subscribeInterpolator(subscribeFn, onDependencyChange) {\n    return function interpolatedSubscribe(topics, cb, options) {\n        topics = [].concat(topics);\n        var dependencies = getDependencies(topics);\n        if (!dependencies.length) {\n            return subscribeFn(topics, cb, options);\n        }\n        var innerSubsId = subscribeFn(dependencies, function handleDependencyValueChange(data, dependenciesMeta) {\n            const isSameData = isEqual(data, dependenciesMeta.previousData);\n            if (isSameData) return;\n\n            var interpolatedTopics = interpolateWithDependencies(topics, data);\n            var outerSubsId = subscribeFn(interpolatedTopics, function handleInterpolatedValueChange(actualData, actualMeta) {\n                var toSendback = mergeInterpolatedTopicsWithData(topics, interpolatedTopics, actualData);\n\n                cb(toSendback, actualMeta);\n            }, options);\n\n            (onDependencyChange || $.noop)(dependenciesMeta.id, outerSubsId);\n            return outerSubsId;\n        }, $.extend(options, { autoFetch: true, batch: true }));\n\n        return innerSubsId;\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/channel-manager-enhancements/interpolatable/subscribe-interpolator.js","import { extractDependencies, interpolateWithValues } from './interpolatable-utils';\nimport { normalizeParamOptions } from 'channels/channel-utils';\n\nimport { uniq } from 'lodash';\n\n/**\n * @param {Publishable[]} publishInputs\n * @returns {string[]} dependencies for inputs\n */\nexport function getDependencies(publishInputs) {\n    var deps = publishInputs.reduce((accum, input)=> {\n        var inner = extractDependencies(input.name);\n        accum = accum.concat(inner);\n        return accum;\n    }, []);\n    return uniq(deps);\n}\n\n/**\n * @param {Publishable[]} publishInputs\n * @param {{string: any}} valuesToInterpolate\n * @returns {Publishable[]} inputs with resolved dependencies\n */\nexport function interpolateWithDependencies(publishInputs, valuesToInterpolate) {\n    return publishInputs.map((ip)=> {\n        return {\n            name: interpolateWithValues(ip.name, valuesToInterpolate),\n            value: ip.value,\n        };\n    });\n}\n\n/**\n * Publish function to wrap\n * @param  {Function} publishFunction\n * @param  {function(string[], function({string: any}):void):void} fetchFn         function to get interpolated values from\n * @returns {Function}                 wrapped function\n */\nexport default function publishInterpolator(publishFunction, fetchFn) {\n    return function interpolatedPublishfunction(topic, value, options) {\n        var normalizedPublishInputs = normalizeParamOptions(topic, value, options);\n        var dependencies = getDependencies(normalizedPublishInputs.params);\n        if (!dependencies.length) {\n            return publishFunction(topic, value, options);\n        }\n        \n        var prom = $.Deferred();\n        fetchFn(dependencies, function handleDependencyChange(resolvedDependencies) {\n            var interpolated = interpolateWithDependencies(normalizedPublishInputs.params, resolvedDependencies);\n            var newPublishProm = publishFunction(interpolated, normalizedPublishInputs.options);\n            newPublishProm.then(prom.resolve, prom.reject);\n        });\n        return prom.promise();\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/channel-manager-enhancements/interpolatable/publish-interpolator.js","import { normalizeParamOptions } from '../../channel-utils';\nimport { omit, difference, uniq } from 'lodash';\n\nfunction getTopicsFromSubsList(subcriptionList) {\n    const allTopics = subcriptionList.reduce(function (accum, subs) {\n        accum = accum.concat(subs.topics);\n        return accum;\n    }, []);\n    return uniq(allTopics);\n}\n\n/**\n * Decorates passed channel manager with middleware functionality\n * @param  {ChannelManager} BaseChannelManager\n * @param  {Object} router\n * @returns {ChannelManager} wrapped channel manager\n */\nexport default function withRouter(BaseChannelManager, router) {\n    /**\n     * @augments ChannelManager\n     */\n    return class ChannelWithRouter extends BaseChannelManager {\n        constructor(options) {\n            super(options);\n            const defaults = {\n                routes: []\n            };\n            const opts = $.extend(true, {}, defaults, options);\n            const optsToPassOn = omit(opts, Object.keys(defaults));\n\n            const rt = router(opts.routes, optsToPassOn, this.notify.bind(this));\n            Object.assign(this, rt.expose || {});\n            this.router = rt;\n        }\n\n        /**\n         * Allow intercepting and excluding topics from by subsequent middlewares\n         * @param  {string | string[]}   topics\n         * @param  {Function} cb\n         * @param  {Object}   options\n         * @returns {string}           subscription id\n         */\n        subscribe(topics, cb, options) {\n            const subsid = super.subscribe(topics, cb, options);\n            this.router.subscribeHandler([].concat(topics), options).then((topicsWithData)=> {\n                if (topicsWithData && topicsWithData.length) {\n                    this.notify([].concat(topicsWithData));\n                }\n            }, (err)=> {\n                this.unsubscribe(subsid);\n                if (options && options.onError) {\n                    options.onError(err);\n                }\n            });\n            return subsid;\n        }\n\n        /**\n         * Allow intercepting and handling/suppressing data to publish calls.\n         * @param {string | Publishable } topic\n         * @param {any} [value] item to publish\n         * @param {Object} [options]\n         * @returns {Promise}\n         */\n        publish(topic, value, options) {\n            const publishData = normalizeParamOptions(topic, value, options);\n            return this.router.publishHandler(publishData.params, publishData.options).then((published)=> {\n                return super.publish(published, publishData.options);\n            });\n        }\n        \n\n        /**\n         * Calls unsubscribe middleware *after* unsubscription with a list of recently unsubscribed topics\n         * @param  {string} token\n         * @returns {void}\n         */\n        unsubscribe(token) {\n            const originalTopics = getTopicsFromSubsList(this.subscriptions);\n            super.unsubscribe(token);\n            const remainingTopics = getTopicsFromSubsList(this.subscriptions);\n            const unsubscribedTopics = difference(originalTopics, remainingTopics);\n\n            this.router.unsubscribeHandler(unsubscribedTopics, remainingTopics);\n        }\n\n        /**\n         * Calls unsubscribe middleware after unsubscribeAll on the channel\n         * @returns {void}\n         */\n        unsubscribeAll() {\n            const originalTopics = getTopicsFromSubsList(this.subscriptions);\n            super.unsubscribeAll();\n\n            return this.router.unsubscribeHandler(originalTopics, []);\n        }\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/channel-manager-enhancements/routable/index.js","export { makePromise, debounceAndMerge } from './general';\n\n\n// WEBPACK FOOTER //\n// ./src/utils/index.js"],"sourceRoot":""}