{"version":3,"sources":["webpack:///webpack/bootstrap 884bea88e458efd6d7b4","webpack:///external \"_\"","webpack:///./src/config.js","webpack:///./src/channels/channel-router/utils/index.js","webpack:///./src/channels/channel-router/index.js","webpack:///./src/utils/parse-utils.js","webpack:///./src/channels/channel-utils.js","webpack:///./src/channels/route-handlers/route-matchers.js","webpack:///./src/utils/general/index.js","webpack:///./src/channels/route-handlers/epicenter-route-handlers/run-route-handler/index.js","webpack:///./src/utils/animation.js","webpack:///./src/dom/attribute-manager/attr-template-utils.js","webpack:///./src/dom/nodes/default-input-node.js","webpack:///./src/dom/nodes/default-node.js","webpack:///./src/dom/attribute-manager/attributes/loop-attrs/loop-attr-utils.js","webpack:///./src/utils/general/promise-utils.js","webpack:///./src/channels/route-handlers/epicenter-route-handlers/world-route-handler/consensus-route-handler/consensus-utils.js","webpack:///./src/channels/channel-manager-enhancements/interpolatable/interpolatable-utils.js","webpack:///./src/flow.js","webpack:///./src/dom/dom-manager.js","webpack:///./src/dom/dom-manager-utils/dom-parse-helpers/index.js","webpack:///./src/dom/dom-manager-utils/dom-parse-helpers/parse-converters.js","webpack:///./src/dom/dom-manager-utils/dom-parse-helpers/parse-channel.js","webpack:///./src/dom/dom-manager-utils/dom-parse-helpers/parse-topics.js","webpack:///./src/dom/dom-manager-utils/dom-channel-prefix-helpers/index.js","webpack:///./src/converter-manager/index.js","webpack:///./src/converter-manager/converters/number-converter.js","webpack:///./src/converter-manager/converters/string-converter.js","webpack:///./src/converter-manager/converters/array-converter.js","webpack:///./src/converter-manager/converters/general-util-converters.js","webpack:///./src/converter-manager/converters/numberformat-converter.js","webpack:///./src/converter-manager/converters/number-compare-converters.js","webpack:///./src/converter-manager/converters/bool-conditional-converters.js","webpack:///./src/converter-manager/converters/collection-converters.js","webpack:///./src/dom/nodes/node-manager.js","webpack:///./src/dom/nodes/input-checkbox-node.js","webpack:///./src/utils/base-view.js","webpack:///./src/dom/attribute-manager/index.js","webpack:///./src/dom/attribute-manager/attributes/no-op-attr/index.js","webpack:///./src/dom/attribute-manager/attributes/events/default-event-attr/index.js","webpack:///./src/dom/attribute-manager/attributes/loop-attrs/foreach-attr/index.js","webpack:///./src/dom/attribute-manager/attributes/loop-attrs/repeat-attr/index.js","webpack:///./src/utils/general/debounce-and-merge.js","webpack:///./src/dom/attribute-manager/attributes/class-attr/index.js","webpack:///./src/dom/attribute-manager/attributes/boolean-attr/index.js","webpack:///./src/dom/attribute-manager/attributes/toggles/show-if-attr/index.js","webpack:///./src/dom/attribute-manager/attributes/toggles/hide-if-attr/index.js","webpack:///./src/dom/attribute-manager/attributes/binds/checkbox-radio-bind-attr/index.js","webpack:///./src/dom/attribute-manager/attributes/binds/input-bind-attr/index.js","webpack:///./src/dom/attribute-manager/attributes/binds/default-bind-attr/index.js","webpack:///./src/dom/attribute-manager/attributes/binds/bind-utils/index.js","webpack:///./src/dom/attribute-manager/attributes/default-attr/index.js","webpack:///./src/dom/plugins/auto-update-bindings.js","webpack:///./src/channels/configured-channel-manager.js","webpack:///./src/channels/channel-manager.js","webpack:///external \"jQuery\"","webpack:///./src/channels/channel-router/utils/handler-utils.js","webpack:///./src/channels/channel-router/utils/silencable.js","webpack:///./src/channels/channel-router/utils/exclude-read-only.js","webpack:///./src/channels/route-handlers/index.js","webpack:///./src/channels/route-handlers/json-route-handler/index.js","webpack:///./src/channels/route-handlers/epicenter-route-handlers/index.js","webpack:///./src/channels/route-handlers/epicenter-route-handlers/default-run-route-handler/index.js","webpack:///./src/channels/route-handlers/epicenter-route-handlers/run-route-handler/run-meta-route-handler.js","webpack:///./src/channels/route-handlers/epicenter-route-handlers/run-route-handler/run-variables-route-handler.js","webpack:///./src/channels/route-handlers/epicenter-route-handlers/run-route-handler/retriable-variable-fetch.js","webpack:///./src/channels/route-handlers/epicenter-route-handlers/run-route-handler/run-operations-route-hander.js","webpack:///./src/channels/route-handlers/epicenter-route-handlers/scenario-route-handler/index.js","webpack:///./src/channels/route-handlers/epicenter-route-handlers/runid-route-handler/index.js","webpack:///./src/channels/route-handlers/epicenter-route-handlers/run-router-factory.js","webpack:///./src/channels/route-handlers/epicenter-route-handlers/world-route-handler/index.js","webpack:///./src/channels/route-handlers/epicenter-route-handlers/world-route-handler/world-users-route-handler/index.js","webpack:///./src/channels/route-handlers/epicenter-route-handlers/world-route-handler/world-current-user-route-handler/index.js","webpack:///./src/channels/route-handlers/epicenter-route-handlers/world-route-handler/consensus-route-handler/index.js","webpack:///./src/channels/route-handlers/epicenter-route-handlers/world-route-handler/consensus-route-handler/consensus-operations-handler.js","webpack:///./src/channels/route-handlers/epicenter-route-handlers/world-route-handler/consensus-route-handler/consensus-status-handler.js","webpack:///./src/channels/route-handlers/epicenter-route-handlers/multi-run-route-handler/index.js","webpack:///./src/channels/channel-manager-enhancements/index.js","webpack:///./src/channels/channel-manager-enhancements/interpolatable/index.js","webpack:///./src/channels/channel-manager-enhancements/interpolatable/subscribe-interpolator.js","webpack:///./src/channels/channel-manager-enhancements/interpolatable/publish-interpolator.js","webpack:///./src/channels/channel-manager-enhancements/routable/index.js"],"names":["module","exports","prefix","binderAttr","events","trigger","convert","error","attrs","checkboxOffValue","repeat","templateId","errorAttr","animation","addAttr","changeAttr","initialAttr","CHANNEL_DELIMITER","stripSuffixDelimiter","text","indexOf","length","replace","mapWithPrefix","dataArray","map","datapt","name","$","extend","withPrefix","callback","prefixList","arr","concat","data","forEach","mapped","unprefixTopics","list","unprefixed","item","unprefix","notifySubscribeHandlers","handlers","topics","options","grouped","groupByHandlers","promises","filter","handler","subscribeHandler","mergedOptions","matched","promise","makePromise","subsResponse","then","topicsWithData","normalized","normalizeSubscribeResponse","prefixed","push","when","apply","arguments","notifyUnsubscribeHandlers","recentlyUnsubscribedTopics","remainingTopics","h","index","unsubsKey","unsubsGrouped","remainingGrouped","unsubscribeHandler","unprefixedUnsubs","matchingRemainingHandler","_","find","remainingHandler","matchingTopicsRemaining","unprefixedRemaining","passthroughPublishInterceptors","publishData","groupSequentiallyByHandlers","$initialProm","Deferred","resolve","dataSoFar","publishableData","excludeReadOnly","readOnly","result","publishHandler","publishProm","published","silencable","silent","isDefault","router","notifier","myHandlers","Handler","isFunction","expose","match","matchString","t","reduce","accum","topic","addRoute","Error","id","uniqueId","unshift","removeRoute","routeid","toImplicitType","objRegex","arrRegex","converted","trim","charAt","substring","isNumeric","test","bracketReplaced","parsed","split","val","JSON","parse","e","console","splitUnescapedCommas","str","regex","m","op","exec","lastIndex","groupIndex","splitNameArgs","value","fnName","params","args","p","toPublishableFormat","OPERATIONS_SEPERATOR","listOfOperations","objectToPublishable","obj","Object","keys","publishableToObject","mergeWith","normalizeParamOptions","publishValue","isPlainObject","Array","isArray","ROUTE_DELIMITER","matchPrefix","prefixMatcher","hasPrefix","isOnlyPrefix","matchDefaultPrefix","defaultPrefixMatcher","forcePrefix","matchRegex","toMatch","RegExp","regexMatcher","random","min","max","parseInt","rnd","_random","VARIABLES_PREFIX","META_PREFIX","OPERATIONS_PREFIX","_shouldFetch","ignoreOperations","filtered","r","isIgnored","isVariable","isOperation","RunService","F","service","Run","GenericRunRouteHandler","config","defaults","serviceOptions","channelOptions","variables","autoFetch","debounce","operations","meta","opts","rs","operationNotifier","variableNotifier","metaHandler","operationsHandler","variablesHandler","subscribed","channel","TOPICS","subscribeOpts","includeMine","subscribe","RUN_VARIABLES","log","notify","fetch","RUN_OPERATIONS","CONSENSUS_UPDATE","consensus","closed","RUN_RESET","runRouter","oldhandler","publishable","prom","shouldFetch","excludeFromFetch","exclude","_findMostConsequtive","reduced","prev","count","maxCount","Math","buildDiffArray","currentcontents","newContents","contents","isSame","fill","a","i","elToContents","el","outerHTML","elementsToContents","$els","child","get","addChangeClassesToList","$currentEls","$newEls","isInitial","reversedContents","diffFromEnd","diffFromBeginning","slice","reverse","endMatches","beginningMatches","placeHoldersCount","placeHolders","undefined","$el","eq","curr","removeAttr","attr","addContentAndAnimate","newValue","current","html","setTimeout","CURRENT_INDEX_KEY","CURRENT_INDEX_ATTR","getKnownDataForEl","closestKnownDataEl","closest","knownData","updateKnownDataForEl","stringify","removeKnownData","getTemplateTags","template","templateTagsUsed","isTemplated","findMissingReferences","knownDataKeys","isKnownTag","tag","knownTags","key","missingReferences","refKey","refToMarkup","stubMissingReferences","refId","addBackMissingReferences","originalTemplateVal","commentRef","elTemplateMap","WeakMap","getOriginalContents","resolver","originalHTML","set","clearOriginalContents","delete","BaseView","propertyHandlers","uiChangeEvent","getUIValue","removeEvents","off","initialize","me","propName","on","payload","source","prototype","selector","require","IN_OF_REGEX","KEY_VALUE_REGEX","extractVariableName","attrVal","inMatch","varName","parseKeyAlias","itMatch","alias","parseValueAlias","aliasesFromTopics","relevantTopic","defaultKey","keyAlias","valueAlias","parseTopics","$def","toReturn","reject","promisify","fn","promisifiedFunction","makeConsensusService","consensisAPIResponse","window","Consensus","stage","consensusGroup","worldId","interpolationRegex","extractDependencies","deps","interpolateWithValues","interpolatedTopic","dependency","toReplace","Flow","dom","utils","model","run","root","autoBind","domManager","unbindAll","bindAll","ChannelManager","constants","version","expr","pseudos","attributes","nodeName","getMatchingElements","$root","matchedElements","is","add","getElementOrError","element","context","removeAllSubscriptions","subscriptions","subs","unsubscribe","unbindAllAttributes","domEl","each","nodeMap","wantedPrefix","attrManager","getHandler","unbind","unbindAllNodeHandlers","nodeManager","handle","triggerError","msg","message","publicAPI","nodes","converters","Map","unbindElement","existingData","subsid","subscriptionId","animAttrs","join","removeData","bindElement","filterPrefix","attrList","parseTopicsFromAttributeValue","init","channelPrefix","getChannelForAttribute","addPrefixToTopics","getConvertersForEl","channelConfig","getChannelConfigForElement","attrsWithSubscriptions","subsOptions","batch","onError","subscribableTopics","isEqual","previousData","toConvert","dataForAttr","pick","k","assign","elementsToBind","elementsToUnbind","plugins","attachUIListeners","parseValue","converterManager","evt","elMeta","target","sourceMeta","action","parsedValue","actualName","prefixedName","addDefaultPrefix","publish","last","attachConversionListner","prop","convertedValue","deferred","autoUpdatePlugin","convertersToArray","conv","v","getConvertersFromAttr","attribute","withConv","getFConvertAttrVal","suffix","baseAttr","suffixAttr","getAllConverters","convertersAsPipes","whiteListedGenericAttributes","canUseFConvert","$parentEl","parents","resolvedConverters","parentConv","attrib","specified","commaRegex","topicsPart","mappedTopics","currentName","hasChannelDefined","DEFAULT_OPERATIONS_PREFIX","DEFAULT_VARIABLES_PREFIX","isUnprefixed","defaultPrefix","needsDefaultPrefix","hasDefaultPrefix","normalize","converter","acceptList","ret","matchConverter","isString","isRegExp","private","register","currentConverter","splice","getConverter","norm","Function","bind","currentValue","convertArray","converterName","convertObject","mapValues","defaultconverters","c","parseFloat","s","upperCase","toUpperCase","lowerCase","toLowerCase","titleCase","txt","substr","parseLimitArgs","starting","limit","toRet","input","n","stripped","first","previous","size","src","pickEvery","startIndex","newfn","toArray","indexOfActualValue","newArgs","parseArgs","toCompare","trueVal","falseVal","valueToCompare","isNumber","isAllowedLeading","validPrefixes","checkValMatch","validStandalone","validFirstChars","validLastChars","isValidFirstChar","isValidLastChar","validRemainingChars","areRemainingCharactersValid","char","isMatch","parts","isNegative","floatMatcher","results","number","scales","roundTo","digits","round","pow","getDigits","ceil","LN10","TXT","numberTXT","toString","decimalSet","iTXT","addDecimals","decimals","minDecimals","hasCommas","hasDecimals","iDec","iChar","toADD","getSuffix","formatTXT","fixesTXT","format","isNaN","entityCodeMapping","code","formats","abs","sign","leftOfDecimal","d","lastIndexOf","isShortFormat","nextChar","leadingText","rightOfPrefix","shortFormatTest","shortFormatTestResult","valScale","floor","Number","limitDigits","SUFFIX","valWithoutLeading","subFormats","preffix","formatted","greaterThan","greaterThanEqual","equalsNumber","lessThan","lessThanEqual","toBool","not","ifTrue","ifFalse","valueToFilterBy","except","valueToReject","any","some","every","node","currentHandler","defaultHandlers","default","offAttr","offAttrVal","offVal","onAttrVal","onVal","has","extendView","protoProps","staticProps","constructor","Surrogate","__super__","View","handlersList","attributeMatcher","nodeMatcher","matchAttr","matchExpr","attrMatch","matchNode","nodeFilter","attributeManager","attrFilter","noopAttr","defaultEventAttr","eventName","matching","preventDefault","elAnimatedMap","foreachAttr","stubbedTemplate","templateFn","$dummyEl","dataval","datakey","templateData","templated","templatedWithReferences","newNode","$newNode","append","isInitialAnim","$withAnimAttrs","children","empty","templateIdAttr","loopAttrHandler","nextUntil","remove","replaceWith","$dummyOldDiv","$removed","isEmpty","hasData","insertAfter","debounceAndMerge","debounceInterval","argumentsReducers","argsToPass","arrayReducer","newVal","queue","timer","isExecuting","debouncedFunction","arg","reducer","isComplete","clearTimeout","argsClone","promisifiedFn","shift","elClassesMap","deleteAddedClasses","addedClasses","removeClass","classAttr","addClass","booleanAttrHandler","showifHandler","hide","show","hideifHandler","checkboxAttrHandler","settableValue","isChecked","inputBindAttr","toAliasMap","getNewContent","currentContents","translateDataToInsertable","translateDataToTemplatable","templatedHTML","bindAttrHandler","extractAlias","bindTemplate","originalContents","aliasMap","originalName","AS_REGEX","asMatch","defaultAttr","isEnabled","MutationObserver","observer","mutations","mutation","added","addedNodes","removed","removedNodes","attributeName","mutconfig","attributeFilter","childList","subtree","characterData","publicApi","enable","observe","disable","disconnect","InterpolatableRoutableChannelManager","interpolatable","routable","defaultRouteHandlers","routes","cm","makeSubs","cache","cacheBySubsId","sentDataBySubsId","copy","callbackSubscriber","subscription","checkAndNotifyBatch","matchingTopics","intersection","relevantDataFromPublish","cachedDataForSubs","knownDataForSubs","hasDataForAllTopics","checkAndNotify","needsThisTopic","isWildCard","getTopicsFromSubsList","subcriptionList","publishResponses","cb","token","olderLength","remaining","uniq","findBestHandler","matchOptions","thishandler","topicMapping","bestHandler","values","dataPt","lastHandler","response","isAlreadyInPublishableFormat","silentOptions","found","readOnlyOptions","isReadonly","warn","getOptions","SCENARIO_PREFIX","RUN_PREFIX","WORLD_PREFIX","sampleRunidLength","runidRegex","EpicenterRouteHandler","channelManagerContext","runidHandlerOpts","runidHandler","multiRunHandler","exposable","runManagerOpts","runManager","scenarioManager","rm","isMultiplayer","strategy","scenarioManagerOpts","sm","epicenterRouter","RunManagerRouteHandler","rmOptions","manager","RunManager","$creationPromise","getRun","currentChannelOpts","currentRunChannel","runRouteHandler","runMangerRouter","RunMetaRouteHandler","$runServicePromise","mergeAndSend","runMeta","requestedTopics","toSend","runService","cachedValues","loadPromise","load","toSave","save","res","mergeVariables","newval","merged","RunVariablesRouteHandler","debouncedVariableQuery","debouncedFetchers","retriableFetch","knownTopics","variablesToFetch","difference","unsubscribedTopics","isAutoFetchEnabled","missingVariables","variableObj","query","catch","responseJSON","info","information","goodVariables","vName","baseName","isBad","names","RunOperationsRouteHandler","operationsResponse","serial","ScenarioManagerRouteHandler","ScenarioManager","baselinePromise","baseline","baselineOptions","currentRunPromise","runOptions","baselineHandler","currentRunHandler","scenarioManagerRouter","RunidRouteHandler","runid","runChannelFactory","knownRunIDServiceChannels","runChannel","MULTI_USER_PREFIX","USER_PREFIX","CONSENSUS_PREFIX","WorldRoutesHandler","runPromise","world","err","$runPromise","alreadyStubbedRunChannel","channelManager","worldChannel","getWorldChannel","updateConfig","currentRunHandlerOpts","$worldProm","getWorld","worldChannelMap","getChannelForWorld","worldid","am","AuthManager","handlerOptions","getSession","getCurrentUserSessionInfo","getChannel","usersRouteHandler","usersHandler","currentUserRouteHandler","currentUserHandler","ConsensusManager","consensusRouteHandler","consensusHandler","worldRouteHandler","WorldUsersRouteHandler","store","users","mark","userid","isOnline","u","userId","parsedUsersPromise","session","lastName","isMe","presenceSubsId","userids","PRESENCE","user","ps","Presence","markOnline","markOffline","WorldCurrentUserRouteHandler","stillNeedRoles","userFields","myUser","toNotify","field","isSubscribingToRole","ROLES","role","ConsensusRouteHandler","consensusProm","getConsensus","force","getCurrent","opnHandler","OperationsHandler","statusHandler","StatusHandler","status","consensusManager","ConsensusOperationsHandler","actions","cs","submitActions","ConsensusStatusHandler","normalizePlayers","rolePlayerMap","playersForRole","playersWithRole","player","userName","normalizeConsensus","submitted","amWaiting","pending","normalizedConsensus","dataForTopics","TypeError","forceClose","MultiRunRouteHandler","topicParamMap","extractFiltersFromTopic","topicString","filters","filterParam","include","runs","debouncedFetch","subsMap","subsidMap","subscribeInterpolator","dependencySubsId","newDependentId","existing","publishInterpolator","getDependencies","inner","interpolateWithDependencies","mergeInterpolatedTopicsWithData","originalTopics","interpolatedTopics","original","subscribeFn","onDependencyChange","interpolatedSubscribe","dependencies","innerSubsId","handleDependencyValueChange","dependenciesMeta","isSameData","outerSubsId","handleInterpolatedValueChange","actualData","actualMeta","toSendback","noop","publishInputs","valuesToInterpolate","ip","publishFunction","fetchFn","interpolatedPublishfunction","normalizedPublishInputs","handleDependencyChange","resolvedDependencies","interpolated","newPublishProm","allTopics","withRouter","BaseChannelManager","optsToPassOn","omit","rt"],"mappings":"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","file":"flow.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 17);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 884bea88e458efd6d7b4","module.exports = _;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"_\"\n// module id = 0\n// module chunks = 0","module.exports = {\n    prefix: 'f',\n    binderAttr: 'f-bind',\n\n    events: {\n        /** UI Change to publish to the channel. */\n        trigger: 'update.f.ui',\n\n        /** Trigger with payload '{attrToUpdate: value}', for e.g. { bind: 34 }. This will run this through all the converts and pass it to attr handler. Useful to by-pass getting this from the model directly.  */\n        convert: 'f.convert',\n\n        /** On a bind or other flow-related error  */\n        error: 'f.error',\n    },\n\n    attrs: {\n        checkboxOffValue: 'data-off-value',\n        //Used by repeat attr handler to keep track of template after first evaluation\n        repeat: {\n            templateId: 'repeat-template-id' //don't prefix by f or dom-manager unbind will kill it\n        },\n    },\n\n    errorAttr: 'data-flow-error',\n    animation: {\n        addAttr: 'data-add',\n        changeAttr: 'data-update',\n        initialAttr: 'data-initial',\n    }\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/config.js","const CHANNEL_DELIMITER = ':';\n\nexport { default as silencable } from './silencable';\nexport { default as excludeReadOnly } from './exclude-read-only';\n\n/**\n * \n * @param {string} text\n * @return {string}\n */\nexport function stripSuffixDelimiter(text) {\n    if (text && text.indexOf(CHANNEL_DELIMITER) === (text.length - 1)) {\n        text = text.replace(CHANNEL_DELIMITER, '');\n    }\n    return text;\n}\n\n/**\n * \n * @param {Publishable[]} dataArray \n * @param {string} prefix \n * @return {Publishable[]} array with name prefixed\n */\nexport function mapWithPrefix(dataArray, prefix) {\n    if (!prefix) return dataArray;\n    return (dataArray || []).map(function (datapt) {\n        const name = (prefix + datapt.name).replace(/:$/, ''); //replace trailing delimiters\n        return $.extend(true, {}, datapt, { name: name });\n    });\n}\n\n/**\n * \n * @param {Function} callback \n * @param {string|string[]} prefixList\n * @return {Function}\n */\nexport function withPrefix(callback, prefixList) {\n    const arr = [].concat(prefixList);\n\n    /**\n     * @param {Publishable[]} data\n     */\n    return function (data) {\n        arr.forEach(function (prefix) {\n            const mapped = mapWithPrefix(data, prefix);\n            callback(mapped);\n        });\n    };\n}\n\n/**\n * \n * @param {string[]} list \n * @param {string} prefix\n * @return {string[]} Item with prefix removed\n */\nexport function unprefixTopics(list, prefix) {\n    if (!prefix) return list;\n    const unprefixed = list.map(function (item) {\n        return item.replace(prefix, '');\n    });\n    return unprefixed;\n}\n\n/**\n * \n * @param {Publishable[]} list \n * @param {string} prefix\n * @return {Publishable[]} Item with prefix removed\n */\nexport function unprefix(list, prefix) {\n    if (!prefix) return list;\n    const unprefixed = list.map(function (item) {\n        if (item.name) {\n            return $.extend(true, {}, item, { name: item.name.replace(prefix, '') });\n        }\n        return item.replace(prefix, '');\n    });\n    return unprefixed;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/channel-router/utils/index.js","import { groupByHandlers, groupSequentiallyByHandlers, normalizeSubscribeResponse } from './utils/handler-utils';\nimport { unprefix, unprefixTopics, mapWithPrefix, silencable, excludeReadOnly } from './utils';\nimport { makePromise } from 'utils/general';\nimport _ from 'lodash';\n\n\n/**\n * Handle subscriptions\n * @param  {Handler[]} handlers Array of the form [{ match: function (){}, }]\n * @param  {String[]} topics   Array of strings\n * @param  {SubscribeOptions} [options]\n * @return {Promise<Publishable[]>} Returns populated topics if available\n */\nexport function notifySubscribeHandlers(handlers, topics, options) {\n    const grouped = groupByHandlers(topics, handlers);\n    const promises = [];\n    grouped.filter((handler)=> handler.subscribeHandler).forEach(function (handler) {\n        const mergedOptions = $.extend(true, {}, handler.options, options);\n        const unprefixed = unprefixTopics(handler.data, handler.matched);\n        const promise = makePromise(()=> {\n            const subsResponse = handler.subscribeHandler(unprefixed, mergedOptions, handler.matched);\n            return subsResponse;\n        }).then((topicsWithData)=> {\n            const normalized = normalizeSubscribeResponse(topicsWithData, unprefixed);\n            const prefixed = mapWithPrefix(normalized, handler.matched);\n            return prefixed;\n        });\n        promises.push(promise);\n    });\n    return $.when.apply(null, promises).then(function () {\n        const arr = [].concat.apply([], arguments);\n        return arr;\n    });\n}\n\n/**\n * \n * @param {Handler[]} handlers \n * @param {String[]} recentlyUnsubscribedTopics\n * @param {String[]} remainingTopics \n */\nexport function notifyUnsubscribeHandlers(handlers, recentlyUnsubscribedTopics, remainingTopics) {\n    handlers = handlers.map(function (h, index) {\n        h.unsubsKey = index;\n        return h;\n    });\n\n    const unsubsGrouped = groupByHandlers(recentlyUnsubscribedTopics, handlers);\n    const remainingGrouped = groupByHandlers(remainingTopics, handlers);\n\n    unsubsGrouped.filter((h)=> h.unsubscribeHandler).forEach(function (handler) {\n        const unprefixedUnsubs = unprefixTopics(handler.data, handler.matched);\n        const matchingRemainingHandler = _.find(remainingGrouped, function (remainingHandler) {\n            return remainingHandler.unsubsKey === handler.unsubsKey;\n        });\n        const matchingTopicsRemaining = matchingRemainingHandler ? matchingRemainingHandler.data : [];\n        const unprefixedRemaining = unprefixTopics(matchingTopicsRemaining || [], handler.matched);\n        handler.unsubscribeHandler(unprefixedUnsubs, unprefixedRemaining);\n    });\n}\n\n/**\n * \n * @param {Handler[]} handlers \n * @param {Publishable[]} publishData \n * @param {PublishOptions} [options]\n * @return {Promise}\n */\nexport function passthroughPublishInterceptors(handlers, publishData, options) {\n    const grouped = groupSequentiallyByHandlers(publishData, handlers);\n    let $initialProm = $.Deferred().resolve([]).promise();\n    grouped.forEach(function (handler) {\n        $initialProm = $initialProm.then(function (dataSoFar) {\n            const mergedOptions = $.extend(true, {}, handler.options, options);\n            const unprefixed = unprefix(handler.data, handler.matched);\n\n            const publishableData = excludeReadOnly(unprefixed, mergedOptions.readOnly);\n            if (!publishableData.length) {\n                return dataSoFar;\n            }\n\n            const result = handler.publishHandler ? handler.publishHandler(publishableData, mergedOptions, handler.matched) : publishableData;\n            const publishProm = $.Deferred().resolve(result).promise();\n            return publishProm.then(function (published) {\n                return silencable(published, mergedOptions.silent);\n            }).then(function (published) {\n                let mapped = mapWithPrefix(published, handler.matched);\n                if (handler.isDefault && handler.matched) {\n                    mapped = mapped.concat(published);\n                }\n                return mapped;\n            }).then(function (mapped) {\n                return [].concat(dataSoFar, mapped);\n            });\n        });\n    });\n    return $initialProm;\n}\n\n/**\n * Router\n * @param  {Handler[]} handlers\n * @param {object} [options]\n * @param {function} [notifier]\n * @return {Router}\n */\nexport default function router(handlers, options, notifier) {\n    let myHandlers = (handlers || []).map((Handler)=> {\n        let handler = Handler;\n        if (_.isFunction(Handler)) {\n            handler = new Handler(options, notifier);\n            $.extend(this, handler.expose);\n        }\n        if (typeof handler.match === 'string') {\n            const matchString = handler.match;\n            handler.name = matchString;\n            handler.match = (t)=> t === matchString ? '' : false;\n        }\n        return handler;\n    });\n\n    const expose = myHandlers.reduce((accum, h)=> {\n        $.extend(true, accum, h.expose);\n        return accum;\n    }, {});\n\n    return {\n        expose: expose,\n        match: (topic)=> {\n            return myHandlers.reduce((match, handler)=> {\n                const matched = handler.match(topic);\n                if (match === false && matched !== false) {\n                    return '';\n                }\n                return match;\n            }, false);\n        },\n\n        /**\n         * @param {String[]} topics\n         * @param {SubscribeOptions} [options]\n         * @return {Promise<Publishable[]>} Returns populated topics if available\n         */\n        subscribeHandler: function (topics, options) {\n            return notifySubscribeHandlers(myHandlers, topics, options);\n        },\n        /**\n         * @param {String[]} recentlyUnsubscribedTopics\n         * @param {String[]} remainingTopics\n         * @return {void}\n         */\n        unsubscribeHandler: function (recentlyUnsubscribedTopics, remainingTopics) {\n            return notifyUnsubscribeHandlers(myHandlers, recentlyUnsubscribedTopics, remainingTopics);\n        },\n\n        /**\n         * @param {Publishable[]} data\n         * @param {PublishOptions} [options]\n         * @return {Promise}\n         */\n        publishHandler: function (data, options) {\n            return passthroughPublishInterceptors(myHandlers, data, options);\n        },\n\n        addRoute: function (handler) {\n            if (!handler || !handler.match) {\n                throw Error('Handler does not have a valid `match` property');\n            }\n            handler.id = _.uniqueId('routehandler-');\n            myHandlers.unshift(handler);\n            return handler.id;\n        },\n        removeRoute: function (routeid) {\n            myHandlers = myHandlers.filter((handler)=> {\n                return handler.id !== routeid;\n            });\n        }\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/channel-router/index.js","/* eslint-disable complexity */\nfunction toImplicitType(data) {\n    const objRegex = /^(?:\\{.*\\})$/;\n    const arrRegex = /^(?:\\[.*])$/;\n\n    let converted = data;\n    if (typeof data === 'string') {\n        converted = data.trim();\n\n        if (converted === 'true') {\n            converted = true;\n        } else if (converted === 'false') {\n            converted = false;\n        } else if (converted === 'null') {\n            converted = null;\n        } else if (converted === 'undefined') {\n            converted = '';\n        } else if (converted.charAt(0) === '\\'' || converted.charAt(0) === '\"') {\n            converted = converted.substring(1, converted.length - 1);\n        } else if ($.isNumeric(converted)) {\n            converted = +converted;\n        } else if (arrRegex.test(converted)) {\n            const bracketReplaced = converted.replace(/[[\\]]/g, '');\n            if (!bracketReplaced) return [];\n            const parsed = bracketReplaced.split(/,(?![^[]*])/).map((val)=> {\n                return toImplicitType(val);\n            });\n            return parsed;\n        } else if (objRegex.test(converted)) {\n            try {\n                converted = JSON.parse(converted);\n            } catch (e) {\n                console.error('toImplicitType: couldn\\'t convert', converted);\n            }\n        }\n    }\n    return converted;\n}\n\nfunction splitUnescapedCommas(str) {\n    const regex = /(\\\\.|[^,])+/g;\n    let m;\n\n    const op = [];\n    while ((m = regex.exec(str)) !== null) { //eslint-disable-line\n        // This is necessary to avoid infinite loops with zero-width matches\n        if (m.index === regex.lastIndex) {\n            regex.lastIndex++;\n        }\n        m.forEach(function (match, groupIndex) {\n            if (groupIndex === 0) {\n                op.push(match.replace('\\\\', ''));\n            }\n        });\n    }\n    return op;\n}\n\nfunction splitNameArgs(value) {\n    value = value.trim();\n    const fnName = value.split('(')[0];\n    const params = value.substring(value.indexOf('(') + 1, value.indexOf(')'));\n    const args = splitUnescapedCommas(params).map((p)=> p.trim());\n    return { name: fnName, args: args };\n}\n\n/**\n * @param  {string} value\n * @return {{ name: string, value: any}[]}       [description]\n */\nfunction toPublishableFormat(value) {\n    const OPERATIONS_SEPERATOR = '&&';\n    const split = (value || '').split(OPERATIONS_SEPERATOR);\n    const listOfOperations = split.map(function (value) {\n        if (value && value.indexOf('=') !== -1) {\n            const split = value.split('=');\n            return { name: split[0].trim(), value: split[1].trim() };\n        }\n        const parsed = splitNameArgs(value);\n        return { name: parsed.name, value: parsed.args };\n    });\n    return listOfOperations;\n}\n\nexport { toImplicitType, toPublishableFormat, splitNameArgs };\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils/parse-utils.js","/**\n * \n * @param {object} obj\n * @return {Publishable[]}\n */\nexport function objectToPublishable(obj) {\n    var mapped = Object.keys(obj || {}).map(function (t) {\n        return { name: t, value: obj[t] };\n    });\n    return mapped;\n}\n\n/**\n * Converts arrays of the form [{ name: '', value: ''}] to {[name]: value}\n * @param {Publishable[]} arr\n * @param {object} [mergeWith]\n * @returns {object}\n */\nexport function publishableToObject(arr, mergeWith) {\n    var result = (arr || []).reduce(function (accum, topic) {\n        accum[topic.name] = topic.value;\n        return accum;\n    }, $.extend(true, {}, mergeWith));\n    return result;\n}\n\n/**\n * @typedef NormalizedParam\n * @property {Publishable[]} params\n * @property {Object} options\n */\n\n/**\n *\n * @param {String|Object|array} topic \n * @param {*} publishValue \n * @param {Object} [options]\n * @return {NormalizedParam}\n */\nexport function normalizeParamOptions(topic, publishValue, options) {\n    if (!topic) {\n        return { params: [], options: {} };\n    }\n    if ($.isPlainObject(topic)) {\n        return { params: objectToPublishable(topic), options: publishValue };\n    }\n    if (Array.isArray(topic)) {\n        return { params: topic, options: publishValue };\n    }\n    return { params: [{ name: topic, value: publishValue }], options: options };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/channel-utils.js","const ROUTE_DELIMITER = ':';\n\n/**\n * \n * @param {string} prefix\n * @returns {matchFunction}\n */\nexport function matchPrefix(prefix) {\n    return function prefixMatcher(topic) {\n        const hasPrefix = topic.indexOf(prefix) === 0;\n        if (hasPrefix) return prefix;\n\n        const isOnlyPrefix = prefix.replace(/:/g, '') === topic;\n        if (isOnlyPrefix) return topic;\n\n        return false;\n    };\n}\n\n/**\n* \n* @param {string} prefix\n* @returns {matchFunction}\n*/\nexport function matchDefaultPrefix(prefix) {\n    return function defaultPrefixMatcher(topic, forcePrefix) {\n        const hasPrefix = topic.indexOf(prefix) === 0;\n        return (hasPrefix || forcePrefix) ? prefix : '';\n    };\n}\n\n/**\n * \n * @param {string} regex\n * @returns {matchFunction}\n */\nexport function matchRegex(regex) {\n    var toMatch = new RegExp('^' + regex + ROUTE_DELIMITER);\n    return function regexMatcher(topic) {\n        var match = topic.match(toMatch);\n        if (match && match.length) {\n            return match[0];\n        }\n        return false;\n    };\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/route-matchers.js","import { uniqueId, random as _random } from 'lodash';\n\nexport { makePromise, promisify } from './promise-utils';\nexport { default as debounceAndMerge } from './debounce-and-merge';\n\nexport function random(prefix, min, max) {\n    if (!min) {\n        min = parseInt(uniqueId(), 10);\n    }\n    if (!max) {\n        max = 100000; //eslint-disable-line no-magic-numbers\n    }\n    var rnd = _random(min, max, false) + '';\n    if (prefix) {\n        rnd = prefix + rnd;\n    }\n    return rnd;\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils/general/index.js","import MetaRouteHandler from './run-meta-route-handler';\nimport VariablesRouteHandler from './run-variables-route-handler';\nimport OperationsRouteHandler from './run-operations-route-hander';\n\nimport router from 'channels/channel-router';\nimport { withPrefix } from 'channels/channel-router/utils';\nimport { matchPrefix, matchDefaultPrefix } from 'channels/route-handlers/route-matchers';\n\nimport _ from 'lodash';\n\nexport const VARIABLES_PREFIX = 'variables:';\nexport const META_PREFIX = 'meta:';\nexport const OPERATIONS_PREFIX = 'operations:';\n\n/**\n * \n * @param {Publishable[]} result \n * @param {string[]} ignoreOperations \n * @returns {boolean}\n */\nexport function _shouldFetch(result, ignoreOperations) {\n    const filtered = (result || []).filter((r)=> {\n        const name = r.name || '';\n        const isIgnored = (ignoreOperations || []).indexOf(name.replace(OPERATIONS_PREFIX, '')) !== -1;\n        const isVariable = name.indexOf(VARIABLES_PREFIX) === 0;\n        const isOperation = name.indexOf(OPERATIONS_PREFIX) === 0;\n\n        return isVariable || (isOperation && !isIgnored);\n    });\n    return filtered.length > 0;\n}\n\nconst RunService = F.service.Run;\nexport default function GenericRunRouteHandler(config, notifier) {\n    const defaults = {\n        serviceOptions: {},\n        channelOptions: {\n            variables: {\n                autoFetch: true,\n                debounce: 200,\n                silent: false,\n                readOnly: false,\n            },\n            operations: {\n                readOnly: false,\n                silent: false,\n            },\n            meta: {\n                silent: false,\n                autoFetch: true,\n                readOnly: ['id', 'created', 'account', 'project', 'model', 'lastModified']\n            },\n        }\n    };\n    const opts = $.extend(true, {}, defaults, config);\n\n    const serviceOptions = _.result(opts, 'serviceOptions');\n\n    let $initialProm = null;\n    if (serviceOptions instanceof RunService) {\n        $initialProm = $.Deferred().resolve(serviceOptions).promise();\n    } else if (serviceOptions.then) {\n        $initialProm = serviceOptions;\n    } else {\n        const rs = new RunService(serviceOptions);\n        $initialProm = $.Deferred().resolve(rs).promise();\n    }\n\n    const operationNotifier = withPrefix(notifier, OPERATIONS_PREFIX);\n    const variableNotifier = withPrefix(notifier, [VARIABLES_PREFIX, '']);\n\n    const metaHandler = new MetaRouteHandler($initialProm, withPrefix(notifier, META_PREFIX));\n    const operationsHandler = new OperationsRouteHandler($initialProm, operationNotifier);\n    const variablesHandler = new VariablesRouteHandler($initialProm, variableNotifier);\n\n    let subscribed = false;\n    $initialProm.then((rs)=> {\n        if (rs.channel && !subscribed) {\n            subscribed = true;\n            const { TOPICS } = rs.channel;\n            const subscribeOpts = { includeMine: false };\n            //FIXME: Exclude silenced -- let notify take care of this?\n            //FIXME: Provide subscription fn to individual channels and let them handle it\n            rs.channel.subscribe(TOPICS.RUN_VARIABLES, (data, meta)=> {\n                console.log('variables', data, meta);\n                variablesHandler.notify(data, meta);\n                variablesHandler.fetch();\n            }, this, subscribeOpts);\n            rs.channel.subscribe(TOPICS.RUN_OPERATIONS, (data, meta)=> {\n                operationsHandler.notify(data, meta);\n                variablesHandler.fetch();\n            }, this, subscribeOpts);\n            rs.channel.subscribe(TOPICS.CONSENSUS_UPDATE, (consensus, meta)=> {\n                if (consensus.closed) {\n                    variablesHandler.fetch(); \n                    // I should also do operationsHandler.notify but I don't know what to notify them about\n                    //Just remove the 'include Mine' check for operations? That's just cached anyway\n                }\n            }, this, { includeMine: true });\n            rs.channel.subscribe(TOPICS.RUN_RESET, (data, meta)=> {\n                operationsHandler.notify({ name: 'reset', result: data }, meta);\n            }, this, subscribeOpts);\n\n\n            // rs.channel.subscribe('', (data, meta)=> {\n            //     console.log('everything', data, meta);\n            // });\n        }\n    });\n\n    const handlers = [\n        $.extend({}, metaHandler, { \n            name: 'meta',\n            match: matchPrefix(META_PREFIX),\n            options: opts.channelOptions.meta,\n        }),\n        $.extend({}, operationsHandler, { \n            name: 'operations',\n            match: matchPrefix(OPERATIONS_PREFIX),\n            options: opts.channelOptions.operations,\n        }),\n        $.extend({}, variablesHandler, { \n            isDefault: true,\n            name: 'variables',\n            match: matchDefaultPrefix(VARIABLES_PREFIX),\n            options: opts.channelOptions.variables,\n        }),\n    ];\n\n    // router.addRoute(prefix('meta:'), metaChannel, opts.channelOptions.meta);\n\n    const runRouter = router(handlers);\n    const oldhandler = runRouter.publishHandler;\n    runRouter.publishHandler = function (publishable) {\n        const prom = oldhandler.apply(router, arguments);\n        return prom.then(function (result) { //all the silencing will be taken care of by the router\n            const shouldFetch = _shouldFetch(result, ['reset']);\n            if (shouldFetch) {\n                const excludeFromFetch = result.map((r)=> r.name); //This was just published, no need to get the value again\n                variablesHandler.fetch({ exclude: excludeFromFetch });\n            }\n            return result;\n        });\n    };\n    return runRouter;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/epicenter-route-handlers/run-route-handler/index.js","export function _findMostConsequtive(arr, match) {\n    const reduced = arr.reduce((accum, val)=> {\n        if (val === match) {\n            if (accum.prev === match) {\n                accum.count = accum.count + 1;\n            } else {\n                accum.count = 1;\n            }\n        }\n        accum.maxCount = Math.max(accum.maxCount, accum.count);\n        accum.prev = val;\n        return accum;\n    }, { prev: null, count: 0, maxCount: 0 });\n    return reduced.maxCount;\n}\n\nfunction buildDiffArray(currentcontents, newContents) {\n    return newContents.map((contents, index)=> {\n        const isSame = contents === currentcontents[index]; \n        return isSame;\n    });\n}\n\nfunction fill(count, val) {\n    const a = [];\n    for (let i = 0; i < count; i++) {\n        a.push(val);\n    }\n    return a;\n}\n\nfunction elToContents(el) {\n    //ignore data attributes for comparison\n    return el.outerHTML\n        .replace(/\\s?data-[a-zA-Z]*=['\"][a-zA-Z0-9]*['\"]/g, '')\n        .replace(/\\s\\s/g, ' ').trim();\n}\n\nfunction elementsToContents($els) {\n    return $els.map((index, child)=> {\n        return elToContents(child);\n    }).get();\n}\n\nconst defaults = {\n    addAttr: 'data-add',\n    changeAttr: 'data-update',\n    initialAttr: 'data-initial',\n};\n\n/**\n * Compares 2 lists and Adds add or update classes\n * @param {JQuery<HTMLElement>} $currentEls existing elements\n * @param {JQuery<HTMLElement>} $newEls   new elements\n * @param {Boolean} isInitial check if this is initial data or it's updating\n * @param {{ addAttr: string, changeAttr: string}} [options]\n * @returns {JQuery<HTMLElement>} elements with updated attributes\n */\nexport function addChangeClassesToList($currentEls, $newEls, isInitial, options) {\n    const opts = $.extend({}, defaults, options);\n\n    let currentcontents = elementsToContents($currentEls);\n    const newContents = elementsToContents($newEls);\n    const reversedContents = currentcontents;\n\n    //Guess if data was added to end or beginning of array\n    const diffFromEnd = buildDiffArray(currentcontents, newContents);\n    const diffFromBeginning = buildDiffArray(reversedContents.slice().reverse(), newContents.slice().reverse());\n\n    const endMatches = _findMostConsequtive(diffFromEnd, true);\n    const beginningMatches = _findMostConsequtive(diffFromBeginning, true);\n\n    const placeHoldersCount = newContents.length - currentcontents.length;\n    const placeHolders = fill(placeHoldersCount, undefined);\n\n    if (beginningMatches <= endMatches) {\n        currentcontents = currentcontents.concat(placeHolders);\n    } else {\n        currentcontents = placeHolders.concat(currentcontents);\n    }\n\n    for (let i = 0; i < newContents.length; i++) {\n        const $el = $newEls.eq(i);\n        const curr = currentcontents[i];\n        $el.removeAttr(opts.initialAttr);\n\n        const contents = elToContents($el.get(0));\n        if (curr === undefined) {\n            $el.attr({\n                [opts.addAttr]: true,\n                [opts.initialAttr]: isInitial || null\n            });\n            $el.removeAttr(opts.changeAttr);\n        } else if (curr !== contents) {\n            $el.attr({\n                [opts.changeAttr]: true,\n                [opts.initialAttr]: isInitial || null\n            });\n            $el.removeAttr(opts.addAttr);\n        } else {\n            $el.removeAttr(`${opts.addAttr} ${opts.changeAttr}`);\n        }\n    }\n\n    return $newEls;\n}\n\nexport function addContentAndAnimate($el, newValue, isInitial, options) {\n    const opts = $.extend({}, defaults, options);\n    const current = $el.html().trim();\n\n    $el.removeAttr(`${opts.changeAttr} ${opts.initialAttr}`);\n    if (current === `${newValue}`.trim()) {\n        return $el;\n    }\n\n    $el.html(newValue);\n    setTimeout(function () {\n        $el.attr({\n            [opts.changeAttr]: true,\n            [opts.initialAttr]: isInitial || null //jquery removes if set to null\n        });\n    }, 0); //need this to trigger animation\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils/animation.js","import { uniqueId } from 'lodash';\n\nconst CURRENT_INDEX_KEY = 'current-index';\nconst CURRENT_INDEX_ATTR = `data-${CURRENT_INDEX_KEY}`;\n\nexport function getKnownDataForEl($el) {\n    const closestKnownDataEl = $el.closest(`[${CURRENT_INDEX_ATTR}]`);\n    let knownData = {};\n    if (closestKnownDataEl.length) {\n        knownData = closestKnownDataEl.data(CURRENT_INDEX_KEY);\n    }\n    return knownData;\n}\nexport function updateKnownDataForEl($el, data) {\n    $el.attr(CURRENT_INDEX_ATTR, JSON.stringify(data));\n}\nexport function removeKnownData($el) {\n    $el.removeAttr(CURRENT_INDEX_ATTR);\n}\n\nexport function getTemplateTags(template) {\n    template = template.replace(/&lt;/g, '<').replace(/&gt;/g, '>');\n    const templateTagsUsed = template.match(/<%[=-]?([\\s\\S]+?)%>/g);\n    return templateTagsUsed || [];\n}\nexport function isTemplated(template) {\n    return getTemplateTags(template).length > 0;\n}\n\n\nexport function findMissingReferences(template, knownDataKeys) {\n    function isKnownTag(tag, knownTags) {\n        const match = knownDataKeys.find((key)=> {\n            const regex = new RegExp('\\\\b' + key + '\\\\b');\n            return regex.test(tag);\n        });\n        return match;\n    }\n\n    template = template.replace(/&lt;/g, '<').replace(/&gt;/g, '>');\n    const missingReferences = {};\n    const templateTagsUsed = getTemplateTags(template);\n    if (templateTagsUsed) {\n        templateTagsUsed.forEach(function (tag) {\n            if (tag.match(/\\w+/) && !isKnownTag(tag, knownDataKeys)) {\n                let refKey = missingReferences[tag];\n                if (!refKey) {\n                    refKey = uniqueId('no-ref');\n                    missingReferences[tag] = refKey;\n                }\n            }\n        });\n    }\n    return missingReferences;\n}\n\nfunction refToMarkup(refKey) {\n    return '<!--' + refKey + '-->';\n}\n\nexport function stubMissingReferences(template, missingReferences) {\n    template = template.replace(/&lt;/g, '<').replace(/&gt;/g, '>');\n\n    Object.keys(missingReferences).forEach((tag)=> {\n        const refId = missingReferences[tag];\n        const r = new RegExp(tag, 'g');\n        template = template.replace(r, refToMarkup(refId));\n    });\n    return template;\n}\n\nexport function addBackMissingReferences(template, missingReferences) {\n    Object.keys(missingReferences).forEach((originalTemplateVal)=> {\n        const commentRef = missingReferences[originalTemplateVal];\n        const r = new RegExp(refToMarkup(commentRef), 'g');\n        template = template.replace(r, originalTemplateVal);\n    });\n\n    return template;\n}\n\n\nconst elTemplateMap = new WeakMap();\nexport function getOriginalContents($el, resolver) {\n    const el = $el.get(0);\n    let originalHTML = elTemplateMap.get(el);\n    if (!originalHTML && resolver) {\n        originalHTML = resolver($el).replace(/&lt;/g, '<').replace(/&gt;/g, '>');\n        elTemplateMap.set(el, originalHTML);\n    }\n    return originalHTML;\n}\nexport function clearOriginalContents($el) {\n    const el = $el.get(0);\n    elTemplateMap.delete(el);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attribute-manager/attr-template-utils.js","import { binderAttr, events } from '../../config';\nimport BaseView from './default-node';\n\nexport default BaseView.extend({\n    propertyHandlers: [],\n\n    uiChangeEvent: 'change',\n    getUIValue: function () {\n        return this.$el.val();\n    },\n\n    removeEvents: function () {\n        this.$el.off(this.uiChangeEvent);\n    },\n\n    initialize: function () {\n        const me = this;\n        const propName = this.$el.data(binderAttr);\n\n        if (propName) {\n            this.$el.off(this.uiChangeEvent).on(this.uiChangeEvent, function () {\n                const val = me.getUIValue();\n                const payload = [{ name: propName, value: val }];\n                me.$el.trigger(events.trigger, { data: payload, source: 'bind' });\n            });\n        }\n        BaseView.prototype.initialize.apply(this, arguments);\n    }\n}, { selector: 'input, select, textarea' });\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/nodes/default-input-node.js","'use strict';\n\nvar BaseView = require('../../utils/base-view');\n\nmodule.exports = BaseView.extend({\n    propertyHandlers: [\n\n    ],\n\n    initialize: function () {\n    }\n}, { selector: '*' });\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/nodes/default-node.js","const IN_OF_REGEX = /\\((.*)\\) (?:in|of)\\s+(.*)/;\nconst KEY_VALUE_REGEX = /(.*),(.*)/;\n\n/**\n * @param {string} attrVal \n * @return {string}\n */\nexport function extractVariableName(attrVal) {\n    const inMatch = attrVal.trim().match(IN_OF_REGEX);\n    const varName = inMatch ? inMatch[2] : attrVal;\n    return varName.trim();\n}\n\n/**\n * @param {string} attrVal \n * @return {string}\n */\nexport function parseKeyAlias(attrVal) {\n    const inMatch = attrVal.match(IN_OF_REGEX);\n    if (!inMatch) {\n        return undefined;\n    }\n    const itMatch = inMatch[1].match(KEY_VALUE_REGEX);\n    const alias = itMatch ? itMatch[1].trim() : undefined;\n    return alias;\n}\n\n/**\n * @param {string} attrVal \n * @return {string}\n */\nexport function parseValueAlias(attrVal) {\n    const inMatch = attrVal.match(IN_OF_REGEX);\n    if (!inMatch) {\n        return undefined;\n    }\n    const itMatch = inMatch[1].match(KEY_VALUE_REGEX);\n    const alias = itMatch ? itMatch[2] : inMatch[1];\n    return alias.trim();\n}\n\n\n//Public exports\n\nexport function aliasesFromTopics(topics, value) {\n    const relevantTopic = topics[0]; //doesn't support multiple topics\n\n    const defaultKey = $.isPlainObject(value) ? 'key' : 'index';\n    const keyAlias = relevantTopic.keyAlias || defaultKey;\n    const valueAlias = relevantTopic.valueAlias || 'value';\n\n    return { keyAlias: keyAlias, valueAlias: valueAlias };\n}\nexport function parseTopics(topics) {\n    const attrVal = topics[0].name; //doesn't support multiple topics\n    return [{\n        name: extractVariableName(attrVal),\n        keyAlias: parseKeyAlias(attrVal),\n        valueAlias: parseValueAlias(attrVal),\n    }];\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attribute-manager/attributes/loop-attrs/loop-attr-utils.js","import { isFunction } from 'lodash';\n\n/**\n * @param {any} val \n * @returns {Promise}\n */\nexport function makePromise(val) {\n    //Can be replaced with Promise.resolve when we drop IE11;\n    // if (isFunction(val)) {\n    //     return Promise.resolve(val());\n    // }\n    // return Promise.resolve(val);\n    if (val && val.then) {\n        return val;\n    }\n    const $def = $.Deferred();\n    if (isFunction(val)) {\n        try {\n            const toReturn = val();\n            if (toReturn && toReturn.then) {\n                return toReturn.then((r)=> $def.resolve(r), ((e)=> $def.reject(e)));\n            }\n            $def.resolve(toReturn);\n        } catch (e) {\n            $def.reject(e);\n        }\n    } else {\n        $def.resolve(val);\n    }\n    return $def.promise();\n}\n\n/**\n * \n * @param {function(*)} fn \n * @returns {function(...any): Promise}\n */\nexport function promisify(fn) {\n    if (!isFunction(fn)) {\n        throw new Error(`Promisify requires a function, received ${typeof fn}`);\n    }\n    /**\n     * @param {...*} args \n     * @returns {Promise}\n     */\n    return function promisifiedFunction(args) {\n        const $def = $.Deferred();\n        try {\n            const toReturn = fn.apply(fn, arguments);\n            if (toReturn && toReturn.then) {\n                return toReturn.then((r)=> {\n                    return $def.resolve(r);\n                }, (e)=> {\n                    return $def.reject(e);\n                });\n            } else {\n                $def.resolve(toReturn);\n            }\n        } catch (e) {\n            $def.reject(e);\n        }\n        return $def.promise();\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils/general/promise-utils.js","export function makeConsensusService(consensisAPIResponse) {\n    return new window.F.service.Consensus({\n        name: consensisAPIResponse.stage,\n        consensusGroup: consensisAPIResponse.name,\n        worldId: consensisAPIResponse.worldId,\n    });\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/epicenter-route-handlers/world-route-handler/consensus-route-handler/consensus-utils.js","var interpolationRegex = /<(.*?)>/g;\n/**\n *  \n * @param {String} topic topic to extract dependencies from\n * @return {String[]} dependencies\n */\nexport function extractDependencies(topic) {\n    var deps = (topic.match(interpolationRegex) || []).map((val)=> {\n        return val.substring(1, val.length - 1); \n    });\n    return deps;\n}\n\n/**\n * @param {String} topic topic with dependencies\n * @param {Object} data object with values of dependencies\n * @return {String} interpolated string\n */\nexport function interpolateWithValues(topic, data) {\n    var interpolatedTopic = topic.replace(interpolationRegex, (match, dependency)=> {\n        var val = data[dependency];\n        var toReplace = Array.isArray(val) ? val[val.length - 1] : val;\n        return toReplace;\n    });\n    return interpolatedTopic;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/channel-manager-enhancements/interpolatable/interpolatable-utils.js","import domManager from './dom/dom-manager';\n\nimport ChannelManager from 'channels/configured-channel-manager';\nimport config from 'config';\n\nimport * as utils from './utils';\n\nconst Flow = {\n    dom: domManager,\n    utils: utils,\n    initialize: function (config) {\n        const model = $('body').data('f-model');\n        const defaults = {\n            channel: {\n                //FIXME: Defaults can't be here..\n                defaults: {\n                    run: {\n                        model: model,\n                    }\n                },\n            },\n            dom: {\n                root: 'body',\n                autoBind: true\n            }\n        };\n\n        const options = $.extend(true, {}, defaults, config);\n   \n        if (config && config.channel && (config.channel instanceof ChannelManager)) {\n            this.channel = config.channel;\n        } else {\n            this.channel = new ChannelManager(options.channel);\n        }\n\n        const prom = domManager.initialize($.extend(true, {\n            channel: this.channel\n        }, options.dom));\n        \n        this.channel.subscribe('operations:reset', function () {\n            domManager.unbindAll();\n            domManager.bindAll();\n        });\n\n        return prom;\n    }\n};\nFlow.ChannelManager = ChannelManager;\nFlow.constants = config;\n//set by grunt\nif (RELEASE_VERSION) Flow.version = RELEASE_VERSION; //eslint-disable-line no-undef\nexport default Flow;\n\n\n\n// WEBPACK FOOTER //\n// ./src/flow.js","import { getConvertersForEl, getChannelForAttribute, getChannelConfigForElement, parseTopicsFromAttributeValue } from './dom-manager-utils/dom-parse-helpers';\n\nimport { addPrefixToTopics, addDefaultPrefix } from './dom-manager-utils/dom-channel-prefix-helpers';\nimport { toImplicitType } from 'utils/parse-utils';\n\nimport { pick, isEqual } from 'lodash';\n\nimport { prefix, errorAttr, events, animation } from '../config';\n\nimport converterManager from 'converter-manager';\nimport nodeManager from './nodes/node-manager';\nimport attrManager from './attribute-manager';\nimport autoUpdatePlugin from './plugins/auto-update-bindings';\n\nexport default (function () {\n    //Jquery selector to return everything which has a f- property set\n    $.expr.pseudos[prefix] = function (el) {\n        if (!el || !el.attributes) {\n            return false;\n        }\n        for (let i = 0; i < el.attributes.length; i++) {\n            const attr = el.attributes[i].nodeName;\n            if (attr.indexOf('data-' + prefix) === 0) {\n                return true;\n            }\n        }\n        return false;\n    };\n\n    /**\n     * @param {JQuery<HTMLElement>} root\n     * @return {JQuery<HTMLElement>}\n     */ \n    function getMatchingElements(root) {\n        const $root = $(root);\n        let matchedElements = $root.find(':' + prefix);\n        if ($root.is(':' + prefix)) {\n            matchedElements = matchedElements.add($root);\n        }\n        return matchedElements;\n    }\n\n    /**\n     * @param {JQuery<HTMLElement> | HTMLElement} element\n     * @param {*} [context]\n     * @return {HTMLElement}\n     */ \n    function getElementOrError(element, context) {\n        const el = (element instanceof $) ? element.get(0) : element;\n        if (!el || !el.nodeName) {\n            console.error(context, 'Expected to get DOM Element, got ', element);\n            throw new Error(context + ': Expected to get DOM Element, got' + (typeof element));\n        }\n        return el;\n    }\n\n    //Unbind utils\n    function removeAllSubscriptions(subscriptions, channel) {\n        [].concat(subscriptions).forEach(function (subs) {\n            channel.unsubscribe(subs);\n        });\n    }\n    function unbindAllAttributes(domEl) {\n        const $el = $(domEl);\n        $(domEl.attributes).each(function (index, nodeMap) {\n            let attr = nodeMap.nodeName;\n            const wantedPrefix = 'data-f-';\n            if (attr.indexOf(wantedPrefix) === 0) {\n                attr = attr.replace(wantedPrefix, '');\n                const handler = attrManager.getHandler(attr, $el);\n                if (handler.unbind) {\n                    handler.unbind(attr, $el);\n                }\n            }\n        });\n    }\n    function unbindAllNodeHandlers(domEl) {\n        const $el = $(domEl);\n        //FIXME: have to readd events to be able to remove them. Ugly\n        const Handler = nodeManager.getHandler($el);\n        const h = new Handler.handle({\n            el: domEl\n        });\n        if (h.removeEvents) {\n            h.removeEvents();\n        }\n    }\n\n    function triggerError($el, e) {\n        let msg = e.message || e;\n        if ($.isPlainObject(msg)) {\n            msg = JSON.stringify(msg);\n        }\n        $el.attr(errorAttr, msg).trigger(events.error, e);\n    }\n    const publicAPI = {\n\n        nodes: nodeManager,\n        attributes: attrManager,\n        converters: converterManager,\n            \n        matchedElements: new Map(),\n\n        /**\n         * Unbind the element; unsubscribe from all updates on the relevant channels.\n         *\n         * @param {JQuery<HTMLElement> | HTMLElement} element The element to remove from the data binding.\n         * @param {Channel} channel (Optional) The channel from which to unsubscribe. Defaults to the [variables channel](../channels/variables-channel/).\n         * @returns {void}\n         */\n        unbindElement: function (element, channel) {\n            if (!channel) {\n                channel = this.options.channel;\n            }\n            const domEl = getElementOrError(element);\n            const $el = $(element);\n            const existingData = this.matchedElements.get(domEl);\n            if (!$el.is(':' + prefix) || !existingData) {\n                return;\n            }\n            this.matchedElements.delete(element);\n            const subscriptions = Object.keys(existingData).reduce((accum, a)=> {\n                const subsid = existingData[a].subscriptionId;\n                if (subsid) accum.push(subsid);\n                return accum;\n            }, []);\n\n            unbindAllNodeHandlers(domEl);\n            unbindAllAttributes(domEl);\n            removeAllSubscriptions(subscriptions, channel);\n            \n            const animAttrs = Object.keys(animation).join(' ');\n            $el.removeAttr(animAttrs);\n\n            Object.keys($el.data()).forEach(function (key) {\n                if (key.indexOf('f-') === 0 || key.match(/^f[A-Z]/)) {\n                    $el.removeData(key);\n                }\n            });\n        },\n\n        /**\n         * Bind the element: subscribe from updates on the relevant channels.\n         *\n         * @param {HTMLElement | JQuery<HTMLElement>} element The element to add to the data binding.\n         * @param {Channel} channel (Optional) The channel to subscribe to. Defaults to the [run channel](../channels/run-channel/).\n         * @returns {void}\n         */\n        bindElement: function (element, channel) {\n            if (!channel) {\n                channel = this.options.channel;\n            }\n            // this.unbindElement(element); //unbind actually removes the data,and jquery doesn't refetch when .data() is called..\n            const domEl = getElementOrError(element);\n            const $el = $(domEl);\n            if (!$el.is(`:${prefix}`)) {\n                return;\n            }\n\n            //Send to node manager to handle ui changes\n            const Handler = nodeManager.getHandler($el);\n            new Handler.handle({\n                el: domEl\n            });\n\n            const filterPrefix = `data-${prefix}-`;\n            const attrList = {};\n            $(domEl.attributes).each(function (index, nodeMap) {\n                let attr = nodeMap.nodeName;\n                if (attr.indexOf(filterPrefix) !== 0) {\n                    return;\n                } \n                attr = attr.replace(filterPrefix, '');\n\n                const attrVal = nodeMap.value;\n                let topics = parseTopicsFromAttributeValue(attrVal);\n                \n                const handler = attrManager.getHandler(attr, $el);\n                if (handler && handler.init) {\n                    handler.init(attr, topics, $el);\n                }\n                if (topics.length && handler && handler.parse) {\n                    topics = [].concat(handler.parse(topics));\n                }\n                \n                const channelPrefix = getChannelForAttribute($el, attr);\n                topics = addPrefixToTopics(topics, channelPrefix);\n\n                const converters = getConvertersForEl($el, attr);\n                attrList[attr] = {\n                    channelPrefix: channelPrefix,\n                    topics: topics,\n                    converters: converters, //Store once instead of calculating on demand. Avoids having to parse through dom every time\n                };\n            });\n            //Need this to be set before subscribing or callback maybe called before it's set\n            this.matchedElements.set(domEl, attrList);\n            \n            const channelConfig = getChannelConfigForElement(domEl);\n            const attrsWithSubscriptions = Object.keys(attrList).reduce((accum, name)=> {\n                const attr = attrList[name];\n                const { topics, channelPrefix } = attr;\n                if (!topics.length) {\n                    accum[name] = attr;\n                    return accum;\n                }\n\n                const subsOptions = $.extend({ \n                    batch: true,\n                    onError: (e)=> {\n                        console.error('DomManager: Subscription error', domEl, e);\n                        triggerError($el, e);\n                    }\n                }, channelConfig);\n                const subscribableTopics = topics.map((t)=> t.name);\n                const subsid = channel.subscribe(subscribableTopics, (data, meta)=> {\n                    if (meta && isEqual(data, meta.previousData)) {\n                        return;\n                    }\n                    const toConvert = {};\n                    if (subscribableTopics.length === 1) { //If I'm only interested in 1 thing pass in value directly, else make a map;\n                        toConvert[name] = data[subscribableTopics[0]];\n                    } else {\n                        const dataForAttr = pick(data, subscribableTopics) || {};\n                        toConvert[name] = Object.keys(dataForAttr).reduce((accum, key)=> {\n                            //If this was through a auto-prefixed channel attr return what was bound\n                            const toReplace = new RegExp(`^${channelPrefix}:`);\n                            const k = channelPrefix ? key.replace(toReplace, '') : key;\n                            accum[k] = dataForAttr[key];\n                            return accum;\n                        }, {});\n                    }\n                    $el.removeAttr(errorAttr).trigger(events.convert, toConvert);\n                }, subsOptions);\n\n                accum[name] = Object.assign({}, attr, { subscriptionId: subsid });\n                return accum;\n            }, {});\n\n            this.matchedElements.set(domEl, attrsWithSubscriptions);\n        },\n\n        /**\n         * Bind all provided elements.\n         *\n         * @param  {JQuery<HTMLElement> | HTMLElement[]} [elementsToBind] (Optional) If not provided, binds all matching elements within default root provided at initialization.\n         * @returns {void}\n         */\n        bindAll: function (elementsToBind) {\n            if (!elementsToBind) {\n                elementsToBind = getMatchingElements(this.options.root);\n            } else if (!Array.isArray(elementsToBind)) {\n                elementsToBind = getMatchingElements(elementsToBind);\n            }\n\n            //parse through dom and find everything with matching attributes\n            $.each(elementsToBind, (index, element)=> {\n                this.bindElement(element, this.options.channel);\n            });\n        },\n        /**\n         * Unbind provided elements.\n         *\n         * @param  {JQuery<HTMLElement> | HTMLElement[]} [elementsToUnbind] (Optional) If not provided, unbinds everything.\n         * @returns {void}\n         */\n        unbindAll: function (elementsToUnbind) {\n            const me = this;\n            if (!elementsToUnbind) {\n                elementsToUnbind = [];\n                this.matchedElements.forEach((val, key)=> {\n                    elementsToUnbind.push(key);\n                });\n            } else if (!Array.isArray(elementsToUnbind)) {\n                elementsToUnbind = getMatchingElements(elementsToUnbind);\n            }\n            $.each(elementsToUnbind, function (index, element) {\n                me.unbindElement(element, me.options.channel);\n            });\n        },\n\n        plugins: {},\n\n        /**\n         * Initialize the DOM Manager to work with a particular HTML element and all elements within that root. Data bindings between individual HTML elements and the model variables specified in the attributes will happen via the channel.\n         *\n         * @param {Object} options (Optional) Overrides for the default options.\n         * @param {string} options.root The root HTML element being managed by this instance of the DOM Manager. Defaults to `body`.\n         * @param {Object} options.channel The channel to communicate with. Defaults to the Channel Manager from [Epicenter.js](../../../api_adapters/).\n         * @param {boolean} options.autoBind If `true` (default), any variables added to the DOM after `Flow.initialize()` has been called will be automatically parsed, and subscriptions added to channels. Note, this does not work in IE versions < 11.\n         * @returns {Promise}\n         */\n        initialize: function (options) {\n            const defaults = {\n                /**\n                 * Root of the element for flow.js to manage from.\n                 * @type {string} jQuery selector\n                 */\n                root: 'body',\n                channel: null,\n\n                /**\n                 * Any variables added to the DOM after `Flow.initialize()` has been called will be automatically parsed, and subscriptions added to channels. Note, this does not work in IE versions < 11.\n                 * @type {boolean}\n                 */\n                autoBind: true\n            };\n            $.extend(defaults, options);\n\n            const channel = defaults.channel;\n\n            this.options = defaults;\n\n            const me = this;\n            const $root = $(defaults.root);\n\n            function attachUIListeners($root) {\n                function parseValue(value, converters) {\n                    if (Array.isArray(value)) {\n                        const parsed = value.map(function (val) {\n                            return toImplicitType(val);\n                        });\n                        return converterManager.parse(parsed, converters);\n                    }\n                    return converterManager.parse(toImplicitType(value), converters);\n                }\n\n                $root.off(events.trigger).on(events.trigger, function (evt, params) {\n                    const elMeta = me.matchedElements.get(evt.target);\n                    const { data, source, options } = params;\n                    if (!elMeta || !data) {\n                        return;\n                    }\n                    const sourceMeta = elMeta[source] || {};\n                    const { channelPrefix, converters } = sourceMeta;\n                    const $el = $(evt.target);\n\n                    const parsed = ([].concat(data)).map(function (action) {\n                        const { name, value } = action;\n                        const parsedValue = parseValue(value, converters);\n                        const actualName = name.split('|')[0].trim(); //FIXME: this shouldn't know about the pipe syntax\n                        const prefixedName = addDefaultPrefix(actualName, source, channelPrefix);\n                        return { name: prefixedName, value: parsedValue };\n                    }, []);\n\n                    channel.publish(parsed, options).then((result)=> {\n                        if (!result || !result.length) {\n                            return;\n                        }\n                        const last = result[result.length - 1];\n                        $el.trigger(events.convert, { [source]: last.value });\n                    }, (e)=> {\n                        triggerError($el, e);\n                    });\n                });\n            }\n\n            function attachConversionListner($root) {\n                // data = {proptoupdate: value}\n                $root.off(events.convert).on(events.convert, function (evt, data) {\n                    const $el = $(evt.target);\n\n                    const elMeta = me.matchedElements.get(evt.target);\n                    if (!elMeta) {\n                        return;\n                    }\n\n                    Object.keys(data).forEach((prop)=> {\n                        const val = data[prop];\n                        const { converters, topics } = elMeta[prop];\n                        const convertedValue = converterManager.convert(val, converters);\n\n                        const handler = attrManager.getHandler(prop, $el);\n                        handler.handle(convertedValue, prop, $el, topics);\n                    });\n                });\n            }\n            \n            const deferred = $.Deferred();\n            $(function () {\n                me.bindAll();\n            \n                attachUIListeners($root);\n                attachConversionListner($root);\n\n                me.plugins.autoBind = autoUpdatePlugin($root.get(0), me, me.options.autoBind);\n                \n                deferred.resolve($root);\n                $root.trigger('f.domready');\n            });\n\n            return deferred.promise();\n        }\n    };\n\n    return $.extend(this, publicAPI);\n}());\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/dom-manager.js","import { getConvertersForEl } from './parse-converters';\nimport { getChannelForAttribute, getChannelConfigForElement } from './parse-channel';\nimport { parseTopicsFromAttributeValue } from './parse-topics';\n\nexport { \n    getConvertersForEl,\n    getChannelForAttribute,\n    getChannelConfigForElement,\n    parseTopicsFromAttributeValue,\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/dom-manager-utils/dom-parse-helpers/index.js","/**\n * @param {string} conv \n * @returns {string[]}\n */\nfunction convertersToArray(conv) {\n    if (!conv || !conv.trim()) return [];\n    return conv.split('|').map((v)=> v.trim());\n}\n\n/**\n * @param {JQuery<HTMLElement>} $el\n * @param {string} attribute \n * @returns {string[]}\n */\nfunction getConvertersFromAttr($el, attribute) {\n    const attrVal = $el.attr(`data-f-${attribute}`);\n    const withConv = convertersToArray(attrVal);\n    if (withConv.length > 1) {\n        return withConv.slice(1); //First item will be the topic\n    }\n    return [];\n}\nfunction getFConvertAttrVal($el, suffix) {\n    const baseAttr = 'data-f-convert';\n    const suffixAttr = suffix ? `-${suffix}` : '';\n    const conv = $el.attr(`${baseAttr}${suffixAttr}`); //.data shows value cached by jquery\n    return convertersToArray(conv);\n}\n\n/**\n * @param {JQuery<HTMLElement>} $el  \n * @param {string} attribute \n * @returns {string[]} converters\n */\nexport function getConvertersForEl($el, attribute) {\n    function getAllConverters($el, attribute) {\n        const convertersAsPipes = getConvertersFromAttr($el, attribute);\n        if (convertersAsPipes.length) {\n            return convertersAsPipes;\n        }\n\n        const whiteListedGenericAttributes = ['bind', 'foreach', 'repeat'];\n        const canUseFConvert = whiteListedGenericAttributes.indexOf(attribute) !== -1;\n        if (canUseFConvert) {\n            return getFConvertAttrVal($el, '');\n        }\n        return getFConvertAttrVal($el, attribute);\n    }\n   \n    const converters = getAllConverters($el, attribute);\n    const $parentEl = $el.parents('[data-f-convert]').eq(0);\n    const resolvedConverters = converters.reduce((accum, val)=> {\n        if (val === 'inherit') {\n            const parentConv = getConvertersForEl($parentEl, attribute);\n            accum = accum.concat(parentConv);\n        } else {\n            accum = accum.concat(val);\n        }\n        return accum;\n    }, []);\n\n    if (!resolvedConverters.length && $parentEl.length) {\n        return getConvertersForEl($parentEl, attribute);\n    }\n    return resolvedConverters;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/dom-manager-utils/dom-parse-helpers/parse-converters.js","/**\n * \n * @param {JQuery<HTMLElement>} $el  \n * @param {string} attr \n * @returns {string|undefined}\n */\nexport function getChannelForAttribute($el, attr) {\n    attr = attr.replace('data-f-', '');\n    let channel = $el.data('f-channel-' + attr);\n    if (channel === undefined) {\n        channel = $el.attr('data-f-channel'); //.data shows value cached by jquery\n    }\n    if (channel === undefined) {\n        const $parentEl = $el.closest('[data-f-channel]');\n        if ($parentEl) {\n            channel = $parentEl.attr('data-f-channel');\n        }\n    }\n    return channel;\n}\n\n/**\n * @param {HTMLElement} el\n * @return {object}\n */ \nexport function getChannelConfigForElement(el) {\n    //TODO: Should this look at parents too?\n    const attrs = el.attributes;\n    const config = {};\n    for (let i = 0; i < attrs.length; i++) {\n        const attrib = el.attributes[i];\n        if (attrib.specified && attrib.name.indexOf('data-f-channel-') === 0) {\n            const key = attrib.name.replace('data-f-channel-', '');\n            config[key] = attrib.value;\n        }\n    }\n    return config;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/dom-manager-utils/dom-parse-helpers/parse-channel.js","/**\n * @param {string} attrVal \n * @returns {NormalizedTopic[]} variables\n */\nexport function parseTopicsFromAttributeValue(attrVal) {\n    const commaRegex = /,(?![^[(]*[\\])])/; //split except on a[b,c] or a(v,c)\n    const topicsPart = attrVal.split('|')[0];\n    if (topicsPart.indexOf('<%') !== -1) { //Assume it's templated for later use\n        return [];\n    } \n    const split = topicsPart.split(commaRegex);\n    if (split.length > 1) {\n        return split.map((v)=> ({ name: v.trim() }));\n    } \n    return [{ name: topicsPart.trim() }];\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/dom-manager-utils/dom-parse-helpers/parse-topics.js","/**\n * \n * @param {NormalizedTopic[]} topics \n * @param {string} prefix \n * @returns {NormalizedTopic[]}\n */\nexport function addPrefixToTopics(topics, prefix) {\n    if (!prefix) {\n        return topics;\n    }\n    const mappedTopics = topics.map((topic)=> {\n        const currentName = topic.name;\n        const hasChannelDefined = currentName.indexOf(':') !== -1;\n        if (!hasChannelDefined) {\n            topic.name = `${prefix}:${currentName}`;\n        }\n        return topic;\n    });\n    return mappedTopics;\n}\n\nconst DEFAULT_OPERATIONS_PREFIX = 'operations:';\nconst DEFAULT_VARIABLES_PREFIX = 'variables:';\n\nexport function addDefaultPrefix(name, source, channelPrefix) {\n    const isUnprefixed = name.indexOf(':') === -1;\n\n    const defaultPrefix = source.indexOf('on-') === 0 ? DEFAULT_OPERATIONS_PREFIX : DEFAULT_VARIABLES_PREFIX;\n    const needsDefaultPrefix = defaultPrefix !== DEFAULT_VARIABLES_PREFIX;\n\n    if (isUnprefixed && needsDefaultPrefix) {\n        name = `${defaultPrefix}${name}`;\n    }\n    const hasDefaultPrefix = name.indexOf(defaultPrefix) === 0;\n    if ((isUnprefixed || hasDefaultPrefix) && channelPrefix) {\n        name = `${channelPrefix}:${name}`;\n    }\n    return name;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/dom-manager-utils/dom-channel-prefix-helpers/index.js","import { isFunction, isString, isRegExp, find, mapValues } from 'lodash';\nimport { splitNameArgs, toImplicitType } from '../utils/parse-utils';\n\nvar normalize = function (alias, converter, acceptList) {\n    var ret = [];\n    //nomalize('flip', fn)\n    if (isFunction(converter)) {\n        ret.push({\n            alias: alias,\n            convert: converter,\n            acceptList: acceptList\n        });\n    } else if ($.isPlainObject(converter) && converter.convert) {\n        converter.alias = alias;\n        converter.acceptList = acceptList;\n        ret.push(converter);\n    } else if ($.isPlainObject(alias)) {\n        //normalize({alias: 'flip', convert: function})\n        if (alias.convert) {\n            ret.push(alias);\n        } else {\n            // normalize({flip: fun})\n            $.each(alias, function (key, val) {\n                ret.push({\n                    alias: key,\n                    convert: val,\n                    acceptList: acceptList\n                });\n            });\n        }\n    }\n    return ret;\n};\n\nvar matchConverter = function (alias, converter) {\n    if (isString(converter.alias)) {\n        return alias === converter.alias;\n    } else if (isFunction(converter.alias)) {\n        return converter.alias(alias);\n    } else if (isRegExp(converter.alias)) {\n        return converter.alias.match(alias);\n    }\n    return false;\n};\n\nvar converterManager = {\n    private: {\n        matchConverter: matchConverter\n    },\n\n    list: [],\n    /**\n     * Add a new attribute converter to this instance of Flow.js.\n     *\n     * **Example**\n     *\n     *      Flow.dom.converters.register('max', function (value) {\n     *          return max(value);\n     *      }, true);\n     *\n     *      Flow.dom.converters.register({\n     *          alias: 'sig',\n     *          parse: $.noop,\n     *          convert: function (value) {\n     *              return value.firstName + ' ' + value.lastName + ', ' + value.jobTitle;\n     *      }, false);\n     *\n     *      <div>\n     *          The largest sales you had was <span data-f-bind=\"salesByYear | max | $#,###\"></span>.\n     *          The current sales manager is <span data-f-bind=\"salesMgr | sig\"></span>.\n     *      </div>\n     *\n     * @param  {string|function|RegExp} alias Formatter name.\n     * @param  {function|object} [converter] If a function, `converter` is called with the value. If an object, should include fields for `alias` (name), `parse` (function), and `convert` (function).\n     * @param {boolean} [acceptList] Determines if the converter is a 'list' converter or not. List converters take in arrays as inputs, others expect single values.\n     * @returns {void}\n     */\n    register: function (alias, converter, acceptList) {\n        var normalized = normalize(alias, converter, acceptList);\n        this.list = normalized.concat(this.list);\n    },\n\n    /**\n     * Replace an already registered converter with a new one of the same name.\n     *\n     * @param {string} alias Formatter name.\n     * @param {function|object} converter If a function, `converter` is called with the value. If an object, should include fields for `alias` (name), `parse` (function), and `convert` (function).\n     * @returns {void}\n     */\n    replace: function (alias, converter) {\n        var index;\n        this.list.forEach(function (currentConverter, i) {\n            if (matchConverter(alias, currentConverter)) {\n                index = i;\n                return false;\n            }\n        });\n        this.list.splice(index, 1, normalize(alias, converter)[0]);\n    },\n\n    getConverter: function (alias) {\n        var norm = splitNameArgs(alias);\n        norm.args = norm.args.map(toImplicitType);\n\n        var conv = find(this.list, function (converter) {\n            return matchConverter(norm.name, converter);\n        });\n        if (conv && norm.args) {\n            return $.extend({}, conv, { convert: Function.bind.apply(conv.convert, [null].concat(norm.args)) });\n        }\n        return conv;\n    },\n\n    /**\n     * Pipes the value sequentially through a list of provided converters.\n     *\n     * @param  {*} value Input for the converter to tag.\n     * @param  {string|string[]} list List of converters (maps to converter alias).\n     *\n     * @return {*} Converted value.\n     */\n    convert: function (value, list) {\n        if (!list || !list.length) {\n            return value;\n        }\n        list = ([].concat(list)).map((v)=> v.trim());\n\n        var currentValue = value;\n        var me = this;\n\n        var convertArray = function (converter, val, converterName) {\n            return val.map(function (v) {\n                return converter.convert(v, converterName);\n            });\n        };\n        var convert = function (converter, value, converterName) {\n            var converted;\n            if (Array.isArray(value) && converter.acceptList !== true) {\n                converted = convertArray(converter, value, converterName);\n            } else {\n                converted = converter.convert(value, converterName);\n            }\n            return converted;\n        };\n        var convertObject = function (converter, value, converterName) {\n            return mapValues(value, function (val) {\n                return convert(converter, val, converterName);\n            });\n        };\n        list.forEach(function (converterName) {\n            var converter = me.getConverter(converterName);\n            if (!converter) {\n                throw new Error('Could not find converter for ' + converterName);\n            }\n            if ($.isPlainObject(currentValue) && converter.acceptList !== true) {\n                currentValue = convertObject(converter, currentValue, converterName);\n            } else {\n                currentValue = convert(converter, currentValue, converterName);\n            }\n        });\n        return currentValue;\n    },\n\n    /**\n     * Counter-part to `convert()`. Translates converted values back to their original form.\n     *\n     * @param  {*} value Value to parse.\n     * @param  {string|string[]} list  List of parsers to run the value through. Outermost is invoked first.\n     * @return {*} Original value.\n     */\n    parse: function (value, list) {\n        if (!list || !list.length) {\n            return value;\n        }\n        list = [].concat(list).reverse().map((v)=> v.trim());\n\n        var currentValue = value;\n        var me = this;\n        list.forEach(function (converterName) {\n            var converter = me.getConverter(converterName);\n            if (!converter) {\n                throw new Error('parse: Could not find converter ' + converterName);\n            }\n            if (converter.parse) {\n                currentValue = converter.parse(currentValue, converterName);\n            }\n        });\n        return currentValue;\n    }\n};\n\n\n//Bootstrap\nvar defaultconverters = [\n    require('./converters/number-converter'),\n    require('./converters/string-converter'),\n    require('./converters/array-converter'),\n    require('./converters/general-util-converters'),\n    require('./converters/numberformat-converter'),\n    require('./converters/number-compare-converters'),\n    require('./converters/bool-conditional-converters'),\n    require('./converters/collection-converters')\n];\n\ndefaultconverters.reverse().forEach(function (converter) {\n    if (Array.isArray(converter)) {\n        converter.forEach(function (c) {\n            converterManager.register(c);\n        });\n    } else {\n        converterManager.register(converter);\n    }\n});\n\nexport default converterManager;\n\n\n\n// WEBPACK FOOTER //\n// ./src/converter-manager/index.js","/**\n * ## Number Converters\n *\n * Converters allow you to change how data is displayed. They let you display the value of any model variable in a different format than it is stored in the model -- converting the output value from one format to another.\n *\n * There are two ways to specify conversion or formatting for the display output of a particular model variable:\n *\n * * Use the `|` (pipe) character within the value of any `data-f-` attribute. Converters are chainable, so you can apply several in a row to a particular variable.\n * * Add the attribute `data-f-convert` to any element to convert all of the model variables referenced within that element's scope.\n *\n */\n\n'use strict';\nmodule.exports = {\n    alias: 'i',\n    /**\n     * Convert the model variable to an integer. Often used for chaining to another converter.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          Your car has driven\n     *          <span data-f-bind=\"Odometer | i | s0.0\"></span> miles.\n     *      </div>\n     *\n     * @param {string} value The model variable.\n     * @return {number}\n     */\n    convert: function (value) {\n        return parseFloat(value);\n    }\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/converter-manager/converters/number-converter.js","/**\n * ## String Converters\n *\n * Converters allow you to change how data is displayed. They let you display the value of any model variable in a different format than it is stored in the model -- converting the output value from one format to another.\n *\n * There are two ways to specify conversion or formatting for the display output of a particular model variable:\n *\n * * Use the `|` (pipe) character within the value of any `data-f-` attribute. Converters are chainable, so you can apply several in a row to a particular variable.\n * * Add the attribute `data-f-convert` to any element to convert all of the model variables referenced within that element's scope.\n *\n * For model variables that are strings (or that have been converted to strings), there are several special string formats you can apply.\n */\n\n'use strict';\nmodule.exports = {\n\n    /**\n     * Convert the model variable to a string. Often used for chaining to another converter.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          This year you are in charge of sales for\n     *          <span data-f-bind=\"salesMgr.region | s | upperCase\"></span>.\n     *      </div>\n     *\n     * @param {Array} val The model variable.\n     * @returns {string} converted string\n     */\n    s: function (val) {\n        return val + '';\n    },\n\n    /**\n     * Convert the model variable to UPPER CASE.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          This year you are in charge of sales for\n     *          <span data-f-bind=\"salesMgr.region | s | upperCase\"></span>.\n     *      </div>\n     *\n     * @param {Array} val The model variable.\n     * @returns {string} converted string\n     */\n    upperCase: function (val) {\n        return (val + '').toUpperCase();\n    },\n\n    /**\n     * Convert the model variable to lower case.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          Enter your user name:\n     *          <input data-f-bind=\"userName | lowerCase\"></input>.\n     *      </div>\n     *\n     * @param {Array} val The model variable.\n     * @returns {string} converted string\n     */\n    lowerCase: function (val) {\n        return (val + '').toLowerCase();\n    },\n\n    /**\n     * Convert the model variable to Title Case.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          Congratulations on your promotion!\n     *          Your new title is: <span data-f-bind=\"currentRole | titleCase\"></span>.\n     *      </div>\n     *\n     * @param {string} val The model variable.\n     * @returns {string} converted string\n     */\n    titleCase: function (val) {\n        val = val + '';\n        return val.replace(/\\w\\S*/g, function (txt) {\n            return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();\n        });\n    },\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/converter-manager/converters/string-converter.js","/**\n * ## Array Converters\n *\n * Converters allow you to change how data is displayed. They let you display the value of any model variable in a different format than it is stored in the model -- converting the output value from one format to another.\n *\n * There are two ways to specify conversion or formatting for the display output of a particular model variable:\n *\n * * Use the `|` (pipe) character within the value of any `data-f-` attribute. Converters are chainable, so you can apply several in a row to a particular variable.\n * * Add the attribute `data-f-convert` to any element to convert all of the model variables referenced within that element's scope.\n *\n * In general, if the model variable is an array, the converter is applied to each element of the array. There are a few built in array converters which, rather than converting all elements of an array, select particular elements from within the array or otherwise treat array variables specially.\n *\n */\n\nconst _ = require('lodash');\n\nfunction parseLimitArgs(starting, limit, val) {\n    let toRet = {};\n    if (arguments.length === 3) { //eslint-disable-line\n        toRet = {\n            input: limit,\n            limit: starting\n        };\n    } else if (arguments.length === 2) {\n        toRet = {\n            input: starting\n        };\n    } else {\n        console.error('Too many arguments passed to last', arguments);\n        throw new Error('Too many arguments passed to last');\n    }\n\n    toRet.input = [].concat(toRet.input);\n    return toRet;\n}\n\nconst list = {\n    /**\n     * Convert the input into an array. \n     *\n     * @param {any[]} val The array model variable.\n     * @returns {any[]}\n     */\n    list: (val)=> [].concat(val),\n\n    /**\n     * Reverse the array.\n     *\n     * **Example**\n     *\n     *      <p>Show the history of our sales, starting with the last (most recent):</p>\n     *      <ul data-f-foreach=\"Sales | reverse\">\n     *          <li></li>\n     *      </ul>\n     *\n     * @param {any[]} val The array model variable.\n     * @returns {any[]} the reversed array\n     */\n    reverse: (val)=> ([].concat(val)).reverse(),\n\n    /**\n     * Select only the last element of the array.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          In the current year, we have <span data-f-bind=\"Sales | last\"></span> in sales.\n     *      </div>\n     *\n     * @param {number} n number of items to get\n     * @param {any[]} val The array model variable.\n     * @returns {any} last element of array\n     */\n    last: function (n, val) {\n        const parsed = parseLimitArgs.apply(null, arguments);\n        const stripped = parsed.input.slice(-(parsed.limit || 1));\n        if (stripped.length <= 1) {\n            return stripped[0];\n        }\n        return stripped;\n    },\n\n    /**\n     * Select only the first element of the array.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          Our initial investment was <span data-f-bind=\"Capital | first\"></span>.\n     *      </div>\n     *\n     * @param {number} n number of items to get\n     * @param {any[]} val The array model variable.\n     * @returns {any} first element of the array\n     */\n    first: function (n, val) {\n        const parsed = parseLimitArgs.apply(null, arguments);\n        const stripped = parsed.input.slice(0, (parsed.limit || 1));\n        if (stripped.length <= 1) {\n            return stripped[0];\n        }\n        return stripped;\n    },\n\n    /**\n     * Select only the previous (second to last) element of the array.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          Last year we had <span data-f-bind=\"Sales | previous\"></span> in sales.\n     *      </div>\n     *\n     * @param {any[]} val The array model variable.\n     * @returns {any} the previous (second to last) element of the array.\n     */\n    previous: (val)=> {\n        val = [].concat(val);\n        return (val.length <= 1) ? val[0] : val[val.length - 2];\n    },\n\n    /**\n     * Returns length of array\n     *\n     * **Example**\n     * Total Items: <h6 data-f-bind=\"items | size\"></h6>\n     * \n     * @param  {any[]} src array\n     * @return {number}     length of array\n     */\n    size: (src)=> [].concat(src).length,\n\n    /**\n     * Select every nth item from array\n     *\n     * **Example**\n     * <!-- select every 10th item starting from itself\n     * <ul data-f-foreach=\"Time | pickEvery(10)\"><li></li></ul>\n     * <!-- select every 10th item starting from the fifth\n     * <ul data-f-foreach=\"Time | pickEvery(10, 5)\"><li></li></ul>\n     * \n     * @param  {number} n          nth item to select\n     * @param  {number} [startIndex] index to start from\n     * @param  {any[]} [val]        source array\n     * @return {any[]}            shortened array\n     */\n    pickEvery: function (n, startIndex, val) {\n        if (arguments.length === 3) { //eslint-disable-line\n            //last item is match string\n            val = startIndex;\n            startIndex = n - 1;\n        }\n        val = [].concat(val);\n        val = val.slice(startIndex);\n        return val.filter((item, index)=> {\n            return (index % n) === 0;\n        });\n    },\n};\n\nconst mapped = Object.keys(list).map(function (alias) {\n    const fn = list[alias];\n    const newfn = function () {\n        const args = _.toArray(arguments);\n        const indexOfActualValue = args.length - 2; //last item is the matchstring\n        const val = args[indexOfActualValue];\n        if ($.isPlainObject(val)) {\n            return Object.keys(val).reduce((accum, key)=> {\n                const arr = val[key];\n                const newArgs = args.slice();\n                newArgs[indexOfActualValue] = arr;\n                accum[key] = fn.apply(fn, newArgs);\n                return accum;\n            }, {});\n        }\n        return fn.apply(fn, arguments);\n    };\n    return {\n        alias: alias,\n        acceptList: true,\n        convert: newfn,\n    };\n});\nmodule.exports = mapped;\n\n\n\n// WEBPACK FOOTER //\n// ./src/converter-manager/converters/array-converter.js","function parseArgs(toCompare, trueVal, falseVal, valueToCompare, matchString) {\n    const toReturn = { trueVal: true, falseVal: false };\n    switch (arguments.length) {\n        case 5: //eslint-disable-line\n            return $.extend(toReturn, { trueVal: trueVal, falseVal: falseVal, input: valueToCompare });\n        case 4: //eslint-disable-line\n            return $.extend(toReturn, { trueVal: trueVal, falseVal: falseVal, input: falseVal }); \n        case 3: //eslint-disable-line\n            return $.extend(toReturn, { input: trueVal, falseVal: trueVal }); \n        default:\n            return toReturn;\n    }\n}\n\nmodule.exports = [\n    {\n        alias: 'is',\n        acceptList: false,\n        convert: function (toCompare) {\n            const args = parseArgs.apply(null, arguments);\n            return args.input === toCompare ? args.trueVal : args.falseVal;\n        }\n    }\n];\n\n\n\n// WEBPACK FOOTER //\n// ./src/converter-manager/converters/general-util-converters.js","/**\n * ## Number Format Converters\n *\n * Converters allow you to change how data is displayed. They let you display the value of any model variable in a different format than it is stored in the model -- converting the output value from one format to another.\n *\n * There are two ways to specify conversion or formatting for the display output of a particular model variable:\n *\n * * Use the `|` (pipe) character within the value of any `data-f-` attribute. Converters are chainable, so you can apply several in a row to a particular variable.\n * * Add the attribute `data-f-convert` to any element to convert all of the model variables referenced within that element's scope.\n *\n * For model variables that are numbers (or that have been [converted to numbers](../number-converter/)), there are several special number formats you can apply.\n *\n * #### Currency Number Format\n *\n * After the `|` (pipe) character, use `$` (dollar sign), `0`, and `.` (decimal point) in your converter to describe how currency should appear. The specifications follow the Excel currency formatting conventions.\n *\n * **Example**\n *\n *      <!-- convert to dollars (include cents) -->\n *      <input type=\"text\" data-f-bind=\"price[car]\" data-f-convert=\"$0.00\" />\n *      <input type=\"text\" data-f-bind=\"price[car] | $0.00\" />\n *\n *      <!-- convert to dollars (truncate cents) -->\n *      <input type=\"text\" data-f-bind=\"price[car]\" data-f-convert=\"$0.\" />\n *      <input type=\"text\" data-f-bind=\"price[car] | $0.\" />\n *\n *\n * #### Specific Digits Number Format\n *\n * After the `|` (pipe) character, use `#` (pound) and `,` (comma) in your converter to describe how the number should appear. The specifications follow the Excel number formatting conventions.\n *\n * **Example**\n *\n *      <!-- convert to thousands -->\n *      <input type=\"text\" data-f-bind=\"sales[car]\" data-f-convert=\"#,###\" />\n *      <input type=\"text\" data-f-bind=\"sales[car] | #,###\" />\n *\n *\n * #### Percentage Number Format\n *\n * After the `|` (pipe) character, use `%` (percent) and `0` in your converter to display the number as a percent.\n *\n * **Example**\n *\n *      <!-- convert to percentage -->\n *      <input type=\"text\" data-f-bind=\"profitMargin[car]\" data-f-convert=\"0%\" />\n *      <input type=\"text\" data-f-bind=\"profitMargin[car] | 0%\" />\n *\n *\n * #### Short Number Format\n *\n * After the `|` (pipe) character, use `s` and `0` in your converter to describe how the number should appear.\n *\n * The `0`s describe the significant digits.\n *\n * The `s` describes the \"short format,\" which uses 'K' for thousands, 'M' for millions, 'B' for billions. For example, `2468` converted with `s0.0` displays as `2.5K`.\n *\n * **Example**\n *\n *      <!-- convert to thousands (show 12,468 as 12.5K) -->\n *      <span type=\"text\" data-f-bind=\"price[car] | s0.0\"></span>\n *\n */\n\nconst { isString, isNumber } = require('lodash');\n\nfunction isAllowedLeading(str) { \n    const validPrefixes = ['₹', '$', '£', '¥', '±', '’', '¢', '€'];\n    return validPrefixes.indexOf(str.trim()) !== -1;\n}\n\nmodule.exports = {\n    /**\n     * @param {string} name\n     * @returns {boolean}\n     */\n    alias: function (name) {\n        /**\n         * @param {string} v\n         * @returns {boolean}\n         */\n        function checkValMatch(v) {\n            const validStandalone = ['#', '0', '%'];\n            if (v.length === 1) {\n                return validStandalone.indexOf(v) !== -1;\n            }\n\n            const validFirstChars = ['s', '#', '0', '.'];\n            const validLastChars = ['%', '#', '0'];\n\n            if (isAllowedLeading(v.charAt(0))) {\n                v = v.slice(1);\n            }\n            const isValidFirstChar = validFirstChars.indexOf(v.charAt(0)) !== -1;\n            const isValidLastChar = validLastChars.indexOf(v.charAt(v.length - 1)) !== -1;\n\n            if (v.length === 2) {\n                return isValidFirstChar && isValidLastChar;\n            }\n            \n            const validRemainingChars = ['#', '0', '.', ','];\n            const areRemainingCharactersValid = v.substr(1, v.length - 2).split('').reduce((accum, char)=> {\n                const isMatch = validRemainingChars.indexOf(char) !== -1;\n                if (!isMatch) {\n                    accum = false;\n                }\n                return accum;\n            }, true);\n\n            return isValidFirstChar && isValidLastChar && areRemainingCharactersValid;\n        }\n\n        const parts = name.split(' ');\n        if (parts.length === 3) {\n            return checkValMatch(parts[1]); //prefix and suffix\n        } else if (parts.length === 1) {\n            return checkValMatch(parts[0]); //just the number\n        } else if (parts.length === 2) {\n            return checkValMatch(parts[0]) || checkValMatch(parts[1]); //either prefix or suffix\n        }\n        return false;\n    },\n\n    /**\n     * @param {string} val\n     * @returns {number}\n     */\n    parse: function (val) {\n        val += '';\n        var isNegative = val.charAt(0) === '-';\n\n        val = val.replace(/,/g, '');\n        var floatMatcher = /([-+]?[0-9]*\\.?[0-9]+)(K?M?B?%?)/i;\n        var results = floatMatcher.exec(val);\n        var number;\n        var suffix = '';\n        if (results && results[1]) {\n            number = results[1];\n        }\n        if (results && results[2]) {\n            suffix = results[2].toLowerCase();\n        }\n\n        /*eslint no-magic-numbers: 0 complexity: 0 */\n        switch (suffix) {\n            case '%':\n                number = number / 100;\n                break;\n            case 'k':\n                number = number * 1000;\n                break;\n            case 'm':\n                number = number * 1000000;\n                break;\n            case 'b':\n                number = number * 1000000000;\n                break;\n            default:\n        }\n        number = parseFloat(number);\n        if (isNegative && number > 0) {\n            number = number * -1;\n        }\n        return number;\n    },\n\n    convert: (function (value) {\n        var scales = ['', 'K', 'M', 'B', 'T'];\n        function roundTo(value, digits) {\n            return Math.round(value * Math.pow(10, digits)) / Math.pow(10, digits);\n        }\n\n        function getDigits(value, digits) {\n            value = value === 0 ? 0 : roundTo(value, Math.max(0, digits - Math.ceil(Math.log(value) / Math.LN10)));\n\n            var TXT = '';\n            var numberTXT = value.toString();\n            var decimalSet = false;\n\n            for (var iTXT = 0; iTXT < numberTXT.length; iTXT++) {\n                TXT += numberTXT.charAt(iTXT);\n                if (numberTXT.charAt(iTXT) === '.') {\n                    decimalSet = true;\n                } else {\n                    digits--;\n                }\n\n                if (digits <= 0) {\n                    return TXT;\n                }\n            }\n\n            if (!decimalSet) {\n                TXT += '.';\n            }\n            while (digits > 0) {\n                TXT += '0';\n                digits--;\n            }\n            return TXT;\n        }\n\n        function addDecimals(value, decimals, minDecimals, hasCommas) {\n            hasCommas = !!hasCommas;\n            var numberTXT = value.toString();\n            var hasDecimals = (numberTXT.split('.').length > 1);\n            var iDec = 0;\n\n            if (hasCommas) {\n                for (var iChar = numberTXT.length - 1; iChar > 0; iChar--) {\n                    if (hasDecimals) {\n                        hasDecimals = (numberTXT.charAt(iChar) !== '.');\n                    } else {\n                        iDec = (iDec + 1) % 3;\n                        if (iDec === 0) {\n                            numberTXT = numberTXT.substr(0, iChar) + ',' + numberTXT.substr(iChar);\n                        }\n                    }\n                }\n\n            }\n            if (decimals > 0) {\n                var toADD;\n                if (numberTXT.split('.').length <= 1) {\n                    toADD = minDecimals;\n                    if (toADD > 0) {\n                        numberTXT += '.';\n                    }\n                } else {\n                    toADD = minDecimals - numberTXT.split('.')[1].length;\n                }\n\n                while (toADD > 0) {\n                    numberTXT += '0';\n                    toADD--;\n                }\n            }\n            return numberTXT;\n        }\n\n        function getSuffix(formatTXT) {\n            formatTXT = formatTXT.replace('.', '');\n            var fixesTXT = formatTXT.split(new RegExp('[0|,|#]+', 'g'));\n            return (fixesTXT.length > 1) ? fixesTXT[1].toString() : '';\n        }\n\n        function format (number, formatTXT) { // eslint-disable-line\n            if (Array.isArray(number)) {\n                number = number[number.length - 1];\n            }\n            if (!isString(number) && !isNumber(number)) {\n                return number;\n            }\n\n            if (!formatTXT || formatTXT.toLowerCase() === 'default') {\n                return number.toString();\n            }\n\n            if (isNaN(number)) {\n                return '?';\n            }\n\n            //var formatTXT;\n            const entityCodeMapping = {\n                '&euro;': '€',\n                '&dollar;': '$',\n                '&cent;': '¢',\n                '&pound;': '£',\n                '&yen;': '¥',\n            };\n            Object.keys(entityCodeMapping).forEach((code)=> {\n                formatTXT = formatTXT.replace(code, entityCodeMapping[code]);\n            });\n\n            // Divide +/- Number Format\n            var formats = formatTXT.split(';');\n            if (formats.length > 1) {\n                return format(Math.abs(number), formats[((number >= 0) ? 0 : 1)]);\n            }\n\n            // Save Sign\n            var sign = (number >= 0) ? '' : '-';\n            number = Math.abs(number);\n\n\n            var leftOfDecimal = formatTXT;\n            var d = leftOfDecimal.indexOf('.');\n            if (d > -1) {\n                leftOfDecimal = leftOfDecimal.substring(0, d);\n            }\n\n            var normalized = leftOfDecimal.toLowerCase();\n            var index = normalized.lastIndexOf('s');\n            var isShortFormat = index > -1;\n\n            if (isShortFormat) {\n                var nextChar = leftOfDecimal.charAt(index + 1);\n                if (nextChar === ' ') {\n                    isShortFormat = false;\n                }\n            }\n\n            var leadingText = isShortFormat ? formatTXT.substring(0, index) : '';\n            var rightOfPrefix = isShortFormat ? formatTXT.substr(index + 1) : formatTXT.substr(index);\n\n            //first check to make sure 's' is actually short format and not part of some leading text\n            if (isShortFormat) {\n                var shortFormatTest = /[0-9#*]/;\n                var shortFormatTestResult = rightOfPrefix.match(shortFormatTest);\n                if (!shortFormatTestResult || shortFormatTestResult.length === 0) {\n                    //no short format characters so this must be leading text ie. 'weeks '\n                    isShortFormat = false;\n                    leadingText = '';\n                }\n            }\n\n            //if (formatTXT.charAt(0) == 's')\n            if (isShortFormat) {\n                var valScale = number === 0 ? 0 : Math.floor(Math.log(Math.abs(number)) / (3 * Math.LN10));\n                valScale = ((number / Math.pow(10, 3 * valScale)) < 1000) ? valScale : (valScale + 1);\n                valScale = Math.max(valScale, 0);\n                valScale = Math.min(valScale, 4);\n                number = number / Math.pow(10, 3 * valScale);\n                //if (!isNaN(Number(formatTXT.substr(1) ) ) )\n\n                if (!isNaN(Number(rightOfPrefix)) && rightOfPrefix.indexOf('.') === -1) {\n                    var limitDigits = Number(rightOfPrefix);\n                    if (number < Math.pow(10, limitDigits)) {\n                        if (isAllowedLeading(leadingText)) {\n                            return sign + leadingText + getDigits(number, Number(rightOfPrefix)) + scales[valScale];\n                        } else {\n                            return leadingText + sign + getDigits(number, Number(rightOfPrefix)) + scales[valScale];\n                        }\n                    } else if (isAllowedLeading(leadingText)) {\n                        return sign + leadingText + Math.round(number) + scales[valScale];\n                    } else {\n                        return leadingText + sign + Math.round(number) + scales[valScale];\n                    }\n                } else {\n                    //formatTXT = formatTXT.substr(1);\n                    formatTXT = formatTXT.substr(index + 1);\n                    var SUFFIX = getSuffix(formatTXT);\n                    formatTXT = formatTXT.substr(0, formatTXT.length - SUFFIX.length);\n\n                    var valWithoutLeading = format(((sign === '') ? 1 : -1) * number, formatTXT) + scales[valScale] + SUFFIX;\n                    if (isAllowedLeading(leadingText) && sign !== '') {\n                        valWithoutLeading = valWithoutLeading.substr(sign.length);\n                        return sign + leadingText + valWithoutLeading;\n                    }\n\n                    return leadingText + valWithoutLeading;\n                }\n            }\n\n            var subFormats = formatTXT.split('.');\n            var decimals;\n            var minDecimals;\n            if (subFormats.length > 1) {\n                decimals = subFormats[1].length - subFormats[1].replace(new RegExp('[0|#]+', 'g'), '').length;\n                minDecimals = subFormats[1].length - subFormats[1].replace(new RegExp('0+', 'g'), '').length;\n                formatTXT = subFormats[0] + subFormats[1].replace(new RegExp('[0|#]+', 'g'), '');\n            } else {\n                decimals = 0;\n            }\n\n            var fixesTXT = formatTXT.split(new RegExp('[0|,|#]+', 'g'));\n            var preffix = fixesTXT[0].toString();\n            var suffix = (fixesTXT.length > 1) ? fixesTXT[1].toString() : '';\n\n            number = number * ((formatTXT.split('%').length > 1) ? 100 : 1);\n            //            if (formatTXT.indexOf('%') !== -1) number = number * 100;\n            number = roundTo(number, decimals);\n\n            sign = (number === 0) ? '' : sign;\n\n            var hasCommas = (formatTXT.substr(formatTXT.length - 4 - suffix.length, 1) === ',');\n            var formatted = sign + preffix + addDecimals(number, decimals, minDecimals, hasCommas) + suffix;\n\n            //  console.log(originalNumber, originalFormat, formatted)\n            return formatted;\n        }\n\n        return format;\n    }())\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/converter-manager/converters/numberformat-converter.js","/**\n * ## Number Comparison Converters\n *\n * Converters allow you to change how data is displayed. They let you display the value of any model variable in a different format than it is stored in the model -- converting the output value from one format to another.\n *\n * For a number comparison converter, the original format is your model variable, and the resulting \"format\" is a (possibly unrelated) value of your choosing. This resulting value is selected based on how the value of the model variable compares to a reference value that you pass to the converter.\n *\n * There are two ways to specify conversion or formatting for the display output of a particular model variable:\n *\n * * Use the `|` (pipe) character within the value of any `data-f-` attribute. Converters are chainable, so you can apply several in a row to a particular variable.\n * * Add the attribute `data-f-convert` to any element to convert all of the model variables referenced within that element's scope.\n *\n * For example:\n *\n *      <!-- displays \"true\" or the number of widgets -->\n *      <span data-f-bind=\"widgets | greaterThan(50)\"></span>\n *\n *      <!-- displays the first string if true, the second if false -->\n *      <span data-f-bind=\"widgets | greaterThan(50, 'nice job!', 'not enough widgets')\"></span>\n *\n * You can also chain multiple converters to simulate evaluating multiple if\\else conditions; for e.g. the following logic\n *\n *      if (temperature > 80) {\n *          return 'hot';\n *      } else if (temperature > 60) {\n *          return 'pleasant';\n *      } else if (temperature >= 30) {\n *          return 'cold';\n *      } else {\n *          return 'freezing!';\n *      }\n *\n * can be represented as\n *\n *      <h4 data-f-bind=\"temperature | greaterThan(80, hot) | greaterThan(60, pleasant) | greaterThanEqual(30, cold, freezing!)\"></h4>\n */\n\n'use strict';\n\nfunction parseArgs(limit, trueVal, falseVal, valueToCompare, matchString) {\n    var toReturn = { trueVal: true, falseVal: false };\n    switch (arguments.length) {\n        case 5: //eslint-disable-line\n            return $.extend(toReturn, { trueVal: trueVal, falseVal: falseVal, input: valueToCompare });\n        case 4: //eslint-disable-line\n            return $.extend(toReturn, { trueVal: trueVal, falseVal: falseVal, input: falseVal }); \n        case 3: //eslint-disable-line\n            return $.extend(toReturn, { input: trueVal, falseVal: trueVal }); \n        default:\n            return toReturn;\n    }\n}\nmodule.exports = {\n    /**\n     * Convert the model variable to true, or other values passed to the converter, based on whether the model variable is greater than the limit.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          <!-- displays true or the number of widgets -->\n     *          <span data-f-bind=\"widgets | greaterThan(50)\"></span> \n     *\n     *          <!-- displays custom text -->\n     *          <span data-f-bind=\"widgets | greaterThan(50, 'Congratulations!', 'Better luck next year')\"></span>\n     *      </div>\n     *\n     * @param {Number} limit The reference value to compare the model variable against.\n     * @param {String} trueVal (Optional) The format (value) to display if the model variable is greater than `limit`. If not included, the display is `true`. If there are commas in this argument, they must be escaped with `\\`.\n     * @param {String} falseVal (Optional) The format (value) to display if the model variable is less than or equal to `limit`. If not included, the display is the value of the model variable. If there are commas in this argument, they must be escaped with `\\`.\n     * @return {Any} If the model variable is greater than `limit`, returns trueVal or `true`. Otherwise returns falseVal if provided, or echoes the input.\n     */\n    greaterThan: function (limit) {\n        var args = parseArgs.apply(null, arguments);\n        return Number(args.input) > Number(limit) ? args.trueVal : args.falseVal;\n    },\n\n    /**\n     * Convert the model variable to true, or other values passed to the converter, based on whether the model variable is greater than or equal to the limit.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          <!-- displays true or the number of widgets -->\n     *          <span data-f-bind=\"widgets | greaterThan(50)\"></span> \n     *\n     *          <!-- displays custom text -->\n     *          <span data-f-bind=\"widgets | greaterThan(50, 'Congratulations!', 'Better luck next year')\"></span>\n     *      </div>\n     *\n     * @param {Number} limit The reference value to compare the model variable against.\n     * @param {String} trueVal (Optional) The format (value) to display if the model variable is greater than or equal to `limit`. If not included, the display is `true`. If there are commas in this argument, they must be escaped with `\\`.\n     * @param {String} falseVal (Optional) The format (value) to display if the model variable is less than `limit`. If not included, the display is the value of the model variable. If there are commas in this argument, they must be escaped with `\\`.\n     * @return {Any} If the model variable is greater than or equal to `limit`, returns trueVal or `true`. Otherwise returns falseVal if provided, or echoes the input.\n     */    \n    greaterThanEqual: function (limit) {\n        var args = parseArgs.apply(null, arguments);\n        return Number(args.input) >= Number(limit) ? args.trueVal : args.falseVal;\n    },\n\n    /**\n     * Convert the model variable to true, or other values passed to the converter, based on whether the model variable is equal to the limit.\n     *\n     * \n     * **Example**\n     *\n     *      <div>\n     *          <!-- displays true or the number of widgets -->\n     *          <span data-f-bind=\"widgets | equalsNumber(50)\"></span> \n     *\n     *          <!-- display custom text -->\n     *          <span data-f-bind=\"widgets | equalsNumber(50, 'Met the goal exactly!', 'Not an exact match')\"></span>\n     *      </div>\n     *\n     * @param {Number} limit The reference value to compare the model variable against.\n     * @param {String} trueVal (Optional) The format (value) to display if the model variable is equal to `limit`. If not included, the display is `true`. If there are commas in this argument, they must be escaped with `\\`.\n     * @param {String} falseVal (Optional) The format (value) to display if the model variable is not equal to `limit`. If not included, the display is the value of the model variable. If there are commas in this argument, they must be escaped with `\\`.\n     * @return {Any} If the model variable equals `limit`, returns trueVal or `true`. Otherwise returns falseVal if provided, or echoes the input.\n     */\n    equalsNumber: function (limit) {\n        var args = parseArgs.apply(null, arguments);\n        return Number(args.input) === Number(limit) ? args.trueVal : args.falseVal;\n    },\n\n    /**\n     * Convert the model variable to true, or other values passed to the converter, based on whether the model variable is less than the limit.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          <!-- displays true or the number of widgets -->\n     *          <span data-f-bind=\"widgets | lessThan(50)\"></span> \n     *\n     *          <!-- display custom text -->\n     *          <span data-f-bind=\"widgets | lessThan(50, 'Oops didn't make quite enough!', 'Built a lot of widgets this year!')\"></span>\n     *      </div>\n     *\n     * @param {Number} limit The reference value to compare the model variable against.\n     * @param {String} trueVal (Optional) The format (value) to display if the model variable is less than `limit`. If not included, the display is `true`. If there are commas in this argument, they must be escaped with `\\`.\n     * @param {String} falseVal (Optional) The format (value) to display if the model variable is less than `limit`. If not included, the display is the value of the model variable. If there are commas in this argument, they must be escaped with `\\`.\n     * @return {Any} If the model variable is less than `limit`, returns trueVal or `true`. Otherwise returns falseVal if provided, or echoes the input.\n     */ \n    lessThan: function (limit) {\n        var args = parseArgs.apply(null, arguments);\n        return Number(args.input) < Number(limit) ? args.trueVal : args.falseVal;\n    },\n\n    /**\n     * Convert the model variable to true, or other values passed to the converter, based on whether the model variable is less than or equal to the limit.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          <!-- displays true or the number of widgets -->\n     *          <span data-f-bind=\"widgets | lessThanEqual(50)\"></span> \n     *\n     *          <!-- display custom text -->\n     *          <span data-f-bind=\"widgets | lessThanEqual(50, 'Oops didn't make quite enough!', 'Built a lot of widgets this year!')\"></span>\n     *      </div>\n     *\n     * @param {Number} limit The reference value to compare the model variable against.\n     * @param {String} trueVal (Optional) The format (value) to display if the model variable is less than or equal to `limit`. If not included, the display is `true`. If there are commas in this argument, they must be escaped with `\\`.\n     * @param {String} falseVal (Optional) The format (value) to display if the model variable is less than or equal to `limit`. If not included, the display is the value of the model variable. If there are commas in this argument, they must be escaped with `\\`.\n     * @return {Any} If the model variable is less than or equal to `limit`, returns trueVal or `true`. Otherwise returns falseVal if provided, or echoes the input.\n     */\n    lessThanEqual: function (limit) {\n        var args = parseArgs.apply(null, arguments);\n        return Number(args.input) <= Number(limit) ? args.trueVal : args.falseVal;\n    }\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/converter-manager/converters/number-compare-converters.js","/**\n * ## Boolean Conditional Converters\n *\n * Converters allow you to change how data is displayed. They let you display the value of any model variable in a different format than it is stored in the model -- converting the output value from one format to another.\n *\n * For a boolean conditional converter, the original format is your model variable, and the resulting \"format\" is a boolean value, or another value of your choosing.\n *\n * There are two ways to specify conversion or formatting for the display output of a particular model variable:\n *\n * * Use the `|` (pipe) character within the value of any `data-f-` attribute. Converters are chainable, so you can apply several in a row to a particular variable.\n * * Add the attribute `data-f-convert` to any element to convert all of the model variables referenced within that element's scope.\n *\n * For example:\n *\n *      <!-- displays \"true\" or \"false\" -->\n *      <!-- in particular, true if sampleVar is truthy (1, true, 'some string', [] etc.), \n *            false if sampleVar is falsy (0, false, '') -->\n *      <span data-f-bind=\"sampleVar | toBool\"></span>\n *\n */\n\nfunction parseArgs(trueVal, falseVal, input, matchString) {\n    var toReturn = { trueVal: true, falseVal: false };\n    switch (arguments.length) {\n        case 4: //eslint-disable-line\n            return $.extend(toReturn, { trueVal: trueVal, falseVal: falseVal, input: input });\n        case 3: //eslint-disable-line\n            return $.extend(toReturn, { trueVal: trueVal, falseVal: falseVal, input: falseVal }); \n        default:\n            return toReturn;\n    }\n}\n\nmodule.exports = {\n    /**\n     * Convert 'truthy' values to true and 'falsy' values to false.\n     *\n     * **Example**\n     *\n     *      <!-- displays \"true\" or \"false\" -->\n     *      <!-- in particular, true if sampleVar is truthy (1, true, 'some string', [] etc.), \n     *            false if sampleVar is falsy (0, false, '') -->\n     *      <span data-f-bind=\"sampleVar | toBool\"></span>\n     * \n     * @param {Any} value\n     * @return {Boolean}\n     */\n    toBool: (value)=> !!value,\n\n    /**\n     * Converts values to boolean and negates.\n     *\n     * **Example**\n     *\n     *      <!-- disables input if isGameInProgress is false -->\n     *      <input type=\"text\" data-f-disabled=\"isGameInProgress | not\" />\n     * \n     * @param {Any} value\n     * @return {Boolean}\n     */\n    not: (value)=> !value,\n\n    /**\n     * Convert the input to a new value (for example, some text), based on whether it is true or false.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          <span data-f-bind=\"sampleVar | ifTrue('yes! please move forward', 'not ready to proceed')\"></span> \n     *          <span data-f-bind=\"sampleVar | ifTrue('yes! please move forward')\"></span>\n     *      </div>\n     *\n     * @param {String} trueVal The value to display if the input is true. If there are commas in this argument, they must be escaped with `\\`.\n     * @param {String} falseVal (Optional) The value to display if the input is false. If not included, returns the input. If there are commas in this argument, they must be escaped with `\\`.\n     * @param {Any} input (Optional) The input to test. If not included, the output of the previous argument is used.\n     * @return {Any} If input is true, returns trueVal. If input is false, returns falseVal if provided, or echoes the input.\n     */\n    ifTrue: function () {\n        var args = parseArgs.apply(null, arguments);\n        return args.input ? args.trueVal : args.falseVal;\n    },\n    /**\n     * Convert the input to a new value (for example, some text), based on whether it is false or true.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          <span data-f-bind=\"sampleVar | ifFalse('not ready to proceed', 'actually this is still true')\"></span> \n     *          <span data-f-bind=\"sampleVar | ifFalse('not ready to proceed')\"></span>\n     *      </div>\n     *\n     * @param {String} trueVal The value to display if the input is false. If there are commas in this argument, they must be escaped with `\\`.\n     * @param {String} falseVal (Optional) The value to display if the input is true. If not included, returns the input. If there are commas in this argument, they must be escaped with `\\`.\n     * @param {Any} input (Optional) The input to test. If not included, the output of the previous argument is used.\n     * @return {Any} If input is false, returns trueVal. If input is true, returns falseVal if provided, or echoes the input.\n     */\n    ifFalse: function () {\n        var args = parseArgs.apply(null, arguments);\n        return !args.input ? args.trueVal : args.falseVal;\n    }\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/converter-manager/converters/bool-conditional-converters.js","const _ = require('lodash');\n\nconst list = {\n    /**\n     * Returns all values in array matching argument\n     *\n     * ** Example **\n     * <!-- list online users -->\n     * <ul data-f-foreach=\"users | filter(isOnline)\"><li></li></button>\n     * \n     * @param  {string|number|boolean} valueToFilterBy value to reject\n     * @param  {any[]} source The arrayed model variable\n     * @return {any[]}     filtered lsit\n     */\n    filter: function (valueToFilterBy, source) {\n        source = [].concat(source);\n        if ($.isPlainObject(source[0])) {\n            return _.filter(source, valueToFilterBy);\n        }\n        return source.filter((v)=> v === valueToFilterBy);\n    },\n\n    /**\n     * Returns all values in array excluding match\n     *\n     * ** Example **\n     * <!-- list offline users -->\n     * <ul data-f-foreach=\"users | except(isOnline)\"><li></li></button>\n     * \n     * @param  {string|number|boolean} valueToReject value to reject\n     * @param  {any[]} source The arrayed model variable\n     * @return {any[]}     filtered lsit\n     */\n    except: function (valueToReject, source) {\n        source = [].concat(source);\n        if ($.isPlainObject(source[0])) {\n            return _.reject(source, valueToReject);\n        }\n        return source.filter((v)=> v !== valueToReject);\n    },\n\n    /**\n     * Checks if array contains *any* item passing the test\n     *\n     * ** Example **\n     * <!-- hides button if any of the users are not online -->\n     * <button data-f-hideif=\"users | any(isOnline) | not\">Get Started</button>\n     * <button data-f-hideif=\"users | any({ isOnline: false })\">Get Started</button>\n     * \n     * @param  {string|object} value value to check for\n     * @param  {any[]} source The arrayed model variable\n     * @return {boolean}     True if match found in array\n     */\n    any: function (value, source) {\n        source = [].concat(source);\n        if ($.isPlainObject(source[0])) {\n            return _.some(source, value);\n        }\n        return source.indexOf(value) !== -1;\n    },\n\n    /**\n     * Checks if *every* item in the array passes the test\n     *\n     * ** Example **\n     * <!-- shows button if any of the users are not online -->\n     * <button data-f-showif=\"users | every(isOnline)\">Get Started</button>\n     * \n     * @param  {string|object} value value to check for\n     * @param  {any[]} source The arrayed model variable\n     * @return {boolean}     True if match found in array\n     */\n    every: function (value, source) {\n        source = [].concat(source);\n        if ($.isPlainObject(source[0])) {\n            return _.every(source, value);\n        }\n        return source.filter((v)=> v === value).length === source.length;\n    }\n};\nconst converters = Object.keys(list).map((name)=> {\n    return {\n        alias: name,\n        acceptList: true,\n        convert: list[name]\n    };\n});\n\nmodule.exports = converters;\n\n\n\n// WEBPACK FOOTER //\n// ./src/converter-manager/converters/collection-converters.js","import { isString, isFunction } from 'lodash';\n/**\n * @typedef NodeHandler\n * @property {string} selector\n * @property {Function} handle\n */ \n\n \n/**\n * @param {string | undefined} selector\n * @param {Function | NodeHandler } handler\n * @return {NodeHandler}\n */\nconst normalize = function (selector, handler) {\n    if (!selector) {\n        selector = '*';\n    }\n    if (isFunction(handler)) {\n        handler = {\n            selector: selector,\n            handle: handler\n        };\n    }\n   \n    handler.selector = selector;\n    return handler;\n};\n\n/**\n * @param {string|HTMLElement|JQuery<HTMLElement>} toMatch\n * @param { {selector:string} } node\n * @return {boolean}\n */ \nconst match = function (toMatch, node) {\n    if (isString(toMatch)) {\n        return toMatch === node.selector;\n    }\n    return $(toMatch).is(node.selector);\n};\n\nconst nodeManager = {\n    list: [],\n\n    /**\n     * Add a new node handler\n     * @param  {string} selector jQuery-compatible selector to use to match nodes\n     * @param  {function} handler  Handlers are new-able functions. They will be called with $el as context.? TODO: Think this through\n     * @returns {void}\n     */\n    register: function (selector, handler) {\n        this.list.unshift(normalize(selector, handler));\n    },\n\n    /**\n     * @param {string|HTMLElement|JQuery<HTMLElement>} selector\n     * @return NodeHandler\n     */ \n    getHandler: function (selector) {\n        return this.list.find(function (node) {\n            return match(selector, node);\n        });\n    },\n\n    replace: function (selector, handler) {\n        let index;\n        this.list.forEach(function (currentHandler, i) {\n            if (selector === currentHandler.selector) {\n                index = i;\n                return false;\n            }\n        });\n        this.list.splice(index, 1, normalize(selector, handler));\n    }\n};\n\n//bootstraps\nconst defaultHandlers = [\n    require('./input-checkbox-node').default,\n    require('./default-input-node').default,\n    require('./default-node')\n];\ndefaultHandlers.reverse().forEach(function (handler) {\n    nodeManager.register(handler.selector, handler);\n});\n\nexport default nodeManager;\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/nodes/node-manager.js","import BaseView from './default-input-node';\nimport config from 'config';\n\nconst offAttr = config.attrs.checkboxOffValue;\n\nexport default BaseView.extend({\n    propertyHandlers: [\n\n    ],\n\n    getUIValue: function () {\n        const $el = this.$el;\n        const offAttrVal = $el.attr(offAttr);\n        const offVal = (offAttrVal && typeof offAttrVal !== 'undefined') ? offAttrVal : false;\n\n        const onAttrVal = $el.attr('value');\n        //attr = initial value, prop = current value\n        const onVal = (onAttrVal && typeof onAttrVal !== 'undefined') ? $el.prop('value') : true;\n\n        const val = ($el.is(':checked')) ? onVal : offVal;\n        return val;\n    },\n    initialize: function () {\n        BaseView.prototype.initialize.apply(this, arguments);\n    }\n}, { selector: ':checkbox,:radio' });\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/nodes/input-checkbox-node.js","const { extend, has } = require('lodash');\n\nvar extendView = function (protoProps, staticProps) {\n    var me = this;\n    var child;\n\n    // The constructor function for the new subclass is either defined by you\n    // (the \"constructor\" property in your `extend` definition), or defaulted\n    // by us to simply call the parent's constructor.\n    if (protoProps && has(protoProps, 'constructor')) {\n        child = protoProps.constructor;\n    } else {\n        child = function () { return me.apply(this, arguments); };\n    }\n\n    // Add static properties to the constructor function, if supplied.\n    extend(child, me, staticProps);\n\n    // Set the prototype chain to inherit from `parent`, without calling\n    // `parent`'s constructor function.\n    var Surrogate = function () { this.constructor = child; };\n    Surrogate.prototype = me.prototype;\n    child.prototype = new Surrogate();\n\n    // Add prototype properties (instance properties) to the subclass,\n    // if supplied.\n    if (protoProps) {\n        extend(child.prototype, protoProps);\n    }\n\n    // Set a convenience property in case the parent's prototype is needed\n    // later.\n    child.__super__ = me.prototype; //eslint-disable-line no-underscore-dangle\n\n    return child;\n};\n\nvar View = function (options) {\n    this.$el = (options.$el) || $(options.el);\n    this.el = options.el;\n    this.initialize.apply(this, arguments);\n\n};\nextend(View.prototype, {\n    initialize: function () {},\n});\n\nView.extend = extendView;\n\nmodule.exports = View;\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils/base-view.js","import { isString, isFunction, isRegExp, each } from 'lodash';\n\nconst defaultHandlers = [\n    require('./attributes/no-op-attr').default,\n    require('./attributes/events/default-event-attr').default,\n    require('./attributes/loop-attrs/foreach-attr').default,\n    require('./attributes/loop-attrs/repeat-attr').default,\n    require('./attributes/class-attr').default,\n    require('./attributes/boolean-attr').default,\n    require('./attributes/toggles/show-if-attr').default,\n    require('./attributes/toggles/hide-if-attr').default,\n    require('./attributes/binds/checkbox-radio-bind-attr').default,\n    require('./attributes/binds/input-bind-attr').default,\n    require('./attributes/binds/default-bind-attr').default,\n    require('./attributes/default-attr').default\n];\n\nconst handlersList = [];\n\nconst normalize = function (attributeMatcher, nodeMatcher, handler) {\n    if (!nodeMatcher) {\n        nodeMatcher = '*';\n    }\n    if (isFunction(handler)) {\n        handler = {\n            handle: handler\n        };\n    }\n    return $.extend(handler, { test: attributeMatcher, target: nodeMatcher });\n};\n\ndefaultHandlers.forEach(function (handler) {\n    handlersList.push(normalize(handler.test, handler.target, handler));\n});\n\n\nconst matchAttr = function (matchExpr, attr, $el) {\n    let attrMatch;\n\n    if (isString(matchExpr)) {\n        attrMatch = (matchExpr === '*' || (matchExpr.toLowerCase() === attr.toLowerCase()));\n    } else if (isFunction(matchExpr)) {\n        //TODO: remove element selectors from attributes\n        attrMatch = matchExpr(attr, $el);\n    } else if (isRegExp(matchExpr)) {\n        attrMatch = attr.match(matchExpr);\n    }\n    return attrMatch;\n};\n\nconst matchNode = function (target, nodeFilter) {\n    return (isString(nodeFilter)) ? (nodeFilter === target) : nodeFilter.is(target);\n};\n\nconst attributeManager = {\n    list: handlersList,\n    /**\n     * Add a new attribute handler.\n     *\n     * @param  {string|Function|RegExp} attributeMatcher Description of which attributes to match.\n     * @param  {string|JQuery<HTMLElement>} nodeMatcher Which nodes to add attributes to. Use [jquery Selector syntax](https://api.jquery.com/category/selectors/).\n     * @param  {Function|object} handler If `handler` is a function, the function is called with `$element` as context, and attribute value + name. If `handler` is an object, it should include two functions, and have the form: `{ init: fn,  handle: fn }`. The `init` function is called when the page loads; use this to define event handlers. The `handle` function is called with `$element` as context, and attribute value + name.\n     * @returns {void}\n     */\n    register: function (attributeMatcher, nodeMatcher, handler) {\n        handlersList.unshift(normalize.apply(null, arguments));\n    },\n\n    /**\n     * Find an attribute matcher matching some criteria.\n     *\n     * @param  {string} attrFilter Attribute to match.\n     * @param  {string|JQuery<HTMLElement>} nodeFilter Node to match.\n     *\n     * @return {AttributeHandler[]} An array of matching attribute handlers, or null if no matches found.\n     */\n    filter: function (attrFilter, nodeFilter) {\n        let filtered = handlersList.filter(function (handler) {\n            return matchAttr(handler.test, attrFilter);\n        });\n        if (nodeFilter) {\n            filtered = filtered.filter(function (handler) {\n                return matchNode(handler.target, nodeFilter);\n            });\n        }\n        return filtered;\n    },\n\n    /**\n     * Replace an existing attribute handler.\n     *\n     * @param  {string} attrFilter Attribute to match.\n     * @param  {string|JQuery<HTMLElement>} nodeFilter Node to match.\n     * @param  {Function|object} handler The updated attribute handler. If `handler` is a function, the function is called with `$element` as context, and attribute value + name. If `handler` is an object, it should include two functions, and have the form: `{ init: fn,  handle: fn }`. The `init` function is called when the page loads; use this to define event handlers. The `handle` function is called with `$element` as context, and attribute value + name.\n     * @returns {void}\n     */\n    replace: function (attrFilter, nodeFilter, handler) {\n        let index;\n        each(handlersList, function (currentHandler, i) {\n            if (matchAttr(currentHandler.test, attrFilter) && matchNode(currentHandler.target, nodeFilter)) {\n                index = i;\n                return false;\n            }\n        });\n        handlersList.splice(index, 1, normalize(attrFilter, nodeFilter, handler));\n    },\n\n    /**\n     *  Retrieve the appropriate handler for a particular attribute. There may be multiple matching handlers, but the first (most exact) match is always used.\n     *\n     * @param {string} attr The attribute.\n     * @param {string|JQuery<HTMLElement>} $el The DOM element.\n     *\n     * @return {AttributeHandler|undefined} The attribute handler, if a matching one is found\n     */\n    getHandler: function (attr, $el) {\n        const filtered = this.filter(attr, $el);\n        //There could be multiple matches, but the top first has the most priority\n        return filtered[0];\n    }\n};\n\nexport default attributeManager;\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attribute-manager/index.js","/**\n * ## No-op Attributes\n *\n * Flow.js provides special handling for both `data-f-model` (described [here](../../../../#using_in_project)) and `data-f-convert` (described [here](../../../../converter-overview/)). For these attributes, the default behavior is to do nothing, so that this additional special handling can take precendence.\n *\n */\n\n/**\n * @type AttributeHandler \n */\nconst noopAttr = {\n\n    target: '*',\n\n    test: /^(?:model|convert|channel|on-init)/i,\n\n    handle: ()=> {},\n    parse: ()=> []\n};\n\nexport default noopAttr;\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attribute-manager/attributes/no-op-attr/index.js","import { events } from 'config';\nimport { toPublishableFormat } from 'utils/parse-utils';\n\n/**\n * @type AttributeHandler \n */\nconst defaultEventAttr = {\n\n    target: '*',\n\n    test: function (attr) {\n        return (attr.indexOf('on-') === 0);\n    },\n\n    unbind: function (attr, $el) {\n        const eventName = attr.replace('on-', '');\n        $el.off(eventName);\n    },\n\n    parse: ()=> ([]), //There's nothing to subscribe to on an event\n    handle: ()=> {},\n\n    init: function (attr, topics, $el) {\n        const eventName = attr.replace('on-', '');\n        const matching = topics[0] && topics[0].name; //multiple topics aren't really relevant here\n        $el.off(eventName).on(eventName, function (evt) {\n            evt.preventDefault();\n            var listOfOperations = toPublishableFormat(matching);\n            $el.trigger(events.trigger, { data: listOfOperations, source: attr });\n        });\n    }\n};\n\nexport default defaultEventAttr;\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attribute-manager/attributes/events/default-event-attr/index.js","import { toImplicitType } from 'utils/parse-utils';\nimport { animation } from 'config';\n\nimport { aliasesFromTopics, parseTopics } from '../loop-attr-utils';\nimport { addChangeClassesToList } from 'utils/animation';\nimport { each, template } from 'lodash';\n\nimport { getKnownDataForEl, updateKnownDataForEl, removeKnownData, findMissingReferences, stubMissingReferences, addBackMissingReferences, getOriginalContents, clearOriginalContents } from 'dom/attribute-manager/attr-template-utils';\n\nconst elAnimatedMap = new WeakMap(); //TODO: Can probably get rid of this if we make subscribe a promise and distinguish between initial value\n\n/**\n * @type AttributeHandler\n */\nconst foreachAttr = {\n\n    test: 'foreach',\n\n    target: '*',\n\n    unbind: function (attr, $el) {\n        const el = $el.get(0);\n        elAnimatedMap.delete(el);\n        \n        const template = getOriginalContents($el);\n        const current = $el.html();\n        if (template && current !== template) {\n            $el.html(template);\n        }\n        clearOriginalContents($el);\n        removeKnownData($el);\n    },\n\n    parse: function (topics) {\n        return parseTopics(topics);\n    },\n\n    handle: function (value, prop, $el, topics) {\n        value = ($.isPlainObject(value) ? value : [].concat(value));\n\n        const { keyAlias, valueAlias } = aliasesFromTopics(topics, value);\n\n        const originalHTML = getOriginalContents($el, ($el)=> $el.html());\n        const knownData = getKnownDataForEl($el);\n        const missingReferences = findMissingReferences(originalHTML, [keyAlias, valueAlias].concat(Object.keys(knownData)));\n        const stubbedTemplate = stubMissingReferences(originalHTML, missingReferences);\n\n        const templateFn = template(stubbedTemplate);\n        const $dummyEl = $('<div></div>');\n        each(value, function (dataval, datakey) {\n            if (dataval === undefined || dataval === null) {\n                dataval = dataval + ''; //convert undefineds to strings\n            }\n            const templateData = $.extend(true, {}, knownData, {\n                [keyAlias]: datakey,\n                [valueAlias]: dataval\n            });\n\n            let nodes;\n            let isTemplated;\n            try {\n                const templated = templateFn(templateData);\n                const templatedWithReferences = addBackMissingReferences(templated, missingReferences);\n                isTemplated = templatedWithReferences !== stubbedTemplate;\n                nodes = $(templatedWithReferences);\n            } catch (e) { //you don't have all the references you need;\n                nodes = $(stubbedTemplate);\n                isTemplated = true;\n                updateKnownDataForEl($(nodes), templateData);\n            }\n\n            nodes.each(function (i, newNode) {\n                const $newNode = $(newNode);\n                each($newNode.data(), function (val, key) {\n                    $newNode.data(key, toImplicitType(val));\n                });\n                if (!isTemplated && !$newNode.html().trim()) {\n                    $newNode.html(dataval);\n                }\n            });\n            $dummyEl.append(nodes);\n        });\n        \n        const el = $el.get(0);\n        const isInitialAnim = !elAnimatedMap.get(el);\n        const $withAnimAttrs = addChangeClassesToList($el.children(), $dummyEl.children(), isInitialAnim, animation);\n        $el.empty().append($withAnimAttrs);\n\n        elAnimatedMap.set(el, true);\n    }\n};\n\nexport default foreachAttr;\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attribute-manager/attributes/loop-attrs/foreach-attr/index.js","import { template, each, isEmpty } from 'lodash';\nimport { toImplicitType } from 'utils/parse-utils';\nimport { random } from 'utils/general';\nimport { attrs, animation } from 'config';\n\nconst templateIdAttr = attrs.repeat.templateId;\n\nimport { addChangeClassesToList } from 'utils/animation';\n\nconst elAnimatedMap = new WeakMap(); //TODO: Can probably get rid of this if we make subscribe a promise and distinguish between initial value\n\nimport { getKnownDataForEl, updateKnownDataForEl, removeKnownData, findMissingReferences, stubMissingReferences, addBackMissingReferences, getOriginalContents, clearOriginalContents } from 'dom/attribute-manager/attr-template-utils';\n\nimport { aliasesFromTopics, parseTopics } from '../loop-attr-utils';\n\n/**\n * @type AttributeHandler \n */\nconst loopAttrHandler = {\n    test: 'repeat',\n\n    target: '*',\n\n    unbind: function (attr, $el) {\n        var id = $el.data(templateIdAttr);\n        if (id) {\n            $el.nextUntil(':not([data-' + id + '])').remove();\n            // $el.removeAttr('data-' + templateIdAttr); //FIXME: Something about calling rebind multiple times in IB makes this happen without the removal\n        }\n\n        const el = $el.get(0);\n        elAnimatedMap.delete(el);\n\n        const originalHTML = getOriginalContents($el);\n        const current = $el.get(0).outerHTML;\n        if (originalHTML && current !== originalHTML) {\n            $el.replaceWith(originalHTML);\n        }\n        clearOriginalContents($el);\n        removeKnownData($el);\n    },\n\n    parse: function (topics) {\n        return parseTopics(topics);\n    },\n\n    init: function (attr, value, $el) {\n        \n    },\n\n    handle: function (value, prop, $el, topics) {\n        value = ($.isPlainObject(value) ? value : [].concat(value));\n        let id = $el.data(templateIdAttr);\n        \n        $el.removeAttr('hidden');\n        const originalHTML = getOriginalContents($el, ($el)=> $el.get(0).outerHTML);\n\n        const $dummyOldDiv = $('<div></div>');\n        if (id) {\n            const $removed = $el.nextUntil(':not([data-' + id + '])').remove();\n            $dummyOldDiv.append($removed);\n        } else {\n            id = random('repeat-');\n            $el.attr('data-' + templateIdAttr, id);\n        }\n\n        const { keyAlias, valueAlias } = aliasesFromTopics(topics, value);\n\n        const knownData = getKnownDataForEl($el);\n        const missingReferences = findMissingReferences(originalHTML, [keyAlias, valueAlias].concat(Object.keys(knownData)));\n        const stubbedTemplate = stubMissingReferences(originalHTML, missingReferences);\n\n        if (isEmpty(value)) {\n            $el.attr('hidden', true); //There's always going to be 1 el otherwise\n            return;\n        }\n\n        const templateFn = template(stubbedTemplate);\n        let last;\n        each(value, function (dataval, datakey) {\n            if (dataval === undefined || dataval === null) {\n                dataval = dataval + ''; //convert undefineds to strings\n            }\n            const templateData = $.extend(true, {}, knownData, {\n                [keyAlias]: datakey,\n                [valueAlias]: dataval\n            });\n\n            let nodes;\n            let isTemplated;\n            try {\n                const templated = templateFn(templateData);\n                const templatedWithReferences = addBackMissingReferences(templated, missingReferences);\n                isTemplated = templatedWithReferences !== stubbedTemplate;\n                nodes = $(templatedWithReferences);\n            } catch (e) { //you don't have all the references you need;\n                nodes = $(stubbedTemplate);\n                isTemplated = true;\n                updateKnownDataForEl($(nodes), templateData);\n            }\n\n            var hasData = (dataval !== null && dataval !== undefined);\n            nodes.each(function (i, newNode) {\n                const $newNode = $(newNode);\n                $newNode.removeAttr('data-f-repeat').removeAttr('data-' + templateIdAttr);\n                each($newNode.data(), function (val, key) {\n                    if (!last) {\n                        $el.data(key, toImplicitType(val));\n                    } else {\n                        $newNode.data(key, toImplicitType(val));\n                    }\n                });\n                $newNode.attr('data-' + id, true);\n                if (!isTemplated && !$newNode.children().length && hasData) {\n                    $newNode.html(dataval + '');\n                }\n            });\n            if (!last) {\n                last = $el.html(nodes.html());\n            } else {\n                last = nodes.insertAfter(last);\n            }\n        });\n\n        const $newEls = $el.nextUntil(`:not('[data-${id}]')`);\n\n        const el = $el.get(0);\n        const isInitialAnim = !elAnimatedMap.get(el);\n        addChangeClassesToList($dummyOldDiv.children(), $newEls, isInitialAnim, animation);\n\n        elAnimatedMap.set(el, true);\n    }\n};\n\nexport default loopAttrHandler;\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attribute-manager/attributes/loop-attrs/repeat-attr/index.js","import { toArray } from 'lodash';\nimport { promisify } from './promise-utils';\n\n/**\n * Returns debounced version of original (optionally promise returning) function\n * \n * @param {function(*):Promise} fn function to debounce\n * @param {number} debounceInterval \n * @param {Function[]} [argumentsReducers] pass in 1 reducer for each option your function takes\n * @return {Function} debounced function\n */\nexport default function debounceAndMerge(fn, debounceInterval, argumentsReducers) {\n    var argsToPass = [];\n    if (!argumentsReducers) {\n        var arrayReducer = function (accum, newVal) {\n            if (!accum) {\n                accum = [];\n            }\n            return accum.concat(newVal);\n        };\n        argumentsReducers = [\n            arrayReducer\n        ];\n    }\n\n    const queue = [];\n\n    let timer = null;\n    let isExecuting = false;\n    let $def = $.Deferred();\n    /**\n     * @returns {Promise}\n     */\n    return function debouncedFunction() {\n        var newArgs = toArray(arguments);\n        argsToPass = newArgs.map(function (arg, index) {\n            var reducer = argumentsReducers[index];\n            if (reducer) {\n                return reducer(argsToPass[index], arg);\n            } else {\n                return arg;\n            }\n        });\n\n        if (isExecuting || $def.isComplete) {\n            $def = $.Deferred();\n        }\n        if (timer && !isExecuting) {\n            clearTimeout(timer);//caught within debounce period, reuse old deferred\n        } else {\n            queue.push($def);\n        }\n        \n        timer = setTimeout(()=> {\n            isExecuting = true;\n            timer = null;\n\n            const argsClone = [].concat(argsToPass);\n            argsToPass = [];\n\n            const promisifiedFn = promisify(fn);\n            promisifiedFn.apply(fn, argsClone).then((args)=> {\n                isExecuting = false;\n                const $def = queue.shift();\n                $def.isComplete = true;\n                return $def.resolve(args);\n            }, (e)=> {\n                isExecuting = false;\n                const $def = queue.shift();\n                $def.isComplete = true;\n                return $def.reject(e);\n            });\n        }, debounceInterval);\n        const prom = $def.promise();\n\n        return prom;\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils/general/debounce-and-merge.js","import { isNumber } from 'lodash';\n\nconst elClassesMap = new WeakMap();\nfunction deleteAddedClasses($el) {\n    const el = $el.get(0);\n    const addedClasses = elClassesMap.get(el);\n    if (addedClasses) {\n        $el.removeClass(addedClasses);\n    }\n}\n/**\n * @type AttributeHandler\n */\nconst classAttr = {\n    test: 'class',\n\n    target: '*',\n\n\n    unbind: function (attr, $el) {\n        const el = $el.get(0);\n        deleteAddedClasses($el);\n        elClassesMap.delete(el);\n    },\n\n    handle: function (value, prop, $el) {\n        if (Array.isArray(value)) {\n            value = value[value.length - 1];\n        }\n\n        const el = $el.get(0);\n        deleteAddedClasses($el);\n\n        if (isNumber(value)) {\n            value = 'value-' + value;\n        }\n        setTimeout(()=> {\n            $el.addClass(value); //If the classes have an animation set, removing with a timeout will trigger it\n        }, 0);\n        elClassesMap.set(el, value);\n    }\n};\n\nexport default classAttr;\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attribute-manager/attributes/class-attr/index.js","/**\n * @type AttributeHandler \n */\nconst booleanAttrHandler = {\n    target: '*',\n\n    test: /^(?:checked|selected|async|autofocus|autoplay|controls|defer|ismap|loop|multiple|open|required|scoped|disabled|hidden|readonly)$/i,\n\n    handle: function (value, prop, $el) {\n        if (Array.isArray(value)) {\n            value = value[value.length - 1];\n        }\n        const val = ($el.attr('value')) ? (value == $el.prop('value')) : !!value; //eslint-disable-line eqeqeq\n        $el.prop(prop, val);\n    }\n};\n\nexport default booleanAttrHandler;\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attribute-manager/attributes/boolean-attr/index.js","/**\n  * @type AttributeHandler\n  */\nconst showifHandler = {\n    test: 'showif',\n\n    target: '*',\n\n    init: function (attr, value, $el) {\n        $el.hide(); //hide by default; if not this shows text until data is fetched\n    },\n\n    handle: function (value, prop, $el) {\n        if (Array.isArray(value)) {\n            value = value[value.length - 1];\n        }\n        return (value && `${value}`.trim()) ? $el.show() : $el.hide();\n    }\n};\n\nexport default showifHandler;\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attribute-manager/attributes/toggles/show-if-attr/index.js","/**\n  * @type AttributeHandler\n  */\nconst hideifHandler = {\n    test: 'hideif',\n\n    target: '*',\n\n    init: function (attr, value, $el) {\n        $el.hide(); //hide by default; if not this shows text until data is fetched\n    },\n    handle: function (value, prop, $el) {\n        if (Array.isArray(value)) {\n            value = value[value.length - 1];\n        }\n        if (value && `${value}`.trim()) {\n            $el.hide();\n        } else {\n            $el.show();\n        }\n    }\n};\n\nexport default hideifHandler;\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attribute-manager/attributes/toggles/hide-if-attr/index.js","/**\n  * @type {AttributeHandler}\n  */\nconst checkboxAttrHandler = {\n\n    target: ':checkbox,:radio',\n\n    test: 'bind',\n\n    handle: function (value, prop, $el) {\n        if (Array.isArray(value)) {\n            value = value[value.length - 1];\n        }\n        const settableValue = $el.attr('value'); //initial value\n        const isChecked = (typeof settableValue !== 'undefined') ? (settableValue == value) : !!value; //eslint-disable-line eqeqeq\n        $el.prop('checked', isChecked);\n    }\n};\n\nexport default checkboxAttrHandler;\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attribute-manager/attributes/binds/checkbox-radio-bind-attr/index.js","/**\n * @type AttributeHandler \n */\nconst inputBindAttr = {\n    target: 'input, select, textarea',\n\n    test: 'bind',\n\n    handle: function (value, prop, $el) {\n        if (value === undefined) {\n            value = '';\n        } else if (Array.isArray(value)) {\n            value = value[value.length - 1];\n        }\n        $el.val(value + '');\n    }\n};\n\nexport default inputBindAttr;\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attribute-manager/attributes/binds/input-bind-attr/index.js","import { template } from 'lodash';\nimport { addContentAndAnimate } from 'utils/animation';\nimport { animation } from 'config';\n\nimport { extractVariableName, extractAlias, translateDataToTemplatable, translateDataToInsertable } from '../bind-utils';\n\nimport { getKnownDataForEl, updateKnownDataForEl, removeKnownData, findMissingReferences, stubMissingReferences, addBackMissingReferences, isTemplated, getOriginalContents, clearOriginalContents } from 'dom/attribute-manager/attr-template-utils';\n\nconst elAnimatedMap = new WeakMap(); //TODO: Can probably get rid of this if we make subscribe a promise and distinguish between initial value\n\nfunction toAliasMap(topics) {\n    return (topics || []).reduce((accum, topic)=> {\n        accum[topic.name] = topic.alias;   \n        return accum;\n    }, {});\n}\n\nfunction getNewContent(currentContents, value, $el, topics) {\n    if (!isTemplated(currentContents)) {\n        return translateDataToInsertable(value);\n    }\n\n    const templateData = translateDataToTemplatable(value, toAliasMap(topics));\n    const knownData = getKnownDataForEl($el);\n    $.extend(templateData, knownData);\n\n    const missingReferences = findMissingReferences(currentContents, Object.keys(templateData));\n    const stubbedTemplate = stubMissingReferences(currentContents, missingReferences);\n\n    const templateFn = template(stubbedTemplate);\n    try {\n        const templatedHTML = templateFn(templateData);\n        const templatedWithReferences = addBackMissingReferences(templatedHTML, missingReferences);\n        return templatedWithReferences;\n    } catch (e) { //you don't have all the references you need;\n        updateKnownDataForEl($el, templateData);\n        return currentContents;\n    }\n}\n\n/**\n * @type AttributeHandler \n */\nconst bindAttrHandler = {\n\n    target: '*',\n\n    test: 'bind',\n\n    parse: function (topics) {\n        return topics.map((topic)=> {\n            const attrVal = topic.name;\n            return {\n                name: extractVariableName(attrVal),\n                alias: extractAlias(attrVal),\n            };\n        });\n    },\n\n    //FIXME: Can't do this because if you have a bind within a foreach, foreach overwrites the old el with a new el, and at that points contents are lost\n    // But if i don't do this the <%= %> is going to show up\n    // init: function (attr, value, $el) {\n    //     const contents = getOriginalContents($el, ($el)=> $el.html());\n    //     if (isTemplated(contents)) {\n    //         $el.empty();\n    //     }\n    // },\n\n    unbind: function (attr, $el) {\n        const el = $el.get(0);\n        elAnimatedMap.delete(el);\n\n        const bindTemplate = getOriginalContents($el);\n        const current = $el.html();\n        if (bindTemplate && current !== bindTemplate) {\n            $el.html(bindTemplate);\n        }\n        clearOriginalContents($el);\n        removeKnownData($el);\n    },\n\n    handle: function (value, prop, $el, topics) {\n        const el = $el.get(0);\n        const originalContents = getOriginalContents($el, ($el)=> $el.html());\n        const contents = getNewContent(originalContents, value, $el, topics);\n\n        addContentAndAnimate($el, contents, !elAnimatedMap.has(el), animation);\n        elAnimatedMap.set(el, true);\n    }\n};\n\nexport default bindAttrHandler;\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attribute-manager/attributes/binds/default-bind-attr/index.js","export function translateDataToInsertable(value) {\n    if (Array.isArray(value)) {\n        value = value[value.length - 1];\n    }\n    value = ($.isPlainObject(value)) ? JSON.stringify(value) : value + '';\n    return value;\n}\n\n/**\n * @param {any} value\n * @param {object} aliasMap\n * @returns {{value: any}}\n */\nexport function translateDataToTemplatable(value, aliasMap) {\n    const templateData = { value: value };\n    if ($.isPlainObject(value)) {\n        Object.keys(value).forEach((originalName)=> {\n            const alias = aliasMap[originalName] || originalName;\n            templateData[alias] = value[originalName];\n        });\n    } else {\n        Object.keys(aliasMap).forEach((originalName)=> {\n            const alias = aliasMap[originalName] || originalName;\n            templateData[alias] = value;\n        });\n    }\n    \n    return templateData;\n}\n\nconst AS_REGEX = /(.*) (?:as)\\s+\\((.*)\\)/;\n\n/**\n * @param {string} attrVal \n * @returns {string}\n */\nexport function extractVariableName(attrVal) {\n    const asMatch = attrVal.trim().match(AS_REGEX);\n    const varName = asMatch && asMatch[1] ? asMatch[1] : attrVal;\n    return varName.trim();\n}\n\n/**\n * @param {string} attrVal \n * @returns {string}\n */\nexport function extractAlias(attrVal) {\n    const asMatch = attrVal.trim().match(AS_REGEX);\n    const alias = asMatch && asMatch[2] ? asMatch[2] : attrVal;\n    return alias.trim();\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attribute-manager/attributes/binds/bind-utils/index.js","/**\n * @type AttributeHandler \n */\nconst defaultAttr = {\n    test: '*',\n\n    target: '*',\n\n    handle: function (value, prop, $el) {\n        //FIXME: The _right_ way to do this would be to set attr, not prop. \n        //However Polymer 1.0 doesn't link attrs with stringified JSON, and that's really the primary use-case for this, so, ignoring\n        //However Polymer is fine with 'data-X' attrs having stringified JSON. Eventually we should make this attr and fix polymer\n        //but can't do that for backwards comptability reason. See commit bbc4a49039fb73faf1ef591a07b371d7d667cf57\n        $el.prop(prop, value);\n    }\n};\n\nexport default defaultAttr;\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attribute-manager/attributes/default-attr/index.js","/**\n * Hooks up dom elements to mutation observer\n * @param  {HTMLElement} target     root to start observing from\n * @param  {object} domManager \n * @param  {boolean} isEnabled Determines if it's enabled by default\n * @return {object}\n */\nexport default function (target, domManager, isEnabled) {\n    if (typeof MutationObserver === 'undefined') {\n        return;\n    }\n    // Create an observer instance\n    var observer = new MutationObserver(function (mutations) {\n        mutations.forEach(function (mutation) {\n            var added = $(mutation.addedNodes).find(':f');\n            added = added.add($(mutation.addedNodes).filter(':f'));\n            var removed = $(mutation.removedNodes).find(':f');\n            removed = removed.add($(mutation.removedNodes).filter(':f'));\n            if (added && added.length) {\n                domManager.bindAll(added);\n            }\n            if (removed && removed.length) {\n                domManager.unbindAll(removed);\n            }\n            if (mutation.attributeName === 'data-f-channel') {\n                domManager.unbindAll(mutation.target);\n                domManager.bindAll(mutation.target);\n            }\n        });\n    });\n    var mutconfig = {\n        attributes: true,\n        attributeFilter: ['data-f-channel'],\n        childList: true,\n        subtree: true,\n        characterData: false\n    };\n    var publicApi = {\n        enable: function () {\n            observer.observe(target, mutconfig);\n        },\n        disable: function () {\n            observer.disconnect();\n        }\n    };\n    if (isEnabled) {\n        publicApi.enable();\n    }\n    return publicApi;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/plugins/auto-update-bindings.js","import DefaultChannelManager from './channel-manager';\n\nimport router from 'channels/channel-router';\nimport { JSONRouteHandler, EpicenterRouteHandler } from './route-handlers';\nimport { interpolatable, routable } from './channel-manager-enhancements';\n\n//Moving connecting glue here so channel-manager can be tested in isolation\nconst InterpolatableRoutableChannelManager = interpolatable(routable(DefaultChannelManager, router));\nexport default function ChannelManager(opts) {\n    const defaultRouteHandlers = [JSONRouteHandler, EpicenterRouteHandler];\n    const routes = opts && opts.routes ? opts.routes : [];\n    const cm = new InterpolatableRoutableChannelManager($.extend(true, {}, {\n        routes: [].concat(routes, defaultRouteHandlers)\n    }, opts));\n    return cm;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/configured-channel-manager.js","import $ from 'jquery';\nimport { normalizeParamOptions, publishableToObject } from './channel-utils';\nimport { uniqueId, isFunction, intersection, uniq } from 'lodash';\n/**\n * \n * @param {String[]|String} topics \n * @param {Function} callback \n * @param {Object} options\n * @return {Subscription}\n */\nfunction makeSubs(topics, callback, options) {\n    const id = uniqueId('subs-');\n    const defaults = {\n        batch: false,\n\n        /**\n         * Determines if the last published data should be cached for future notifications. For e.g.,\n         *\n         * channel.subscribe(['price', 'cost'], callback1, { batch: true, cache: false });\n         * channel.subscribe(['price', 'cost'], callback2, { batch: true, cache: true });\n         *\n         * channel.publish({ price: 1 });\n         * channel.publish({ cost: 1 });\n         *\n         * callback1 will have been called once, and callback2 will not have been called. i.e., the channel caches the first publish value and notifies after all dependent topics have data\n         * If we'd done channel.publish({ price: 1, cost: 1 }) would have called both callback1 and callback2\n         *\n         * `cache: true` is useful if you know if your topics will can published individually, but you still want to handle them together.\n         * `cache: false` is useful if you know if your topics will *always* be published together and they'll be called at the same time.\n         *\n         * Note this has no discernible effect if batch is false\n         * @type {Boolean}\n         */\n        cache: true,\n    };\n    const opts = $.extend({}, defaults, options);\n    if (!callback || !isFunction(callback)) {\n        throw new Error('subscribe callback should be a function');\n    }\n    return $.extend(true, {\n        id: id,\n        topics: [].concat(topics),\n        callback: callback,\n    }, opts);\n}\n\nlet cacheBySubsId = {};\nlet sentDataBySubsId = {};\n\nfunction copy(data) {\n    if (Array.isArray(data)) {\n        return data.map((d)=> copy(d));\n    } else if ($.isPlainObject(data)) {\n        return Object.keys(data).reduce((accum, key)=> {\n            accum[key] = copy(data[key]);\n            return accum;\n        }, {});\n    }\n    return data;\n}\n/**\n* @param {Subscription} subscription \n* @param {*} data\n*/\nfunction callbackSubscriber(subscription, data) {\n    const id = subscription.id;\n    subscription.callback(data, { id: id, previousData: sentDataBySubsId[id] });\n    sentDataBySubsId[id] = copy(data);\n}\n\n/**\n* @param {Publishable[]} topics\n* @param {Subscription} subscription \n*/\nfunction checkAndNotifyBatch(topics, subscription) {\n    const publishData = publishableToObject(topics);\n    const matchingTopics = intersection(Object.keys(publishData), subscription.topics);\n    if (!matchingTopics.length) {\n        return;\n    }\n\n    const relevantDataFromPublish = matchingTopics.reduce((accum, topic)=> {\n        accum[topic] = publishData[topic];\n        return accum;\n    }, {});\n    const cachedDataForSubs = cacheBySubsId[subscription.id] || {};\n    const knownDataForSubs = $.extend({}, cachedDataForSubs, relevantDataFromPublish);//jQ Deep clone here will also concat arrays.\n\n    if (subscription.cache) {\n        cacheBySubsId[subscription.id] = knownDataForSubs;\n    }\n    const hasDataForAllTopics = intersection(Object.keys(knownDataForSubs), subscription.topics).length === subscription.topics.length;\n    if (hasDataForAllTopics) {\n        callbackSubscriber(subscription, knownDataForSubs);\n    }\n}\n\n\n/**\n * @param {Publishable[]} topics\n * @param {Subscription} subscription \n */\nfunction checkAndNotify(topics, subscription) {\n    topics.forEach(function (topic) {\n        const needsThisTopic = subscription.topics.indexOf(topic.name) !== -1;\n        const isWildCard = subscription.topics.indexOf('*') !== -1;\n        if (needsThisTopic || isWildCard) {\n            callbackSubscriber(subscription, { [topic.name]: topic.value });\n        }\n    });\n}\n\n/**\n* @param {Subscription[]} subcriptionList\n* @return {String[]}\n*/\nfunction getTopicsFromSubsList(subcriptionList) {\n    return subcriptionList.reduce(function (accum, subs) {\n        accum = accum.concat(subs.topics);\n        return accum;\n    }, []);\n}\n\n/**\n * @class ChannelManager\n */\nclass ChannelManager {\n    constructor(options) {\n        this.subscriptions = [];\n    }\n\n    /**\n     * @param {String | Publishable } topic\n     * @param {any} [value] item to publish\n     * @param {PublishOptions} [options]\n     * @return {Promise}\n     */\n    publish(topic, value, options) {\n        const normalized = normalizeParamOptions(topic, value, options);\n        let prom = $.Deferred().resolve(normalized.params).promise();\n        prom = prom.then((publishResponses)=> {\n            this.notify(publishResponses, options);\n            return publishResponses;\n        });\n        return prom;\n    }\n\n    notify(topic, value, options) {\n        const normalized = normalizeParamOptions(topic, value, options);\n        // console.log('notify', normalized.params);\n        return this.subscriptions.forEach(function (subs) {\n            const fn = subs.batch ? checkAndNotifyBatch : checkAndNotify;\n            fn(normalized.params, subs);\n        });\n    }\n\n    /**\n     * @param {String[] | String} topics\n     * @param {Function} cb\n     * @param {Object} [options]\n     * @return {String}\n     */\n    subscribe(topics, cb, options) {\n        const subs = makeSubs(topics, cb, options);\n        delete cacheBySubsId[subs.id]; //Just in case subsid is being reused\n        delete sentDataBySubsId[subs.id];\n        this.subscriptions = this.subscriptions.concat(subs);\n        return subs.id;\n    }\n        \n\n    /**\n     * @param {String} token\n     */\n    unsubscribe(token) {\n        const olderLength = this.subscriptions.length;\n        const remaining = this.subscriptions.filter(function (subs) {\n            return subs.id !== token;\n        });\n        if (remaining.length === olderLength) {\n            throw new Error('No subscription found for token ' + token);\n        }\n        delete cacheBySubsId[token];\n        delete sentDataBySubsId[token];\n        this.subscriptions = remaining;\n    }\n    unsubscribeAll() {\n        cacheBySubsId = {};\n        sentDataBySubsId = {};\n        this.subscriptions = [];\n    }\n\n    /**\n     * @return {String[]}\n     */\n    getSubscribedTopics() {\n        const list = uniq(getTopicsFromSubsList(this.subscriptions));\n        return list;\n    }\n\n    /**\n     * @param {String} [topic] optional topic to filter by\n     * @return {Subscription[]}\n     */\n    getSubscribers(topic) {\n        if (!topic) {\n            return this.subscriptions;\n        }\n        return this.subscriptions.filter(function (subs) {\n            return subs.topics.indexOf(topic) !== -1;\n        });\n    }\n}\n\nexport default ChannelManager;\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/channel-manager.js","module.exports = jQuery;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"jQuery\"\n// module id = 54\n// module chunks = 0","import _ from 'lodash';\n\n/**\n * @param {String} topic\n * @param {Handler[]} handlers\n * @param {any} [matchOptions] options to pass on to matcher\n * @return {Handler | undefined}\n */\nexport function findBestHandler(topic, handlers, matchOptions) {\n    for (var i = 0; i < handlers.length; i++) {\n        var thishandler = handlers[i];\n        var match = thishandler.match(topic, matchOptions);\n        if (match !== false) {\n            return $.extend(true, {}, thishandler, { matched: match });\n        }\n    }\n    return undefined;\n}\n\n/**\n * [groupByHandlers description]\n * @param  {String[]} topics   List of topics to match. Format can be anything your handler.match function handles\n * @param  {Handler[]} handlers Handlers of type [{ match: func }]\n * @return {HandlerWithTopics[]} The handler array with each item now having an additional 'data' attr added to it with the matching topics\n */\nexport function groupByHandlers(topics, handlers) {\n    handlers = handlers.map(function (h, index) {\n        h.key = index;\n        return h;\n    });\n    var topicMapping = ([].concat(topics)).reduce(function (accum, topic) {\n        var bestHandler = findBestHandler(topic, handlers);\n        if (bestHandler) {\n            //if handler matches different strings treat both as different handlers\n            var key = bestHandler.key + bestHandler.matched;\n            if (!accum[key]) {\n                bestHandler.data = [];\n                accum[key] = bestHandler;\n            }\n            accum[key].data.push(topic);\n        }\n        return accum;\n    }, {});\n    return _.values(topicMapping);\n}\n\n/**\n * Takes a `publish` dataset and groups it by handler maintaining the data sequence\n * @param  {Publishable[]} data     Of the form [{ name: 'X', }]\n * @param  {Handler[]} handlers Handlers of type [{ match: func }]\n * @return {HandlerWithData[]} The handler array with each item now having an additional 'data' attr added to it with the publishable data\n */\nexport function groupSequentiallyByHandlers(data, handlers) {\n    handlers = handlers.map(function (h, index) {\n        h.key = index;\n        return h;\n    });\n    var grouped = data.reduce(function (accum, dataPt) {\n        var lastHandler = accum[accum.length - 1];\n        var bestHandler = findBestHandler(dataPt.name, handlers, true);\n        if (bestHandler) {\n            if (lastHandler && bestHandler.key === lastHandler.key) {\n                lastHandler.data.push(dataPt);\n            } else {\n                accum.push($.extend({}, bestHandler, { data: [dataPt] }));\n            }\n        } else {\n            accum.push({ data: [dataPt], matched: false });\n        }\n        return accum;\n    }, []);\n    return grouped;\n}\n\n\n/**\n * @param {any} response \n * @param {string[]} topics \n * @returns {Publishable[]}\n */\nexport function normalizeSubscribeResponse(response, topics) {\n    // @ts-ignore\n    if (response === undefined) {\n        return [];\n    }\n    const isAlreadyInPublishableFormat = Array.isArray(response) && (!response.length || response[0].name !== undefined);\n    if (isAlreadyInPublishableFormat) {\n        return response; \n    }\n    if (typeof response === 'object' && !Array.isArray(response)) {\n        return topics.reduce((accum, t)=> {\n            accum.push({ name: t, value: response[t] });\n            return accum; \n        }, []);\n    }\n    if (topics.length === 1) { //it's not in a publishable format, so someone just returned a string or something\n        const name = topics[0];\n        return [{ name: name, value: response }];\n    }\n    throw new Error('unrecognized subscribe response format');\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/channel-router/utils/handler-utils.js","/**\n * @param {Publishable[]} published \n * @param {boolean|String[]|{except: String[]}} [silentOptions]\n * @return {Publishable[]} filtered list\n */\nexport default function silencable(published, silentOptions) {\n    if (silentOptions === true || !published) {\n        return [];\n    } else if (Array.isArray(silentOptions)) {\n        return published.filter((data)=> {\n            const found = silentOptions.indexOf(data.name) !== -1;\n            return !found;\n        });\n    } else if (silentOptions && silentOptions.except) {\n        return published.filter((data)=> {\n            const found = (silentOptions.except || []).indexOf(data.name) !== -1;\n            return found;\n        });\n    }\n    return published;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/channel-router/utils/silencable.js","import { isFunction } from 'lodash';\n\n/**\n * \n * @param {Publishable[]} publishable \n * @param {boolean|string[]|Function} readOnlyOptions \n * @return {Publishable[]} filtered list\n */\nexport default function excludeReadOnly(publishable, readOnlyOptions) {\n    if (isFunction(readOnlyOptions)) {\n        readOnlyOptions = readOnlyOptions();\n    }\n    if (readOnlyOptions === true) {\n        console.error('Tried to publish to a readonly channel', publishable);\n        return [];\n    }  \n    if (Array.isArray(readOnlyOptions)) {\n        const split = publishable.reduce((accum, data)=> {\n            const isReadonly = readOnlyOptions.indexOf(data.name) !== -1;\n            if (isReadonly) {\n                accum.readOnly.push(data);\n            } else {\n                accum.remaining.push(data);\n            }\n            return accum;\n        }, { readOnly: [], remaining: [] });\n        \n        if (split.readOnly.length) {\n            console.warn('Ignoring readonly publishes', split.readOnly);\n        }\n        return split.remaining;\n    }\n    return publishable;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/channel-router/utils/exclude-read-only.js","export { default as JSONRouteHandler } from './json-route-handler';\nexport { default as EpicenterRouteHandler } from './epicenter-route-handlers';\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/index.js","import { toImplicitType } from 'utils/parse-utils';\n\nexport function match(topic) {\n    var parsed = toImplicitType(topic);\n    return typeof parsed !== 'string' ? '' : false;\n}\n\nexport default {\n    match: match,\n    name: 'JSON Route',\n    subscribeHandler: function (topics) {\n        const parsed = topics.map((t)=> {\n            return {\n                name: t,\n                value: toImplicitType(t)\n            };\n        });\n        return parsed;\n    }\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/json-route-handler/index.js","import DefaultRunRouteHandler from './default-run-route-handler';\nimport ScenarioRouteHandler from './scenario-route-handler';\nimport RunidRouteHandler from './runid-route-handler';\nimport WorldRouteHandler from './world-route-handler';\n\nimport MultiRunRouteHandler from './multi-run-route-handler';\n\n\nimport { withPrefix } from 'channels/channel-router/utils';\nimport { matchPrefix, matchDefaultPrefix, matchRegex } from 'channels/route-handlers/route-matchers';\n\nimport router from 'channels/channel-router';\n\nfunction getOptions(opts, key) {\n    var serviceOptions = $.extend(true, {}, opts.defaults, opts[key]);\n    var channelOptions = $.extend(true, {}, serviceOptions.channelOptions);\n    delete serviceOptions.channelOptions;\n\n    return { serviceOptions: serviceOptions, channelOptions: channelOptions };\n}\n\nvar SCENARIO_PREFIX = 'sm:';\nvar RUN_PREFIX = 'rm:';\nconst WORLD_PREFIX = 'world:';\n\nvar sampleRunidLength = '000001593dd81950d4ee4f3df14841769a0b'.length;\nvar runidRegex = '(?:.{' + sampleRunidLength + '})';\n\nexport default function EpicenterRouteHandler(config, notifier, channelManagerContext) {\n    var opts = $.extend(true, {}, config);\n\n    var runidHandlerOpts = getOptions(opts, 'runid');\n    var runidHandler = new RunidRouteHandler(runidHandlerOpts, notifier);\n    var multiRunHandler = new MultiRunRouteHandler(runidHandlerOpts, withPrefix(notifier, 'runs'), channelManagerContext);\n    // var userChannel = new UserRouter(getOptions(opts, 'runManager').run, withPrefix(notifier, 'user:'), channelManagerContext);\n    \n    /** @type {Handler[]} **/\n    var handlers = [\n        $.extend({}, runidHandler, { \n            name: 'customRun',\n            match: matchRegex(runidRegex),\n            options: runidHandlerOpts.channelOptions,\n        }), \n        $.extend({}, multiRunHandler, {\n            name: 'archiveRuns',\n            match: matchPrefix('runs:'),\n            options: runidHandlerOpts.channelOptions,\n        }),  \n        // $.extend({}, userChannel, {\n        //     name: 'User Channel',\n        //     match: matchPrefix('user:'),\n        // })\n    ];\n    var exposable = {};\n\n    var runManagerOpts = getOptions(opts, 'runManager');\n    if (opts.runManager || (!opts.scenarioManager && runManagerOpts.serviceOptions.run)) {\n        var rm;\n        const isMultiplayer = runManagerOpts.serviceOptions.strategy === 'multiplayer';\n        if (opts.scenarioManager) {\n            rm = new DefaultRunRouteHandler(runManagerOpts, withPrefix(notifier, RUN_PREFIX));\n            handlers.push($.extend({}, rm, { \n                name: 'run',\n                match: matchPrefix(RUN_PREFIX), //if both scenario manager and run manager are being used, require a prefix\n                options: runManagerOpts.channelOptions,\n            }));\n        } else if (isMultiplayer) {\n            //Ignore case where both scenario manager and multiplayer are being used\n            rm = new WorldRouteHandler(runManagerOpts, withPrefix(notifier, [WORLD_PREFIX, '']));\n            handlers.push($.extend({}, rm, { \n                name: 'World run',\n                match: matchDefaultPrefix(WORLD_PREFIX),\n                isDefault: true,\n                options: runManagerOpts.channelOptions,\n            }));\n        } else {\n            rm = new DefaultRunRouteHandler(runManagerOpts, withPrefix(notifier, [RUN_PREFIX, '']));\n            handlers.push($.extend({}, rm, { \n                name: 'run',\n                match: matchDefaultPrefix(RUN_PREFIX),\n                isDefault: true,\n                options: runManagerOpts.channelOptions,\n            }));\n        }\n\n        $.extend(exposable, rm.expose);\n    }\n\n    if (opts.scenarioManager) {\n        var scenarioManagerOpts = getOptions(opts, 'scenarioManager');\n        var sm = new ScenarioRouteHandler(scenarioManagerOpts, withPrefix(notifier, [SCENARIO_PREFIX, '']));\n        handlers.push($.extend({}, sm, { \n            name: 'scenario',\n            match: matchDefaultPrefix(SCENARIO_PREFIX),\n            options: scenarioManagerOpts.channelOptions,\n            isDefault: true,\n        }));\n\n        $.extend(exposable, sm.expose);\n    }\n\n    var epicenterRouter = router(handlers, notifier);\n    epicenterRouter.expose = exposable;\n    \n    return epicenterRouter;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/epicenter-route-handlers/index.js","import RunRouteHandler from '../run-route-handler';\n\nimport { withPrefix } from 'channels/channel-router/utils';\nimport router from 'channels/channel-router';\nimport { matchDefaultPrefix } from 'channels/route-handlers/route-matchers';\n\nconst { F } = window;\n\nconst RUN_PREFIX = 'current:';\n\nexport default function RunManagerRouteHandler(config, notifier) {\n    const defaults = {\n        serviceOptions: {},\n        channelOptions: {}\n    };\n    const opts = $.extend(true, {}, defaults, config);\n\n    const rmOptions = opts.serviceOptions;\n    const rm = new F.manager.RunManager(rmOptions);\n\n    const $creationPromise = rm.getRun().then((run)=> {\n        return rm.run;\n    });\n    const currentChannelOpts = $.extend(true, \n        { serviceOptions: $creationPromise }, opts.defaults, opts.current);\n    const currentRunChannel = new RunRouteHandler(currentChannelOpts, withPrefix(notifier, [RUN_PREFIX, '']));\n\n    const runRouteHandler = $.extend(currentRunChannel, { \n        match: matchDefaultPrefix(RUN_PREFIX), //TODO: Just remove prefix?\n        name: 'Current Run',\n        isDefault: true,\n        options: currentChannelOpts.channelOptions,\n    });\n    const handlers = [\n        runRouteHandler\n    ];\n\n    const runMangerRouter = router(handlers);\n    runMangerRouter.expose = { runManager: rm };\n\n    return runMangerRouter;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/epicenter-route-handlers/default-run-route-handler/index.js","import { objectToPublishable, publishableToObject } from 'channels/channel-utils';\nimport { intersection } from 'lodash';\n\nexport default function RunMetaRouteHandler($runServicePromise, notifier) {\n\n    function mergeAndSend(runMeta, requestedTopics) {\n        var toSend = ([].concat(requestedTopics)).reduce(function (accum, meta) {\n            accum.push({ name: meta, value: runMeta[meta] });\n            return accum;\n        }, []);\n        return toSend;\n        // return notifier(toSend);\n    }\n    return {\n        subscribeHandler: function (topics, options) {\n            topics = [].concat(topics);\n            \n            return $runServicePromise.then(function (runService) {\n                var cachedValues = intersection(Object.keys(runService.runMeta || {}), topics);\n                if (options.autoFetch === false) {\n                    return $.Deferred().resolve({}).promise();\n                } else if (cachedValues.length === topics.length) {\n                    //FIXME: Add 'updated time' to meta, and fetch if that's < debounce interval -- use the custom debounce fn with the custom merge (debounce save as well?)\n                    //Make run service factory return patched run-service?\n                    return $.Deferred().resolve(mergeAndSend(runService.runMeta, topics)).promise();\n                } if (!runService.loadPromise) {\n                    runService.loadPromise = runService.load().then(function (data) {\n                        runService.runMeta = data;\n                        return data;\n                    });\n                } \n                return runService.loadPromise.then(function (data) {\n                    return mergeAndSend(data, topics);\n                });\n            });\n        },\n        publishHandler: function (topics, options) {\n            return $runServicePromise.then(function (runService) {\n                var toSave = publishableToObject(topics);\n                return runService.save(toSave).then(function (res) {\n                    runService.runMeta = $.extend({}, true, runService.runMeta, res);\n                    return objectToPublishable(res);\n                });\n            });\n        }\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/epicenter-route-handlers/run-route-handler/run-meta-route-handler.js","import { debounceAndMerge } from 'utils/general';\nimport { objectToPublishable, publishableToObject } from 'channels/channel-utils';\nimport { uniqueId, uniq, difference } from 'lodash';\nimport { retriableFetch } from './retriable-variable-fetch';\n// import { optimizedFetch } from './optimized-variables-fetch';\n\nfunction mergeVariables(accum, newval) {\n    if (!accum) {\n        accum = [];\n    }\n    const merged = uniq(accum.concat(newval)).filter((v)=> !!(v && v.trim()));\n    // console.log(merged, 'merged');\n    return merged;\n}\n\nexport default function RunVariablesRouteHandler($runServicePromise, notifier) {\n    const id = uniqueId('variable-route-handler');\n\n    function debouncedVariableQuery(runService, debounceInterval) {\n        if (!runService.debouncedFetchers) {\n            runService.debouncedFetchers = {};\n        }\n        if (!runService.debouncedFetchers[id]) {\n            runService.debouncedFetchers[id] = debounceAndMerge(function (variables) {\n                return retriableFetch(runService, variables);\n            }, debounceInterval, [mergeVariables]);\n        }\n        return runService.debouncedFetchers[id];\n    }\n\n    let knownTopics = [];\n    return { \n        /**\n         * @param {{exclude:? boolean}} options \n         * @return {Promise}\n         */\n        fetch: function (options) {\n            const opts = $.extend({ exclude: [] }, options);\n            return $runServicePromise.then(function (runService) {\n                const variablesToFetch = difference([].concat(knownTopics), opts.exclude);\n                if (!variablesToFetch.length) {\n                    return [];\n                }\n                return retriableFetch(runService, [].concat(variablesToFetch)).then(objectToPublishable).then(notifier);\n            });\n        },\n\n        unsubscribeHandler: function (unsubscribedTopics, remainingTopics) {\n            knownTopics = knownTopics.filter((t)=> unsubscribedTopics.indexOf(t) === -1);\n        },\n        subscribeHandler: function (topics, options) {\n            console.log('subscribe', JSON.stringify(topics));\n            const isAutoFetchEnabled = options.autoFetch;\n            const debounceInterval = options.debounce;\n\n            return $runServicePromise.then(function (runService) {\n                knownTopics = uniq(knownTopics.concat(topics));\n                if (!knownTopics.length) {\n                    return $.Deferred().resolve([]).promise();\n                } else if (!isAutoFetchEnabled) {\n                    return $.Deferred().resolve(topics).promise();\n                }\n                return debouncedVariableQuery(runService, debounceInterval)(topics).then((response)=> {\n                    const missingVariables = difference(topics, Object.keys(response));\n                    if (missingVariables.length) {\n                        return $.Deferred().reject({\n                            context: missingVariables,\n                            message: `Missing variables: ${missingVariables.join(',')}`\n                        }).promise();\n                    }\n                    return response;\n                });\n            });\n        },\n        notify: function (variableObj) {\n            return $runServicePromise.then(function (runService) {\n                const variables = Object.keys(variableObj); \n                return retriableFetch(runService, variables).then(objectToPublishable).then(notifier);\n            });\n        },\n        publishHandler: function (topics, options) {\n            return $runServicePromise.then(function (runService) {\n                const toSave = publishableToObject(topics);\n                return runService.variables().save(toSave).then(function (response) {\n                    const variables = Object.keys(toSave); \n                    //Get the latest from the server because what you think you saved may not be what was saved\n                    //bool -> 1, scalar to array for time-based models etc\n                    return retriableFetch(runService, variables).then(objectToPublishable);\n                });\n            });\n        }\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/epicenter-route-handlers/run-route-handler/run-variables-route-handler.js","//Opaquely handle missing variables\nexport function retriableFetch(runService, variables) {\n    if (!variables || !variables.length) {\n        return $.Deferred().resolve({}).promise();\n    }\n    return runService.variables().query(variables).catch((e)=> {\n        const response = e.responseJSON;\n        const info = response.information;\n        if (info.code !== 'VARIABLE_NOT_FOUND') {\n            throw e;\n        }\n        const goodVariables = variables.filter((vName)=> {\n            const baseName = vName.split('[')[0];\n            const isBad = info.context.names.indexOf(baseName) !== -1;\n            return !isBad;\n        });\n        return retriableFetch(runService, goodVariables);\n    });\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/epicenter-route-handlers/run-route-handler/retriable-variable-fetch.js","export default function RunOperationsRouteHandler($runServicePromise, notifier) {\n    return {\n        notify: function (operationsResponse) {\n            const parsed = [{ name: operationsResponse.name, value: operationsResponse.result }];\n            return notifier(parsed);\n        },\n\n        subscribeHandler: function () {\n            return [];\n        },\n        publishHandler: function (topics, options) {\n            return $runServicePromise.then(function (runService) {\n                const toSave = topics.map(function (topic) {\n                    return { name: topic.name, params: topic.value };\n                });\n                return runService.serial(toSave).then(function (result) {\n                    const toReturn = result.map(function (response, index) {\n                        return { name: topics[index].name, value: response.result };\n                    });\n                    return toReturn;\n                });\n            });\n        }\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/epicenter-route-handlers/run-route-handler/run-operations-route-hander.js","import RunRouteHandler from '../run-route-handler';\nimport { withPrefix } from 'channels/channel-router/utils';\nimport router from 'channels/channel-router';\nimport { matchPrefix, matchDefaultPrefix, } from 'channels/route-handlers/route-matchers';\n\n\nexport default function ScenarioManagerRouteHandler(config, notifier) {\n    var defaults = {\n        serviceOptions: {},\n        channelOptions: {},\n    };\n    var opts = $.extend(true, {}, defaults, config);\n\n    var sm = new window.F.manager.ScenarioManager(opts.serviceOptions);\n\n    var baselinePromise = sm.baseline.getRun().then(()=> sm.baseline.run);\n    var baselineOptions = $.extend(true, {\n        serviceOptions: baselinePromise,\n        channelOptions: {\n            meta: {\n                readOnly: true\n            },\n            variables: {\n                readOnly: true\n            }\n        }\n    }, opts.defaults, opts.baseline);\n    var currentRunPromise = sm.current.getRun().then(()=> sm.current.run);\n\n    var runOptions = $.extend(true, {\n        serviceOptions: currentRunPromise,\n    }, opts.defaults, opts.current);\n\n    var baselineHandler = new RunRouteHandler(baselineOptions, withPrefix(notifier, 'baseline:'));\n    var currentRunHandler = new RunRouteHandler(runOptions, withPrefix(notifier, ['current:', '']));\n    var handlers = [\n        $.extend(baselineHandler, {\n            name: 'baseline',\n            match: matchPrefix('baseline:'),\n            options: baselineOptions.channelOptions,\n        }),\n        $.extend(currentRunHandler, { \n            isDefault: true, \n            name: 'current',\n            match: matchDefaultPrefix('current:'),\n            options: runOptions.channelOptions,\n        }),\n\n    ];\n    \n    var scenarioManagerRouter = router(handlers, notifier);\n    scenarioManagerRouter.expose = { scenarioManager: sm };\n    return scenarioManagerRouter;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/epicenter-route-handlers/scenario-route-handler/index.js","import runChannelFactory from '../run-router-factory';\nimport { withPrefix, stripSuffixDelimiter } from 'channels/channel-router/utils';\n\nexport default function RunidRouteHandler(options, notifier) {\n    if (!options) options = {};\n\n    var opts = {};\n    opts.serviceOptions = options.serviceOptions && options.serviceOptions.run ? options.serviceOptions.run : {};\n    opts.channelOptions = options.channelOptions;\n\n    return {\n        subscribeHandler: function (topics, options, prefix) {\n            var runid = stripSuffixDelimiter(prefix);\n            //FIXME: Should i merge options here?\n            var channel = runChannelFactory(runid, opts, withPrefix(notifier, prefix));\n            return channel.subscribeHandler(topics, options, prefix);\n        },\n        publishHandler: function (topics, options, prefix) {\n            var runid = stripSuffixDelimiter(prefix);\n            var channel = runChannelFactory(runid, opts, withPrefix(notifier, prefix));\n            return channel.publishHandler(topics);\n        }\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/epicenter-route-handlers/runid-route-handler/index.js","import RunRouteHandler from './run-route-handler';\nvar knownRunIDServiceChannels = {};\n\nexport default function (runid, options, notifier) {\n    var runChannel = knownRunIDServiceChannels[runid];\n    if (!runChannel) {\n        var runOptions = $.extend(true, {}, options, { serviceOptions: { id: runid } });\n        runChannel = new RunRouteHandler(runOptions, notifier);\n        knownRunIDServiceChannels[runid] = runChannel;\n    }\n    return runChannel;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/epicenter-route-handlers/run-router-factory.js","import WorldUsersRouteHandler from './world-users-route-handler';\nimport WorldCurrentUserRouteHandler from './world-current-user-route-handler';\nimport ConsensusRouteHandler from './consensus-route-handler';\n\nimport { withPrefix } from 'channels/channel-router/utils';\nimport { matchPrefix, matchDefaultPrefix } from 'channels/route-handlers/route-matchers';\n\nimport RunRouteHandler from '../run-route-handler';\nimport router from 'channels/channel-router';\n\nconst { F } = window;\n\nconst RUN_PREFIX = 'run:';\nconst MULTI_USER_PREFIX = 'users:';\nconst USER_PREFIX = 'user:';\nconst CONSENSUS_PREFIX = 'consensus:';\n\n//TODO: Add custom worldid channel as well\nexport default function WorldRoutesHandler(config, notifier) {\n    const defaults = {\n        serviceOptions: {},\n        channelOptions: {}\n    };\n    const opts = $.extend(true, {}, defaults, config);\n\n    const rmOptions = opts.serviceOptions;\n    const rm = new F.manager.RunManager(rmOptions);\n    \n    let runPromise = null;\n    function getRun() {\n        if (!runPromise) {\n            runPromise = rm.getRun().then((run)=> {\n                if (!run.world) {\n                    console.error('No world found in run. Make sure you\\'re using EpicenterJS version > 2.7');\n                    throw new Error('Could not find world');\n                }\n                return run;\n            }, (err)=> {\n                console.error('Run manager get run error', err);\n                throw err;\n            });\n        }\n        return runPromise;\n    }\n    const $runPromise = getRun().then((run)=> {\n        const alreadyStubbedRunChannel = rm.run.channel; //FIXME: Explicitly pass instead of stubbing on a channel\n        if (alreadyStubbedRunChannel) {\n            return rm.run;\n        }\n        const channelManager = new F.manager.ChannelManager();\n        const worldChannel = channelManager.getWorldChannel(run.world);\n\n        worldChannel.subscribe(worldChannel.TOPICS.RUN_RESET, (run)=> {\n            rm.run.updateConfig({ filter: run.id });//Run handler is also listening on the run and will take care of notifying\n        }, this, { includeMine: false });\n        rm.run.channel = worldChannel;\n        return rm.run;\n    });\n\n    const currentRunHandlerOpts = $.extend(true, { serviceOptions: $runPromise }, opts.defaults, opts.current);\n    const currentRunHandler = new RunRouteHandler(currentRunHandlerOpts, withPrefix(notifier, [RUN_PREFIX, '']));\n\n    const handlers = [];\n\n    const runRouteHandler = $.extend(currentRunHandler, { \n        match: matchDefaultPrefix(RUN_PREFIX),\n        name: 'World Run',\n        isDefault: true,\n        options: currentRunHandlerOpts.channelOptions,\n    });\n    handlers.unshift(runRouteHandler);\n\n    let $worldProm = null;\n    function getWorld() {\n        if (!$worldProm) {\n            $worldProm = getRun().then((run)=> {\n                return run.world;\n            });\n        }\n        return $worldProm;\n    }\n\n    const worldChannelMap = {};\n    const channelManager = new F.manager.ChannelManager();\n    function getChannelForWorld(worldid) {\n        if (!worldChannelMap[worldid]) {\n            worldChannelMap[worldid] = channelManager.getWorldChannel(worldid);\n        }\n        return worldChannelMap[worldid];\n    }\n\n    const am = new F.manager.AuthManager();\n    const handlerOptions = {\n        serviceOptions: {\n            getRun: getRun,\n            getWorld: getWorld,\n            getSession: ()=> am.getCurrentUserSessionInfo(),\n            getChannel: getChannelForWorld,\n        },\n        channelOptions: {}\n    };\n    \n    const usersRouteHandler = new WorldUsersRouteHandler(handlerOptions, withPrefix(notifier, MULTI_USER_PREFIX));\n    const usersHandler = $.extend(usersRouteHandler, { \n        match: matchPrefix(MULTI_USER_PREFIX),\n        name: 'world users',\n    });\n    handlers.unshift(usersHandler);\n    \n    const currentUserRouteHandler = new WorldCurrentUserRouteHandler(handlerOptions, withPrefix(notifier, USER_PREFIX));\n    const currentUserHandler = $.extend(currentUserRouteHandler, {\n        match: matchPrefix(USER_PREFIX),\n        name: 'world current user',\n    });\n    handlers.unshift(currentUserHandler);\n\n    const ConsensusManager = window.F.manager.ConsensusManager;\n    if (ConsensusManager) { //epijs < 2.80 did not have this\n        const consensusRouteHandler = new ConsensusRouteHandler(handlerOptions, withPrefix(notifier, CONSENSUS_PREFIX));\n        const consensusHandler = $.extend(consensusRouteHandler, {\n            match: matchPrefix(CONSENSUS_PREFIX),\n            name: 'consensus',\n        });\n        handlers.unshift(consensusHandler);\n    }\n\n    const worldRouteHandler = router(handlers);\n    worldRouteHandler.expose = { runManager: rm };\n\n    return worldRouteHandler;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/epicenter-route-handlers/world-route-handler/index.js","const F = window.F;\n\nexport default function WorldUsersRouteHandler(config, notifier) {\n    const options = $.extend(true, {\n        serviceOptions: {},\n        channelOptions: {},\n    }, config);\n\n    const { getWorld, getSession, getChannel } = options.serviceOptions;\n\n    const store = {\n        users: [],\n        mark: (userid, isOnline)=> {\n            store.users = store.users.map((u)=> {\n                if (u.userId === userid) {\n                    u.isOnline = isOnline;\n                }\n                return u;\n            });\n            return store.users;\n        }\n    };\n    \n    const parsedUsersPromise = getWorld().then((world)=> {\n        const session = getSession();\n        const parsed = world.users.map((u)=> {\n            u.name = u.lastName;\n            u.isMe = u.userId === session.userId;\n            u.isOnline = u.isMe; //Assume i'm the only online one by default\n            return u;\n        });\n        store.users = parsed;\n        return parsed;\n    });\n    \n    let presenceSubsId;\n    return { \n        unsubscribeHandler: function (knownTopics, remainingTopics) {\n            if (remainingTopics.length || !presenceSubsId) {\n                return;\n            }\n            getWorld().then((world)=> {\n                const worldChannel = getChannel(world.id);\n                worldChannel.unsubscribe(presenceSubsId);\n                presenceSubsId = null;\n            });\n\n        },\n        subscribeHandler: function (userids) {\n            if (!presenceSubsId) {\n                //TODO: Also listen to roles channel to update users\n                getWorld().then((world)=> {\n                    const worldChannel = getChannel(world.id);\n                    presenceSubsId = worldChannel.subscribe(worldChannel.TOPICS.PRESENCE, (user, meta)=> {\n                        const userid = user.id;\n                        store.mark(userid, user.isOnline);\n                        return notifier([{ name: '', value: store.users }]);\n                    }, { includeMine: false });\n                });\n            }\n            return parsedUsersPromise.then((users)=> {\n                return [{ name: '', value: users }];\n            });\n        },\n        publishHandler: function (topics, options) {\n            const ps = new F.service.Presence();\n            topics.forEach((topic)=> {\n                const split = topic.name.split(':');\n                if (split[1]) {\n                    if (split[1] === 'markOnline') {\n                        ps.markOnline(split[0]);\n                    } else if (split[1] === 'markOffline') {\n                        ps.markOffline(split[0]);\n                    }\n                }\n            });\n            return topics;\n        }\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/epicenter-route-handlers/world-route-handler/world-users-route-handler/index.js","export default function WorldCurrentUserRouteHandler(config, notifier) {\n    const options = $.extend(true, {\n        serviceOptions: {},\n        channelOptions: {},\n    }, config);\n\n    const { getWorld, getSession, getChannel } = options.serviceOptions;\n\n    \n    let subsid;\n\n    const store = $.extend(true, {\n        isMe: true,\n        isOnline: true,\n    }, getSession());\n\n    return { \n        unsubscribeHandler: function (unsubscribedTopics, remainingTopics) {\n            const stillNeedRoles = remainingTopics.indexOf('role') !== -1;\n            if (!stillNeedRoles && subsid) {\n                getWorld().then((world)=> {\n                    const worldChannel = getChannel(world.id);\n                    worldChannel.unsubscribe(subsid);\n                });\n                subsid = null;\n            }\n        },\n        subscribeHandler: function (userFields) {\n            return getWorld().then((world)=> {\n                const session = getSession();\n                const myUser = world.users.find((user)=> {\n                    return user.userId === session.userId;\n                });\n                $.extend(store, myUser);\n                \n                const toNotify = userFields.reduce((accum, field)=> {\n                    if (field === '') { //the entire user object\n                        accum.push({ name: field, value: store });\n                    } else if (store[field] !== undefined) {\n                        accum.push({ name: field, value: store[field] });\n                    }\n                    return accum;\n                }, []);\n                \n                const isSubscribingToRole = userFields.indexOf('role') !== -1;\n                if (isSubscribingToRole && !subsid) {\n                    const worldChannel = getChannel(world.id);\n                    subsid = worldChannel.subscribe(worldChannel.TOPICS.ROLES, (users, meta)=> {\n                        const myUser = users.find((u)=> {\n                            return u.userId === session.userId;\n                        });\n                        if (myUser && myUser.role !== store.role) {\n                            store.role = myUser.role;\n                            notifier([{ name: 'role', value: myUser.role }]);\n                        }\n                    });\n                }\n                return toNotify;\n            });\n        }\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/epicenter-route-handlers/world-route-handler/world-current-user-route-handler/index.js","import OperationsHandler from './consensus-operations-handler';\nimport StatusHandler from './consensus-status-handler';\nimport router from 'channels/channel-router';\nimport { matchPrefix } from 'channels/route-handlers/route-matchers';\nimport { withPrefix } from 'channels/channel-router/utils';\n\nconst ConsensusManager = window.F.manager.ConsensusManager;\n\nconst OPERATIONS_PREFIX = 'operations:';\n\nexport default function ConsensusRouteHandler(config, notifier) {\n    const options = $.extend(true, {\n        serviceOptions: {},\n        channelOptions: {},\n    }, config);\n\n    const { getWorld, getRun, getSession, getChannel } = options.serviceOptions;\n\n    const cm = new ConsensusManager();\n\n    let consensusProm = null;\n    function getConsensus(force) {\n        if (!consensusProm || force) {\n            consensusProm = getRun().then(()=> {\n                return cm.getCurrent(); //TODO: GetRun deletes the barrier if it overlaps with this call, so synchronize them\n            });\n        }\n        return consensusProm;\n    }\n\n    const handlerOptions = {\n        serviceOptions: {\n            getConsensus: getConsensus,\n            getSession: getSession\n        },\n        channelOptions: {}\n    };\n\n    const opnHandler = OperationsHandler(handlerOptions, withPrefix(notifier, OPERATIONS_PREFIX));\n    const statusHandler = StatusHandler(handlerOptions, notifier);\n\n    const handlers = [\n        $.extend({}, opnHandler, { \n            name: 'consensus operations',\n            match: matchPrefix(OPERATIONS_PREFIX),\n            options: handlerOptions.channelOptions.operations,\n        }),\n        $.extend({}, statusHandler, { \n            name: 'consensus status',\n            match: matchPrefix(''),\n            isDefault: true,\n            options: handlerOptions.channelOptions.status,\n        }),\n    ];\n\n    getWorld().then((world)=> {\n        const channel = getChannel(world.id);\n        channel.subscribe(channel.TOPICS.RUN_RESET, ()=> {\n            getConsensus(true).then((consensus)=> {\n                statusHandler.notify(consensus);\n            });\n        });\n        // FIXME: Filter by stage here\n        channel.subscribe(channel.TOPICS.CONSENSUS_UPDATE, (consensus)=> {\n            const isComplete = consensus.closed;\n            if (isComplete) {\n                getConsensus(true).then((consensus)=> {\n                    statusHandler.notify(consensus);\n                });\n            } else {\n                statusHandler.notify(consensus);\n            }\n        });\n    });\n\n    var consensusRouteHandler = router(handlers, notifier);\n    consensusRouteHandler.expose = { consensusManager: cm };\n    \n    return consensusRouteHandler;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/epicenter-route-handlers/world-route-handler/consensus-route-handler/index.js","import { makeConsensusService } from './consensus-utils';\n\nexport default function ConsensusOperationsHandler(config, notifier) {\n    const options = $.extend(true, {\n        serviceOptions: {},\n        channelOptions: {},\n    }, config);\n\n    const { getConsensus } = options.serviceOptions;\n\n    return {\n        subscribeHandler: function () {\n            return [];\n        },\n        publishHandler: function (topics, options) {\n            return getConsensus().then((consensus)=> {\n                const actions = topics.map(function (topic) {\n                    return { name: topic.name, arguments: topic.value };\n                });\n                const cs = makeConsensusService(consensus);\n                return cs.submitActions(actions).then(()=> {\n                    return topics;\n                });\n            });\n        }\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/epicenter-route-handlers/world-route-handler/consensus-route-handler/consensus-operations-handler.js","import { makeConsensusService } from './consensus-utils';\nimport { objectToPublishable } from 'channels/channel-utils';\nimport { pick } from 'lodash';\n\nexport default function ConsensusStatusHandler(config, notifier) {\n    const options = $.extend(true, {\n        serviceOptions: {},\n        channelOptions: {},\n    }, config);\n\n    const { getConsensus, getSession } = options.serviceOptions;\n\n    function normalizePlayers(rolePlayerMap) {\n        const session = getSession();\n        const normalized = Object.keys(rolePlayerMap).reduce((accum, role)=> {\n            const playersForRole = rolePlayerMap[role];\n            const playersWithRole = playersForRole.map((p)=> {\n                const player = p.user || p; //submitted puts user under an extra object because of course\n                return Object.assign({}, player, {\n                    role: role,\n                    userName: player.userName.split('/')[0], //API adds user/project because of course\n                    name: player.lastName,\n                    isMe: player.userName === session.userName, // so you can do :submitted:users | reject('isMe')\n                });\n            });\n            accum = accum.concat(playersWithRole);\n            return accum;\n        }, []);\n        return normalized;\n    }\n    function normalizeConsensus(consensus) {\n        const session = getSession();\n        const submitted = normalizePlayers(consensus.submitted);\n        const amWaiting = submitted.find((u)=> u.userName === session.userName);\n        const normalized = $.extend(true, {}, consensus, {\n            amWaiting: !!amWaiting,\n            submitted: submitted,\n            pending: normalizePlayers(consensus.pending),\n        });\n        return normalized;\n    }\n\n    return {\n        notify: function (consensus) {\n            const normalizedConsensus = normalizeConsensus(consensus);\n            notifier(objectToPublishable(normalizedConsensus));\n        },\n        subscribeHandler: function (topics) {\n            return getConsensus().then((consensus)=> {\n                const normalized = normalizeConsensus(consensus);\n                const dataForTopics = pick(normalized, topics);\n                return objectToPublishable(dataForTopics);\n            });\n        },\n        publishHandler: function (topics) {\n            return getConsensus().then((consensus)=> {\n                if (topics.length > 1 || topics[0].name !== 'close') {\n                    throw new TypeError('Can only publish `close` on consensus:status');\n                }\n                const cs = makeConsensusService(consensus);\n                return cs.forceClose().then(()=> topics);\n            });\n        }\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/epicenter-route-handlers/world-route-handler/consensus-route-handler/consensus-status-handler.js","import { debounceAndMerge } from 'utils/general';\nvar { F } = window;\n\nexport default function MultiRunRouteHandler(options, notifier, channelManagerContext) {\n    var runService = new F.service.Run(options.serviceOptions.run);\n\n    var topicParamMap = {};\n\n    function extractFiltersFromTopic(topicString) {\n        var filters = topicString.replace('(', '').replace(')', '');\n        var filterParam = filters.split(';').reduce((accum, filter)=> {\n            var [key, val] = filter.split('=');\n            if (val) {\n                val = true;\n            }\n            accum[key] = val;\n            return accum;\n        }, {});\n        return filterParam;\n    }\n\n    function fetch(topic, variables) {\n        var filters = extractFiltersFromTopic(topic);\n        return runService.query(filters, { include: variables }).then((runs)=> {\n            notifier([{ name: topic, value: runs }]);\n\n            // if (topicParamMap[topic]) {\n            //     Object.keys(topicParamMap[topic]).forEach((runid)=> {\n            //         channelManagerContext.unsubscribe(topicParamMap[topic][runid]);\n            //     });\n            // }\n\n            return runs;\n        });\n    }\n\n    return {\n        fetch: fetch,\n\n        unsubscribeHandler: function (unsubscribedTopics, remainingTopics) {\n            console.log('unsubs');\n            // knownTopics = remainingTopics;\n        },\n        subscribeHandler: function (topics, options) {\n            var topic = ([].concat(topics))[0];\n\n            var filters = extractFiltersFromTopic(topic);\n            var variables = options && options.include;\n\n            var debounceInterval = 300;\n            var debouncedFetch = debounceAndMerge(fetch, debounceInterval, (accum, newval)=> newval);\n            return fetch(topic, variables).then(function (runs) {\n                var subsMap = {};\n                //TODO: Provide this meta information to runs-factory so it doesn't trigger a fetch to get meta for each run\n                runs.forEach((run)=> {\n                    var subscriptions = Object.keys(filters).map((filter)=> run.id + ':meta:' + filter);\n                    var subsid = channelManagerContext.subscribe(subscriptions, function () {\n                        debouncedFetch(topic, variables);\n                    }, { batch: false, autoFetch: false, cache: false });\n                    subsMap[run.id] = subsid;\n                });\n\n                topicParamMap[topic] = subsMap;\n                return runs;\n            });\n        }\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/epicenter-route-handlers/multi-run-route-handler/index.js","export { default as interpolatable } from './interpolatable';\nexport { default as routable } from './routable';\n// export { default as withMiddleware } from './with-middleware';\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/channel-manager-enhancements/index.js","import subscribeInterpolator from './subscribe-interpolator';\nimport publishInterpolator from './publish-interpolator';\n\n/**\n * Decorates passed channel manager with interpolation functionality\n * @param  {ChannelManager} ChannelManager\n * @return {ChannelManager}                wrapped channel manager\n */\nexport default function interpolatable(ChannelManager) {\n    var subsidMap = {};\n\n    /**\n     * @implements {ChannelManager}\n     */\n    return class InterpolatedChannelManager extends ChannelManager {\n        constructor(options) {\n            super(options);\n            //FIXME: Add on-error (from routable) here?\n            this.subscribe = subscribeInterpolator(this.subscribe.bind(this), (dependencySubsId, newDependentId)=> {\n                var existing = subsidMap[dependencySubsId];\n                if (existing) {\n                    this.unsubscribe(existing);\n                }\n                subsidMap[dependencySubsId] = newDependentId;\n            });\n\n            this.publish = publishInterpolator(this.publish.bind(this), (variables, cb)=> {\n                super.subscribe(variables, (response, meta)=> {\n                    this.unsubscribe(meta.id);\n                    cb(response);\n                }, { autoFetch: true, batch: true, onError: (e)=> {\n                    throw e;\n                } });\n            });\n        }\n        unsubscribe(token) {\n            var existing = subsidMap[token];\n            if (existing) {\n                super.unsubscribe(existing);\n            }\n            super.unsubscribe(token);\n            delete subsidMap[token];\n        }\n        unsubscribeAll() {\n            subsidMap = {};\n            super.unsubscribeAll();\n        }\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/channel-manager-enhancements/interpolatable/index.js","import { extractDependencies, interpolateWithValues } from './interpolatable-utils';\nimport { uniq, isEqual } from 'lodash';\n\n/**\n * @param {String[]} topics\n * @return {String[]} interpolated\n */\nexport function getDependencies(topics) {\n    var deps = topics.reduce((accum, topic)=> {\n        var inner = extractDependencies(topic);\n        accum = accum.concat(inner);\n        return accum;\n    }, []);\n    return uniq(deps);\n}\n\n/**\n * @param {String[]} topics\n * @param {Object} data\n * @return {String[]}\n */\nexport function interpolateWithDependencies(topics, data) {\n    return topics.map((topic)=> {\n        return interpolateWithValues(topic, data);\n    });\n}\n\n/**\n * @param  {String[]} originalTopics     \n * @param  {String[]} interpolatedTopics \n * @param  {Object} data               \n * @return {Object}                    Interpolated\n */\nexport function mergeInterpolatedTopicsWithData(originalTopics, interpolatedTopics, data) {\n    return interpolatedTopics.reduce((accum, interpolatedTopic, index)=> {\n        var original = originalTopics[index];\n        var val = data[interpolatedTopic];\n        if (val !== undefined) {\n            accum[original] = data[interpolatedTopic];\n        }\n        return accum;\n    }, {});\n}\n\n/**\n * Takes a subscribe function and resolves any interpolated inputs\n * @param  {Function} subscribeFn        function to wrap\n * @param  {Function} onDependencyChange callback function when any dependencies change\n * @return {Function}                    wrapped function\n */\nexport default function subscribeInterpolator(subscribeFn, onDependencyChange) {\n    return function interpolatedSubscribe(topics, cb, options) {\n        topics = [].concat(topics);\n        var dependencies = getDependencies(topics);\n        if (!dependencies.length) {\n            return subscribeFn(topics, cb, options);\n        }\n        var innerSubsId = subscribeFn(dependencies, function handleDependencyValueChange(data, dependenciesMeta) {\n            const isSameData = isEqual(data, dependenciesMeta.previousData);\n            if (isSameData) return;\n\n            var interpolatedTopics = interpolateWithDependencies(topics, data);\n            var outerSubsId = subscribeFn(interpolatedTopics, function handleInterpolatedValueChange(actualData, actualMeta) {\n                var toSendback = mergeInterpolatedTopicsWithData(topics, interpolatedTopics, actualData);\n\n                cb(toSendback, actualMeta);\n            }, options);\n\n            (onDependencyChange || $.noop)(dependenciesMeta.id, outerSubsId);\n            return outerSubsId;\n        }, $.extend(options, { autoFetch: true, batch: true }));\n\n        return innerSubsId;\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/channel-manager-enhancements/interpolatable/subscribe-interpolator.js","import { extractDependencies, interpolateWithValues } from './interpolatable-utils';\nimport { normalizeParamOptions } from 'channels/channel-utils';\n\nimport { uniq } from 'lodash';\n\n/**\n * @param {Publishable[]} publishInputs\n * @returns {String[]} dependencies for inputs\n */\nexport function getDependencies(publishInputs) {\n    var deps = publishInputs.reduce((accum, input)=> {\n        var inner = extractDependencies(input.name);\n        accum = accum.concat(inner);\n        return accum;\n    }, []);\n    return uniq(deps);\n}\n\n/**\n * @param {Publishable[]} publishInputs\n * @param {Object} valuesToInterpolate\n * @returns {Publishable[]} inputs with resolved dependencies\n */\nexport function interpolateWithDependencies(publishInputs, valuesToInterpolate) {\n    return publishInputs.map((ip)=> {\n        return {\n            name: interpolateWithValues(ip.name, valuesToInterpolate),\n            value: ip.value,\n        };\n    });\n}\n\n/**\n * Publish function to wrap\n * @param  {Function} publishFunction\n * @param  {Function} fetchFn         function to get interpolated values from\n * @return {Function}                 wrapped function\n */\nexport default function publishInterpolator(publishFunction, fetchFn) {\n    return function interpolatedPublishfunction(topic, value, options) {\n        var normalizedPublishInputs = normalizeParamOptions(topic, value, options);\n        var dependencies = getDependencies(normalizedPublishInputs.params);\n        if (!dependencies.length) {\n            return publishFunction(topic, value, options);\n        }\n        \n        var prom = $.Deferred();\n        fetchFn(dependencies, function handleDependencyChange(resolvedDependencies) {\n            var interpolated = interpolateWithDependencies(normalizedPublishInputs.params, resolvedDependencies);\n            var newPublishProm = publishFunction(interpolated, normalizedPublishInputs.options);\n            newPublishProm.then(prom.resolve, prom.reject);\n        });\n        return prom.promise();\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/channel-manager-enhancements/interpolatable/publish-interpolator.js","import { normalizeParamOptions } from '../../channel-utils';\nimport { omit, difference, uniq } from 'lodash';\n\nfunction getTopicsFromSubsList(subcriptionList) {\n    const allTopics = subcriptionList.reduce(function (accum, subs) {\n        accum = accum.concat(subs.topics);\n        return accum;\n    }, []);\n    return uniq(allTopics);\n}\n\n/**\n * Decorates passed channel manager with middleware functionality\n * @param  {ChannelManager} BaseChannelManager\n * @return {ChannelManager} wrapped channel manager\n */\nexport default function withRouter(BaseChannelManager, router) {\n    /**\n     * @augments ChannelManager\n     */\n    return class ChannelWithRouter extends BaseChannelManager {\n        constructor(options) {\n            super(options);\n            const defaults = {\n                routes: []\n            };\n            const opts = $.extend(true, {}, defaults, options);\n            const optsToPassOn = omit(opts, Object.keys(defaults));\n\n            const rt = router(opts.routes, optsToPassOn, this.notify.bind(this));\n            Object.assign(this, rt.expose || {});\n            this.router = rt;\n        }\n\n        /**\n         * Allow intercepting and excluding topics from by subsequent middlewares\n         * @param  {string | string[]}   topics\n         * @param  {Function} cb\n         * @param  {Object}   options\n         * @return {string}           subscription id\n         */\n        subscribe(topics, cb, options) {\n            const subsid = super.subscribe(topics, cb, options);\n            this.router.subscribeHandler([].concat(topics), options).then((topicsWithData)=> {\n                if (topicsWithData && topicsWithData.length) {\n                    this.notify([].concat(topicsWithData));\n                }\n            }, (err)=> {\n                this.unsubscribe(subsid);\n                if (options && options.onError) {\n                    options.onError(err);\n                }\n            });\n            return subsid;\n        }\n\n        /**\n         * Allow intercepting and handling/suppressing data to publish calls.\n         * @param {string | Publishable } topic\n         * @param {any} [value] item to publish\n         * @param {Object} [options]\n         * @return {Promise}\n         */\n        publish(topic, value, options) {\n            const publishData = normalizeParamOptions(topic, value, options);\n            return this.router.publishHandler(publishData.params, publishData.options).then((published)=> {\n                return super.publish(published, publishData.options);\n            });\n        }\n        \n\n        /**\n         * Calls unsubscribe middleware *after* unsubscription with a list of recently unsubscribed topics\n         * @param  {string} token\n         * @return {void}\n         */\n        unsubscribe(token) {\n            const originalTopics = getTopicsFromSubsList(this.subscriptions);\n            super.unsubscribe(token);\n            const remainingTopics = getTopicsFromSubsList(this.subscriptions);\n            const unsubscribedTopics = difference(originalTopics, remainingTopics);\n\n            this.router.unsubscribeHandler(unsubscribedTopics, remainingTopics);\n        }\n\n        /**\n         * Calls unsubscribe middleware after unsubscribeAll on the channel\n         * @return {void}\n         */\n        unsubscribeAll() {\n            const originalTopics = getTopicsFromSubsList(this.subscriptions);\n            super.unsubscribeAll();\n\n            return this.router.unsubscribeHandler(originalTopics, []);\n        }\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/channel-manager-enhancements/routable/index.js"],"sourceRoot":""}