{"version":3,"sources":["webpack:///webpack/bootstrap e9746bdd71296bfac9d3","webpack:///external \"_\"","webpack:///./src/config.js","webpack:///./src/channels/channel-router/utils/index.js","webpack:///./src/channels/channel-utils.js","webpack:///./src/channels/channel-router/index.js","webpack:///./src/utils/parse-utils.js","webpack:///./src/channels/route-handlers/route-matchers.js","webpack:///./src/utils/general/index.js","webpack:///./src/channels/route-handlers/epicenter-route-handlers/run-route-handler/index.js","webpack:///./src/utils/animation.js","webpack:///./src/dom/attribute-manager/attr-template-utils.js","webpack:///./src/dom/nodes/default-input-node.js","webpack:///./src/dom/nodes/default-node.js","webpack:///./src/dom/attribute-manager/attributes/loop-attrs/loop-attr-utils.js","webpack:///./src/utils/general/promise-utils.js","webpack:///./src/channels/route-handlers/epicenter-route-handlers/world-route-handler/consensus-route-handler/consensus-utils.js","webpack:///./src/channels/channel-manager-enhancements/interpolatable/interpolatable-utils.js","webpack:///./src/flow.js","webpack:///./src/dom/dom-manager.js","webpack:///./src/dom/dom-manager-utils/dom-parse-helpers/index.js","webpack:///./src/dom/dom-manager-utils/dom-parse-helpers/parse-converters.js","webpack:///./src/dom/dom-manager-utils/dom-parse-helpers/parse-channel.js","webpack:///./src/dom/dom-manager-utils/dom-parse-helpers/parse-topics.js","webpack:///./src/dom/dom-manager-utils/dom-channel-prefix-helpers/index.js","webpack:///./src/converter-manager/index.js","webpack:///./src/converter-manager/converters/number-converters/index.js","webpack:///./src/converter-manager/converters/string-converters/index.js","webpack:///./src/converter-manager/converters/array-converters/index.js","webpack:///./src/converter-manager/converters/general-util-converters/index.js","webpack:///./src/converter-manager/converters/numberformat-converter/index.js","webpack:///./src/converter-manager/converters/number-compare-converters/index.js","webpack:///./src/converter-manager/converters/boolean-conditional-converters/index.js","webpack:///./src/converter-manager/converters/collection-converters/index.js","webpack:///./src/dom/nodes/node-manager.js","webpack:///./src/dom/nodes/input-checkbox-node.js","webpack:///./src/utils/base-view.js","webpack:///./src/dom/attribute-manager/index.js","webpack:///./src/dom/attribute-manager/attributes/no-op-attr/index.js","webpack:///./src/dom/attribute-manager/attributes/events/default-event-attr/index.js","webpack:///./src/dom/attribute-manager/attributes/loop-attrs/foreach-attr/index.js","webpack:///./src/dom/attribute-manager/attributes/loop-attrs/repeat-attr/index.js","webpack:///./src/utils/general/debounce-and-merge.js","webpack:///./src/dom/attribute-manager/attributes/class-attr/index.js","webpack:///./src/dom/attribute-manager/attributes/boolean-attr/index.js","webpack:///./src/dom/attribute-manager/attributes/toggles/show-if-attr/index.js","webpack:///./src/dom/attribute-manager/attributes/toggles/hide-if-attr/index.js","webpack:///./src/dom/attribute-manager/attributes/binds/checkbox-radio-bind-attr/index.js","webpack:///./src/dom/attribute-manager/attributes/binds/input-bind-attr/index.js","webpack:///./src/dom/attribute-manager/attributes/binds/default-bind-attr/index.js","webpack:///./src/dom/attribute-manager/attributes/binds/bind-utils/index.js","webpack:///./src/dom/attribute-manager/attributes/default-attr/index.js","webpack:///./src/dom/plugins/auto-update-bindings.js","webpack:///./src/channels/configured-channel-manager.js","webpack:///./src/channels/channel-manager.js","webpack:///external \"jQuery\"","webpack:///./src/channels/channel-router/utils/handler-utils.js","webpack:///./src/channels/channel-router/utils/silencable.js","webpack:///./src/channels/channel-router/utils/exclude-read-only.js","webpack:///./src/channels/route-handlers/index.js","webpack:///./src/channels/route-handlers/json-route-handler/index.js","webpack:///./src/channels/route-handlers/epicenter-route-handlers/index.js","webpack:///./src/channels/route-handlers/epicenter-route-handlers/default-run-route-handler/index.js","webpack:///./src/channels/route-handlers/epicenter-route-handlers/run-route-handler/run-meta-route-handler.js","webpack:///./src/channels/route-handlers/epicenter-route-handlers/run-route-handler/run-variables-route-handler.js","webpack:///./src/channels/route-handlers/epicenter-route-handlers/run-route-handler/retriable-variable-fetch.js","webpack:///./src/channels/route-handlers/epicenter-route-handlers/run-route-handler/run-operations-route-hander.js","webpack:///./src/channels/route-handlers/epicenter-route-handlers/scenario-route-handler/index.js","webpack:///./src/channels/route-handlers/epicenter-route-handlers/runid-route-handler/index.js","webpack:///./src/channels/route-handlers/epicenter-route-handlers/run-router-factory.js","webpack:///./src/channels/route-handlers/epicenter-route-handlers/world-route-handler/index.js","webpack:///./src/channels/route-handlers/epicenter-route-handlers/world-route-handler/world-users-route-handler/index.js","webpack:///./src/channels/route-handlers/epicenter-route-handlers/world-route-handler/world-current-user-route-handler/index.js","webpack:///./src/channels/route-handlers/epicenter-route-handlers/world-route-handler/consensus-route-handler/index.js","webpack:///./src/channels/route-handlers/epicenter-route-handlers/world-route-handler/consensus-route-handler/consensus-operations-handler.js","webpack:///./src/channels/route-handlers/epicenter-route-handlers/world-route-handler/consensus-route-handler/consensus-status-handler.js","webpack:///./src/channels/route-handlers/epicenter-route-handlers/multi-run-route-handler/index.js","webpack:///./src/channels/channel-manager-enhancements/index.js","webpack:///./src/channels/channel-manager-enhancements/interpolatable/index.js","webpack:///./src/channels/channel-manager-enhancements/interpolatable/subscribe-interpolator.js","webpack:///./src/channels/channel-manager-enhancements/interpolatable/publish-interpolator.js","webpack:///./src/channels/channel-manager-enhancements/routable/index.js"],"names":["module","exports","prefix","binderAttr","events","trigger","convert","error","attrs","checkboxOffValue","repeat","templateId","errorAttr","animation","addAttr","changeAttr","initialAttr","CHANNEL_DELIMITER","stripSuffixDelimiter","text","indexOf","length","replace","mapWithPrefix","dataArray","map","datapt","name","$","extend","withPrefix","callback","prefixList","arr","concat","data","forEach","mapped","unprefixTopics","list","unprefixed","item","unprefix","objectToPublishable","obj","Object","keys","t","value","publishableToObject","mergeWith","result","reduce","accum","topic","normalizeParamOptions","publishValue","options","params","isPlainObject","Array","isArray","notifySubscribeHandlers","handlers","topics","grouped","groupByHandlers","promises","filter","handler","subscribeHandler","mergedOptions","matched","promise","makePromise","subsResponse","then","topicsWithData","normalized","normalizeSubscribeResponse","prefixed","push","when","apply","arguments","notifyUnsubscribeHandlers","recentlyUnsubscribedTopics","remainingTopics","h","index","unsubsKey","unsubsGrouped","remainingGrouped","unsubscribeHandler","unprefixedUnsubs","matchingRemainingHandler","_","find","remainingHandler","matchingTopicsRemaining","unprefixedRemaining","passthroughPublishInterceptors","publishData","groupSequentiallyByHandlers","$initialProm","Deferred","resolve","dataSoFar","publishableData","excludeReadOnly","readOnly","publishHandler","publishProm","published","silencable","silent","isDefault","router","notifier","myHandlers","Handler","isFunction","expose","match","matchString","addRoute","Error","id","uniqueId","unshift","removeRoute","routeid","toImplicitType","objRegex","arrRegex","converted","trim","charAt","substring","isNumeric","test","bracketReplaced","parsed","split","val","JSON","parse","e","console","splitUnescapedCommas","str","regex","m","op","exec","lastIndex","groupIndex","splitNameArgs","fnName","args","p","toPublishableFormat","OPERATIONS_SEPERATOR","listOfOperations","ROUTE_DELIMITER","matchPrefix","prefixMatcher","hasPrefix","isOnlyPrefix","matchDefaultPrefix","defaultPrefixMatcher","forcePrefix","matchRegex","toMatch","RegExp","regexMatcher","random","min","max","parseInt","rnd","_random","VARIABLES_PREFIX","META_PREFIX","OPERATIONS_PREFIX","_shouldFetch","ignoreOperations","filtered","r","isIgnored","isVariable","isOperation","RunService","F","service","Run","GenericRunRouteHandler","config","defaults","serviceOptions","channelOptions","variables","autoFetch","debounce","operations","meta","opts","rs","operationNotifier","variableNotifier","metaHandler","operationsHandler","variablesHandler","subscribed","channel","TOPICS","subscribeOpts","includeMine","subscribe","RUN_VARIABLES","publishable","excludingSilenced","notify","fetch","RUN_OPERATIONS","CONSENSUS_UPDATE","consensus","closed","RUN_RESET","runRouter","oldhandler","prom","shouldFetch","excludeFromFetch","exclude","_findMostConsequtive","reduced","prev","count","maxCount","Math","buildDiffArray","currentcontents","newContents","contents","isSame","fill","a","i","elToContents","el","outerHTML","elementsToContents","$els","child","get","addChangeClassesToList","$currentEls","$newEls","isInitial","reversedContents","diffFromEnd","diffFromBeginning","slice","reverse","endMatches","beginningMatches","placeHoldersCount","placeHolders","undefined","$el","eq","curr","removeAttr","attr","addContentAndAnimate","newValue","current","html","setTimeout","CURRENT_INDEX_KEY","CURRENT_INDEX_ATTR","getKnownDataForEl","closestKnownDataEl","closest","knownData","updateKnownDataForEl","stringify","removeKnownData","getTemplateTags","template","templateTagsUsed","isTemplated","findMissingReferences","knownDataKeys","isKnownTag","tag","knownTags","key","missingReferences","refKey","refToMarkup","stubMissingReferences","refId","addBackMissingReferences","originalTemplateVal","commentRef","elTemplateMap","WeakMap","getOriginalContents","resolver","originalHTML","set","clearOriginalContents","delete","BaseView","propertyHandlers","uiChangeEvent","getUIValue","removeEvents","off","initialize","me","propName","on","payload","source","prototype","selector","require","IN_OF_REGEX","KEY_VALUE_REGEX","extractVariableName","attrVal","inMatch","varName","parseKeyAlias","itMatch","alias","parseValueAlias","aliasesFromTopics","relevantTopic","defaultKey","keyAlias","valueAlias","parseTopics","$def","toReturn","reject","promisify","fn","promisifiedFunction","makeConsensusService","consensisAPIResponse","window","Consensus","stage","consensusGroup","worldId","interpolationRegex","extractDependencies","deps","interpolateWithValues","interpolatedTopic","dependency","toReplace","Flow","dom","utils","model","run","root","autoBind","domManager","unbindAll","bindAll","ChannelManager","constants","version","expr","pseudos","attributes","nodeName","getMatchingElements","$root","matchedElements","is","add","getElementOrError","element","context","triggerError","msg","message","unbindAllAttributes","domEl","each","nodeMap","wantedPrefix","attrManager","getHandler","unbind","unbindAllNodeHandlers","nodeManager","handle","removeAllSubscriptions","subscriptions","subs","unsubscribe","publicAPI","nodes","converters","Map","unbindElement","existingData","subsid","subscriptionId","animAttrs","join","removeData","bindElement","filterPrefix","attrList","parseTopicsFromAttributeValue","init","channelPrefix","getChannelForAttribute","addPrefixToTopics","getConvertersForEl","channelConfig","getChannelConfigForElement","attrsWithSubscriptions","subsOptions","batch","onError","subscribableTopics","isEqual","previousData","toConvert","dataForAttr","pick","k","assign","elementsToBind","elementsToUnbind","plugins","attachUIListeners","parseValue","converterManager","evt","elMeta","target","sourceMeta","action","parsedValue","actualName","prefixedName","addDefaultPrefix","publish","last","attachConversionListner","prop","convertedValue","deferred","autoUpdatePlugin","convertersToArray","conv","v","getConvertersFromAttr","attribute","withConv","getFConvertAttrVal","suffix","baseAttr","suffixAttr","getAllConverters","convertersAsPipes","whiteListedGenericAttributes","canUseFConvert","$parentEl","parents","resolvedConverters","parentConv","attrib","specified","commaRegex","topicsPart","mappedTopics","currentName","hasChannelDefined","DEFAULT_OPERATIONS_PREFIX","DEFAULT_VARIABLES_PREFIX","isUnprefixed","defaultPrefix","needsDefaultPrefix","hasDefaultPrefix","normalize","converter","acceptList","ret","matchConverter","isString","isRegExp","private","register","currentConverter","splice","getConverter","norm","Function","bind","currentValue","convertArray","converterName","convertObject","mapValues","defaultconverters","c","parseFloat","s","upperCase","toUpperCase","lowerCase","toLowerCase","titleCase","txt","substr","parseLimitArgs","starting","limit","toRet","input","n","stripped","first","previous","size","src","pickEvery","startIndex","newfn","toArray","indexOfActualValue","newArgs","parseArgs","toCompare","trueVal","falseVal","valueToCompare","isNumber","isAllowedLeading","validPrefixes","checkValMatch","validStandalone","validFirstChars","validLastChars","isValidFirstChar","isValidLastChar","validRemainingChars","areRemainingCharactersValid","char","isMatch","parts","isNegative","floatMatcher","results","number","scales","roundTo","digits","round","pow","getDigits","ceil","log","LN10","TXT","numberTXT","toString","decimalSet","iTXT","addDecimals","decimals","minDecimals","hasCommas","hasDecimals","iDec","iChar","toADD","getSuffix","formatTXT","fixesTXT","format","isNaN","entityCodeMapping","code","formats","abs","sign","leftOfDecimal","d","lastIndexOf","isShortFormat","nextChar","leadingText","rightOfPrefix","shortFormatTest","shortFormatTestResult","valScale","floor","Number","limitDigits","SUFFIX","valWithoutLeading","subFormats","preffix","formatted","greaterThan","greaterThanEqual","equalsNumber","lessThan","lessThanEqual","toBool","not","ifTrue","ifFalse","valueToFilterBy","except","valueToReject","any","some","every","node","currentHandler","defaultHandlers","default","offAttr","offAttrVal","offVal","onAttrVal","onVal","has","extendView","protoProps","staticProps","constructor","Surrogate","__super__","View","handlersList","attributeMatcher","nodeMatcher","matchAttr","matchExpr","attrMatch","matchNode","nodeFilter","attributeManager","attrFilter","noopAttr","eventNameFromAttr","eventName","nameSpacedEvent","defaultEventAttr","matching","preventDefault","elAnimatedMap","foreachAttr","stubbedTemplate","templateFn","$dummyEl","dataval","datakey","templateData","templated","templatedWithReferences","newNode","$newNode","append","isInitialAnim","$withAnimAttrs","children","empty","templateIdAttr","loopAttrHandler","nextUntil","remove","replaceWith","$dummyOldDiv","$removed","isEmpty","hasData","insertAfter","executeAndResolve","promisifiedFn","debounceAndMerge","debounceInterval","argumentsReducers","arrayReducer","newVal","queue","timer","mergeArgs","oldArgs","merged","newArg","reducer","debouncedFunction","call","clearTimeout","mergedArgs","pop","elClassesMap","deleteAddedClasses","addedClasses","removeClass","classAttr","addClass","booleanAttrHandler","showifHandler","hide","show","hideifHandler","checkboxAttrHandler","settableValue","isChecked","inputBindAttr","toAliasMap","getNewContent","currentContents","translateDataToInsertable","translateDataToTemplatable","templatedHTML","bindAttrHandler","extractAlias","bindTemplate","originalContents","aliasMap","originalName","AS_REGEX","asMatch","defaultAttr","isEnabled","MutationObserver","observer","mutations","mutation","added","addedNodes","removed","removedNodes","attributeName","mutconfig","attributeFilter","childList","subtree","characterData","publicApi","enable","observe","disable","disconnect","InterpolatableRoutableChannelManager","interpolatable","routable","defaultRouteHandlers","routes","cm","makeSubs","cache","cacheBySubsId","sentDataBySubsId","copy","callbackSubscriber","subscription","checkAndNotifyBatch","matchingTopics","intersection","relevantDataFromPublish","cachedDataForSubs","knownDataForSubs","hasDataForAllTopics","checkAndNotify","needsThisTopic","isWildCard","getTopicsFromSubsList","subcriptionList","publishResponses","cb","token","olderLength","remaining","uniq","findBestHandler","matchOptions","thishandler","topicMapping","bestHandler","values","dataPt","lastHandler","response","isAlreadyInPublishableFormat","silentOptions","found","readOnlyOptions","isReadonly","warn","getOptions","SCENARIO_PREFIX","RUN_PREFIX","WORLD_PREFIX","sampleRunidLength","runidRegex","EpicenterRouteHandler","channelManagerContext","runidHandlerOpts","runidHandler","multiRunHandler","exposable","runManagerOpts","runManager","scenarioManager","rm","isMultiplayer","strategy","scenarioManagerOpts","sm","epicenterRouter","RunManagerRouteHandler","rmOptions","manager","RunManager","$creationPromise","getRun","currentChannelOpts","currentRunChannel","runRouteHandler","runMangerRouter","RunMetaRouteHandler","$runServicePromise","mergeAndSend","runMeta","requestedTopics","toSend","runService","cachedValues","loadPromise","load","toSave","save","res","mergeVariables","newval","RunVariablesRouteHandler","debouncedVariableQuery","debouncedFetchers","retriableFetch","knownTopics","variablesToFetch","difference","unsubscribedTopics","isAutoFetchEnabled","missingVariables","variableData","query","catch","responseJSON","info","information","goodVariables","vName","baseName","isBad","names","RunOperationsRouteHandler","operationsResponse","serial","ScenarioManagerRouteHandler","ScenarioManager","baselinePromise","baseline","baselineOptions","currentRunPromise","runOptions","baselineHandler","currentRunHandler","scenarioManagerRouter","RunidRouteHandler","runid","runChannelFactory","knownRunIDServiceChannels","runChannel","MULTI_USER_PREFIX","USER_PREFIX","CONSENSUS_PREFIX","WorldRoutesHandler","runPromise","world","err","$runPromise","alreadyStubbedRunChannel","channelManager","worldChannel","getWorldChannel","updateConfig","currentRunHandlerOpts","$worldProm","getWorld","worldChannelMap","getChannelForWorld","worldid","am","AuthManager","handlerOptions","getSession","getCurrentUserSessionInfo","getChannel","usersRouteHandler","usersHandler","currentUserRouteHandler","currentUserHandler","ConsensusManager","consensusRouteHandler","consensusHandler","worldRouteHandler","WorldUsersRouteHandler","store","users","mark","userid","isOnline","u","userId","parsedUsersPromise","session","lastName","isMe","presenceSubsId","userids","PRESENCE","user","ps","Presence","markOnline","markOffline","WorldCurrentUserRouteHandler","stillNeedRoles","userFields","myUser","toNotify","field","isSubscribingToRole","ROLES","role","ConsensusRouteHandler","consensusProm","getConsensus","force","getCurrent","opnHandler","OperationsHandler","statusHandler","StatusHandler","status","isComplete","consensusManager","ConsensusOperationsHandler","actions","cs","submitActions","ConsensusStatusHandler","normalizePlayers","rolePlayerMap","playersForRole","playersWithRole","player","userName","normalizeConsensus","submitted","amWaiting","pending","normalizedConsensus","dataForTopics","TypeError","forceClose","MultiRunRouteHandler","topicParamMap","extractFiltersFromTopic","topicString","filters","filterParam","include","runs","debouncedFetch","subsMap","subsidMap","subscribeInterpolator","dependencySubsId","newDependentId","existing","publishInterpolator","getDependencies","inner","interpolateWithDependencies","mergeInterpolatedTopicsWithData","originalTopics","interpolatedTopics","original","subscribeFn","onDependencyChange","interpolatedSubscribe","dependencies","innerSubsId","handleDependencyValueChange","dependenciesMeta","isSameData","outerSubsId","handleInterpolatedValueChange","actualData","actualMeta","toSendback","noop","publishInputs","valuesToInterpolate","ip","publishFunction","fetchFn","interpolatedPublishfunction","normalizedPublishInputs","handleDependencyChange","resolvedDependencies","interpolated","newPublishProm","allTopics","withRouter","BaseChannelManager","optsToPassOn","omit","rt"],"mappings":"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","file":"flow.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 17);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap e9746bdd71296bfac9d3","module.exports = _;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"_\"\n// module id = 0\n// module chunks = 0","module.exports = {\n    prefix: 'f',\n    binderAttr: 'f-bind',\n\n    events: {\n        /** UI Change to publish to the channel. */\n        trigger: 'update.f.ui',\n\n        /** Trigger with payload '{attrToUpdate: value}', for e.g. { bind: 34 }. This will run this through all the converts and pass it to attr handler. Useful to by-pass getting this from the model directly.  */\n        convert: 'f.convert',\n\n        /** On a bind or other flow-related error  */\n        error: 'f.error',\n    },\n\n    attrs: {\n        checkboxOffValue: 'data-off-value',\n        //Used by repeat attr handler to keep track of template after first evaluation\n        repeat: {\n            templateId: 'repeat-template-id' //don't prefix by f or dom-manager unbind will kill it\n        },\n    },\n\n    errorAttr: 'data-flow-error',\n    animation: {\n        addAttr: 'data-add',\n        changeAttr: 'data-update',\n        initialAttr: 'data-initial',\n    }\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/config.js","const CHANNEL_DELIMITER = ':';\n\nexport { default as silencable } from './silencable';\nexport { default as excludeReadOnly } from './exclude-read-only';\n\n/**\n * \n * @param {string} text\n * @returns {string}\n */\nexport function stripSuffixDelimiter(text) {\n    if (text && text.indexOf(CHANNEL_DELIMITER) === (text.length - 1)) {\n        text = text.replace(CHANNEL_DELIMITER, '');\n    }\n    return text;\n}\n\n/**\n * \n * @param {Publishable[]} dataArray \n * @param {string} prefix \n * @returns {Publishable[]} array with name prefixed\n */\nexport function mapWithPrefix(dataArray, prefix) {\n    if (!prefix) return dataArray;\n    return (dataArray || []).map(function (datapt) {\n        const name = (prefix + datapt.name).replace(/:$/, ''); //replace trailing delimiters\n        return $.extend(true, {}, datapt, { name: name });\n    });\n}\n\n/**\n * \n * @param {Function} callback \n * @param {string|string[]} prefixList\n * @returns {Function}\n */\nexport function withPrefix(callback, prefixList) {\n    const arr = [].concat(prefixList);\n\n    /**\n     * @param {Publishable[]} data\n     */\n    return function (data) {\n        arr.forEach(function (prefix) {\n            const mapped = mapWithPrefix(data, prefix);\n            callback(mapped);\n        });\n    };\n}\n\n/**\n * \n * @param {string[]} list \n * @param {string} prefix\n * @returns {string[]} Item with prefix removed\n */\nexport function unprefixTopics(list, prefix) {\n    if (!prefix) return list;\n    const unprefixed = list.map(function (item) {\n        return item.replace(prefix, '');\n    });\n    return unprefixed;\n}\n\n/**\n * \n * @param {Publishable[]} list \n * @param {string} prefix\n * @returns {Publishable[]} Item with prefix removed\n */\nexport function unprefix(list, prefix) {\n    if (!prefix) return list;\n    const unprefixed = list.map(function (item) {\n        if (item.name) {\n            return $.extend(true, {}, item, { name: item.name.replace(prefix, '') });\n        }\n        return item.replace(prefix, '');\n    });\n    return unprefixed;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/channel-router/utils/index.js","/**\n * \n * @param {Object} obj\n * @returns {Publishable[]}\n */\nexport function objectToPublishable(obj) {\n    var mapped = Object.keys(obj || {}).map(function (t) {\n        return { name: t, value: obj[t] };\n    });\n    return mapped;\n}\n\n/**\n * Converts arrays of the form [{ name: '', value: ''}] to {[name]: value}\n * @param {Publishable[]} arr\n * @param {Object} [mergeWith]\n * @returns {Object}\n */\nexport function publishableToObject(arr, mergeWith) {\n    var result = (arr || []).reduce(function (accum, topic) {\n        accum[topic.name] = topic.value;\n        return accum;\n    }, $.extend(true, {}, mergeWith));\n    return result;\n}\n\n/**\n * @typedef NormalizedParam\n * @property {Publishable[]} params\n * @property {Object} options\n */\n\n/**\n *\n * @param {string|Object|Array} topic \n * @param {*} publishValue \n * @param {Object} [options]\n * @returns {NormalizedParam}\n */\nexport function normalizeParamOptions(topic, publishValue, options) {\n    if (!topic) {\n        return { params: [], options: {} };\n    }\n    if ($.isPlainObject(topic)) {\n        return { params: objectToPublishable(topic), options: publishValue };\n    }\n    if (Array.isArray(topic)) {\n        return { params: topic, options: publishValue };\n    }\n    return { params: [{ name: topic, value: publishValue }], options: options };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/channel-utils.js","import { groupByHandlers, groupSequentiallyByHandlers, normalizeSubscribeResponse } from './utils/handler-utils';\nimport { unprefix, unprefixTopics, mapWithPrefix, silencable, excludeReadOnly } from './utils';\nimport { makePromise } from 'utils/general';\nimport _ from 'lodash';\n\n\n/**\n * Handle subscriptions\n * @param  {Handler[]} handlers Array of the form [{ match: function (){}, }]\n * @param  {Array<string>} topics   Array of strings\n * @param  {SubscribeOptions} [options]\n * @returns {Promise<Publishable[]>} Returns populated topics if available\n */\nexport function notifySubscribeHandlers(handlers, topics, options) {\n    const grouped = groupByHandlers(topics, handlers);\n    const promises = [];\n    grouped.filter((handler)=> handler.subscribeHandler).forEach(function (handler) {\n        const mergedOptions = $.extend(true, {}, handler.options, options);\n        const unprefixed = unprefixTopics(handler.data, handler.matched);\n        const promise = makePromise(()=> {\n            const subsResponse = handler.subscribeHandler(unprefixed, mergedOptions, handler.matched);\n            return subsResponse;\n        }).then((topicsWithData)=> {\n            const normalized = normalizeSubscribeResponse(topicsWithData, unprefixed);\n            const prefixed = mapWithPrefix(normalized, handler.matched);\n            return prefixed;\n        });\n        promises.push(promise);\n    });\n    return $.when.apply(null, promises).then(function () {\n        const arr = [].concat.apply([], arguments);\n        return arr;\n    });\n}\n\n/**\n * \n * @param {Handler[]} handlers \n * @param {Array<string>} recentlyUnsubscribedTopics\n * @param {Array<string>} remainingTopics \n */\nexport function notifyUnsubscribeHandlers(handlers, recentlyUnsubscribedTopics, remainingTopics) {\n    handlers = handlers.map(function (h, index) {\n        h.unsubsKey = index;\n        return h;\n    });\n\n    const unsubsGrouped = groupByHandlers(recentlyUnsubscribedTopics, handlers);\n    const remainingGrouped = groupByHandlers(remainingTopics, handlers);\n\n    unsubsGrouped.filter((h)=> h.unsubscribeHandler).forEach(function (handler) {\n        const unprefixedUnsubs = unprefixTopics(handler.data, handler.matched);\n        const matchingRemainingHandler = _.find(remainingGrouped, function (remainingHandler) {\n            return remainingHandler.unsubsKey === handler.unsubsKey;\n        });\n        const matchingTopicsRemaining = matchingRemainingHandler ? matchingRemainingHandler.data : [];\n        const unprefixedRemaining = unprefixTopics(matchingTopicsRemaining || [], handler.matched);\n        handler.unsubscribeHandler(unprefixedUnsubs, unprefixedRemaining);\n    });\n}\n/**\n * \n * @param {Handler[]} handlers \n * @param {Publishable[]} publishData \n * @param {PublishOptions} [options]\n * @returns {Promise}\n */\nexport function passthroughPublishInterceptors(handlers, publishData, options) {\n    const grouped = groupSequentiallyByHandlers(publishData, handlers);\n    let $initialProm = $.Deferred().resolve([]).promise();\n    grouped.forEach(function (handler) {\n        $initialProm = $initialProm.then(function (dataSoFar) {\n            const mergedOptions = $.extend(true, {}, handler.options, options);\n            const unprefixed = unprefix(handler.data, handler.matched);\n\n            const publishableData = excludeReadOnly(unprefixed, mergedOptions.readOnly);\n            if (!publishableData.length) {\n                return dataSoFar;\n            }\n\n            const result = handler.publishHandler ? handler.publishHandler(publishableData, mergedOptions, handler.matched) : publishableData;\n            const publishProm = $.Deferred().resolve(result).promise();\n            return publishProm.then(function (published) {\n                return silencable(published, mergedOptions.silent);\n            }).then(function (published) {\n                let mapped = mapWithPrefix(published, handler.matched);\n                if (handler.isDefault && handler.matched) {\n                    mapped = mapped.concat(published);\n                }\n                return mapped;\n            }).then(function (mapped) {\n                return [].concat(dataSoFar, mapped);\n            });\n        });\n    });\n    return $initialProm;\n}\n\n/**\n * Router\n * @param  {Handler[]} handlers\n * @param {Object} [options]\n * @param {Function} [notifier]\n * @returns {Router}\n */\nexport default function router(handlers, options, notifier) {\n    let myHandlers = (handlers || []).map((Handler)=> {\n        let handler = Handler;\n        if (_.isFunction(Handler)) {\n            handler = new Handler(options, notifier);\n            $.extend(this, handler.expose);\n        }\n        if (typeof handler.match === 'string') {\n            const matchString = handler.match;\n            handler.name = matchString;\n            handler.match = (t)=> t === matchString ? '' : false;\n        }\n        return handler;\n    });\n\n    const expose = myHandlers.reduce((accum, h)=> {\n        $.extend(true, accum, h.expose);\n        return accum;\n    }, {});\n\n    return {\n        expose: expose,\n        match: (topic)=> {\n            return myHandlers.reduce((match, handler)=> {\n                const matched = handler.match(topic);\n                if (match === false && matched !== false) {\n                    return '';\n                }\n                return match;\n            }, false);\n        },\n\n        /**\n         * @param {Array<string>} topics\n         * @param {SubscribeOptions} [options]\n         * @returns {Promise<Publishable[]>} Returns populated topics if available\n         */\n        subscribeHandler: function (topics, options) {\n            return notifySubscribeHandlers(myHandlers, topics, options);\n        },\n        /**\n         * @param {Array<string>} recentlyUnsubscribedTopics\n         * @param {Array<string>} remainingTopics\n         * @returns {void}\n         */\n        unsubscribeHandler: function (recentlyUnsubscribedTopics, remainingTopics) {\n            return notifyUnsubscribeHandlers(myHandlers, recentlyUnsubscribedTopics, remainingTopics);\n        },\n\n        /**\n         * @param {Publishable[]} data\n         * @param {PublishOptions} [options]\n         * @returns {Promise}\n         */\n        publishHandler: function (data, options) {\n            return passthroughPublishInterceptors(myHandlers, data, options);\n        },\n\n        addRoute: function (handler) {\n            if (!handler || !handler.match) {\n                throw Error('Handler does not have a valid `match` property');\n            }\n            handler.id = _.uniqueId('routehandler-');\n            myHandlers.unshift(handler);\n            return handler.id;\n        },\n        removeRoute: function (routeid) {\n            myHandlers = myHandlers.filter((handler)=> {\n                return handler.id !== routeid;\n            });\n        }\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/channel-router/index.js","/* eslint-disable complexity */\nfunction toImplicitType(data) {\n    const objRegex = /^(?:\\{.*\\})$/;\n    const arrRegex = /^(?:\\[.*])$/;\n\n    let converted = data;\n    if (typeof data === 'string') {\n        converted = data.trim();\n\n        if (converted === 'true') {\n            converted = true;\n        } else if (converted === 'false') {\n            converted = false;\n        } else if (converted === 'null') {\n            converted = null;\n        } else if (converted === 'undefined') {\n            converted = '';\n        } else if (converted.charAt(0) === '\\'' || converted.charAt(0) === '\"') {\n            converted = converted.substring(1, converted.length - 1);\n        } else if ($.isNumeric(converted)) {\n            converted = +converted;\n        } else if (arrRegex.test(converted)) {\n            const bracketReplaced = converted.replace(/[[\\]]/g, '');\n            if (!bracketReplaced) return [];\n            const parsed = bracketReplaced.split(/,(?![^[]*])/).map((val)=> {\n                return toImplicitType(val);\n            });\n            return parsed;\n        } else if (objRegex.test(converted)) {\n            try {\n                converted = JSON.parse(converted);\n            } catch (e) {\n                console.error('toImplicitType: couldn\\'t convert', converted);\n            }\n        }\n    }\n    return converted;\n}\n\nfunction splitUnescapedCommas(str) {\n    const regex = /(\\\\.|[^,])+/g;\n    let m;\n\n    const op = [];\n    while ((m = regex.exec(str)) !== null) { //eslint-disable-line\n        // This is necessary to avoid infinite loops with zero-width matches\n        if (m.index === regex.lastIndex) {\n            regex.lastIndex++;\n        }\n        m.forEach(function (match, groupIndex) {\n            if (groupIndex === 0) {\n                op.push(match.replace('\\\\', ''));\n            }\n        });\n    }\n    return op;\n}\n\nfunction splitNameArgs(value) {\n    value = value.trim();\n    const fnName = value.split('(')[0];\n    const params = value.substring(value.indexOf('(') + 1, value.indexOf(')'));\n    const args = splitUnescapedCommas(params).map((p)=> p.trim());\n    return { name: fnName, args: args };\n}\n\n/**\n * @param  {string} value\n * @returns {{ name: string, value: any}[]}       [description]\n */\nfunction toPublishableFormat(value) {\n    const OPERATIONS_SEPERATOR = '&&';\n    const split = (value || '').split(OPERATIONS_SEPERATOR);\n    const listOfOperations = split.map(function (value) {\n        if (value && value.indexOf('=') !== -1) {\n            const split = value.split('=');\n            return { name: split[0].trim(), value: split[1].trim() };\n        }\n        const parsed = splitNameArgs(value);\n        return { name: parsed.name, value: parsed.args };\n    });\n    return listOfOperations;\n}\n\nexport { toImplicitType, toPublishableFormat, splitNameArgs };\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils/parse-utils.js","const ROUTE_DELIMITER = ':';\n\n/**\n * \n * @param {string} prefix\n * @returns {matchFunction}\n */\nexport function matchPrefix(prefix) {\n    return function prefixMatcher(topic) {\n        const hasPrefix = topic.indexOf(prefix) === 0;\n        if (hasPrefix) return prefix;\n\n        const isOnlyPrefix = prefix.replace(/:/g, '') === topic;\n        if (isOnlyPrefix) return topic;\n\n        return false;\n    };\n}\n\n/**\n* \n* @param {string} prefix\n* @returns {matchFunction}\n*/\nexport function matchDefaultPrefix(prefix) {\n    return function defaultPrefixMatcher(topic, forcePrefix) {\n        const hasPrefix = topic.indexOf(prefix) === 0;\n        return (hasPrefix || forcePrefix) ? prefix : '';\n    };\n}\n\n/**\n * \n * @param {string} regex\n * @returns {matchFunction}\n */\nexport function matchRegex(regex) {\n    var toMatch = new RegExp('^' + regex + ROUTE_DELIMITER);\n    return function regexMatcher(topic) {\n        var match = topic.match(toMatch);\n        if (match && match.length) {\n            return match[0];\n        }\n        return false;\n    };\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/route-matchers.js","import { uniqueId, random as _random } from 'lodash';\n\nexport { makePromise, promisify } from './promise-utils';\nexport { default as debounceAndMerge } from './debounce-and-merge';\n\nexport function random(prefix, min, max) {\n    if (!min) {\n        min = parseInt(uniqueId(), 10);\n    }\n    if (!max) {\n        max = 100000; //eslint-disable-line no-magic-numbers\n    }\n    var rnd = _random(min, max, false) + '';\n    if (prefix) {\n        rnd = prefix + rnd;\n    }\n    return rnd;\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils/general/index.js","import MetaRouteHandler from './run-meta-route-handler';\nimport VariablesRouteHandler from './run-variables-route-handler';\nimport OperationsRouteHandler from './run-operations-route-hander';\n\nimport router from 'channels/channel-router';\nimport { withPrefix, silencable } from 'channels/channel-router/utils';\nimport { matchPrefix, matchDefaultPrefix } from 'channels/route-handlers/route-matchers';\n\nimport _ from 'lodash';\nimport { objectToPublishable } from 'channels/channel-utils';\n\nexport const VARIABLES_PREFIX = 'variables:';\nexport const META_PREFIX = 'meta:';\nexport const OPERATIONS_PREFIX = 'operations:';\n\n/**\n * \n * @param {Publishable[]} result \n * @param {string[]} ignoreOperations \n * @returns {boolean}\n */\nexport function _shouldFetch(result, ignoreOperations) {\n    const filtered = (result || []).filter((r)=> {\n        const name = r.name || '';\n        const isIgnored = (ignoreOperations || []).indexOf(name.replace(OPERATIONS_PREFIX, '')) !== -1;\n        const isVariable = name.indexOf(VARIABLES_PREFIX) === 0;\n        const isOperation = name.indexOf(OPERATIONS_PREFIX) === 0;\n\n        return isVariable || (isOperation && !isIgnored);\n    });\n    return filtered.length > 0;\n}\n\nconst RunService = F.service.Run;\nexport default function GenericRunRouteHandler(config, notifier) {\n    const defaults = {\n        serviceOptions: {},\n        channelOptions: {\n            variables: {\n                autoFetch: true,\n                debounce: 200,\n                silent: false,\n                readOnly: false,\n            },\n            operations: {\n                readOnly: false,\n                silent: false,\n            },\n            meta: {\n                silent: false,\n                autoFetch: true,\n                readOnly: ['id', 'created', 'account', 'project', 'model', 'lastModified']\n            },\n        }\n    };\n    const opts = $.extend(true, {}, defaults, config);\n\n    const serviceOptions = _.result(opts, 'serviceOptions');\n\n    let $initialProm = null;\n    if (serviceOptions instanceof RunService) {\n        $initialProm = $.Deferred().resolve(serviceOptions).promise();\n    } else if (serviceOptions.then) {\n        $initialProm = serviceOptions;\n    } else {\n        const rs = new RunService(serviceOptions);\n        $initialProm = $.Deferred().resolve(rs).promise();\n    }\n\n    const operationNotifier = withPrefix(notifier, OPERATIONS_PREFIX);\n    const variableNotifier = withPrefix(notifier, [VARIABLES_PREFIX, '']);\n\n    const metaHandler = new MetaRouteHandler($initialProm, withPrefix(notifier, META_PREFIX));\n    const operationsHandler = new OperationsRouteHandler($initialProm, operationNotifier);\n    const variablesHandler = new VariablesRouteHandler($initialProm, variableNotifier);\n\n    let subscribed = false;\n    $initialProm.then((rs)=> {\n        if (rs.channel && !subscribed) {\n            subscribed = true;\n            const { TOPICS } = rs.channel;\n            const subscribeOpts = { includeMine: false };\n            //TODO: Provide subscription fn to individual channels and let them handle it?\n            rs.channel.subscribe(TOPICS.RUN_VARIABLES, (data, meta)=> {\n                const publishable = objectToPublishable(data);\n                const excludingSilenced = silencable(publishable, opts.variables.silent);\n                if (!excludingSilenced.length) {\n                    return;\n                }\n                variablesHandler.notify(publishable, meta);\n                variablesHandler.fetch();//Variables channel #notify also does a fetch, but this is not supposed to know about that. Debouncing will take care of duplicate fetches anyway.\n            }, this, subscribeOpts);\n            rs.channel.subscribe(TOPICS.RUN_OPERATIONS, (data, meta)=> {\n                const publishable = [{ name: data.name, value: data.result }];\n                const excludingSilenced = silencable(publishable, opts.operations.silent);\n                if (!excludingSilenced.length) {\n                    return;\n                }\n                operationsHandler.notify(publishable, meta);\n                variablesHandler.fetch();\n            }, this, subscribeOpts);\n            rs.channel.subscribe(TOPICS.CONSENSUS_UPDATE, (consensus, meta)=> {\n                if (consensus.closed) {\n                    variablesHandler.fetch(); \n                    // I should also do operationsHandler.notify but I don't know what to notify them about\n                    //Just remove the 'include Mine' check for operations? That's just cached anyway\n                }\n            }, this, { includeMine: true });\n            rs.channel.subscribe(TOPICS.RUN_RESET, (data, meta)=> {\n                const publishable = [{ name: 'reset', value: data }];\n                const excludingSilenced = silencable(publishable, opts.operations.silent);\n                if (!excludingSilenced.length) {\n                    return;\n                }\n                operationsHandler.notify(publishable, meta);\n            }, this, subscribeOpts);\n\n\n            // rs.channel.subscribe('', (data, meta)=> {\n            //     console.log('everything', data, meta);\n            // });\n        }\n    });\n\n    const handlers = [\n        $.extend({}, metaHandler, { \n            name: 'meta',\n            match: matchPrefix(META_PREFIX),\n            options: opts.channelOptions.meta,\n        }),\n        $.extend({}, operationsHandler, { \n            name: 'operations',\n            match: matchPrefix(OPERATIONS_PREFIX),\n            options: opts.channelOptions.operations,\n        }),\n        $.extend({}, variablesHandler, { \n            isDefault: true,\n            name: 'variables',\n            match: matchDefaultPrefix(VARIABLES_PREFIX),\n            options: opts.channelOptions.variables,\n        }),\n    ];\n\n    // router.addRoute(prefix('meta:'), metaChannel, opts.channelOptions.meta);\n\n    const runRouter = router(handlers);\n    const oldhandler = runRouter.publishHandler;\n    runRouter.publishHandler = function (publishable) {\n        const prom = oldhandler.apply(router, arguments);\n        return prom.then(function (result) { //all the silencing will be taken care of by the router\n            const shouldFetch = _shouldFetch(result, ['reset']);\n            if (shouldFetch) {\n                const excludeFromFetch = result.map((r)=> r.name); //This was just published, no need to get the value again\n                variablesHandler.fetch({ exclude: excludeFromFetch });\n            }\n            return result;\n        });\n    };\n    return runRouter;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/epicenter-route-handlers/run-route-handler/index.js","export function _findMostConsequtive(arr, match) {\n    const reduced = arr.reduce((accum, val)=> {\n        if (val === match) {\n            if (accum.prev === match) {\n                accum.count = accum.count + 1;\n            } else {\n                accum.count = 1;\n            }\n        }\n        accum.maxCount = Math.max(accum.maxCount, accum.count);\n        accum.prev = val;\n        return accum;\n    }, { prev: null, count: 0, maxCount: 0 });\n    return reduced.maxCount;\n}\n\nfunction buildDiffArray(currentcontents, newContents) {\n    return newContents.map((contents, index)=> {\n        const isSame = contents === currentcontents[index]; \n        return isSame;\n    });\n}\n\nfunction fill(count, val) {\n    const a = [];\n    for (let i = 0; i < count; i++) {\n        a.push(val);\n    }\n    return a;\n}\n\nfunction elToContents(el) {\n    //ignore data attributes for comparison\n    return el.outerHTML\n        .replace(/\\s?data-[a-zA-Z]*=['\"][a-zA-Z0-9]*['\"]/g, '')\n        .replace(/\\s\\s/g, ' ').trim();\n}\n\nfunction elementsToContents($els) {\n    return $els.map((index, child)=> {\n        return elToContents(child);\n    }).get();\n}\n\nconst defaults = {\n    addAttr: 'data-add',\n    changeAttr: 'data-update',\n    initialAttr: 'data-initial',\n};\n\n/**\n * Compares 2 lists and Adds add or update classes\n * @param {JQuery<HTMLElement>} $currentEls existing elements\n * @param {JQuery<HTMLElement>} $newEls   new elements\n * @param {boolean} isInitial check if this is initial data or it's updating\n * @param {{ addAttr: string, changeAttr: string}} [options]\n * @returns {JQuery<HTMLElement>} elements with updated attributes\n */\nexport function addChangeClassesToList($currentEls, $newEls, isInitial, options) {\n    const opts = $.extend({}, defaults, options);\n\n    let currentcontents = elementsToContents($currentEls);\n    const newContents = elementsToContents($newEls);\n    const reversedContents = currentcontents;\n\n    //Guess if data was added to end or beginning of array\n    const diffFromEnd = buildDiffArray(currentcontents, newContents);\n    const diffFromBeginning = buildDiffArray(reversedContents.slice().reverse(), newContents.slice().reverse());\n\n    const endMatches = _findMostConsequtive(diffFromEnd, true);\n    const beginningMatches = _findMostConsequtive(diffFromBeginning, true);\n\n    const placeHoldersCount = newContents.length - currentcontents.length;\n    const placeHolders = fill(placeHoldersCount, undefined);\n\n    if (beginningMatches <= endMatches) {\n        currentcontents = currentcontents.concat(placeHolders);\n    } else {\n        currentcontents = placeHolders.concat(currentcontents);\n    }\n\n    for (let i = 0; i < newContents.length; i++) {\n        const $el = $newEls.eq(i);\n        const curr = currentcontents[i];\n        $el.removeAttr(opts.initialAttr);\n\n        const contents = elToContents($el.get(0));\n        if (curr === undefined) {\n            $el.attr({\n                [opts.addAttr]: true,\n                [opts.initialAttr]: isInitial || null\n            });\n            $el.removeAttr(opts.changeAttr);\n        } else if (curr !== contents) {\n            $el.attr({\n                [opts.changeAttr]: true,\n                [opts.initialAttr]: isInitial || null\n            });\n            $el.removeAttr(opts.addAttr);\n        } else {\n            $el.removeAttr(`${opts.addAttr} ${opts.changeAttr}`);\n        }\n    }\n\n    return $newEls;\n}\n\nexport function addContentAndAnimate($el, newValue, isInitial, options) {\n    const opts = $.extend({}, defaults, options);\n    const current = $el.html().trim();\n\n    $el.removeAttr(`${opts.changeAttr} ${opts.initialAttr}`);\n    if (current === `${newValue}`.trim()) {\n        return $el;\n    }\n\n    $el.html(newValue);\n    setTimeout(function () {\n        $el.attr({\n            [opts.changeAttr]: true,\n            [opts.initialAttr]: isInitial || null //jquery removes if set to null\n        });\n    }, 0); //need this to trigger animation\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils/animation.js","import { uniqueId } from 'lodash';\n\nconst CURRENT_INDEX_KEY = 'current-index';\nconst CURRENT_INDEX_ATTR = `data-${CURRENT_INDEX_KEY}`;\n\nexport function getKnownDataForEl($el) {\n    const closestKnownDataEl = $el.closest(`[${CURRENT_INDEX_ATTR}]`);\n    let knownData = {};\n    if (closestKnownDataEl.length) {\n        knownData = closestKnownDataEl.data(CURRENT_INDEX_KEY);\n    }\n    return knownData;\n}\nexport function updateKnownDataForEl($el, data) {\n    $el.attr(CURRENT_INDEX_ATTR, JSON.stringify(data));\n}\nexport function removeKnownData($el) {\n    $el.removeAttr(CURRENT_INDEX_ATTR);\n}\n\nexport function getTemplateTags(template) {\n    template = template.replace(/&lt;/g, '<').replace(/&gt;/g, '>');\n    const templateTagsUsed = template.match(/<%[=-]?([\\s\\S]+?)%>/g);\n    return templateTagsUsed || [];\n}\nexport function isTemplated(template) {\n    return getTemplateTags(template).length > 0;\n}\n\n\nexport function findMissingReferences(template, knownDataKeys) {\n    function isKnownTag(tag, knownTags) {\n        const match = knownDataKeys.find((key)=> {\n            const regex = new RegExp('\\\\b' + key + '\\\\b');\n            return regex.test(tag);\n        });\n        return match;\n    }\n\n    template = template.replace(/&lt;/g, '<').replace(/&gt;/g, '>');\n    const missingReferences = {};\n    const templateTagsUsed = getTemplateTags(template);\n    if (templateTagsUsed) {\n        templateTagsUsed.forEach(function (tag) {\n            if (tag.match(/\\w+/) && !isKnownTag(tag, knownDataKeys)) {\n                let refKey = missingReferences[tag];\n                if (!refKey) {\n                    refKey = uniqueId('no-ref');\n                    missingReferences[tag] = refKey;\n                }\n            }\n        });\n    }\n    return missingReferences;\n}\n\nfunction refToMarkup(refKey) {\n    return '<!--' + refKey + '-->';\n}\n\nexport function stubMissingReferences(template, missingReferences) {\n    template = template.replace(/&lt;/g, '<').replace(/&gt;/g, '>');\n\n    Object.keys(missingReferences).forEach((tag)=> {\n        const refId = missingReferences[tag];\n        const r = new RegExp(tag, 'g');\n        template = template.replace(r, refToMarkup(refId));\n    });\n    return template;\n}\n\nexport function addBackMissingReferences(template, missingReferences) {\n    Object.keys(missingReferences).forEach((originalTemplateVal)=> {\n        const commentRef = missingReferences[originalTemplateVal];\n        const r = new RegExp(refToMarkup(commentRef), 'g');\n        template = template.replace(r, originalTemplateVal);\n    });\n\n    return template;\n}\n\n\nconst elTemplateMap = new WeakMap();\nexport function getOriginalContents($el, resolver) {\n    const el = $el.get(0);\n    let originalHTML = elTemplateMap.get(el);\n    if (!originalHTML && resolver) {\n        originalHTML = resolver($el).replace(/&lt;/g, '<').replace(/&gt;/g, '>');\n        elTemplateMap.set(el, originalHTML);\n    }\n    return originalHTML;\n}\nexport function clearOriginalContents($el) {\n    const el = $el.get(0);\n    elTemplateMap.delete(el);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attribute-manager/attr-template-utils.js","import { binderAttr, events } from '../../config';\nimport BaseView from './default-node';\n\nexport default BaseView.extend({\n    propertyHandlers: [],\n\n    uiChangeEvent: 'change.f-node-event',\n    getUIValue: function () {\n        return this.$el.val();\n    },\n\n    removeEvents: function () {\n        this.$el.off(this.uiChangeEvent);\n    },\n\n    initialize: function () {\n        const me = this;\n        const propName = this.$el.data(binderAttr);\n\n        if (propName) {\n            this.$el.off(this.uiChangeEvent).on(this.uiChangeEvent, function () {\n                const val = me.getUIValue();\n                const payload = [{ name: propName, value: val }];\n                me.$el.trigger(events.trigger, { data: payload, source: 'bind' });\n            });\n        }\n        BaseView.prototype.initialize.apply(this, arguments);\n    }\n}, { selector: 'input, select, textarea' });\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/nodes/default-input-node.js","'use strict';\n\nvar BaseView = require('../../utils/base-view');\n\nmodule.exports = BaseView.extend({\n    propertyHandlers: [\n\n    ],\n\n    initialize: function () {\n    }\n}, { selector: '*' });\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/nodes/default-node.js","const IN_OF_REGEX = /\\((.*)\\) (?:in|of)\\s+(.*)/;\nconst KEY_VALUE_REGEX = /(.*),(.*)/;\n\n/**\n * @param {string} attrVal \n * @returns {string}\n */\nexport function extractVariableName(attrVal) {\n    const inMatch = attrVal.trim().match(IN_OF_REGEX);\n    const varName = inMatch ? inMatch[2] : attrVal;\n    return varName.trim();\n}\n\n/**\n * @param {string} attrVal \n * @returns {string}\n */\nexport function parseKeyAlias(attrVal) {\n    const inMatch = attrVal.match(IN_OF_REGEX);\n    if (!inMatch) {\n        return undefined;\n    }\n    const itMatch = inMatch[1].match(KEY_VALUE_REGEX);\n    const alias = itMatch ? itMatch[1].trim() : undefined;\n    return alias;\n}\n\n/**\n * @param {string} attrVal \n * @returns {string}\n */\nexport function parseValueAlias(attrVal) {\n    const inMatch = attrVal.match(IN_OF_REGEX);\n    if (!inMatch) {\n        return undefined;\n    }\n    const itMatch = inMatch[1].match(KEY_VALUE_REGEX);\n    const alias = itMatch ? itMatch[2] : inMatch[1];\n    return alias.trim();\n}\n\n\n//Public exports\n\nexport function aliasesFromTopics(topics, value) {\n    const relevantTopic = topics[0]; //doesn't support multiple topics\n\n    const defaultKey = $.isPlainObject(value) ? 'key' : 'index';\n    const keyAlias = relevantTopic.keyAlias || defaultKey;\n    const valueAlias = relevantTopic.valueAlias || 'value';\n\n    return { keyAlias: keyAlias, valueAlias: valueAlias };\n}\nexport function parseTopics(topics) {\n    const attrVal = topics[0].name; //doesn't support multiple topics\n    return [{\n        name: extractVariableName(attrVal),\n        keyAlias: parseKeyAlias(attrVal),\n        valueAlias: parseValueAlias(attrVal),\n    }];\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attribute-manager/attributes/loop-attrs/loop-attr-utils.js","import { isFunction } from 'lodash';\n\n/**\n * @param {any} val \n * @returns {Promise}\n */\nexport function makePromise(val) {\n    //Can be replaced with Promise.resolve when we drop IE11;\n    // if (isFunction(val)) {\n    //     return Promise.resolve(val());\n    // }\n    // return Promise.resolve(val);\n    if (val && val.then) {\n        return val;\n    }\n    const $def = $.Deferred();\n    if (isFunction(val)) {\n        try {\n            const toReturn = val();\n            if (toReturn && toReturn.then) {\n                return toReturn.then((r)=> $def.resolve(r), ((e)=> $def.reject(e)));\n            }\n            $def.resolve(toReturn);\n        } catch (e) {\n            $def.reject(e);\n        }\n    } else {\n        $def.resolve(val);\n    }\n    return $def.promise();\n}\n\n/**\n * \n * @param {function(*)} fn \n * @returns {function(...any): Promise}\n */\nexport function promisify(fn) {\n    if (!isFunction(fn)) {\n        throw new Error(`Promisify requires a function, received ${typeof fn}`);\n    }\n    /**\n     * @param {...*} args \n     * @returns {Promise}\n     */\n    return function promisifiedFunction(args) {\n        const $def = $.Deferred();\n        try {\n            const toReturn = fn.apply(fn, arguments);\n            if (toReturn && toReturn.then) {\n                return toReturn.then((r)=> {\n                    return $def.resolve(r);\n                }, (e)=> {\n                    return $def.reject(e);\n                });\n            } else {\n                $def.resolve(toReturn);\n            }\n        } catch (e) {\n            $def.reject(e);\n        }\n        return $def.promise();\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils/general/promise-utils.js","export function makeConsensusService(consensisAPIResponse) {\n    return new window.F.service.Consensus({\n        name: consensisAPIResponse.stage,\n        consensusGroup: consensisAPIResponse.name,\n        worldId: consensisAPIResponse.worldId,\n    });\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/epicenter-route-handlers/world-route-handler/consensus-route-handler/consensus-utils.js","var interpolationRegex = /<(.*?)>/g;\n/**\n *  \n * @param {string} topic topic to extract dependencies from\n * @returns {string[]} dependencies\n */\nexport function extractDependencies(topic) {\n    var deps = (topic.match(interpolationRegex) || []).map((val)=> {\n        return val.substring(1, val.length - 1); \n    });\n    return deps;\n}\n\n/**\n * @param {string} topic topic with dependencies\n * @param {{string: any}} data object with values of dependencies\n * @returns {string} interpolated string\n */\nexport function interpolateWithValues(topic, data) {\n    var interpolatedTopic = topic.replace(interpolationRegex, (match, dependency)=> {\n        var val = data[dependency];\n        var toReplace = Array.isArray(val) ? val[val.length - 1] : val;\n        return toReplace;\n    });\n    return interpolatedTopic;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/channel-manager-enhancements/interpolatable/interpolatable-utils.js","import domManager from './dom/dom-manager';\n\nimport ChannelManager from 'channels/configured-channel-manager';\nimport config from 'config';\n\nimport * as utils from './utils';\n\nconst Flow = {\n    dom: domManager,\n    utils: utils,\n    initialize: function (config) {\n        const model = $('body').data('f-model');\n        const defaults = {\n            channel: {\n                //FIXME: Defaults can't be here..\n                defaults: {\n                    run: {\n                        model: model,\n                    }\n                },\n            },\n            dom: {\n                root: 'body',\n                autoBind: true\n            }\n        };\n\n        const options = $.extend(true, {}, defaults, config);\n   \n        if (config && config.channel && (config.channel instanceof ChannelManager)) {\n            this.channel = config.channel;\n        } else {\n            this.channel = new ChannelManager(options.channel);\n        }\n\n        const prom = domManager.initialize($.extend(true, {\n            channel: this.channel\n        }, options.dom));\n        \n        this.channel.subscribe('operations:reset', function () {\n            domManager.unbindAll();\n            domManager.bindAll();\n        });\n\n        return prom;\n    }\n};\nFlow.ChannelManager = ChannelManager;\nFlow.constants = config;\n//set by grunt\nif (RELEASE_VERSION) Flow.version = RELEASE_VERSION; //eslint-disable-line no-undef\nexport default Flow;\n\n\n\n// WEBPACK FOOTER //\n// ./src/flow.js","import { getConvertersForEl, getChannelForAttribute, getChannelConfigForElement, parseTopicsFromAttributeValue } from './dom-manager-utils/dom-parse-helpers';\n\nimport { addPrefixToTopics, addDefaultPrefix } from './dom-manager-utils/dom-channel-prefix-helpers';\nimport { toImplicitType } from 'utils/parse-utils';\n\nimport { pick, isEqual } from 'lodash';\n\nimport { prefix, errorAttr, events, animation } from '../config';\n\nimport converterManager from 'converter-manager';\nimport nodeManager from './nodes/node-manager';\nimport attrManager from './attribute-manager';\nimport autoUpdatePlugin from './plugins/auto-update-bindings';\n\nexport default (function () {\n    //Jquery selector to return everything which has a f- property set\n    $.expr.pseudos[prefix] = function (el) {\n        if (!el || !el.attributes) {\n            return false;\n        }\n        for (let i = 0; i < el.attributes.length; i++) {\n            const attr = el.attributes[i].nodeName;\n            if (attr.indexOf('data-' + prefix) === 0) {\n                return true;\n            }\n        }\n        return false;\n    };\n\n    /**\n     * @param {JQuery<HTMLElement>} root\n     * @returns {JQuery<HTMLElement>}\n     */ \n    function getMatchingElements(root) {\n        const $root = $(root);\n        let matchedElements = $root.find(':' + prefix);\n        if ($root.is(':' + prefix)) {\n            matchedElements = matchedElements.add($root);\n        }\n        return matchedElements;\n    }\n\n    /**\n     * @param {JQuery<HTMLElement> | HTMLElement} element\n     * @param {*} [context]\n     * @returns {HTMLElement}\n     */ \n    function getElementOrError(element, context) {\n        const el = (element instanceof $) ? element.get(0) : element;\n        if (!el || !el.nodeName) {\n            console.error(context, 'Expected to get DOM Element, got ', element);\n            throw new Error(context + ': Expected to get DOM Element, got' + (typeof element));\n        }\n        return el;\n    }\n\n    //Unbind utils\n    function triggerError($el, e) {\n        let msg = e.message || e;\n        if ($.isPlainObject(msg)) {\n            msg = JSON.stringify(msg);\n        }\n        $el.attr(errorAttr, msg).trigger(events.error, e);\n    }\n    function unbindAllAttributes(domEl) {\n        const $el = $(domEl);\n        $(domEl.attributes).each(function (index, nodeMap) {\n            let attr = nodeMap.nodeName;\n            const wantedPrefix = 'data-f-';\n            if (attr.indexOf(wantedPrefix) === 0) {\n                attr = attr.replace(wantedPrefix, '');\n                const handler = attrManager.getHandler(attr, $el);\n                if (handler.unbind) {\n                    handler.unbind(attr, $el);\n                }\n            }\n        });\n    }\n    function unbindAllNodeHandlers(domEl) {\n        const $el = $(domEl);\n        //FIXME: have to readd events to be able to remove them. Ugly\n        const Handler = nodeManager.getHandler($el);\n        const h = new Handler.handle({\n            el: domEl\n        });\n        if (h.removeEvents) {\n            h.removeEvents();\n        }\n    }\n    function removeAllSubscriptions(subscriptions, channel, el) {\n        [].concat(subscriptions).forEach(function (subs) {\n            try {\n                channel.unsubscribe(subs);\n            } catch (e) {\n                triggerError(el, e);\n            } \n        });\n    }\n\n\n    const publicAPI = {\n\n        nodes: nodeManager,\n        attributes: attrManager,\n        converters: converterManager,\n            \n        matchedElements: new Map(),\n\n        /**\n         * Unbind the element; unsubscribe from all updates on the relevant channels.\n         *\n         * @param {JQuery<HTMLElement> | HTMLElement} element The element to remove from the data binding.\n         * @param {Channel} channel (Optional) The channel from which to unsubscribe. Defaults to the [variables channel](../channels/variables-channel/).\n         * @returns {void}\n         */\n        unbindElement: function (element, channel) {\n            if (!channel) {\n                channel = this.options.channel;\n            }\n            const domEl = getElementOrError(element);\n            const $el = $(element);\n            const existingData = this.matchedElements.get(domEl);\n            if (!$el.is(':' + prefix) || !existingData) {\n                return;\n            }\n            this.matchedElements.delete(element);\n            const subscriptions = Object.keys(existingData).reduce((accum, a)=> {\n                const subsid = existingData[a].subscriptionId;\n                if (subsid) accum.push(subsid);\n                return accum;\n            }, []);\n\n            unbindAllNodeHandlers(domEl);\n            unbindAllAttributes(domEl);\n            removeAllSubscriptions(subscriptions, channel, $el);\n            \n            const animAttrs = Object.keys(animation).join(' ');\n            $el.removeAttr(animAttrs);\n\n            Object.keys($el.data()).forEach(function (key) {\n                if (key.indexOf('f-') === 0 || key.match(/^f[A-Z]/)) {\n                    $el.removeData(key);\n                }\n            });\n        },\n\n        /**\n         * Bind the element: subscribe from updates on the relevant channels.\n         *\n         * @param {HTMLElement | JQuery<HTMLElement>} element The element to add to the data binding.\n         * @param {Channel} channel (Optional) The channel to subscribe to. Defaults to the [run channel](../channels/run-channel/).\n         * @returns {void}\n         */\n        bindElement: function (element, channel) {\n            if (!channel) {\n                channel = this.options.channel;\n            }\n            // this.unbindElement(element); //unbind actually removes the data,and jquery doesn't refetch when .data() is called..\n            const domEl = getElementOrError(element);\n            const $el = $(domEl);\n            if (!$el.is(`:${prefix}`)) {\n                return;\n            }\n\n            //Send to node manager to handle ui changes\n            const Handler = nodeManager.getHandler($el);\n            new Handler.handle({\n                el: domEl\n            });\n\n            const filterPrefix = `data-${prefix}-`;\n            const attrList = {};\n            $(domEl.attributes).each(function (index, nodeMap) {\n                let attr = nodeMap.nodeName;\n                if (attr.indexOf(filterPrefix) !== 0) {\n                    return;\n                } \n                attr = attr.replace(filterPrefix, '');\n\n                const attrVal = nodeMap.value;\n                let topics = parseTopicsFromAttributeValue(attrVal);\n                \n                const handler = attrManager.getHandler(attr, $el);\n                if (handler && handler.init) {\n                    handler.init(attr, topics, $el);\n                }\n                if (topics.length && handler && handler.parse) {\n                    topics = [].concat(handler.parse(topics));\n                }\n                \n                const channelPrefix = getChannelForAttribute($el, attr);\n                topics = addPrefixToTopics(topics, channelPrefix);\n\n                const converters = getConvertersForEl($el, attr);\n                attrList[attr] = {\n                    channelPrefix: channelPrefix,\n                    topics: topics,\n                    converters: converters, //Store once instead of calculating on demand. Avoids having to parse through dom every time\n                };\n            });\n            //Need this to be set before subscribing or callback maybe called before it's set\n            this.matchedElements.set(domEl, attrList);\n            \n            const channelConfig = getChannelConfigForElement(domEl);\n            const attrsWithSubscriptions = Object.keys(attrList).reduce((accum, name)=> {\n                const attr = attrList[name];\n                const { topics, channelPrefix } = attr;\n                if (!topics.length) {\n                    accum[name] = attr;\n                    return accum;\n                }\n\n                const subsOptions = $.extend({ \n                    batch: true,\n                    onError: (e)=> {\n                        console.error('DomManager: Subscription error', domEl, e);\n                        triggerError($el, e);\n                    }\n                }, channelConfig);\n                const subscribableTopics = topics.map((t)=> t.name);\n                const subsid = channel.subscribe(subscribableTopics, (data, meta)=> {\n                    if (meta && isEqual(data, meta.previousData)) {\n                        return;\n                    }\n                    const toConvert = {};\n                    if (subscribableTopics.length === 1) { //If I'm only interested in 1 thing pass in value directly, else make a map;\n                        toConvert[name] = data[subscribableTopics[0]];\n                    } else {\n                        const dataForAttr = pick(data, subscribableTopics) || {};\n                        toConvert[name] = Object.keys(dataForAttr).reduce((accum, key)=> {\n                            //If this was through a auto-prefixed channel attr return what was bound\n                            const toReplace = new RegExp(`^${channelPrefix}:`);\n                            const k = channelPrefix ? key.replace(toReplace, '') : key;\n                            accum[k] = dataForAttr[key];\n                            return accum;\n                        }, {});\n                    }\n                    $el.removeAttr(errorAttr).trigger(events.convert, toConvert);\n                }, subsOptions);\n\n                accum[name] = Object.assign({}, attr, { subscriptionId: subsid });\n                return accum;\n            }, {});\n\n            this.matchedElements.set(domEl, attrsWithSubscriptions);\n        },\n\n        /**\n         * Bind all provided elements.\n         *\n         * @param  {JQuery<HTMLElement> | HTMLElement[]} [elementsToBind] (Optional) If not provided, binds all matching elements within default root provided at initialization.\n         * @returns {void}\n         */\n        bindAll: function (elementsToBind) {\n            if (!elementsToBind) {\n                elementsToBind = getMatchingElements(this.options.root);\n            } else if (!Array.isArray(elementsToBind)) {\n                elementsToBind = getMatchingElements(elementsToBind);\n            }\n\n            //parse through dom and find everything with matching attributes\n            $.each(elementsToBind, (index, element)=> {\n                this.bindElement(element, this.options.channel);\n            });\n        },\n        /**\n         * Unbind provided elements.\n         *\n         * @param  {JQuery<HTMLElement> | HTMLElement[]} [elementsToUnbind] (Optional) If not provided, unbinds everything.\n         * @returns {void}\n         */\n        unbindAll: function (elementsToUnbind) {\n            const me = this;\n            if (!elementsToUnbind) {\n                elementsToUnbind = [];\n                this.matchedElements.forEach((val, key)=> {\n                    elementsToUnbind.push(key);\n                });\n            } else if (!Array.isArray(elementsToUnbind)) {\n                elementsToUnbind = getMatchingElements(elementsToUnbind);\n            }\n            $.each(elementsToUnbind, function (index, element) {\n                me.unbindElement(element, me.options.channel);\n            });\n        },\n\n        plugins: {},\n\n        /**\n         * Initialize the DOM Manager to work with a particular HTML element and all elements within that root. Data bindings between individual HTML elements and the model variables specified in the attributes will happen via the channel.\n         *\n         * @param {Object} options (Optional) Overrides for the default options.\n         * @param {string} options.root The root HTML element being managed by this instance of the DOM Manager. Defaults to `body`.\n         * @param {Object} options.channel The channel to communicate with. Defaults to the Channel Manager from [Epicenter.js](../../../api_adapters/).\n         * @param {boolean} options.autoBind If `true` (default), any variables added to the DOM after `Flow.initialize()` has been called will be automatically parsed, and subscriptions added to channels. Note, this does not work in IE versions < 11.\n         * @returns {Promise}\n         */\n        initialize: function (options) {\n            const defaults = {\n                /**\n                 * Root of the element for flow.js to manage from.\n                 * @type {string} jQuery selector\n                 */\n                root: 'body',\n                channel: null,\n\n                /**\n                 * Any variables added to the DOM after `Flow.initialize()` has been called will be automatically parsed, and subscriptions added to channels. Note, this does not work in IE versions < 11.\n                 * @type {boolean}\n                 */\n                autoBind: true\n            };\n            $.extend(defaults, options);\n\n            const channel = defaults.channel;\n\n            this.options = defaults;\n\n            const me = this;\n            const $root = $(defaults.root);\n\n            function attachUIListeners($root) {\n                function parseValue(value, converters) {\n                    if (Array.isArray(value)) {\n                        const parsed = value.map(function (val) {\n                            return toImplicitType(val);\n                        });\n                        return converterManager.parse(parsed, converters);\n                    }\n                    return converterManager.parse(toImplicitType(value), converters);\n                }\n\n                $root.off(events.trigger).on(events.trigger, function (evt, params) {\n                    const elMeta = me.matchedElements.get(evt.target);\n                    const { data, source, options } = params;\n                    if (!elMeta || !data) {\n                        return;\n                    }\n                    const sourceMeta = elMeta[source] || {};\n                    const { channelPrefix, converters } = sourceMeta;\n                    const $el = $(evt.target);\n\n                    const parsed = ([].concat(data)).map(function (action) {\n                        const { name, value } = action;\n                        const parsedValue = parseValue(value, converters);\n                        const actualName = name.split('|')[0].trim(); //FIXME: this shouldn't know about the pipe syntax\n                        const prefixedName = addDefaultPrefix(actualName, source, channelPrefix);\n                        return { name: prefixedName, value: parsedValue };\n                    }, []);\n\n                    channel.publish(parsed, options).then((result)=> {\n                        if (!result || !result.length) {\n                            return;\n                        }\n                        const last = result[result.length - 1];\n                        $el.trigger(events.convert, { [source]: last.value });\n                    }, (e)=> {\n                        triggerError($el, e);\n                    });\n                });\n            }\n\n            function attachConversionListner($root) {\n                // data = {proptoupdate: value}\n                $root.off(events.convert).on(events.convert, function (evt, data) {\n                    const $el = $(evt.target);\n\n                    const elMeta = me.matchedElements.get(evt.target);\n                    if (!elMeta) {\n                        return;\n                    }\n\n                    Object.keys(data).forEach((prop)=> {\n                        const val = data[prop];\n                        const { converters, topics } = elMeta[prop];\n                        const convertedValue = converterManager.convert(val, converters);\n\n                        const handler = attrManager.getHandler(prop, $el);\n                        handler.handle(convertedValue, prop, $el, topics);\n                    });\n                });\n            }\n            \n            const deferred = $.Deferred();\n            $(function () {\n                me.bindAll();\n            \n                attachUIListeners($root);\n                attachConversionListner($root);\n\n                me.plugins.autoBind = autoUpdatePlugin($root.get(0), me, me.options.autoBind);\n                \n                deferred.resolve($root);\n                $root.trigger('f.domready');\n            });\n\n            return deferred.promise();\n        }\n    };\n\n    return $.extend(this, publicAPI);\n}());\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/dom-manager.js","import { getConvertersForEl } from './parse-converters';\nimport { getChannelForAttribute, getChannelConfigForElement } from './parse-channel';\nimport { parseTopicsFromAttributeValue } from './parse-topics';\n\nexport { \n    getConvertersForEl,\n    getChannelForAttribute,\n    getChannelConfigForElement,\n    parseTopicsFromAttributeValue,\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/dom-manager-utils/dom-parse-helpers/index.js","/**\n * @param {string} conv \n * @returns {string[]}\n */\nfunction convertersToArray(conv) {\n    if (!conv || !conv.trim()) return [];\n    return conv.split('|').map((v)=> v.trim());\n}\n\n/**\n * @param {JQuery<HTMLElement>} $el\n * @param {string} attribute \n * @returns {string[]}\n */\nfunction getConvertersFromAttr($el, attribute) {\n    const attrVal = $el.attr(`data-f-${attribute}`);\n    const withConv = convertersToArray(attrVal);\n    if (withConv.length > 1) {\n        return withConv.slice(1); //First item will be the topic\n    }\n    return [];\n}\nfunction getFConvertAttrVal($el, suffix) {\n    const baseAttr = 'data-f-convert';\n    const suffixAttr = suffix ? `-${suffix}` : '';\n    const conv = $el.attr(`${baseAttr}${suffixAttr}`); //.data shows value cached by jquery\n    return convertersToArray(conv);\n}\n\n/**\n * @param {JQuery<HTMLElement>} $el  \n * @param {string} attribute \n * @returns {string[]} converters\n */\nexport function getConvertersForEl($el, attribute) {\n    function getAllConverters($el, attribute) {\n        const convertersAsPipes = getConvertersFromAttr($el, attribute);\n        if (convertersAsPipes.length) {\n            return convertersAsPipes;\n        }\n\n        const whiteListedGenericAttributes = ['bind', 'foreach', 'repeat'];\n        const canUseFConvert = whiteListedGenericAttributes.indexOf(attribute) !== -1;\n        if (canUseFConvert) {\n            return getFConvertAttrVal($el, '');\n        }\n        return getFConvertAttrVal($el, attribute);\n    }\n   \n    const converters = getAllConverters($el, attribute);\n    const $parentEl = $el.parents('[data-f-convert]').eq(0);\n    const resolvedConverters = converters.reduce((accum, val)=> {\n        if (val === 'inherit') {\n            const parentConv = getConvertersForEl($parentEl, attribute);\n            accum = accum.concat(parentConv);\n        } else {\n            accum = accum.concat(val);\n        }\n        return accum;\n    }, []);\n\n    if (!resolvedConverters.length && $parentEl.length) {\n        return getConvertersForEl($parentEl, attribute);\n    }\n    return resolvedConverters;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/dom-manager-utils/dom-parse-helpers/parse-converters.js","/**\n * \n * @param {JQuery<HTMLElement>} $el  \n * @param {string} attr \n * @returns {string|undefined}\n */\nexport function getChannelForAttribute($el, attr) {\n    attr = attr.replace('data-f-', '');\n    let channel = $el.data('f-channel-' + attr);\n    if (channel === undefined) {\n        channel = $el.attr('data-f-channel'); //.data shows value cached by jquery\n    }\n    if (channel === undefined) {\n        const $parentEl = $el.closest('[data-f-channel]');\n        if ($parentEl) {\n            channel = $parentEl.attr('data-f-channel');\n        }\n    }\n    return channel;\n}\n\n/**\n * @param {HTMLElement} el\n * @returns {Object}\n */ \nexport function getChannelConfigForElement(el) {\n    //TODO: Should this look at parents too?\n    const attrs = el.attributes;\n    const config = {};\n    for (let i = 0; i < attrs.length; i++) {\n        const attrib = el.attributes[i];\n        if (attrib.specified && attrib.name.indexOf('data-f-channel-') === 0) {\n            const key = attrib.name.replace('data-f-channel-', '');\n            config[key] = attrib.value;\n        }\n    }\n    return config;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/dom-manager-utils/dom-parse-helpers/parse-channel.js","/**\n * @param {string} attrVal \n * @returns {NormalizedTopic[]} variables\n */\nexport function parseTopicsFromAttributeValue(attrVal) {\n    const commaRegex = /,(?![^[(]*[\\])])/; //split except on a[b,c] or a(v,c)\n    const topicsPart = attrVal.split('|')[0];\n    if (topicsPart.indexOf('<%') !== -1) { //Assume it's templated for later use\n        return [];\n    } \n    const split = topicsPart.split(commaRegex);\n    if (split.length > 1) {\n        return split.map((v)=> ({ name: v.trim() }));\n    } \n    return [{ name: topicsPart.trim() }];\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/dom-manager-utils/dom-parse-helpers/parse-topics.js","/**\n * \n * @param {NormalizedTopic[]} topics \n * @param {string} prefix \n * @returns {NormalizedTopic[]}\n */\nexport function addPrefixToTopics(topics, prefix) {\n    if (!prefix) {\n        return topics;\n    }\n    const mappedTopics = topics.map((topic)=> {\n        const currentName = topic.name;\n        const hasChannelDefined = currentName.indexOf(':') !== -1;\n        if (!hasChannelDefined) {\n            topic.name = `${prefix}:${currentName}`;\n        }\n        return topic;\n    });\n    return mappedTopics;\n}\n\nconst DEFAULT_OPERATIONS_PREFIX = 'operations:';\nconst DEFAULT_VARIABLES_PREFIX = 'variables:';\n\nexport function addDefaultPrefix(name, source, channelPrefix) {\n    const isUnprefixed = name.indexOf(':') === -1;\n\n    const defaultPrefix = source.indexOf('on-') === 0 ? DEFAULT_OPERATIONS_PREFIX : DEFAULT_VARIABLES_PREFIX;\n    const needsDefaultPrefix = defaultPrefix !== DEFAULT_VARIABLES_PREFIX;\n\n    if (isUnprefixed && needsDefaultPrefix) {\n        name = `${defaultPrefix}${name}`;\n    }\n    const hasDefaultPrefix = name.indexOf(defaultPrefix) === 0;\n    if ((isUnprefixed || hasDefaultPrefix) && channelPrefix) {\n        name = `${channelPrefix}:${name}`;\n    }\n    return name;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/dom-manager-utils/dom-channel-prefix-helpers/index.js","import { isFunction, isString, isRegExp, find, mapValues } from 'lodash';\nimport { splitNameArgs, toImplicitType } from '../utils/parse-utils';\n\nvar normalize = function (alias, converter, acceptList) {\n    var ret = [];\n    //nomalize('flip', fn)\n    if (isFunction(converter)) {\n        ret.push({\n            alias: alias,\n            convert: converter,\n            acceptList: acceptList\n        });\n    } else if ($.isPlainObject(converter) && converter.convert) {\n        converter.alias = alias;\n        converter.acceptList = acceptList;\n        ret.push(converter);\n    } else if ($.isPlainObject(alias)) {\n        //normalize({alias: 'flip', convert: function})\n        if (alias.convert) {\n            ret.push(alias);\n        } else {\n            // normalize({flip: fun})\n            $.each(alias, function (key, val) {\n                ret.push({\n                    alias: key,\n                    convert: val,\n                    acceptList: acceptList\n                });\n            });\n        }\n    }\n    return ret;\n};\n\nvar matchConverter = function (alias, converter) {\n    if (isString(converter.alias)) {\n        return alias === converter.alias;\n    } else if (isFunction(converter.alias)) {\n        return converter.alias(alias);\n    } else if (isRegExp(converter.alias)) {\n        return converter.alias.match(alias);\n    }\n    return false;\n};\n\nvar converterManager = {\n    private: {\n        matchConverter: matchConverter\n    },\n\n    list: [],\n    /**\n     * Add a new attribute converter to this instance of Flow.js.\n     *\n     * **Example**\n     *\n     *      Flow.dom.converters.register('max', function (value) {\n     *          return max(value);\n     *      }, true);\n     *\n     *      Flow.dom.converters.register({\n     *          alias: 'sig',\n     *          parse: $.noop,\n     *          convert: function (value) {\n     *              return value.firstName + ' ' + value.lastName + ', ' + value.jobTitle;\n     *      }, false);\n     *\n     *      <div>\n     *          The largest sales you had was <span data-f-bind=\"salesByYear | max | $#,###\"></span>.\n     *          The current sales manager is <span data-f-bind=\"salesMgr | sig\"></span>.\n     *      </div>\n     *\n     * @param  {string|Function|RegExp} alias Formatter name.\n     * @param  {Function|Object} [converter] If a function, `converter` is called with the value. If an object, should include fields for `alias` (name), `parse` (function), and `convert` (function).\n     * @param {boolean} [acceptList] Determines if the converter is a 'list' converter or not. List converters take in arrays as inputs, others expect single values.\n     * @returns {void}\n     */\n    register: function (alias, converter, acceptList) {\n        var normalized = normalize(alias, converter, acceptList);\n        this.list = normalized.concat(this.list);\n    },\n\n    /**\n     * Replace an already registered converter with a new one of the same name.\n     *\n     * @param {string} alias Formatter name.\n     * @param {Function|Object} converter If a function, `converter` is called with the value. If an object, should include fields for `alias` (name), `parse` (function), and `convert` (function).\n     * @returns {void}\n     */\n    replace: function (alias, converter) {\n        var index;\n        this.list.forEach(function (currentConverter, i) {\n            if (matchConverter(alias, currentConverter)) {\n                index = i;\n                return false;\n            }\n        });\n        this.list.splice(index, 1, normalize(alias, converter)[0]);\n    },\n\n    getConverter: function (alias) {\n        var norm = splitNameArgs(alias);\n        norm.args = norm.args.map(toImplicitType);\n\n        var conv = find(this.list, function (converter) {\n            return matchConverter(norm.name, converter);\n        });\n        if (conv && norm.args) {\n            return $.extend({}, conv, { convert: Function.bind.apply(conv.convert, [null].concat(norm.args)) });\n        }\n        return conv;\n    },\n\n    /**\n     * Pipes the value sequentially through a list of provided converters.\n     *\n     * @param  {*} value Input for the converter to tag.\n     * @param  {string|string[]} list List of converters (maps to converter alias).\n     *\n     * @returns {*} Converted value.\n     */\n    convert: function (value, list) {\n        if (!list || !list.length) {\n            return value;\n        }\n        list = ([].concat(list)).map((v)=> v.trim());\n\n        var currentValue = value;\n        var me = this;\n\n        var convertArray = function (converter, val, converterName) {\n            return val.map(function (v) {\n                return converter.convert(v, converterName);\n            });\n        };\n        var convert = function (converter, value, converterName) {\n            var converted;\n            if (Array.isArray(value) && converter.acceptList !== true) {\n                converted = convertArray(converter, value, converterName);\n            } else {\n                converted = converter.convert(value, converterName);\n            }\n            return converted;\n        };\n        var convertObject = function (converter, value, converterName) {\n            return mapValues(value, function (val) {\n                return convert(converter, val, converterName);\n            });\n        };\n        list.forEach(function (converterName) {\n            var converter = me.getConverter(converterName);\n            if (!converter) {\n                throw new Error('Could not find converter for ' + converterName);\n            }\n            if ($.isPlainObject(currentValue) && converter.acceptList !== true) {\n                currentValue = convertObject(converter, currentValue, converterName);\n            } else {\n                currentValue = convert(converter, currentValue, converterName);\n            }\n        });\n        return currentValue;\n    },\n\n    /**\n     * Counter-part to `convert()`. Translates converted values back to their original form.\n     *\n     * @param  {*} value Value to parse.\n     * @param  {string|string[]} list  List of parsers to run the value through. Outermost is invoked first.\n     * @returns {*} Original value.\n     */\n    parse: function (value, list) {\n        if (!list || !list.length) {\n            return value;\n        }\n        list = [].concat(list).reverse().map((v)=> v.trim());\n\n        var currentValue = value;\n        var me = this;\n        list.forEach(function (converterName) {\n            var converter = me.getConverter(converterName);\n            if (!converter) {\n                throw new Error('parse: Could not find converter ' + converterName);\n            }\n            if (converter.parse) {\n                currentValue = converter.parse(currentValue, converterName);\n            }\n        });\n        return currentValue;\n    }\n};\n\n\n//Bootstrap\nvar defaultconverters = [\n    require('./converters/number-converters'),\n    require('./converters/string-converters'),\n    require('./converters/array-converters'),\n    require('./converters/general-util-converters'),\n    require('./converters/numberformat-converter'),\n    require('./converters/number-compare-converters'),\n    require('./converters/boolean-conditional-converters'),\n    require('./converters/collection-converters')\n];\n\ndefaultconverters.reverse().forEach(function (converter) {\n    if (Array.isArray(converter)) {\n        converter.forEach(function (c) {\n            converterManager.register(c);\n        });\n    } else {\n        converterManager.register(converter);\n    }\n});\n\nexport default converterManager;\n\n\n\n// WEBPACK FOOTER //\n// ./src/converter-manager/index.js","module.exports = {\n    alias: 'i',\n    /**\n     * Convert the model variable to an integer. Often used for chaining to another converter.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          Your car has driven\n     *          <span data-f-bind=\"Odometer | i | s0.0\"></span> miles.\n     *      </div>\n     *\n     * @param {string} value The model variable.\n     * @returns {number}\n     */\n    convert: function (value) {\n        return parseFloat(value);\n    }\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/converter-manager/converters/number-converters/index.js","module.exports = {\n\n    /**\n     * Convert the model variable to a string. Often used for chaining to another converter.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          This year you are in charge of sales for\n     *          <span data-f-bind=\"salesMgr.region | s | upperCase\"></span>.\n     *      </div>\n     *\n     * @param {Array} val The model variable.\n     * @returns {string} converted string\n     */\n    s: function (val) {\n        return val + '';\n    },\n\n    /**\n     * Convert the model variable to UPPER CASE.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          This year you are in charge of sales for\n     *          <span data-f-bind=\"salesMgr.region | s | upperCase\"></span>.\n     *      </div>\n     *\n     * @param {Array} val The model variable.\n     * @returns {string} converted string\n     */\n    upperCase: function (val) {\n        return (val + '').toUpperCase();\n    },\n\n    /**\n     * Convert the model variable to lower case.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          Enter your user name:\n     *          <input data-f-bind=\"userName | lowerCase\"></input>.\n     *      </div>\n     *\n     * @param {Array} val The model variable.\n     * @returns {string} converted string\n     */\n    lowerCase: function (val) {\n        return (val + '').toLowerCase();\n    },\n\n    /**\n     * Convert the model variable to Title Case.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          Congratulations on your promotion!\n     *          Your new title is: <span data-f-bind=\"currentRole | titleCase\"></span>.\n     *      </div>\n     *\n     * @param {string} val The model variable.\n     * @returns {string} converted string\n     */\n    titleCase: function (val) {\n        val = val + '';\n        return val.replace(/\\w\\S*/g, function (txt) {\n            return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();\n        });\n    },\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/converter-manager/converters/string-converters/index.js","const _ = require('lodash');\n\nfunction parseLimitArgs(starting, limit, val) {\n    let toRet = {};\n    if (arguments.length === 3) { //eslint-disable-line\n        toRet = {\n            input: limit,\n            limit: starting\n        };\n    } else if (arguments.length === 2) {\n        toRet = {\n            input: starting\n        };\n    } else {\n        console.error('Too many arguments passed to last', arguments);\n        throw new Error('Too many arguments passed to last');\n    }\n\n    toRet.input = [].concat(toRet.input);\n    return toRet;\n}\n\nconst list = {\n    /**\n     * Convert the input into an array. \n     *\n     * @param {any[]} val The array model variable.\n     * @returns {any[]}\n     */\n    list: (val)=> [].concat(val),\n\n    /**\n     * Reverse the array.\n     *\n     * **Example**\n     *\n     *      <p>Show the history of our sales, starting with the last (most recent):</p>\n     *      <ul data-f-foreach=\"Sales | reverse\">\n     *          <li></li>\n     *      </ul>\n     *\n     * @param {any[]} val The array model variable.\n     * @returns {any[]} the reversed array\n     */\n    reverse: (val)=> ([].concat(val)).reverse(),\n\n    /**\n     * Select only the last element of the array.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          In the current year, we have <span data-f-bind=\"Sales | last\"></span> in sales.\n     *      </div>\n     *\n     * @param {number} n number of items to get\n     * @param {any[]} val The array model variable.\n     * @returns {any} last element of array\n     */\n    last: function (n, val) {\n        const parsed = parseLimitArgs.apply(null, arguments);\n        const stripped = parsed.input.slice(-(parsed.limit || 1));\n        if (stripped.length <= 1) {\n            return stripped[0];\n        }\n        return stripped;\n    },\n\n    /**\n     * Select only the first element of the array.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          Our initial investment was <span data-f-bind=\"Capital | first\"></span>.\n     *      </div>\n     *\n     * @param {number} n number of items to get\n     * @param {any[]} val The array model variable.\n     * @returns {any} first element of the array\n     */\n    first: function (n, val) {\n        const parsed = parseLimitArgs.apply(null, arguments);\n        const stripped = parsed.input.slice(0, (parsed.limit || 1));\n        if (stripped.length <= 1) {\n            return stripped[0];\n        }\n        return stripped;\n    },\n\n    /**\n     * Select only the previous (second to last) element of the array.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          Last year we had <span data-f-bind=\"Sales | previous\"></span> in sales.\n     *      </div>\n     *\n     * @param {any[]} val The array model variable.\n     * @returns {any} the previous (second to last) element of the array.\n     */\n    previous: (val)=> {\n        val = [].concat(val);\n        return (val.length <= 1) ? val[0] : val[val.length - 2];\n    },\n\n    /**\n     * Returns length of array\n     *\n     * **Example**\n     * Total Items: <h6 data-f-bind=\"items | size\"></h6>\n     * \n     * @param  {any[]} src array\n     * @returns {number}     length of array\n     */\n    size: (src)=> [].concat(src).length,\n\n    /**\n     * Select every nth item from array\n     *\n     * **Example**\n     * <!-- select every 10th item starting from itself\n     * <ul data-f-foreach=\"Time | pickEvery(10)\"><li></li></ul>\n     * <!-- select every 10th item starting from the fifth\n     * <ul data-f-foreach=\"Time | pickEvery(10, 5)\"><li></li></ul>\n     * \n     * @param  {number} n          nth item to select\n     * @param  {number} [startIndex] index to start from\n     * @param  {any[]} [val]        source array\n     * @returns {any[]}            shortened array\n     */\n    pickEvery: function (n, startIndex, val) {\n        if (arguments.length === 3) { //eslint-disable-line\n            //last item is match string\n            val = startIndex;\n            startIndex = 0;\n        }\n        val = [].concat(val);\n        val = val.slice(startIndex);\n        return val.filter((item, index)=> {\n            return (index % n) === 0;\n        });\n    },\n};\n\nconst mapped = Object.keys(list).map(function (alias) {\n    const fn = list[alias];\n    const newfn = function () {\n        const args = _.toArray(arguments);\n        const indexOfActualValue = args.length - 2; //last item is the matchstring\n        const val = args[indexOfActualValue];\n        if ($.isPlainObject(val)) {\n            return Object.keys(val).reduce((accum, key)=> {\n                const arr = val[key];\n                const newArgs = args.slice();\n                newArgs[indexOfActualValue] = arr;\n                accum[key] = fn.apply(fn, newArgs);\n                return accum;\n            }, {});\n        }\n        return fn.apply(fn, arguments);\n    };\n    return {\n        alias: alias,\n        acceptList: true,\n        convert: newfn,\n    };\n});\nmodule.exports = mapped;\n\n\n\n// WEBPACK FOOTER //\n// ./src/converter-manager/converters/array-converters/index.js","function parseArgs(toCompare, trueVal, falseVal, valueToCompare, matchString) {\n    const toReturn = { trueVal: true, falseVal: false };\n    switch (arguments.length) {\n        case 5: //eslint-disable-line\n            return $.extend(toReturn, { trueVal: trueVal, falseVal: falseVal, input: valueToCompare });\n        case 4: //eslint-disable-line\n            return $.extend(toReturn, { trueVal: trueVal, falseVal: falseVal, input: falseVal }); \n        case 3: //eslint-disable-line\n            return $.extend(toReturn, { input: trueVal, falseVal: trueVal }); \n        default:\n            return toReturn;\n    }\n}\n\nmodule.exports = [\n    {\n        alias: 'is',\n        acceptList: false,\n        convert: function (toCompare) {\n            const args = parseArgs.apply(null, arguments);\n            return args.input === toCompare ? args.trueVal : args.falseVal;\n        }\n    }\n];\n\n\n\n// WEBPACK FOOTER //\n// ./src/converter-manager/converters/general-util-converters/index.js","const { isString, isNumber } = require('lodash');\n\nfunction isAllowedLeading(str) { \n    const validPrefixes = ['', '$', '', '', '', '', '', ''];\n    return validPrefixes.indexOf(str.trim()) !== -1;\n}\n\nmodule.exports = {\n    /**\n     * @param {string} name\n     * @returns {boolean}\n     */\n    alias: function (name) {\n        /**\n         * @param {string} v\n         * @returns {boolean}\n         */\n        function checkValMatch(v) {\n            const validStandalone = ['#', '0', '%'];\n            if (v.length === 1) {\n                return validStandalone.indexOf(v) !== -1;\n            }\n\n            const validFirstChars = ['s', '#', '0', '.'];\n            const validLastChars = ['%', '#', '0'];\n\n            if (isAllowedLeading(v.charAt(0))) {\n                v = v.slice(1);\n            }\n            const isValidFirstChar = validFirstChars.indexOf(v.charAt(0)) !== -1;\n            const isValidLastChar = validLastChars.indexOf(v.charAt(v.length - 1)) !== -1;\n\n            if (v.length === 2) {\n                return isValidFirstChar && isValidLastChar;\n            }\n            \n            const validRemainingChars = ['#', '0', '.', ','];\n            const areRemainingCharactersValid = v.substr(1, v.length - 2).split('').reduce((accum, char)=> {\n                const isMatch = validRemainingChars.indexOf(char) !== -1;\n                if (!isMatch) {\n                    accum = false;\n                }\n                return accum;\n            }, true);\n\n            return isValidFirstChar && isValidLastChar && areRemainingCharactersValid;\n        }\n\n        const parts = name.split(' ');\n        if (parts.length === 3) {\n            return checkValMatch(parts[1]); //prefix and suffix\n        } else if (parts.length === 1) {\n            return checkValMatch(parts[0]); //just the number\n        } else if (parts.length === 2) {\n            return checkValMatch(parts[0]) || checkValMatch(parts[1]); //either prefix or suffix\n        }\n        return false;\n    },\n\n    /**\n     * @param {string} val\n     * @returns {number}\n     */\n    parse: function (val) {\n        val += '';\n        var isNegative = val.charAt(0) === '-';\n\n        val = val.replace(/,/g, '');\n        var floatMatcher = /([-+]?[0-9]*\\.?[0-9]+)(K?M?B?%?)/i;\n        var results = floatMatcher.exec(val);\n        var number;\n        var suffix = '';\n        if (results && results[1]) {\n            number = results[1];\n        }\n        if (results && results[2]) {\n            suffix = results[2].toLowerCase();\n        }\n\n        /*eslint no-magic-numbers: 0 complexity: 0 */\n        switch (suffix) {\n            case '%':\n                number = number / 100;\n                break;\n            case 'k':\n                number = number * 1000;\n                break;\n            case 'm':\n                number = number * 1000000;\n                break;\n            case 'b':\n                number = number * 1000000000;\n                break;\n            default:\n        }\n        number = parseFloat(number);\n        if (isNegative && number > 0) {\n            number = number * -1;\n        }\n        return number;\n    },\n\n    convert: (function (value) {\n        var scales = ['', 'K', 'M', 'B', 'T'];\n        function roundTo(value, digits) {\n            return Math.round(value * Math.pow(10, digits)) / Math.pow(10, digits);\n        }\n\n        function getDigits(value, digits) {\n            value = value === 0 ? 0 : roundTo(value, Math.max(0, digits - Math.ceil(Math.log(value) / Math.LN10)));\n\n            var TXT = '';\n            var numberTXT = value.toString();\n            var decimalSet = false;\n\n            for (var iTXT = 0; iTXT < numberTXT.length; iTXT++) {\n                TXT += numberTXT.charAt(iTXT);\n                if (numberTXT.charAt(iTXT) === '.') {\n                    decimalSet = true;\n                } else {\n                    digits--;\n                }\n\n                if (digits <= 0) {\n                    return TXT;\n                }\n            }\n\n            if (!decimalSet) {\n                TXT += '.';\n            }\n            while (digits > 0) {\n                TXT += '0';\n                digits--;\n            }\n            return TXT;\n        }\n\n        function addDecimals(value, decimals, minDecimals, hasCommas) {\n            hasCommas = !!hasCommas;\n            var numberTXT = value.toString();\n            var hasDecimals = (numberTXT.split('.').length > 1);\n            var iDec = 0;\n\n            if (hasCommas) {\n                for (var iChar = numberTXT.length - 1; iChar > 0; iChar--) {\n                    if (hasDecimals) {\n                        hasDecimals = (numberTXT.charAt(iChar) !== '.');\n                    } else {\n                        iDec = (iDec + 1) % 3;\n                        if (iDec === 0) {\n                            numberTXT = numberTXT.substr(0, iChar) + ',' + numberTXT.substr(iChar);\n                        }\n                    }\n                }\n\n            }\n            if (decimals > 0) {\n                var toADD;\n                if (numberTXT.split('.').length <= 1) {\n                    toADD = minDecimals;\n                    if (toADD > 0) {\n                        numberTXT += '.';\n                    }\n                } else {\n                    toADD = minDecimals - numberTXT.split('.')[1].length;\n                }\n\n                while (toADD > 0) {\n                    numberTXT += '0';\n                    toADD--;\n                }\n            }\n            return numberTXT;\n        }\n\n        function getSuffix(formatTXT) {\n            formatTXT = formatTXT.replace('.', '');\n            var fixesTXT = formatTXT.split(new RegExp('[0|,|#]+', 'g'));\n            return (fixesTXT.length > 1) ? fixesTXT[1].toString() : '';\n        }\n\n        function format (number, formatTXT) { // eslint-disable-line\n            if (Array.isArray(number)) {\n                number = number[number.length - 1];\n            }\n            if (!isString(number) && !isNumber(number)) {\n                return number;\n            }\n\n            if (!formatTXT || formatTXT.toLowerCase() === 'default') {\n                return number.toString();\n            }\n\n            if (isNaN(number)) {\n                return '?';\n            }\n\n            //var formatTXT;\n            const entityCodeMapping = {\n                '&euro;': '',\n                '&dollar;': '$',\n                '&cent;': '',\n                '&pound;': '',\n                '&yen;': '',\n            };\n            Object.keys(entityCodeMapping).forEach((code)=> {\n                formatTXT = formatTXT.replace(code, entityCodeMapping[code]);\n            });\n\n            // Divide +/- Number Format\n            var formats = formatTXT.split(';');\n            if (formats.length > 1) {\n                return format(Math.abs(number), formats[((number >= 0) ? 0 : 1)]);\n            }\n\n            // Save Sign\n            var sign = (number >= 0) ? '' : '-';\n            number = Math.abs(number);\n\n\n            var leftOfDecimal = formatTXT;\n            var d = leftOfDecimal.indexOf('.');\n            if (d > -1) {\n                leftOfDecimal = leftOfDecimal.substring(0, d);\n            }\n\n            var normalized = leftOfDecimal.toLowerCase();\n            var index = normalized.lastIndexOf('s');\n            var isShortFormat = index > -1;\n\n            if (isShortFormat) {\n                var nextChar = leftOfDecimal.charAt(index + 1);\n                if (nextChar === ' ') {\n                    isShortFormat = false;\n                }\n            }\n\n            var leadingText = isShortFormat ? formatTXT.substring(0, index) : '';\n            var rightOfPrefix = isShortFormat ? formatTXT.substr(index + 1) : formatTXT.substr(index);\n\n            //first check to make sure 's' is actually short format and not part of some leading text\n            if (isShortFormat) {\n                var shortFormatTest = /[0-9#*]/;\n                var shortFormatTestResult = rightOfPrefix.match(shortFormatTest);\n                if (!shortFormatTestResult || shortFormatTestResult.length === 0) {\n                    //no short format characters so this must be leading text ie. 'weeks '\n                    isShortFormat = false;\n                    leadingText = '';\n                }\n            }\n\n            //if (formatTXT.charAt(0) == 's')\n            if (isShortFormat) {\n                var valScale = number === 0 ? 0 : Math.floor(Math.log(Math.abs(number)) / (3 * Math.LN10));\n                valScale = ((number / Math.pow(10, 3 * valScale)) < 1000) ? valScale : (valScale + 1);\n                valScale = Math.max(valScale, 0);\n                valScale = Math.min(valScale, 4);\n                number = number / Math.pow(10, 3 * valScale);\n                //if (!isNaN(Number(formatTXT.substr(1) ) ) )\n\n                if (!isNaN(Number(rightOfPrefix)) && rightOfPrefix.indexOf('.') === -1) {\n                    var limitDigits = Number(rightOfPrefix);\n                    if (number < Math.pow(10, limitDigits)) {\n                        if (isAllowedLeading(leadingText)) {\n                            return sign + leadingText + getDigits(number, Number(rightOfPrefix)) + scales[valScale];\n                        } else {\n                            return leadingText + sign + getDigits(number, Number(rightOfPrefix)) + scales[valScale];\n                        }\n                    } else if (isAllowedLeading(leadingText)) {\n                        return sign + leadingText + Math.round(number) + scales[valScale];\n                    } else {\n                        return leadingText + sign + Math.round(number) + scales[valScale];\n                    }\n                } else {\n                    //formatTXT = formatTXT.substr(1);\n                    formatTXT = formatTXT.substr(index + 1);\n                    var SUFFIX = getSuffix(formatTXT);\n                    formatTXT = formatTXT.substr(0, formatTXT.length - SUFFIX.length);\n\n                    var valWithoutLeading = format(((sign === '') ? 1 : -1) * number, formatTXT) + scales[valScale] + SUFFIX;\n                    if (isAllowedLeading(leadingText) && sign !== '') {\n                        valWithoutLeading = valWithoutLeading.substr(sign.length);\n                        return sign + leadingText + valWithoutLeading;\n                    }\n\n                    return leadingText + valWithoutLeading;\n                }\n            }\n\n            var subFormats = formatTXT.split('.');\n            var decimals;\n            var minDecimals;\n            if (subFormats.length > 1) {\n                decimals = subFormats[1].length - subFormats[1].replace(new RegExp('[0|#]+', 'g'), '').length;\n                minDecimals = subFormats[1].length - subFormats[1].replace(new RegExp('0+', 'g'), '').length;\n                formatTXT = subFormats[0] + subFormats[1].replace(new RegExp('[0|#]+', 'g'), '');\n            } else {\n                decimals = 0;\n            }\n\n            var fixesTXT = formatTXT.split(new RegExp('[0|,|#]+', 'g'));\n            var preffix = fixesTXT[0].toString();\n            var suffix = (fixesTXT.length > 1) ? fixesTXT[1].toString() : '';\n\n            number = number * ((formatTXT.split('%').length > 1) ? 100 : 1);\n            //            if (formatTXT.indexOf('%') !== -1) number = number * 100;\n            number = roundTo(number, decimals);\n\n            sign = (number === 0) ? '' : sign;\n\n            var hasCommas = (formatTXT.substr(formatTXT.length - 4 - suffix.length, 1) === ',');\n            var formatted = sign + preffix + addDecimals(number, decimals, minDecimals, hasCommas) + suffix;\n\n            //  console.log(originalNumber, originalFormat, formatted)\n            return formatted;\n        }\n\n        return format;\n    }())\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/converter-manager/converters/numberformat-converter/index.js","function parseArgs(limit, trueVal, falseVal, valueToCompare, matchString) {\n    var toReturn = { trueVal: true, falseVal: false };\n    switch (arguments.length) {\n        case 5: //eslint-disable-line\n            return $.extend(toReturn, { trueVal: trueVal, falseVal: falseVal, input: valueToCompare });\n        case 4: //eslint-disable-line\n            return $.extend(toReturn, { trueVal: trueVal, falseVal: falseVal, input: falseVal }); \n        case 3: //eslint-disable-line\n            return $.extend(toReturn, { input: trueVal, falseVal: trueVal }); \n        default:\n            return toReturn;\n    }\n}\nmodule.exports = {\n    /**\n     * Convert the model variable to true, or other values passed to the converter, based on whether the model variable is greater than the limit.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          <!-- displays true or the number of widgets -->\n     *          <span data-f-bind=\"widgets | greaterThan(50)\"></span> \n     *\n     *          <!-- displays custom text -->\n     *          <span data-f-bind=\"widgets | greaterThan(50, 'Congratulations!', 'Better luck next year')\"></span>\n     *      </div>\n     *\n     * @param {number} limit The reference value to compare the model variable against.\n     * @param {string} trueVal (Optional) The format (value) to display if the model variable is greater than `limit`. If not included, the display is `true`. If there are commas in this argument, they must be escaped with `\\`.\n     * @param {string} falseVal (Optional) The format (value) to display if the model variable is less than or equal to `limit`. If not included, the display is the value of the model variable. If there are commas in this argument, they must be escaped with `\\`.\n     * @returns {*} If the model variable is greater than `limit`, returns trueVal or `true`. Otherwise returns falseVal if provided, or echoes the input.\n     */\n    greaterThan: function (limit) {\n        var args = parseArgs.apply(null, arguments);\n        return Number(args.input) > Number(limit) ? args.trueVal : args.falseVal;\n    },\n\n    /**\n     * Convert the model variable to true, or other values passed to the converter, based on whether the model variable is greater than or equal to the limit.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          <!-- displays true or the number of widgets -->\n     *          <span data-f-bind=\"widgets | greaterThan(50)\"></span> \n     *\n     *          <!-- displays custom text -->\n     *          <span data-f-bind=\"widgets | greaterThan(50, 'Congratulations!', 'Better luck next year')\"></span>\n     *      </div>\n     *\n     * @param {number} limit The reference value to compare the model variable against.\n     * @param {string} trueVal (Optional) The format (value) to display if the model variable is greater than or equal to `limit`. If not included, the display is `true`. If there are commas in this argument, they must be escaped with `\\`.\n     * @param {string} falseVal (Optional) The format (value) to display if the model variable is less than `limit`. If not included, the display is the value of the model variable. If there are commas in this argument, they must be escaped with `\\`.\n     * @returns {*} If the model variable is greater than or equal to `limit`, returns trueVal or `true`. Otherwise returns falseVal if provided, or echoes the input.\n     */    \n    greaterThanEqual: function (limit) {\n        var args = parseArgs.apply(null, arguments);\n        return Number(args.input) >= Number(limit) ? args.trueVal : args.falseVal;\n    },\n\n    /**\n     * Convert the model variable to true, or other values passed to the converter, based on whether the model variable is equal to the limit.\n     *\n     * \n     * **Example**\n     *\n     *      <div>\n     *          <!-- displays true or the number of widgets -->\n     *          <span data-f-bind=\"widgets | equalsNumber(50)\"></span> \n     *\n     *          <!-- display custom text -->\n     *          <span data-f-bind=\"widgets | equalsNumber(50, 'Met the goal exactly!', 'Not an exact match')\"></span>\n     *      </div>\n     *\n     * @param {number} limit The reference value to compare the model variable against.\n     * @param {string} trueVal (Optional) The format (value) to display if the model variable is equal to `limit`. If not included, the display is `true`. If there are commas in this argument, they must be escaped with `\\`.\n     * @param {string} falseVal (Optional) The format (value) to display if the model variable is not equal to `limit`. If not included, the display is the value of the model variable. If there are commas in this argument, they must be escaped with `\\`.\n     * @returns {*} If the model variable equals `limit`, returns trueVal or `true`. Otherwise returns falseVal if provided, or echoes the input.\n     */\n    equalsNumber: function (limit) {\n        var args = parseArgs.apply(null, arguments);\n        return Number(args.input) === Number(limit) ? args.trueVal : args.falseVal;\n    },\n\n    /**\n     * Convert the model variable to true, or other values passed to the converter, based on whether the model variable is less than the limit.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          <!-- displays true or the number of widgets -->\n     *          <span data-f-bind=\"widgets | lessThan(50)\"></span> \n     *\n     *          <!-- display custom text -->\n     *          <span data-f-bind=\"widgets | lessThan(50, 'Oops didn't make quite enough!', 'Built a lot of widgets this year!')\"></span>\n     *      </div>\n     *\n     * @param {number} limit The reference value to compare the model variable against.\n     * @param {string} trueVal (Optional) The format (value) to display if the model variable is less than `limit`. If not included, the display is `true`. If there are commas in this argument, they must be escaped with `\\`.\n     * @param {string} falseVal (Optional) The format (value) to display if the model variable is less than `limit`. If not included, the display is the value of the model variable. If there are commas in this argument, they must be escaped with `\\`.\n     * @returns {*} If the model variable is less than `limit`, returns trueVal or `true`. Otherwise returns falseVal if provided, or echoes the input.\n     */ \n    lessThan: function (limit) {\n        var args = parseArgs.apply(null, arguments);\n        return Number(args.input) < Number(limit) ? args.trueVal : args.falseVal;\n    },\n\n    /**\n     * Convert the model variable to true, or other values passed to the converter, based on whether the model variable is less than or equal to the limit.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          <!-- displays true or the number of widgets -->\n     *          <span data-f-bind=\"widgets | lessThanEqual(50)\"></span> \n     *\n     *          <!-- display custom text -->\n     *          <span data-f-bind=\"widgets | lessThanEqual(50, 'Oops didn't make quite enough!', 'Built a lot of widgets this year!')\"></span>\n     *      </div>\n     *\n     * @param {number} limit The reference value to compare the model variable against.\n     * @param {string} trueVal (Optional) The format (value) to display if the model variable is less than or equal to `limit`. If not included, the display is `true`. If there are commas in this argument, they must be escaped with `\\`.\n     * @param {string} falseVal (Optional) The format (value) to display if the model variable is less than or equal to `limit`. If not included, the display is the value of the model variable. If there are commas in this argument, they must be escaped with `\\`.\n     * @returns {*} If the model variable is less than or equal to `limit`, returns trueVal or `true`. Otherwise returns falseVal if provided, or echoes the input.\n     */\n    lessThanEqual: function (limit) {\n        var args = parseArgs.apply(null, arguments);\n        return Number(args.input) <= Number(limit) ? args.trueVal : args.falseVal;\n    }\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/converter-manager/converters/number-compare-converters/index.js","function parseArgs(trueVal, falseVal, input, matchString) {\n    var toReturn = { trueVal: true, falseVal: false };\n    switch (arguments.length) {\n        case 4: //eslint-disable-line\n            return $.extend(toReturn, { trueVal: trueVal, falseVal: falseVal, input: input });\n        case 3: //eslint-disable-line\n            return $.extend(toReturn, { trueVal: trueVal, falseVal: falseVal, input: falseVal }); \n        default:\n            return toReturn;\n    }\n}\n\nmodule.exports = {\n    /**\n     * Convert 'truthy' values to true and 'falsy' values to false.\n     *\n     * **Example**\n     *\n     *      <!-- displays \"true\" or \"false\" -->\n     *      <!-- in particular, true if sampleVar is truthy (1, true, 'some string', [] etc.), \n     *            false if sampleVar is falsy (0, false, '') -->\n     *      <span data-f-bind=\"sampleVar | toBool\"></span>\n     * \n     * @param {Any} value\n     * @returns {boolean}\n     */\n    toBool: (value)=> !!value,\n\n    /**\n     * Converts values to boolean and negates.\n     *\n     * **Example**\n     *\n     *      <!-- disables input if isGameInProgress is false -->\n     *      <input type=\"text\" data-f-disabled=\"isGameInProgress | not\" />\n     * \n     * @param {Any} value\n     * @returns {boolean}\n     */\n    not: (value)=> !value,\n\n    /**\n     * Convert the input to a new value (for example, some text), based on whether it is true or false.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          <span data-f-bind=\"sampleVar | ifTrue('yes! please move forward', 'not ready to proceed')\"></span> \n     *          <span data-f-bind=\"sampleVar | ifTrue('yes! please move forward')\"></span>\n     *      </div>\n     *\n     * @param {string} trueVal The value to display if the input is true. If there are commas in this argument, they must be escaped with `\\`.\n     * @param {string} falseVal (Optional) The value to display if the input is false. If not included, returns the input. If there are commas in this argument, they must be escaped with `\\`.\n     * @param {Any} input (Optional) The input to test. If not included, the output of the previous argument is used.\n     * @returns {Any} If input is true, returns trueVal. If input is false, returns falseVal if provided, or echoes the input.\n     */\n    ifTrue: function () {\n        var args = parseArgs.apply(null, arguments);\n        return args.input ? args.trueVal : args.falseVal;\n    },\n    /**\n     * Convert the input to a new value (for example, some text), based on whether it is false or true.\n     *\n     * **Example**\n     *\n     *      <div>\n     *          <span data-f-bind=\"sampleVar | ifFalse('not ready to proceed', 'actually this is still true')\"></span> \n     *          <span data-f-bind=\"sampleVar | ifFalse('not ready to proceed')\"></span>\n     *      </div>\n     *\n     * @param {string} trueVal The value to display if the input is false. If there are commas in this argument, they must be escaped with `\\`.\n     * @param {string} falseVal (Optional) The value to display if the input is true. If not included, returns the input. If there are commas in this argument, they must be escaped with `\\`.\n     * @param {Any} input (Optional) The input to test. If not included, the output of the previous argument is used.\n     * @returns {Any} If input is false, returns trueVal. If input is true, returns falseVal if provided, or echoes the input.\n     */\n    ifFalse: function () {\n        var args = parseArgs.apply(null, arguments);\n        return !args.input ? args.trueVal : args.falseVal;\n    }\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/converter-manager/converters/boolean-conditional-converters/index.js","const _ = require('lodash');\n\nconst list = {\n    /**\n     * Returns all values in array matching argument\n     *\n     * ** Example **\n     * <!-- list online users -->\n     * <ul data-f-foreach=\"users | filter(isOnline)\"><li></li></button>\n     * \n     * @param  {string|number|boolean} valueToFilterBy value to reject\n     * @param  {any[]} source The arrayed model variable\n     * @returns {any[]}     filtered lsit\n     */\n    filter: function (valueToFilterBy, source) {\n        source = [].concat(source);\n        if ($.isPlainObject(source[0])) {\n            return _.filter(source, valueToFilterBy);\n        }\n        return source.filter((v)=> v === valueToFilterBy);\n    },\n\n    /**\n     * Returns all values in array excluding match\n     *\n     * ** Example **\n     * <!-- list offline users -->\n     * <ul data-f-foreach=\"users | except(isOnline)\"><li></li></button>\n     * \n     * @param  {string|number|boolean} valueToReject value to reject\n     * @param  {any[]} source The arrayed model variable\n     * @returns {any[]}     filtered lsit\n     */\n    except: function (valueToReject, source) {\n        source = [].concat(source);\n        if ($.isPlainObject(source[0])) {\n            return _.reject(source, valueToReject);\n        }\n        return source.filter((v)=> v !== valueToReject);\n    },\n\n    /**\n     * Checks if array contains *any* item passing the test\n     *\n     * ** Example **\n     * <!-- hides button if any of the users are not online -->\n     * <button data-f-hideif=\"users | any(isOnline) | not\">Get Started</button>\n     * <button data-f-hideif=\"users | any({ isOnline: false })\">Get Started</button>\n     * \n     * @param  {string|Object} value value to check for\n     * @param  {any[]} source The arrayed model variable\n     * @returns {boolean}     True if match found in array\n     */\n    any: function (value, source) {\n        source = [].concat(source);\n        if ($.isPlainObject(source[0])) {\n            return _.some(source, value);\n        }\n        return source.indexOf(value) !== -1;\n    },\n\n    /**\n     * Checks if *every* item in the array passes the test\n     *\n     * ** Example **\n     * <!-- shows button if any of the users are not online -->\n     * <button data-f-showif=\"users | every(isOnline)\">Get Started</button>\n     * \n     * @param  {string|Object} value value to check for\n     * @param  {any[]} source The arrayed model variable\n     * @returns {boolean}     True if match found in array\n     */\n    every: function (value, source) {\n        source = [].concat(source);\n        if ($.isPlainObject(source[0])) {\n            return _.every(source, value);\n        }\n        return source.filter((v)=> v === value).length === source.length;\n    }\n};\nconst converters = Object.keys(list).map((name)=> {\n    return {\n        alias: name,\n        acceptList: true,\n        convert: list[name]\n    };\n});\n\nmodule.exports = converters;\n\n\n\n// WEBPACK FOOTER //\n// ./src/converter-manager/converters/collection-converters/index.js","import { isString, isFunction } from 'lodash';\n/**\n * @typedef NodeHandler\n * @property {string} selector\n * @property {Function} handle\n */ \n\n \n/**\n * @param {string | undefined} selector\n * @param {Function | NodeHandler } handler\n * @returns {NodeHandler}\n */\nconst normalize = function (selector, handler) {\n    if (!selector) {\n        selector = '*';\n    }\n    if (isFunction(handler)) {\n        handler = {\n            selector: selector,\n            handle: handler\n        };\n    }\n   \n    handler.selector = selector;\n    return handler;\n};\n\n/**\n * @param {string|HTMLElement|JQuery<HTMLElement>} toMatch\n * @param { {selector:string} } node\n * @returns {boolean}\n */ \nconst match = function (toMatch, node) {\n    if (isString(toMatch)) {\n        return toMatch === node.selector;\n    }\n    return $(toMatch).is(node.selector);\n};\n\nconst nodeManager = {\n    list: [],\n\n    /**\n     * Add a new node handler\n     * @param  {string} selector jQuery-compatible selector to use to match nodes\n     * @param  {Function} handler  Handlers are new-able functions. They will be called with $el as context.? TODO: Think this through\n     * @returns {void}\n     */\n    register: function (selector, handler) {\n        this.list.unshift(normalize(selector, handler));\n    },\n\n    /**\n     * @param {string|HTMLElement|JQuery<HTMLElement>} selector\n     * @returns NodeHandler\n     */ \n    getHandler: function (selector) {\n        return this.list.find(function (node) {\n            return match(selector, node);\n        });\n    },\n\n    replace: function (selector, handler) {\n        let index;\n        this.list.forEach(function (currentHandler, i) {\n            if (selector === currentHandler.selector) {\n                index = i;\n                return false;\n            }\n        });\n        this.list.splice(index, 1, normalize(selector, handler));\n    }\n};\n\n//bootstraps\nconst defaultHandlers = [\n    require('./input-checkbox-node').default,\n    require('./default-input-node').default,\n    require('./default-node')\n];\ndefaultHandlers.reverse().forEach(function (handler) {\n    nodeManager.register(handler.selector, handler);\n});\n\nexport default nodeManager;\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/nodes/node-manager.js","import BaseView from './default-input-node';\nimport config from 'config';\n\nconst offAttr = config.attrs.checkboxOffValue;\n\nexport default BaseView.extend({\n    propertyHandlers: [\n\n    ],\n\n    getUIValue: function () {\n        const $el = this.$el;\n        const offAttrVal = $el.attr(offAttr);\n        const offVal = (offAttrVal && typeof offAttrVal !== 'undefined') ? offAttrVal : false;\n\n        const onAttrVal = $el.attr('value');\n        //attr = initial value, prop = current value\n        const onVal = (onAttrVal && typeof onAttrVal !== 'undefined') ? $el.prop('value') : true;\n\n        const val = ($el.is(':checked')) ? onVal : offVal;\n        return val;\n    },\n    initialize: function () {\n        BaseView.prototype.initialize.apply(this, arguments);\n    }\n}, { selector: ':checkbox,:radio' });\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/nodes/input-checkbox-node.js","const { extend, has } = require('lodash');\n\nvar extendView = function (protoProps, staticProps) {\n    var me = this;\n    var child;\n\n    // The constructor function for the new subclass is either defined by you\n    // (the \"constructor\" property in your `extend` definition), or defaulted\n    // by us to simply call the parent's constructor.\n    if (protoProps && has(protoProps, 'constructor')) {\n        child = protoProps.constructor;\n    } else {\n        child = function () { return me.apply(this, arguments); };\n    }\n\n    // Add static properties to the constructor function, if supplied.\n    extend(child, me, staticProps);\n\n    // Set the prototype chain to inherit from `parent`, without calling\n    // `parent`'s constructor function.\n    var Surrogate = function () { this.constructor = child; };\n    Surrogate.prototype = me.prototype;\n    child.prototype = new Surrogate();\n\n    // Add prototype properties (instance properties) to the subclass,\n    // if supplied.\n    if (protoProps) {\n        extend(child.prototype, protoProps);\n    }\n\n    // Set a convenience property in case the parent's prototype is needed\n    // later.\n    child.__super__ = me.prototype; //eslint-disable-line no-underscore-dangle\n\n    return child;\n};\n\nvar View = function (options) {\n    this.$el = (options.$el) || $(options.el);\n    this.el = options.el;\n    this.initialize.apply(this, arguments);\n\n};\nextend(View.prototype, {\n    initialize: function () {},\n});\n\nView.extend = extendView;\n\nmodule.exports = View;\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils/base-view.js","import { isString, isFunction, isRegExp, each } from 'lodash';\n\nconst defaultHandlers = [\n    require('./attributes/no-op-attr').default,\n    require('./attributes/events/default-event-attr').default,\n    require('./attributes/loop-attrs/foreach-attr').default,\n    require('./attributes/loop-attrs/repeat-attr').default,\n    require('./attributes/class-attr').default,\n    require('./attributes/boolean-attr').default,\n    require('./attributes/toggles/show-if-attr').default,\n    require('./attributes/toggles/hide-if-attr').default,\n    require('./attributes/binds/checkbox-radio-bind-attr').default,\n    require('./attributes/binds/input-bind-attr').default,\n    require('./attributes/binds/default-bind-attr').default,\n    require('./attributes/default-attr').default\n];\n\nconst handlersList = [];\n\nconst normalize = function (attributeMatcher, nodeMatcher, handler) {\n    if (!nodeMatcher) {\n        nodeMatcher = '*';\n    }\n    if (isFunction(handler)) {\n        handler = {\n            handle: handler\n        };\n    }\n    return $.extend(handler, { test: attributeMatcher, target: nodeMatcher });\n};\n\ndefaultHandlers.forEach(function (handler) {\n    handlersList.push(normalize(handler.test, handler.target, handler));\n});\n\n\nconst matchAttr = function (matchExpr, attr, $el) {\n    let attrMatch;\n\n    if (isString(matchExpr)) {\n        attrMatch = (matchExpr === '*' || (matchExpr.toLowerCase() === attr.toLowerCase()));\n    } else if (isFunction(matchExpr)) {\n        //TODO: remove element selectors from attributes\n        attrMatch = matchExpr(attr, $el);\n    } else if (isRegExp(matchExpr)) {\n        attrMatch = attr.match(matchExpr);\n    }\n    return attrMatch;\n};\n\nconst matchNode = function (target, nodeFilter) {\n    return (isString(nodeFilter)) ? (nodeFilter === target) : nodeFilter.is(target);\n};\n\nconst attributeManager = {\n    list: handlersList,\n    /**\n     * Add a new attribute handler.\n     *\n     * @param  {string|Function|RegExp} attributeMatcher Description of which attributes to match.\n     * @param  {string|JQuery<HTMLElement>} nodeMatcher Which nodes to add attributes to. Use [jquery Selector syntax](https://api.jquery.com/category/selectors/).\n     * @param  {Function|Object} handler If `handler` is a function, the function is called with `$element` as context, and attribute value + name. If `handler` is an object, it should include two functions, and have the form: `{ init: fn,  handle: fn }`. The `init` function is called when the page loads; use this to define event handlers. The `handle` function is called with `$element` as context, and attribute value + name.\n     * @returns {void}\n     */\n    register: function (attributeMatcher, nodeMatcher, handler) {\n        handlersList.unshift(normalize.apply(null, arguments));\n    },\n\n    /**\n     * Find an attribute matcher matching some criteria.\n     *\n     * @param  {string} attrFilter Attribute to match.\n     * @param  {string|JQuery<HTMLElement>} nodeFilter Node to match.\n     *\n     * @returns {AttributeHandler[]} An array of matching attribute handlers, or null if no matches found.\n     */\n    filter: function (attrFilter, nodeFilter) {\n        let filtered = handlersList.filter(function (handler) {\n            return matchAttr(handler.test, attrFilter);\n        });\n        if (nodeFilter) {\n            filtered = filtered.filter(function (handler) {\n                return matchNode(handler.target, nodeFilter);\n            });\n        }\n        return filtered;\n    },\n\n    /**\n     * Replace an existing attribute handler.\n     *\n     * @param  {string} attrFilter Attribute to match.\n     * @param  {string|JQuery<HTMLElement>} nodeFilter Node to match.\n     * @param  {Function|Object} handler The updated attribute handler. If `handler` is a function, the function is called with `$element` as context, and attribute value + name. If `handler` is an object, it should include two functions, and have the form: `{ init: fn,  handle: fn }`. The `init` function is called when the page loads; use this to define event handlers. The `handle` function is called with `$element` as context, and attribute value + name.\n     * @returns {void}\n     */\n    replace: function (attrFilter, nodeFilter, handler) {\n        let index;\n        each(handlersList, function (currentHandler, i) {\n            if (matchAttr(currentHandler.test, attrFilter) && matchNode(currentHandler.target, nodeFilter)) {\n                index = i;\n                return false;\n            }\n        });\n        handlersList.splice(index, 1, normalize(attrFilter, nodeFilter, handler));\n    },\n\n    /**\n     *  Retrieve the appropriate handler for a particular attribute. There may be multiple matching handlers, but the first (most exact) match is always used.\n     *\n     * @param {string} attr The attribute.\n     * @param {string|JQuery<HTMLElement>} $el The DOM element.\n     *\n     * @returns {AttributeHandler|undefined} The attribute handler, if a matching one is found\n     */\n    getHandler: function (attr, $el) {\n        const filtered = this.filter(attr, $el);\n        //There could be multiple matches, but the top first has the most priority\n        return filtered[0];\n    }\n};\n\nexport default attributeManager;\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attribute-manager/index.js","/**\n * @type AttributeHandler \n */\nconst noopAttr = {\n\n    target: '*',\n\n    test: /^(?:model|convert|channel|on-init)/i,\n\n    handle: ()=> {},\n    parse: ()=> []\n};\n\nexport default noopAttr;\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attribute-manager/attributes/no-op-attr/index.js","import { events } from 'config';\nimport { toPublishableFormat } from 'utils/parse-utils';\n\nfunction eventNameFromAttr(attr) {\n    const eventName = attr.replace('on-', '');\n    const nameSpacedEvent = `${eventName}.f-event`;\n    return nameSpacedEvent;\n}\n/**\n * @type AttributeHandler \n */\nconst defaultEventAttr = {\n\n    target: '*',\n\n    test: function (attr) {\n        return (attr.indexOf('on-') === 0);\n    },\n\n    unbind: function (attr, $el) {\n        const eventName = eventNameFromAttr(attr);\n        $el.off(eventName);\n    },\n\n    parse: ()=> ([]), //There's nothing to subscribe to on an event\n    handle: ()=> {},\n\n    init: function (attr, topics, $el) {\n        const matching = topics[0] && topics[0].name; //multiple topics aren't really relevant here\n        const eventName = eventNameFromAttr(attr);\n        $el.off(eventName).on(eventName, function (evt) {\n            evt.preventDefault();\n            var listOfOperations = toPublishableFormat(matching);\n            $el.trigger(events.trigger, { data: listOfOperations, source: attr });\n        });\n    }\n};\n\nexport default defaultEventAttr;\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attribute-manager/attributes/events/default-event-attr/index.js","import { toImplicitType } from 'utils/parse-utils';\nimport { animation } from 'config';\n\nimport { aliasesFromTopics, parseTopics } from '../loop-attr-utils';\nimport { addChangeClassesToList } from 'utils/animation';\nimport { each, template } from 'lodash';\n\nimport { getKnownDataForEl, updateKnownDataForEl, removeKnownData, findMissingReferences, stubMissingReferences, addBackMissingReferences, getOriginalContents, clearOriginalContents } from 'dom/attribute-manager/attr-template-utils';\n\nconst elAnimatedMap = new WeakMap(); //TODO: Can probably get rid of this if we make subscribe a promise and distinguish between initial value\n\n/**\n * @type AttributeHandler\n */\nconst foreachAttr = {\n\n    test: 'foreach',\n\n    target: '*',\n\n    unbind: function (attr, $el) {\n        const el = $el.get(0);\n        elAnimatedMap.delete(el);\n        \n        const template = getOriginalContents($el);\n        const current = $el.html();\n        if (template && current !== template) {\n            $el.html(template);\n        }\n        clearOriginalContents($el);\n        removeKnownData($el);\n    },\n\n    parse: function (topics) {\n        return parseTopics(topics);\n    },\n\n    handle: function (value, prop, $el, topics) {\n        value = ($.isPlainObject(value) ? value : [].concat(value));\n\n        const { keyAlias, valueAlias } = aliasesFromTopics(topics, value);\n\n        const originalHTML = getOriginalContents($el, ($el)=> $el.html());\n        const knownData = getKnownDataForEl($el);\n        const missingReferences = findMissingReferences(originalHTML, [keyAlias, valueAlias].concat(Object.keys(knownData)));\n        const stubbedTemplate = stubMissingReferences(originalHTML, missingReferences);\n\n        const templateFn = template(stubbedTemplate);\n        const $dummyEl = $('<div></div>');\n        each(value, function (dataval, datakey) {\n            if (dataval === undefined || dataval === null) {\n                dataval = dataval + ''; //convert undefineds to strings\n            }\n            const templateData = $.extend(true, {}, knownData, {\n                [keyAlias]: datakey,\n                [valueAlias]: dataval\n            });\n\n            let nodes;\n            let isTemplated;\n            try {\n                const templated = templateFn(templateData);\n                const templatedWithReferences = addBackMissingReferences(templated, missingReferences);\n                isTemplated = templatedWithReferences !== stubbedTemplate;\n                nodes = $(templatedWithReferences);\n            } catch (e) { //you don't have all the references you need;\n                nodes = $(stubbedTemplate);\n                isTemplated = true;\n                updateKnownDataForEl($(nodes), templateData);\n            }\n\n            nodes.each(function (i, newNode) {\n                const $newNode = $(newNode);\n                each($newNode.data(), function (val, key) {\n                    $newNode.data(key, toImplicitType(val));\n                });\n                if (!isTemplated && !$newNode.html().trim()) {\n                    $newNode.html(dataval);\n                }\n            });\n            $dummyEl.append(nodes);\n        });\n        \n        const el = $el.get(0);\n        const isInitialAnim = !elAnimatedMap.get(el);\n        const $withAnimAttrs = addChangeClassesToList($el.children(), $dummyEl.children(), isInitialAnim, animation);\n        $el.empty().append($withAnimAttrs);\n\n        elAnimatedMap.set(el, true);\n    }\n};\n\nexport default foreachAttr;\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attribute-manager/attributes/loop-attrs/foreach-attr/index.js","import { template, each, isEmpty } from 'lodash';\nimport { toImplicitType } from 'utils/parse-utils';\nimport { random } from 'utils/general';\nimport { attrs, animation } from 'config';\n\nconst templateIdAttr = attrs.repeat.templateId;\n\nimport { addChangeClassesToList } from 'utils/animation';\n\nconst elAnimatedMap = new WeakMap(); //TODO: Can probably get rid of this if we make subscribe a promise and distinguish between initial value\n\nimport { getKnownDataForEl, updateKnownDataForEl, removeKnownData, findMissingReferences, stubMissingReferences, addBackMissingReferences, getOriginalContents, clearOriginalContents } from 'dom/attribute-manager/attr-template-utils';\n\nimport { aliasesFromTopics, parseTopics } from '../loop-attr-utils';\n\n/**\n * @type AttributeHandler \n */\nconst loopAttrHandler = {\n    test: 'repeat',\n\n    target: '*',\n\n    unbind: function (attr, $el) {\n        var id = $el.data(templateIdAttr);\n        if (id) {\n            $el.nextUntil(':not([data-' + id + '])').remove();\n            // $el.removeAttr('data-' + templateIdAttr); //FIXME: Something about calling rebind multiple times in IB makes this happen without the removal\n        }\n\n        const el = $el.get(0);\n        elAnimatedMap.delete(el);\n\n        const originalHTML = getOriginalContents($el);\n        const current = $el.get(0).outerHTML;\n        if (originalHTML && current !== originalHTML) {\n            $el.replaceWith(originalHTML);\n        }\n        clearOriginalContents($el);\n        removeKnownData($el);\n    },\n\n    parse: function (topics) {\n        return parseTopics(topics);\n    },\n\n    init: function (attr, value, $el) {\n        \n    },\n\n    handle: function (value, prop, $el, topics) {\n        value = ($.isPlainObject(value) ? value : [].concat(value));\n        let id = $el.data(templateIdAttr);\n        \n        $el.removeAttr('hidden');\n        const originalHTML = getOriginalContents($el, ($el)=> $el.get(0).outerHTML);\n\n        const $dummyOldDiv = $('<div></div>');\n        if (id) {\n            const $removed = $el.nextUntil(':not([data-' + id + '])').remove();\n            $dummyOldDiv.append($removed);\n        } else {\n            id = random('repeat-');\n            $el.attr('data-' + templateIdAttr, id);\n        }\n\n        const { keyAlias, valueAlias } = aliasesFromTopics(topics, value);\n\n        const knownData = getKnownDataForEl($el);\n        const missingReferences = findMissingReferences(originalHTML, [keyAlias, valueAlias].concat(Object.keys(knownData)));\n        const stubbedTemplate = stubMissingReferences(originalHTML, missingReferences);\n\n        if (isEmpty(value)) {\n            $el.attr('hidden', true); //There's always going to be 1 el otherwise\n            return;\n        }\n\n        const templateFn = template(stubbedTemplate);\n        let last;\n        each(value, function (dataval, datakey) {\n            if (dataval === undefined || dataval === null) {\n                dataval = dataval + ''; //convert undefineds to strings\n            }\n            const templateData = $.extend(true, {}, knownData, {\n                [keyAlias]: datakey,\n                [valueAlias]: dataval\n            });\n\n            let nodes;\n            let isTemplated;\n            try {\n                const templated = templateFn(templateData);\n                const templatedWithReferences = addBackMissingReferences(templated, missingReferences);\n                isTemplated = templatedWithReferences !== stubbedTemplate;\n                nodes = $(templatedWithReferences);\n            } catch (e) { //you don't have all the references you need;\n                nodes = $(stubbedTemplate);\n                isTemplated = true;\n                updateKnownDataForEl($(nodes), templateData);\n            }\n\n            var hasData = (dataval !== null && dataval !== undefined);\n            nodes.each(function (i, newNode) {\n                const $newNode = $(newNode);\n                $newNode.removeAttr('data-f-repeat').removeAttr('data-' + templateIdAttr);\n                each($newNode.data(), function (val, key) {\n                    if (!last) {\n                        $el.data(key, toImplicitType(val));\n                    } else {\n                        $newNode.data(key, toImplicitType(val));\n                    }\n                });\n                $newNode.attr('data-' + id, true);\n                if (!isTemplated && !$newNode.children().length && hasData) {\n                    $newNode.html(dataval + '');\n                }\n            });\n            if (!last) {\n                last = $el.html(nodes.html());\n            } else {\n                last = nodes.insertAfter(last);\n            }\n        });\n\n        const $newEls = $el.nextUntil(`:not('[data-${id}]')`);\n\n        const el = $el.get(0);\n        const isInitialAnim = !elAnimatedMap.get(el);\n        addChangeClassesToList($dummyOldDiv.children(), $newEls, isInitialAnim, animation);\n\n        elAnimatedMap.set(el, true);\n    }\n};\n\nexport default loopAttrHandler;\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attribute-manager/attributes/loop-attrs/repeat-attr/index.js","import { promisify } from './promise-utils';\n\nfunction executeAndResolve(fn, args, $def) {\n    const promisifiedFn = promisify(fn);\n    return promisifiedFn.apply(fn, args).then((result)=> {\n        $def.resolve(result);\n    }, (e)=> {\n        $def.reject(e);\n    });\n}\n\n/**\n * Returns debounced version of original (optionally promise returning) function\n * \n * @param {function(*):Promise} fn function to debounce\n * @param {number} debounceInterval \n * @param {Function[]} [argumentsReducers] pass in 1 reducer for each option your function takes\n * @returns {Function} debounced function\n */\nexport default function debounceAndMerge(fn, debounceInterval, argumentsReducers) {\n    if (!argumentsReducers) {\n        var arrayReducer = function (accum, newVal) {\n            return (accum || []).concat(newVal);\n        };\n        argumentsReducers = [arrayReducer];\n    }\n\n    const queue = [];\n    let timer = null;\n\n    function mergeArgs(oldArgs, newArgs) {\n        const merged = newArgs.map(function (newArg, index) {\n            var reducer = argumentsReducers[index];\n            if (reducer) {\n                return reducer(oldArgs[index], newArg);\n            }\n            return newArg;\n        });\n        return merged;\n    }\n\n    /**\n     * @returns {Promise}\n     */\n    return function debouncedFunction() {\n        const newArgs = Array.prototype.slice.call(arguments);\n        if (timer) {\n            clearTimeout(timer);\n            const mergedArgs = mergeArgs(queue[0].args, newArgs);\n            queue[0].args = mergedArgs;\n        } else {\n            const args = mergeArgs([], newArgs);\n            queue.push({\n                $def: $.Deferred(),\n                args: args\n            });\n        }\n\n        timer = setTimeout(()=> {\n            timer = null;\n            const item = queue.pop();\n            executeAndResolve(fn, item.args, item.$def);\n        }, debounceInterval);\n\n        return queue[0].$def.promise();\n    };\n}\n\n\n// WEBPACK FOOTER //\n// ./src/utils/general/debounce-and-merge.js","import { isNumber } from 'lodash';\n\nconst elClassesMap = new WeakMap();\nfunction deleteAddedClasses($el) {\n    const el = $el.get(0);\n    const addedClasses = elClassesMap.get(el);\n    if (addedClasses) {\n        $el.removeClass(addedClasses);\n    }\n}\n/**\n * @type AttributeHandler\n */\nconst classAttr = {\n    test: 'class',\n\n    target: '*',\n\n\n    unbind: function (attr, $el) {\n        const el = $el.get(0);\n        deleteAddedClasses($el);\n        elClassesMap.delete(el);\n    },\n\n    handle: function (value, prop, $el) {\n        if (Array.isArray(value)) {\n            value = value[value.length - 1];\n        }\n\n        const el = $el.get(0);\n        deleteAddedClasses($el);\n\n        if (isNumber(value)) {\n            value = 'value-' + value;\n        }\n        setTimeout(()=> {\n            $el.addClass(value); //If the classes have an animation set, removing with a timeout will trigger it\n        }, 0);\n        elClassesMap.set(el, value);\n    }\n};\n\nexport default classAttr;\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attribute-manager/attributes/class-attr/index.js","/**\n * @type AttributeHandler \n */\nconst booleanAttrHandler = {\n    target: '*',\n\n    test: /^(?:checked|selected|async|autofocus|autoplay|controls|defer|ismap|loop|multiple|open|required|scoped|disabled|hidden|readonly)$/i,\n\n    handle: function (value, prop, $el) {\n        if (Array.isArray(value)) {\n            value = value[value.length - 1];\n        }\n        const val = ($el.attr('value')) ? (value == $el.prop('value')) : !!value; //eslint-disable-line eqeqeq\n        $el.prop(prop, val);\n    }\n};\n\nexport default booleanAttrHandler;\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attribute-manager/attributes/boolean-attr/index.js","/**\n  * @type AttributeHandler\n  */\nconst showifHandler = {\n    test: 'showif',\n\n    target: '*',\n\n    init: function (attr, value, $el) {\n        $el.hide(); //hide by default; if not this shows text until data is fetched\n    },\n\n    handle: function (value, prop, $el) {\n        if (Array.isArray(value)) {\n            value = value[value.length - 1];\n        }\n        return (value && `${value}`.trim()) ? $el.show() : $el.hide();\n    }\n};\n\nexport default showifHandler;\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attribute-manager/attributes/toggles/show-if-attr/index.js","/**\n  * @type AttributeHandler\n  */\nconst hideifHandler = {\n    test: 'hideif',\n\n    target: '*',\n\n    init: function (attr, value, $el) {\n        $el.hide(); //hide by default; if not this shows text until data is fetched\n    },\n    handle: function (value, prop, $el) {\n        if (Array.isArray(value)) {\n            value = value[value.length - 1];\n        }\n        if (value && `${value}`.trim()) {\n            $el.hide();\n        } else {\n            $el.show();\n        }\n    }\n};\n\nexport default hideifHandler;\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attribute-manager/attributes/toggles/hide-if-attr/index.js","/**\n  * @type {AttributeHandler}\n  */\nconst checkboxAttrHandler = {\n\n    target: ':checkbox,:radio',\n\n    test: 'bind',\n\n    handle: function (value, prop, $el) {\n        if (Array.isArray(value)) {\n            value = value[value.length - 1];\n        }\n        const settableValue = $el.attr('value'); //initial value\n        const isChecked = (typeof settableValue !== 'undefined') ? (settableValue == value) : !!value; //eslint-disable-line eqeqeq\n        $el.prop('checked', isChecked);\n    }\n};\n\nexport default checkboxAttrHandler;\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attribute-manager/attributes/binds/checkbox-radio-bind-attr/index.js","/**\n * @type AttributeHandler \n */\nconst inputBindAttr = {\n    target: 'input, select, textarea',\n\n    test: 'bind',\n\n    handle: function (value, prop, $el) {\n        if ($el.is(':focus')) {\n            return; //If an user is actively typing in a value, don't overwrite it\n        }\n        if (value === undefined) {\n            value = '';\n        } else if (Array.isArray(value)) {\n            value = value[value.length - 1];\n        }\n        $el.val(value + '');\n    }\n};\n\nexport default inputBindAttr;\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attribute-manager/attributes/binds/input-bind-attr/index.js","import { template } from 'lodash';\nimport { addContentAndAnimate } from 'utils/animation';\nimport { animation } from 'config';\n\nimport { extractVariableName, extractAlias, translateDataToTemplatable, translateDataToInsertable } from '../bind-utils';\n\nimport { getKnownDataForEl, updateKnownDataForEl, removeKnownData, findMissingReferences, stubMissingReferences, addBackMissingReferences, isTemplated, getOriginalContents, clearOriginalContents } from 'dom/attribute-manager/attr-template-utils';\n\nconst elAnimatedMap = new WeakMap(); //TODO: Can probably get rid of this if we make subscribe a promise and distinguish between initial value\n\nfunction toAliasMap(topics) {\n    return (topics || []).reduce((accum, topic)=> {\n        accum[topic.name] = topic.alias;   \n        return accum;\n    }, {});\n}\n\nfunction getNewContent(currentContents, value, $el, topics) {\n    if (!isTemplated(currentContents)) {\n        return translateDataToInsertable(value);\n    }\n\n    const templateData = translateDataToTemplatable(value, toAliasMap(topics));\n    const knownData = getKnownDataForEl($el);\n    $.extend(templateData, knownData);\n\n    const missingReferences = findMissingReferences(currentContents, Object.keys(templateData));\n    const stubbedTemplate = stubMissingReferences(currentContents, missingReferences);\n\n    const templateFn = template(stubbedTemplate);\n    try {\n        const templatedHTML = templateFn(templateData);\n        const templatedWithReferences = addBackMissingReferences(templatedHTML, missingReferences);\n        return templatedWithReferences;\n    } catch (e) { //you don't have all the references you need;\n        updateKnownDataForEl($el, templateData);\n        return currentContents;\n    }\n}\n\n/**\n * @type AttributeHandler \n */\nconst bindAttrHandler = {\n\n    target: '*',\n\n    test: 'bind',\n\n    parse: function (topics) {\n        return topics.map((topic)=> {\n            const attrVal = topic.name;\n            return {\n                name: extractVariableName(attrVal),\n                alias: extractAlias(attrVal),\n            };\n        });\n    },\n\n    //FIXME: Can't do this because if you have a bind within a foreach, foreach overwrites the old el with a new el, and at that points contents are lost\n    // But if i don't do this the <%= %> is going to show up\n    // init: function (attr, value, $el) {\n    //     const contents = getOriginalContents($el, ($el)=> $el.html());\n    //     if (isTemplated(contents)) {\n    //         $el.empty();\n    //     }\n    // },\n\n    unbind: function (attr, $el) {\n        const el = $el.get(0);\n        elAnimatedMap.delete(el);\n\n        const bindTemplate = getOriginalContents($el);\n        const current = $el.html();\n        if (bindTemplate && current !== bindTemplate) {\n            $el.html(bindTemplate);\n        }\n        clearOriginalContents($el);\n        removeKnownData($el);\n    },\n\n    handle: function (value, prop, $el, topics) {\n        const el = $el.get(0);\n        const originalContents = getOriginalContents($el, ($el)=> $el.html());\n        const contents = getNewContent(originalContents, value, $el, topics);\n\n        addContentAndAnimate($el, contents, !elAnimatedMap.has(el), animation);\n        elAnimatedMap.set(el, true);\n    }\n};\n\nexport default bindAttrHandler;\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attribute-manager/attributes/binds/default-bind-attr/index.js","export function translateDataToInsertable(value) {\n    if (Array.isArray(value)) {\n        value = value[value.length - 1];\n    }\n    value = ($.isPlainObject(value)) ? JSON.stringify(value) : value + '';\n    return value;\n}\n\n/**\n * @param {any} value\n * @param {Object} aliasMap\n * @returns {{value: any}}\n */\nexport function translateDataToTemplatable(value, aliasMap) {\n    const templateData = { value: value };\n    if ($.isPlainObject(value)) {\n        Object.keys(value).forEach((originalName)=> {\n            const alias = aliasMap[originalName] || originalName;\n            templateData[alias] = value[originalName];\n        });\n    } else {\n        Object.keys(aliasMap).forEach((originalName)=> {\n            const alias = aliasMap[originalName] || originalName;\n            templateData[alias] = value;\n        });\n    }\n    \n    return templateData;\n}\n\nconst AS_REGEX = /(.*) (?:as)\\s+\\((.*)\\)/;\n\n/**\n * @param {string} attrVal \n * @returns {string}\n */\nexport function extractVariableName(attrVal) {\n    const asMatch = attrVal.trim().match(AS_REGEX);\n    const varName = asMatch && asMatch[1] ? asMatch[1] : attrVal;\n    return varName.trim();\n}\n\n/**\n * @param {string} attrVal \n * @returns {string}\n */\nexport function extractAlias(attrVal) {\n    const asMatch = attrVal.trim().match(AS_REGEX);\n    const alias = asMatch && asMatch[2] ? asMatch[2] : attrVal;\n    return alias.trim();\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attribute-manager/attributes/binds/bind-utils/index.js","/**\n * @type AttributeHandler \n */\nconst defaultAttr = {\n    test: '*',\n\n    target: '*',\n\n    handle: function (value, prop, $el) {\n        //FIXME: The _right_ way to do this would be to set attr, not prop. \n        //However Polymer 1.0 doesn't link attrs with stringified JSON, and that's really the primary use-case for this, so, ignoring\n        //However Polymer is fine with 'data-X' attrs having stringified JSON. Eventually we should make this attr and fix polymer\n        //but can't do that for backwards comptability reason. See commit bbc4a49039fb73faf1ef591a07b371d7d667cf57\n        $el.prop(prop, value);\n    }\n};\n\nexport default defaultAttr;\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/attribute-manager/attributes/default-attr/index.js","/**\n * Hooks up dom elements to mutation observer\n * @param  {HTMLElement} target     root to start observing from\n * @param  {Object} domManager \n * @param  {boolean} isEnabled Determines if it's enabled by default\n * @returns {Object}\n */\nexport default function (target, domManager, isEnabled) {\n    if (typeof MutationObserver === 'undefined') {\n        return;\n    }\n    // Create an observer instance\n    var observer = new MutationObserver(function (mutations) {\n        mutations.forEach(function (mutation) {\n            var added = $(mutation.addedNodes).find(':f');\n            added = added.add($(mutation.addedNodes).filter(':f'));\n            var removed = $(mutation.removedNodes).find(':f');\n            removed = removed.add($(mutation.removedNodes).filter(':f'));\n            if (added && added.length) {\n                domManager.bindAll(added);\n            }\n            if (removed && removed.length) {\n                domManager.unbindAll(removed);\n            }\n            if (mutation.attributeName === 'data-f-channel') {\n                domManager.unbindAll(mutation.target);\n                domManager.bindAll(mutation.target);\n            }\n        });\n    });\n    var mutconfig = {\n        attributes: true,\n        attributeFilter: ['data-f-channel'],\n        childList: true,\n        subtree: true,\n        characterData: false\n    };\n    var publicApi = {\n        enable: function () {\n            observer.observe(target, mutconfig);\n        },\n        disable: function () {\n            observer.disconnect();\n        }\n    };\n    if (isEnabled) {\n        publicApi.enable();\n    }\n    return publicApi;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/plugins/auto-update-bindings.js","import DefaultChannelManager from './channel-manager';\n\nimport router from 'channels/channel-router';\nimport { JSONRouteHandler, EpicenterRouteHandler } from './route-handlers';\nimport { interpolatable, routable } from './channel-manager-enhancements';\n\n//Moving connecting glue here so channel-manager can be tested in isolation\nconst InterpolatableRoutableChannelManager = interpolatable(routable(DefaultChannelManager, router));\nexport default function ChannelManager(opts) {\n    const defaultRouteHandlers = [JSONRouteHandler, EpicenterRouteHandler];\n    const routes = opts && opts.routes ? opts.routes : [];\n    const cm = new InterpolatableRoutableChannelManager($.extend(true, {}, {\n        routes: [].concat(routes, defaultRouteHandlers)\n    }, opts));\n    return cm;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/configured-channel-manager.js","import $ from 'jquery';\nimport { normalizeParamOptions, publishableToObject } from './channel-utils';\nimport { uniqueId, isFunction, intersection, uniq } from 'lodash';\n/**\n * \n * @param {Array<string>|string} topics \n * @param {Function} callback \n * @param {Object} options\n * @returns {Subscription}\n */\nfunction makeSubs(topics, callback, options) {\n    const id = uniqueId('subs-');\n    const defaults = {\n        batch: false,\n\n        /**\n         * Determines if the last published data should be cached for future notifications. For e.g.,\n         *\n         * channel.subscribe(['price', 'cost'], callback1, { batch: true, cache: false });\n         * channel.subscribe(['price', 'cost'], callback2, { batch: true, cache: true });\n         *\n         * channel.publish({ price: 1 });\n         * channel.publish({ cost: 1 });\n         *\n         * callback1 will have been called once, and callback2 will not have been called. i.e., the channel caches the first publish value and notifies after all dependent topics have data\n         * If we'd done channel.publish({ price: 1, cost: 1 }) would have called both callback1 and callback2\n         *\n         * `cache: true` is useful if you know if your topics will can published individually, but you still want to handle them together.\n         * `cache: false` is useful if you know if your topics will *always* be published together and they'll be called at the same time.\n         *\n         * Note this has no discernible effect if batch is false\n         * @type {boolean}\n         */\n        cache: true,\n    };\n    const opts = $.extend({}, defaults, options);\n    if (!callback || !isFunction(callback)) {\n        throw new Error('subscribe callback should be a function');\n    }\n    return $.extend(true, {\n        id: id,\n        topics: [].concat(topics),\n        callback: callback,\n    }, opts);\n}\n\nlet cacheBySubsId = {};\nlet sentDataBySubsId = {};\n\nfunction copy(data) {\n    if (Array.isArray(data)) {\n        return data.map((d)=> copy(d));\n    } else if ($.isPlainObject(data)) {\n        return Object.keys(data).reduce((accum, key)=> {\n            accum[key] = copy(data[key]);\n            return accum;\n        }, {});\n    }\n    return data;\n}\n/**\n* @param {Subscription} subscription \n* @param {*} data\n*/\nfunction callbackSubscriber(subscription, data) {\n    const id = subscription.id;\n    subscription.callback(data, { id: id, previousData: sentDataBySubsId[id] });\n    sentDataBySubsId[id] = copy(data);\n}\n\n/**\n* @param {Publishable[]} topics\n* @param {Subscription} subscription \n*/\nfunction checkAndNotifyBatch(topics, subscription) {\n    const publishData = publishableToObject(topics);\n    const matchingTopics = intersection(Object.keys(publishData), subscription.topics);\n    if (!matchingTopics.length) {\n        return;\n    }\n\n    const relevantDataFromPublish = matchingTopics.reduce((accum, topic)=> {\n        accum[topic] = publishData[topic];\n        return accum;\n    }, {});\n    const cachedDataForSubs = cacheBySubsId[subscription.id] || {};\n    const knownDataForSubs = $.extend({}, cachedDataForSubs, relevantDataFromPublish);//jQ Deep clone here will also concat arrays.\n\n    if (subscription.cache) {\n        cacheBySubsId[subscription.id] = knownDataForSubs;\n    }\n    const hasDataForAllTopics = intersection(Object.keys(knownDataForSubs), subscription.topics).length === subscription.topics.length;\n    if (hasDataForAllTopics) {\n        callbackSubscriber(subscription, knownDataForSubs);\n    }\n}\n\n\n/**\n * @param {Publishable[]} topics\n * @param {Subscription} subscription \n */\nfunction checkAndNotify(topics, subscription) {\n    topics.forEach(function (topic) {\n        const needsThisTopic = subscription.topics.indexOf(topic.name) !== -1;\n        const isWildCard = subscription.topics.indexOf('*') !== -1;\n        if (needsThisTopic || isWildCard) {\n            callbackSubscriber(subscription, { [topic.name]: topic.value });\n        }\n    });\n}\n\n/**\n* @param {Subscription[]} subcriptionList\n* @returns {Array<string>}\n*/\nfunction getTopicsFromSubsList(subcriptionList) {\n    return subcriptionList.reduce(function (accum, subs) {\n        accum = accum.concat(subs.topics);\n        return accum;\n    }, []);\n}\n\n/**\n * @class ChannelManager\n */\nclass ChannelManager {\n    constructor(options) {\n        this.subscriptions = [];\n    }\n\n    /**\n     * @param {string|Publishable} topic\n     * @param {any} [value] item to publish\n     * @param {PublishOptions} [options]\n     * @returns {Promise}\n     */\n    publish(topic, value, options) {\n        const normalized = normalizeParamOptions(topic, value, options);\n        let prom = $.Deferred().resolve(normalized.params).promise();\n        prom = prom.then((publishResponses)=> {\n            this.notify(publishResponses, options);\n            return publishResponses;\n        });\n        return prom;\n    }\n\n    notify(topic, value, options) {\n        const normalized = normalizeParamOptions(topic, value, options);\n        // console.log('notify', normalized.params);\n        return this.subscriptions.forEach(function (subs) {\n            const fn = subs.batch ? checkAndNotifyBatch : checkAndNotify;\n            fn(normalized.params, subs);\n        });\n    }\n\n    /**\n     * @param {Array<string>|string} topics\n     * @param {Function} cb\n     * @param {Object} [options]\n     * @returns {string}\n     */\n    subscribe(topics, cb, options) {\n        const subs = makeSubs(topics, cb, options);\n        delete cacheBySubsId[subs.id]; //Just in case subsid is being reused\n        delete sentDataBySubsId[subs.id];\n        this.subscriptions = this.subscriptions.concat(subs);\n        return subs.id;\n    }\n        \n\n    /**\n     * @param {string} token\n     */\n    unsubscribe(token) {\n        const olderLength = this.subscriptions.length;\n        const remaining = this.subscriptions.filter(function (subs) {\n            return subs.id !== token;\n        });\n        if (remaining.length === olderLength) {\n            throw new Error('No subscription found for token ' + token);\n        }\n        delete cacheBySubsId[token];\n        delete sentDataBySubsId[token];\n        this.subscriptions = remaining;\n    }\n    unsubscribeAll() {\n        cacheBySubsId = {};\n        sentDataBySubsId = {};\n        this.subscriptions = [];\n    }\n\n    /**\n     * @returns {Array<string>}\n     */\n    getSubscribedTopics() {\n        const list = uniq(getTopicsFromSubsList(this.subscriptions));\n        return list;\n    }\n\n    /**\n     * @param {string} [topic] optional topic to filter by\n     * @returns {Subscription[]}\n     */\n    getSubscribers(topic) {\n        if (!topic) {\n            return this.subscriptions;\n        }\n        return this.subscriptions.filter(function (subs) {\n            return subs.topics.indexOf(topic) !== -1;\n        });\n    }\n}\n\nexport default ChannelManager;\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/channel-manager.js","module.exports = jQuery;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"jQuery\"\n// module id = 54\n// module chunks = 0","import _ from 'lodash';\n\n/**\n * @param {string} topic\n * @param {Handler[]} handlers\n * @param {any} [matchOptions] options to pass on to matcher\n * @returns {Handler | undefined}\n */\nexport function findBestHandler(topic, handlers, matchOptions) {\n    for (var i = 0; i < handlers.length; i++) {\n        var thishandler = handlers[i];\n        var match = thishandler.match(topic, matchOptions);\n        if (match !== false) {\n            return $.extend(true, {}, thishandler, { matched: match });\n        }\n    }\n    return undefined;\n}\n\n/**\n * [groupByHandlers description]\n * @param  {Array<string>} topics   List of topics to match. Format can be anything your handler.match function handles\n * @param  {Handler[]} handlers Handlers of type [{ match: func }]\n * @returns {HandlerWithTopics[]} The handler array with each item now having an additional 'data' attr added to it with the matching topics\n */\nexport function groupByHandlers(topics, handlers) {\n    handlers = handlers.map(function (h, index) {\n        h.key = index;\n        return h;\n    });\n    var topicMapping = ([].concat(topics)).reduce(function (accum, topic) {\n        var bestHandler = findBestHandler(topic, handlers);\n        if (bestHandler) {\n            //if handler matches different strings treat both as different handlers\n            var key = bestHandler.key + bestHandler.matched;\n            if (!accum[key]) {\n                bestHandler.data = [];\n                accum[key] = bestHandler;\n            }\n            accum[key].data.push(topic);\n        }\n        return accum;\n    }, {});\n    return _.values(topicMapping);\n}\n\n/**\n * Takes a `publish` dataset and groups it by handler maintaining the data sequence\n * @param  {Publishable[]} data     Of the form [{ name: 'X', }]\n * @param  {Handler[]} handlers Handlers of type [{ match: func }]\n * @returns {HandlerWithData[]} The handler array with each item now having an additional 'data' attr added to it with the publishable data\n */\nexport function groupSequentiallyByHandlers(data, handlers) {\n    handlers = handlers.map(function (h, index) {\n        h.key = index;\n        return h;\n    });\n    var grouped = data.reduce(function (accum, dataPt) {\n        var lastHandler = accum[accum.length - 1];\n        var bestHandler = findBestHandler(dataPt.name, handlers, true);\n        if (bestHandler) {\n            if (lastHandler && bestHandler.key === lastHandler.key) {\n                lastHandler.data.push(dataPt);\n            } else {\n                accum.push($.extend({}, bestHandler, { data: [dataPt] }));\n            }\n        } else {\n            accum.push({ data: [dataPt], matched: false });\n        }\n        return accum;\n    }, []);\n    return grouped;\n}\n\n\n/**\n * @param {any} response \n * @param {string[]} topics \n * @returns {Publishable[]}\n */\nexport function normalizeSubscribeResponse(response, topics) {\n    // @ts-ignore\n    if (response === undefined) {\n        return [];\n    }\n    const isAlreadyInPublishableFormat = Array.isArray(response) && (!response.length || response[0].name !== undefined);\n    if (isAlreadyInPublishableFormat) {\n        return response; \n    }\n    if (typeof response === 'object' && !Array.isArray(response)) {\n        return topics.reduce((accum, t)=> {\n            accum.push({ name: t, value: response[t] });\n            return accum; \n        }, []);\n    }\n    if (topics.length === 1) { //it's not in a publishable format, so someone just returned a string or something\n        const name = topics[0];\n        return [{ name: name, value: response }];\n    }\n    throw new Error('unrecognized subscribe response format');\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/channel-router/utils/handler-utils.js","/**\n * @param {Publishable[]} published \n * @param {boolean|Array<string>|{except: Array<string>}} [silentOptions]\n * @returns {Publishable[]} filtered list\n */\nexport default function silencable(published, silentOptions) {\n    if (silentOptions === true || !published) {\n        return [];\n    } else if (Array.isArray(silentOptions)) {\n        return published.filter((data)=> {\n            const found = silentOptions.indexOf(data.name) !== -1;\n            return !found;\n        });\n    } else if (silentOptions && silentOptions.except) {\n        return published.filter((data)=> {\n            const found = (silentOptions.except || []).indexOf(data.name) !== -1;\n            return found;\n        });\n    }\n    return published;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/channel-router/utils/silencable.js","import { isFunction } from 'lodash';\n\n/**\n * \n * @param {Publishable[]} publishable \n * @param {boolean|string[]|Function} readOnlyOptions \n * @returns {Publishable[]} filtered list\n */\nexport default function excludeReadOnly(publishable, readOnlyOptions) {\n    if (isFunction(readOnlyOptions)) {\n        readOnlyOptions = readOnlyOptions();\n    }\n    if (readOnlyOptions === true) {\n        console.error('Tried to publish to a readonly channel', publishable);\n        return [];\n    }  \n    if (Array.isArray(readOnlyOptions)) {\n        const split = publishable.reduce((accum, data)=> {\n            const isReadonly = readOnlyOptions.indexOf(data.name) !== -1;\n            if (isReadonly) {\n                accum.readOnly.push(data);\n            } else {\n                accum.remaining.push(data);\n            }\n            return accum;\n        }, { readOnly: [], remaining: [] });\n        \n        if (split.readOnly.length) {\n            console.warn('Ignoring readonly publishes', split.readOnly);\n        }\n        return split.remaining;\n    }\n    return publishable;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/channel-router/utils/exclude-read-only.js","export { default as JSONRouteHandler } from './json-route-handler';\nexport { default as EpicenterRouteHandler } from './epicenter-route-handlers';\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/index.js","import { toImplicitType } from 'utils/parse-utils';\n\nexport function match(topic) {\n    var parsed = toImplicitType(topic);\n    return typeof parsed !== 'string' ? '' : false;\n}\n\nexport default {\n    match: match,\n    name: 'JSON Route',\n    subscribeHandler: function (topics) {\n        const parsed = topics.map((t)=> {\n            return {\n                name: t,\n                value: toImplicitType(t)\n            };\n        });\n        return parsed;\n    }\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/json-route-handler/index.js","import DefaultRunRouteHandler from './default-run-route-handler';\nimport ScenarioRouteHandler from './scenario-route-handler';\nimport RunidRouteHandler from './runid-route-handler';\nimport WorldRouteHandler from './world-route-handler';\n\nimport MultiRunRouteHandler from './multi-run-route-handler';\n\n\nimport { withPrefix } from 'channels/channel-router/utils';\nimport { matchPrefix, matchDefaultPrefix, matchRegex } from 'channels/route-handlers/route-matchers';\n\nimport router from 'channels/channel-router';\n\nfunction getOptions(opts, key) {\n    var serviceOptions = $.extend(true, {}, opts.defaults, opts[key]);\n    var channelOptions = $.extend(true, {}, serviceOptions.channelOptions);\n    delete serviceOptions.channelOptions;\n\n    return { serviceOptions: serviceOptions, channelOptions: channelOptions };\n}\n\nvar SCENARIO_PREFIX = 'sm:';\nvar RUN_PREFIX = 'rm:';\nconst WORLD_PREFIX = 'world:';\n\nvar sampleRunidLength = '000001593dd81950d4ee4f3df14841769a0b'.length;\nvar runidRegex = '(?:.{' + sampleRunidLength + '})';\n\nexport default function EpicenterRouteHandler(config, notifier, channelManagerContext) {\n    var opts = $.extend(true, {}, config);\n\n    var runidHandlerOpts = getOptions(opts, 'runid');\n    var runidHandler = new RunidRouteHandler(runidHandlerOpts, notifier);\n    var multiRunHandler = new MultiRunRouteHandler(runidHandlerOpts, withPrefix(notifier, 'runs'), channelManagerContext);\n    // var userChannel = new UserRouter(getOptions(opts, 'runManager').run, withPrefix(notifier, 'user:'), channelManagerContext);\n    \n    /** @type {Handler[]} **/\n    var handlers = [\n        $.extend({}, runidHandler, { \n            name: 'customRun',\n            match: matchRegex(runidRegex),\n            options: runidHandlerOpts.channelOptions,\n        }), \n        $.extend({}, multiRunHandler, {\n            name: 'archiveRuns',\n            match: matchPrefix('runs:'),\n            options: runidHandlerOpts.channelOptions,\n        }),  \n        // $.extend({}, userChannel, {\n        //     name: 'User Channel',\n        //     match: matchPrefix('user:'),\n        // })\n    ];\n    var exposable = {};\n\n    var runManagerOpts = getOptions(opts, 'runManager');\n    if (opts.runManager || (!opts.scenarioManager && runManagerOpts.serviceOptions.run)) {\n        var rm;\n        const isMultiplayer = runManagerOpts.serviceOptions.strategy === 'multiplayer' || runManagerOpts.serviceOptions.isMultiplayer;\n        if (opts.scenarioManager) {\n            rm = new DefaultRunRouteHandler(runManagerOpts, withPrefix(notifier, RUN_PREFIX));\n            handlers.push($.extend({}, rm, { \n                name: 'run',\n                match: matchPrefix(RUN_PREFIX), //if both scenario manager and run manager are being used, require a prefix\n                options: runManagerOpts.channelOptions,\n            }));\n        } else if (isMultiplayer) {\n            //Ignore case where both scenario manager and multiplayer are being used\n            rm = new WorldRouteHandler(runManagerOpts, withPrefix(notifier, [WORLD_PREFIX, '']));\n            handlers.push($.extend({}, rm, { \n                name: 'World run',\n                match: matchDefaultPrefix(WORLD_PREFIX),\n                isDefault: true,\n                options: runManagerOpts.channelOptions,\n            }));\n        } else {\n            rm = new DefaultRunRouteHandler(runManagerOpts, withPrefix(notifier, [RUN_PREFIX, '']));\n            handlers.push($.extend({}, rm, { \n                name: 'run',\n                match: matchDefaultPrefix(RUN_PREFIX),\n                isDefault: true,\n                options: runManagerOpts.channelOptions,\n            }));\n        }\n\n        $.extend(exposable, rm.expose);\n    }\n\n    if (opts.scenarioManager) {\n        var scenarioManagerOpts = getOptions(opts, 'scenarioManager');\n        var sm = new ScenarioRouteHandler(scenarioManagerOpts, withPrefix(notifier, [SCENARIO_PREFIX, '']));\n        handlers.push($.extend({}, sm, { \n            name: 'scenario',\n            match: matchDefaultPrefix(SCENARIO_PREFIX),\n            options: scenarioManagerOpts.channelOptions,\n            isDefault: true,\n        }));\n\n        $.extend(exposable, sm.expose);\n    }\n\n    var epicenterRouter = router(handlers, notifier);\n    epicenterRouter.expose = exposable;\n    \n    return epicenterRouter;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/epicenter-route-handlers/index.js","import RunRouteHandler from '../run-route-handler';\n\nimport { withPrefix } from 'channels/channel-router/utils';\nimport router from 'channels/channel-router';\nimport { matchDefaultPrefix } from 'channels/route-handlers/route-matchers';\n\nconst { F } = window;\n\nconst RUN_PREFIX = 'current:';\n\nexport default function RunManagerRouteHandler(config, notifier) {\n    const defaults = {\n        serviceOptions: {},\n        channelOptions: {}\n    };\n    const opts = $.extend(true, {}, defaults, config);\n\n    const rmOptions = opts.serviceOptions;\n    const rm = new F.manager.RunManager(rmOptions);\n\n    const $creationPromise = rm.getRun().then((run)=> {\n        return rm.run;\n    });\n    const currentChannelOpts = $.extend(true, \n        { serviceOptions: $creationPromise, channelOptions: opts.channelOptions }, opts.defaults, opts.current);\n    const currentRunChannel = new RunRouteHandler(currentChannelOpts, withPrefix(notifier, [RUN_PREFIX, '']));\n\n    const runRouteHandler = $.extend(currentRunChannel, { \n        match: matchDefaultPrefix(RUN_PREFIX), //TODO: Just remove prefix?\n        name: 'Current Run',\n        isDefault: true,\n        options: currentChannelOpts.channelOptions,\n    });\n    const handlers = [\n        runRouteHandler\n    ];\n\n    const runMangerRouter = router(handlers);\n    runMangerRouter.expose = { runManager: rm };\n\n    return runMangerRouter;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/epicenter-route-handlers/default-run-route-handler/index.js","import { objectToPublishable, publishableToObject } from 'channels/channel-utils';\nimport { intersection } from 'lodash';\n\nexport default function RunMetaRouteHandler($runServicePromise, notifier) {\n\n    function mergeAndSend(runMeta, requestedTopics) {\n        var toSend = ([].concat(requestedTopics)).reduce(function (accum, meta) {\n            accum.push({ name: meta, value: runMeta[meta] });\n            return accum;\n        }, []);\n        return toSend;\n        // return notifier(toSend);\n    }\n    return {\n        subscribeHandler: function (topics, options) {\n            topics = [].concat(topics);\n            \n            return $runServicePromise.then(function (runService) {\n                var cachedValues = intersection(Object.keys(runService.runMeta || {}), topics);\n                if (options.autoFetch === false) {\n                    return $.Deferred().resolve({}).promise();\n                } else if (cachedValues.length === topics.length) {\n                    //FIXME: Add 'updated time' to meta, and fetch if that's < debounce interval -- use the custom debounce fn with the custom merge (debounce save as well?)\n                    //Make run service factory return patched run-service?\n                    return $.Deferred().resolve(mergeAndSend(runService.runMeta, topics)).promise();\n                } if (!runService.loadPromise) {\n                    runService.loadPromise = runService.load().then(function (data) {\n                        runService.runMeta = data;\n                        return data;\n                    });\n                } \n                return runService.loadPromise.then(function (data) {\n                    return mergeAndSend(data, topics);\n                });\n            });\n        },\n        publishHandler: function (topics, options) {\n            return $runServicePromise.then(function (runService) {\n                var toSave = publishableToObject(topics);\n                return runService.save(toSave).then(function (res) {\n                    runService.runMeta = $.extend({}, true, runService.runMeta, res);\n                    return objectToPublishable(res);\n                });\n            });\n        }\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/epicenter-route-handlers/run-route-handler/run-meta-route-handler.js","import { debounceAndMerge } from 'utils/general';\nimport { objectToPublishable, publishableToObject } from 'channels/channel-utils';\nimport { uniqueId, uniq, difference } from 'lodash';\nimport { retriableFetch } from './retriable-variable-fetch';\n// import { optimizedFetch } from './optimized-variables-fetch';\n\nfunction mergeVariables(accum, newval) {\n    if (!accum) {\n        accum = [];\n    }\n    const merged = uniq(accum.concat(newval)).filter((v)=> !!(v && v.trim()));\n    // console.log(merged, 'merged');\n    return merged;\n}\n\nexport default function RunVariablesRouteHandler($runServicePromise, notifier) {\n    const id = uniqueId('variable-route-handler');\n\n    function debouncedVariableQuery(runService, debounceInterval) {\n        if (!runService.debouncedFetchers) {\n            runService.debouncedFetchers = {};\n        }\n        if (!runService.debouncedFetchers[id]) {\n            runService.debouncedFetchers[id] = debounceAndMerge(function (variables) {\n                return retriableFetch(runService, variables);\n            }, debounceInterval, [mergeVariables]);\n        }\n        return runService.debouncedFetchers[id];\n    }\n\n    let knownTopics = [];\n    return { \n        /**\n         * @param {{exclude:? boolean}} options \n         * @returns {Promise}\n         */\n        fetch: function (options) {\n            const opts = $.extend({ exclude: [] }, options);\n            return $runServicePromise.then(function (runService) {\n                const variablesToFetch = difference([].concat(knownTopics), opts.exclude);\n                if (!variablesToFetch.length) {\n                    return [];\n                }\n                return retriableFetch(runService, [].concat(variablesToFetch)).then(objectToPublishable).then(notifier);\n            });\n        },\n\n        unsubscribeHandler: function (unsubscribedTopics, remainingTopics) {\n            knownTopics = knownTopics.filter((t)=> unsubscribedTopics.indexOf(t) === -1);\n        },\n        subscribeHandler: function (topics, options) {\n            // console.log('subscribe', JSON.stringify(topics));\n            const isAutoFetchEnabled = options.autoFetch;\n            const debounceInterval = options.debounce;\n\n            return $runServicePromise.then(function (runService) {\n                knownTopics = uniq(knownTopics.concat(topics));\n                if (!knownTopics.length) {\n                    return $.Deferred().resolve([]).promise();\n                } else if (!isAutoFetchEnabled) {\n                    return $.Deferred().resolve(topics).promise();\n                }\n                return debouncedVariableQuery(runService, debounceInterval)(topics).then((response)=> {\n                    const missingVariables = difference(topics, Object.keys(response));\n                    if (missingVariables.length) {\n                        return $.Deferred().reject({\n                            context: missingVariables,\n                            message: `Missing variables: ${missingVariables.join(',')}`\n                        }).promise();\n                    }\n                    return response;\n                });\n            });\n        },\n        /**\n         * \n         * @param {Publishable[]} variableData\n         */\n        notify: function (variableData) {\n            return $runServicePromise.then(function (runService) {\n                const variables = variableData.map((v)=> v.name);\n                //Need to fetch again because for Vensim, i'm notified about the Current value, while i need the value over time\n                return retriableFetch(runService, variables).then(objectToPublishable).then(notifier);\n            });\n        },\n        publishHandler: function (topics, options) {\n            return $runServicePromise.then(function (runService) {\n                const toSave = publishableToObject(topics);\n                return runService.variables().save(toSave).then(function (response) {\n                    const variables = Object.keys(toSave); \n                    //Get the latest from the server because what you think you saved may not be what was saved\n                    //bool -> 1, scalar to array for time-based models etc\n                    return retriableFetch(runService, variables).then(objectToPublishable);\n                });\n            });\n        }\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/epicenter-route-handlers/run-route-handler/run-variables-route-handler.js","//Opaquely handle missing variables\nexport function retriableFetch(runService, variables) {\n    if (!variables || !variables.length) {\n        return $.Deferred().resolve({}).promise();\n    }\n    return runService.variables().query(variables).catch((e)=> {\n        const response = e.responseJSON;\n        const info = response.information;\n        if (info.code !== 'VARIABLE_NOT_FOUND') {\n            throw e;\n        }\n        const goodVariables = variables.filter((vName)=> {\n            const baseName = vName.split('[')[0];\n            const isBad = info.context.names.indexOf(baseName) !== -1;\n            return !isBad;\n        });\n        return retriableFetch(runService, goodVariables);\n    });\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/epicenter-route-handlers/run-route-handler/retriable-variable-fetch.js","export default function RunOperationsRouteHandler($runServicePromise, notifier) {\n    return {\n        /**\n         * \n         * @param {Publishable[]} operationsResponse \n         */\n        notify: function (operationsResponse) {\n            return notifier([].concat(operationsResponse));\n        },\n\n        subscribeHandler: function () {\n            return []; //Cannot subscribe to operations\n        },\n        publishHandler: function (topics, options) {\n            return $runServicePromise.then(function (runService) {\n                const toSave = topics.map(function (topic) {\n                    return { name: topic.name, params: topic.value };\n                });\n                return runService.serial(toSave).then(function (result) {\n                    const toReturn = result.map(function (response, index) {\n                        return { name: topics[index].name, value: response.result };\n                    });\n                    return toReturn;\n                });\n            });\n        }\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/epicenter-route-handlers/run-route-handler/run-operations-route-hander.js","import RunRouteHandler from '../run-route-handler';\nimport { withPrefix } from 'channels/channel-router/utils';\nimport router from 'channels/channel-router';\nimport { matchPrefix, matchDefaultPrefix, } from 'channels/route-handlers/route-matchers';\n\n\nexport default function ScenarioManagerRouteHandler(config, notifier) {\n    var defaults = {\n        serviceOptions: {},\n        channelOptions: {},\n    };\n    var opts = $.extend(true, {}, defaults, config);\n\n    var sm = new window.F.manager.ScenarioManager(opts.serviceOptions);\n\n    var baselinePromise = sm.baseline.getRun().then(()=> sm.baseline.run);\n    var baselineOptions = $.extend(true, {\n        serviceOptions: baselinePromise,\n        channelOptions: {\n            meta: {\n                readOnly: true\n            },\n            variables: {\n                readOnly: true\n            }\n        }\n    }, opts.defaults, opts.baseline);\n    var currentRunPromise = sm.current.getRun().then(()=> sm.current.run);\n\n    var runOptions = $.extend(true, {\n        serviceOptions: currentRunPromise,\n    }, opts.defaults, opts.current);\n\n    var baselineHandler = new RunRouteHandler(baselineOptions, withPrefix(notifier, 'baseline:'));\n    var currentRunHandler = new RunRouteHandler(runOptions, withPrefix(notifier, ['current:', '']));\n    var handlers = [\n        $.extend(baselineHandler, {\n            name: 'baseline',\n            match: matchPrefix('baseline:'),\n            options: baselineOptions.channelOptions,\n        }),\n        $.extend(currentRunHandler, { \n            isDefault: true, \n            name: 'current',\n            match: matchDefaultPrefix('current:'),\n            options: runOptions.channelOptions,\n        }),\n\n    ];\n    \n    var scenarioManagerRouter = router(handlers, notifier);\n    scenarioManagerRouter.expose = { scenarioManager: sm };\n    return scenarioManagerRouter;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/epicenter-route-handlers/scenario-route-handler/index.js","import runChannelFactory from '../run-router-factory';\nimport { withPrefix, stripSuffixDelimiter } from 'channels/channel-router/utils';\n\nexport default function RunidRouteHandler(options, notifier) {\n    if (!options) options = {};\n\n    var opts = {};\n    opts.serviceOptions = options.serviceOptions && options.serviceOptions.run ? options.serviceOptions.run : {};\n    opts.channelOptions = options.channelOptions;\n\n    return {\n        subscribeHandler: function (topics, options, prefix) {\n            var runid = stripSuffixDelimiter(prefix);\n            //FIXME: Should i merge options here?\n            var channel = runChannelFactory(runid, opts, withPrefix(notifier, prefix));\n            return channel.subscribeHandler(topics, options, prefix);\n        },\n        publishHandler: function (topics, options, prefix) {\n            var runid = stripSuffixDelimiter(prefix);\n            var channel = runChannelFactory(runid, opts, withPrefix(notifier, prefix));\n            return channel.publishHandler(topics);\n        }\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/epicenter-route-handlers/runid-route-handler/index.js","import RunRouteHandler from './run-route-handler';\nvar knownRunIDServiceChannels = {};\n\nexport default function (runid, options, notifier) {\n    var runChannel = knownRunIDServiceChannels[runid];\n    if (!runChannel) {\n        var runOptions = $.extend(true, {}, options, { serviceOptions: { id: runid } });\n        runChannel = new RunRouteHandler(runOptions, notifier);\n        knownRunIDServiceChannels[runid] = runChannel;\n    }\n    return runChannel;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/epicenter-route-handlers/run-router-factory.js","import WorldUsersRouteHandler from './world-users-route-handler';\nimport WorldCurrentUserRouteHandler from './world-current-user-route-handler';\nimport ConsensusRouteHandler from './consensus-route-handler';\n\nimport { withPrefix } from 'channels/channel-router/utils';\nimport { matchPrefix, matchDefaultPrefix } from 'channels/route-handlers/route-matchers';\n\nimport RunRouteHandler from '../run-route-handler';\nimport router from 'channels/channel-router';\n\nconst { F } = window;\n\nconst RUN_PREFIX = 'run:';\nconst MULTI_USER_PREFIX = 'users:';\nconst USER_PREFIX = 'user:';\nconst CONSENSUS_PREFIX = 'consensus:';\n\n//TODO: Add custom worldid channel as well\nexport default function WorldRoutesHandler(config, notifier) {\n    const defaults = {\n        serviceOptions: {},\n        channelOptions: {}\n    };\n    const opts = $.extend(true, {}, defaults, config);\n\n    const rmOptions = opts.serviceOptions;\n    const rm = new F.manager.RunManager(rmOptions);\n    \n    let runPromise = null;\n    function getRun() {\n        if (!runPromise) {\n            runPromise = rm.getRun().then((run)=> {\n                if (!run.world) {\n                    console.error('No world found in run. Make sure you\\'re using EpicenterJS version > 2.7');\n                    throw new Error('Could not find world');\n                }\n                return run;\n            }, (err)=> {\n                console.error('Run manager get run error', err);\n                throw err;\n            });\n        }\n        return runPromise;\n    }\n    const $runPromise = getRun().then((run)=> {\n        const alreadyStubbedRunChannel = rm.run.channel; //FIXME: Explicitly pass instead of stubbing on a channel\n        if (alreadyStubbedRunChannel) {\n            return rm.run;\n        }\n        const channelManager = new F.manager.ChannelManager();\n        const worldChannel = channelManager.getWorldChannel(run.world);\n\n        worldChannel.subscribe(worldChannel.TOPICS.RUN_RESET, (run)=> {\n            rm.run.updateConfig({ filter: run.id });//Run handler is also listening on the run and will take care of notifying\n        }, this, { includeMine: false });\n        rm.run.channel = worldChannel;\n        return rm.run;\n    });\n\n    const currentRunHandlerOpts = $.extend(true, { serviceOptions: $runPromise, channelOptions: opts.channelOptions }, opts.defaults, opts.current);\n    const currentRunHandler = new RunRouteHandler(currentRunHandlerOpts, withPrefix(notifier, [RUN_PREFIX, '']));\n\n    const handlers = [];\n\n    const runRouteHandler = $.extend(currentRunHandler, { \n        match: matchDefaultPrefix(RUN_PREFIX),\n        name: 'World Run',\n        isDefault: true,\n        options: currentRunHandlerOpts.channelOptions,\n    });\n    handlers.unshift(runRouteHandler);\n\n    let $worldProm = null;\n    function getWorld() {\n        if (!$worldProm) {\n            $worldProm = getRun().then((run)=> {\n                return run.world;\n            });\n        }\n        return $worldProm;\n    }\n\n    const worldChannelMap = {};\n    const channelManager = new F.manager.ChannelManager();\n    function getChannelForWorld(worldid) {\n        if (!worldChannelMap[worldid]) {\n            worldChannelMap[worldid] = channelManager.getWorldChannel(worldid);\n        }\n        return worldChannelMap[worldid];\n    }\n\n    const am = new F.manager.AuthManager();\n    const handlerOptions = {\n        serviceOptions: {\n            getRun: getRun,\n            getWorld: getWorld,\n            getSession: ()=> am.getCurrentUserSessionInfo(),\n            getChannel: getChannelForWorld,\n        },\n        channelOptions: opts.channelOptions\n    };\n    \n    const usersRouteHandler = new WorldUsersRouteHandler(handlerOptions, withPrefix(notifier, MULTI_USER_PREFIX));\n    const usersHandler = $.extend(usersRouteHandler, { \n        match: matchPrefix(MULTI_USER_PREFIX),\n        name: 'world users',\n    });\n    handlers.unshift(usersHandler);\n    \n    const currentUserRouteHandler = new WorldCurrentUserRouteHandler(handlerOptions, withPrefix(notifier, USER_PREFIX));\n    const currentUserHandler = $.extend(currentUserRouteHandler, {\n        match: matchPrefix(USER_PREFIX),\n        name: 'world current user',\n    });\n    handlers.unshift(currentUserHandler);\n\n    const ConsensusManager = window.F.manager.ConsensusManager;\n    if (ConsensusManager) { //epijs < 2.80 did not have this\n        const consensusRouteHandler = new ConsensusRouteHandler(handlerOptions, withPrefix(notifier, CONSENSUS_PREFIX));\n        const consensusHandler = $.extend(consensusRouteHandler, {\n            match: matchPrefix(CONSENSUS_PREFIX),\n            name: 'consensus',\n        });\n        handlers.unshift(consensusHandler);\n    }\n\n    const worldRouteHandler = router(handlers);\n    worldRouteHandler.expose = { runManager: rm };\n\n    return worldRouteHandler;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/epicenter-route-handlers/world-route-handler/index.js","const F = window.F;\n\nexport default function WorldUsersRouteHandler(config, notifier) {\n    const options = $.extend(true, {\n        serviceOptions: {},\n        channelOptions: {},\n    }, config);\n\n    const { getWorld, getSession, getChannel } = options.serviceOptions;\n\n    const store = {\n        users: [],\n        mark: (userid, isOnline)=> {\n            store.users = store.users.map((u)=> {\n                if (u.userId === userid) {\n                    u.isOnline = isOnline;\n                }\n                return u;\n            });\n            return store.users;\n        }\n    };\n    \n    const parsedUsersPromise = getWorld().then((world)=> {\n        const session = getSession();\n        const parsed = world.users.map((u)=> {\n            u.name = u.lastName;\n            u.isMe = u.userId === session.userId;\n            u.isOnline = u.isMe; //Assume i'm the only online one by default\n            return u;\n        });\n        store.users = parsed;\n        return parsed;\n    });\n    \n    let presenceSubsId;\n    return { \n        unsubscribeHandler: function (knownTopics, remainingTopics) {\n            if (remainingTopics.length || !presenceSubsId) {\n                return;\n            }\n            getWorld().then((world)=> {\n                const worldChannel = getChannel(world.id);\n                worldChannel.unsubscribe(presenceSubsId);\n                presenceSubsId = null;\n            });\n\n        },\n        subscribeHandler: function (userids) {\n            if (!presenceSubsId) {\n                //TODO: Also listen to roles channel to update users\n                getWorld().then((world)=> {\n                    const worldChannel = getChannel(world.id);\n                    presenceSubsId = worldChannel.subscribe(worldChannel.TOPICS.PRESENCE, (user, meta)=> {\n                        const userid = user.id;\n                        store.mark(userid, user.isOnline);\n                        return notifier([{ name: '', value: store.users }]);\n                    }, { includeMine: false });\n                });\n            }\n            return parsedUsersPromise.then((users)=> {\n                return [{ name: '', value: users }];\n            });\n        },\n        publishHandler: function (topics, options) {\n            const ps = new F.service.Presence();\n            topics.forEach((topic)=> {\n                const split = topic.name.split(':');\n                if (split[1]) {\n                    if (split[1] === 'markOnline') {\n                        ps.markOnline(split[0]);\n                    } else if (split[1] === 'markOffline') {\n                        ps.markOffline(split[0]);\n                    }\n                }\n            });\n            return topics;\n        }\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/epicenter-route-handlers/world-route-handler/world-users-route-handler/index.js","export default function WorldCurrentUserRouteHandler(config, notifier) {\n    const options = $.extend(true, {\n        serviceOptions: {},\n        channelOptions: {},\n    }, config);\n\n    const { getWorld, getSession, getChannel } = options.serviceOptions;\n\n    \n    let subsid;\n\n    const store = $.extend(true, {\n        isMe: true,\n        isOnline: true,\n    }, getSession());\n\n    return { \n        unsubscribeHandler: function (unsubscribedTopics, remainingTopics) {\n            const stillNeedRoles = remainingTopics.indexOf('role') !== -1;\n            if (!stillNeedRoles && subsid) {\n                getWorld().then((world)=> {\n                    const worldChannel = getChannel(world.id);\n                    worldChannel.unsubscribe(subsid);\n                });\n                subsid = null;\n            }\n        },\n        subscribeHandler: function (userFields) {\n            return getWorld().then((world)=> {\n                const session = getSession();\n                const myUser = world.users.find((user)=> {\n                    return user.userId === session.userId;\n                });\n                $.extend(store, myUser);\n                \n                const toNotify = userFields.reduce((accum, field)=> {\n                    if (field === '') { //the entire user object\n                        accum.push({ name: field, value: store });\n                    } else if (store[field] !== undefined) {\n                        accum.push({ name: field, value: store[field] });\n                    }\n                    return accum;\n                }, []);\n                \n                const isSubscribingToRole = userFields.indexOf('role') !== -1;\n                if (isSubscribingToRole && !subsid) {\n                    const worldChannel = getChannel(world.id);\n                    subsid = worldChannel.subscribe(worldChannel.TOPICS.ROLES, (users, meta)=> {\n                        const myUser = users.find((u)=> {\n                            return u.userId === session.userId;\n                        });\n                        if (myUser && myUser.role !== store.role) {\n                            store.role = myUser.role;\n                            notifier([{ name: 'role', value: myUser.role }]);\n                        }\n                    });\n                }\n                return toNotify;\n            });\n        }\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/epicenter-route-handlers/world-route-handler/world-current-user-route-handler/index.js","import OperationsHandler from './consensus-operations-handler';\nimport StatusHandler from './consensus-status-handler';\nimport router from 'channels/channel-router';\nimport { matchPrefix } from 'channels/route-handlers/route-matchers';\nimport { withPrefix } from 'channels/channel-router/utils';\n\nconst ConsensusManager = window.F.manager.ConsensusManager;\n\nconst OPERATIONS_PREFIX = 'operations:';\n\nexport default function ConsensusRouteHandler(config, notifier) {\n    const options = $.extend(true, {\n        serviceOptions: {},\n        channelOptions: {},\n    }, config);\n\n    const { getWorld, getRun, getSession, getChannel } = options.serviceOptions;\n\n    const cm = new ConsensusManager();\n\n    let consensusProm = null;\n    function getConsensus(force) {\n        if (!consensusProm || force) {\n            consensusProm = getRun().then(()=> {\n                return cm.getCurrent(); //TODO: GetRun deletes the barrier if it overlaps with this call, so synchronize them\n            });\n        }\n        return consensusProm;\n    }\n\n    const handlerOptions = {\n        serviceOptions: {\n            getConsensus: getConsensus,\n            getSession: getSession\n        },\n        channelOptions: {}\n    };\n\n    const opnHandler = OperationsHandler(handlerOptions, withPrefix(notifier, OPERATIONS_PREFIX));\n    const statusHandler = StatusHandler(handlerOptions, notifier);\n\n    const handlers = [\n        $.extend({}, opnHandler, { \n            name: 'consensus operations',\n            match: matchPrefix(OPERATIONS_PREFIX),\n            options: handlerOptions.channelOptions.operations,\n        }),\n        $.extend({}, statusHandler, { \n            name: 'consensus status',\n            match: matchPrefix(''),\n            isDefault: true,\n            options: handlerOptions.channelOptions.status,\n        }),\n    ];\n\n    getWorld().then((world)=> {\n        const channel = getChannel(world.id);\n        channel.subscribe(channel.TOPICS.RUN_RESET, ()=> {\n            getConsensus(true).then((consensus)=> {\n                statusHandler.notify(consensus);\n            });\n        });\n        // FIXME: Filter by stage here\n        channel.subscribe(channel.TOPICS.CONSENSUS_UPDATE, (consensus)=> {\n            const isComplete = consensus.closed;\n            if (isComplete) {\n                getConsensus(true).then((consensus)=> {\n                    statusHandler.notify(consensus);\n                });\n            } else {\n                statusHandler.notify(consensus);\n            }\n        });\n    });\n\n    var consensusRouteHandler = router(handlers, notifier);\n    consensusRouteHandler.expose = { consensusManager: cm };\n    \n    return consensusRouteHandler;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/epicenter-route-handlers/world-route-handler/consensus-route-handler/index.js","import { makeConsensusService } from './consensus-utils';\n\nexport default function ConsensusOperationsHandler(config, notifier) {\n    const options = $.extend(true, {\n        serviceOptions: {},\n        channelOptions: {},\n    }, config);\n\n    const { getConsensus } = options.serviceOptions;\n\n    return {\n        subscribeHandler: function () {\n            return [];\n        },\n        publishHandler: function (topics, options) {\n            return getConsensus().then((consensus)=> {\n                const actions = topics.map(function (topic) {\n                    return { name: topic.name, arguments: topic.value };\n                });\n                const cs = makeConsensusService(consensus);\n                return cs.submitActions(actions).then(()=> {\n                    return topics;\n                });\n            });\n        }\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/epicenter-route-handlers/world-route-handler/consensus-route-handler/consensus-operations-handler.js","import { makeConsensusService } from './consensus-utils';\nimport { objectToPublishable } from 'channels/channel-utils';\nimport { pick } from 'lodash';\n\nexport default function ConsensusStatusHandler(config, notifier) {\n    const options = $.extend(true, {\n        serviceOptions: {},\n        channelOptions: {},\n    }, config);\n\n    const { getConsensus, getSession } = options.serviceOptions;\n\n    function normalizePlayers(rolePlayerMap) {\n        const session = getSession();\n        const normalized = Object.keys(rolePlayerMap).reduce((accum, role)=> {\n            const playersForRole = rolePlayerMap[role];\n            const playersWithRole = playersForRole.map((p)=> {\n                const player = p.user || p; //submitted puts user under an extra object because of course\n                return Object.assign({}, player, {\n                    role: role,\n                    userName: player.userName.split('/')[0], //API adds user/project because of course\n                    name: player.lastName,\n                    isMe: player.userName === session.userName, // so you can do :submitted:users | reject('isMe')\n                });\n            });\n            accum = accum.concat(playersWithRole);\n            return accum;\n        }, []);\n        return normalized;\n    }\n    function normalizeConsensus(consensus) {\n        const session = getSession();\n        const submitted = normalizePlayers(consensus.submitted);\n        const amWaiting = submitted.find((u)=> u.userName === session.userName);\n        const normalized = $.extend(true, {}, consensus, {\n            amWaiting: !!amWaiting,\n            submitted: submitted,\n            pending: normalizePlayers(consensus.pending),\n        });\n        return normalized;\n    }\n\n    return {\n        notify: function (consensus) {\n            const normalizedConsensus = normalizeConsensus(consensus);\n            notifier(objectToPublishable(normalizedConsensus));\n        },\n        subscribeHandler: function (topics) {\n            return getConsensus().then((consensus)=> {\n                const normalized = normalizeConsensus(consensus);\n                const dataForTopics = pick(normalized, topics);\n                return objectToPublishable(dataForTopics);\n            });\n        },\n        publishHandler: function (topics) {\n            return getConsensus().then((consensus)=> {\n                if (topics.length > 1 || topics[0].name !== 'close') {\n                    throw new TypeError('Can only publish `close` on consensus:status');\n                }\n                const cs = makeConsensusService(consensus);\n                return cs.forceClose().then(()=> topics);\n            });\n        }\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/epicenter-route-handlers/world-route-handler/consensus-route-handler/consensus-status-handler.js","import { debounceAndMerge } from 'utils/general';\nvar { F } = window;\n\nexport default function MultiRunRouteHandler(options, notifier, channelManagerContext) {\n    var runService = new F.service.Run(options.serviceOptions.run);\n\n    var topicParamMap = {};\n\n    function extractFiltersFromTopic(topicString) {\n        var filters = topicString.replace('(', '').replace(')', '');\n        var filterParam = filters.split(';').reduce((accum, filter)=> {\n            var [key, val] = filter.split('=');\n            if (val) {\n                val = true;\n            }\n            accum[key] = val;\n            return accum;\n        }, {});\n        return filterParam;\n    }\n\n    function fetch(topic, variables) {\n        var filters = extractFiltersFromTopic(topic);\n        return runService.query(filters, { include: variables }).then((runs)=> {\n            notifier([{ name: topic, value: runs }]);\n\n            // if (topicParamMap[topic]) {\n            //     Object.keys(topicParamMap[topic]).forEach((runid)=> {\n            //         channelManagerContext.unsubscribe(topicParamMap[topic][runid]);\n            //     });\n            // }\n\n            return runs;\n        });\n    }\n\n    return {\n        fetch: fetch,\n\n        unsubscribeHandler: function (unsubscribedTopics, remainingTopics) {\n            // knownTopics = remainingTopics;\n        },\n        subscribeHandler: function (topics, options) {\n            var topic = ([].concat(topics))[0];\n\n            var filters = extractFiltersFromTopic(topic);\n            var variables = options && options.include;\n\n            var debounceInterval = 300;\n            var debouncedFetch = debounceAndMerge(fetch, debounceInterval, [(accum, newval)=> newval]);\n            return fetch(topic, variables).then(function (runs) {\n                var subsMap = {};\n                //TODO: Provide this meta information to runs-factory so it doesn't trigger a fetch to get meta for each run\n                runs.forEach((run)=> {\n                    var subscriptions = Object.keys(filters).map((filter)=> run.id + ':meta:' + filter);\n                    var subsid = channelManagerContext.subscribe(subscriptions, function () {\n                        debouncedFetch(topic, variables);\n                    }, { batch: false, autoFetch: false, cache: false });\n                    subsMap[run.id] = subsid;\n                });\n\n                topicParamMap[topic] = subsMap;\n                return runs;\n            });\n        }\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/route-handlers/epicenter-route-handlers/multi-run-route-handler/index.js","export { default as interpolatable } from './interpolatable';\nexport { default as routable } from './routable';\n// export { default as withMiddleware } from './with-middleware';\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/channel-manager-enhancements/index.js","import subscribeInterpolator from './subscribe-interpolator';\nimport publishInterpolator from './publish-interpolator';\n\n/**\n * Decorates passed channel manager with interpolation functionality\n * @param  {ChannelManager} ChannelManager\n * @returns {ChannelManager}                wrapped channel manager\n */\nexport default function interpolatable(ChannelManager) {\n    var subsidMap = {};\n\n    /**\n     * @implements {ChannelManager}\n     */\n    return class InterpolatedChannelManager extends ChannelManager {\n        constructor(options) {\n            super(options);\n            //FIXME: Add on-error (from routable) here?\n            this.subscribe = subscribeInterpolator(this.subscribe.bind(this), (dependencySubsId, newDependentId)=> {\n                var existing = subsidMap[dependencySubsId];\n                if (existing) {\n                    this.unsubscribe(existing);\n                }\n                subsidMap[dependencySubsId] = newDependentId;\n            });\n\n            this.publish = publishInterpolator(this.publish.bind(this), (variables, cb)=> {\n                super.subscribe(variables, (response, meta)=> {\n                    this.unsubscribe(meta.id);\n                    cb(response);\n                }, { autoFetch: true, batch: true, onError: (e)=> {\n                    throw e;\n                } });\n            });\n        }\n        unsubscribe(token) {\n            var existing = subsidMap[token];\n            if (existing) {\n                super.unsubscribe(existing);\n            }\n            super.unsubscribe(token);\n            delete subsidMap[token];\n        }\n        unsubscribeAll() {\n            subsidMap = {};\n            super.unsubscribeAll();\n        }\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/channel-manager-enhancements/interpolatable/index.js","import { extractDependencies, interpolateWithValues } from './interpolatable-utils';\nimport { uniq, isEqual } from 'lodash';\n\n/**\n * @param {string[]} topics\n * @returns {string[]} interpolated\n */\nexport function getDependencies(topics) {\n    var deps = topics.reduce((accum, topic)=> {\n        var inner = extractDependencies(topic);\n        accum = accum.concat(inner);\n        return accum;\n    }, []);\n    return uniq(deps);\n}\n\n/**\n * @param {string[]} topics\n * @param {Object} data\n * @returns {string[]}\n */\nexport function interpolateWithDependencies(topics, data) {\n    return topics.map((topic)=> {\n        return interpolateWithValues(topic, data);\n    });\n}\n\n/**\n * @param  {string[]} originalTopics     \n * @param  {string[]} interpolatedTopics \n * @param  {Object} data               \n * @returns {Object}                    Interpolated\n */\nexport function mergeInterpolatedTopicsWithData(originalTopics, interpolatedTopics, data) {\n    return interpolatedTopics.reduce((accum, interpolatedTopic, index)=> {\n        var original = originalTopics[index];\n        var val = data[interpolatedTopic];\n        if (val !== undefined) {\n            accum[original] = data[interpolatedTopic];\n        }\n        return accum;\n    }, {});\n}\n\n/**\n * Takes a subscribe function and resolves any interpolated inputs\n * @param  {Function} subscribeFn        function to wrap\n * @param  {Function} onDependencyChange callback function when any dependencies change\n * @returns {Function}                    wrapped function\n */\nexport default function subscribeInterpolator(subscribeFn, onDependencyChange) {\n    return function interpolatedSubscribe(topics, cb, options) {\n        topics = [].concat(topics);\n        var dependencies = getDependencies(topics);\n        if (!dependencies.length) {\n            return subscribeFn(topics, cb, options);\n        }\n        var innerSubsId = subscribeFn(dependencies, function handleDependencyValueChange(data, dependenciesMeta) {\n            const isSameData = isEqual(data, dependenciesMeta.previousData);\n            if (isSameData) return;\n\n            var interpolatedTopics = interpolateWithDependencies(topics, data);\n            var outerSubsId = subscribeFn(interpolatedTopics, function handleInterpolatedValueChange(actualData, actualMeta) {\n                var toSendback = mergeInterpolatedTopicsWithData(topics, interpolatedTopics, actualData);\n\n                cb(toSendback, actualMeta);\n            }, options);\n\n            (onDependencyChange || $.noop)(dependenciesMeta.id, outerSubsId);\n            return outerSubsId;\n        }, $.extend(options, { autoFetch: true, batch: true }));\n\n        return innerSubsId;\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/channel-manager-enhancements/interpolatable/subscribe-interpolator.js","import { extractDependencies, interpolateWithValues } from './interpolatable-utils';\nimport { normalizeParamOptions } from 'channels/channel-utils';\n\nimport { uniq } from 'lodash';\n\n/**\n * @param {Publishable[]} publishInputs\n * @returns {string[]} dependencies for inputs\n */\nexport function getDependencies(publishInputs) {\n    var deps = publishInputs.reduce((accum, input)=> {\n        var inner = extractDependencies(input.name);\n        accum = accum.concat(inner);\n        return accum;\n    }, []);\n    return uniq(deps);\n}\n\n/**\n * @param {Publishable[]} publishInputs\n * @param {{string: any}} valuesToInterpolate\n * @returns {Publishable[]} inputs with resolved dependencies\n */\nexport function interpolateWithDependencies(publishInputs, valuesToInterpolate) {\n    return publishInputs.map((ip)=> {\n        return {\n            name: interpolateWithValues(ip.name, valuesToInterpolate),\n            value: ip.value,\n        };\n    });\n}\n\n/**\n * Publish function to wrap\n * @param  {Function} publishFunction\n * @param  {function(string[], function({string: any}):void):void} fetchFn         function to get interpolated values from\n * @returns {Function}                 wrapped function\n */\nexport default function publishInterpolator(publishFunction, fetchFn) {\n    return function interpolatedPublishfunction(topic, value, options) {\n        var normalizedPublishInputs = normalizeParamOptions(topic, value, options);\n        var dependencies = getDependencies(normalizedPublishInputs.params);\n        if (!dependencies.length) {\n            return publishFunction(topic, value, options);\n        }\n        \n        var prom = $.Deferred();\n        fetchFn(dependencies, function handleDependencyChange(resolvedDependencies) {\n            var interpolated = interpolateWithDependencies(normalizedPublishInputs.params, resolvedDependencies);\n            var newPublishProm = publishFunction(interpolated, normalizedPublishInputs.options);\n            newPublishProm.then(prom.resolve, prom.reject);\n        });\n        return prom.promise();\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/channel-manager-enhancements/interpolatable/publish-interpolator.js","import { normalizeParamOptions } from '../../channel-utils';\nimport { omit, difference, uniq } from 'lodash';\n\nfunction getTopicsFromSubsList(subcriptionList) {\n    const allTopics = subcriptionList.reduce(function (accum, subs) {\n        accum = accum.concat(subs.topics);\n        return accum;\n    }, []);\n    return uniq(allTopics);\n}\n\n/**\n * Decorates passed channel manager with middleware functionality\n * @param  {ChannelManager} BaseChannelManager\n * @param  {Object} router\n * @returns {ChannelManager} wrapped channel manager\n */\nexport default function withRouter(BaseChannelManager, router) {\n    /**\n     * @augments ChannelManager\n     */\n    return class ChannelWithRouter extends BaseChannelManager {\n        constructor(options) {\n            super(options);\n            const defaults = {\n                routes: []\n            };\n            const opts = $.extend(true, {}, defaults, options);\n            const optsToPassOn = omit(opts, Object.keys(defaults));\n\n            const rt = router(opts.routes, optsToPassOn, this.notify.bind(this));\n            Object.assign(this, rt.expose || {});\n            this.router = rt;\n        }\n\n        /**\n         * Allow intercepting and excluding topics from by subsequent middlewares\n         * @param  {string | string[]}   topics\n         * @param  {Function} cb\n         * @param  {Object}   options\n         * @returns {string}           subscription id\n         */\n        subscribe(topics, cb, options) {\n            const subsid = super.subscribe(topics, cb, options);\n            this.router.subscribeHandler([].concat(topics), options).then((topicsWithData)=> {\n                if (topicsWithData && topicsWithData.length) {\n                    this.notify([].concat(topicsWithData));\n                }\n            }, (err)=> {\n                this.unsubscribe(subsid);\n                if (options && options.onError) {\n                    options.onError(err);\n                }\n            });\n            return subsid;\n        }\n\n        /**\n         * Allow intercepting and handling/suppressing data to publish calls.\n         * @param {string | Publishable } topic\n         * @param {any} [value] item to publish\n         * @param {Object} [options]\n         * @returns {Promise}\n         */\n        publish(topic, value, options) {\n            const publishData = normalizeParamOptions(topic, value, options);\n            return this.router.publishHandler(publishData.params, publishData.options).then((published)=> {\n                return super.publish(published, publishData.options);\n            });\n        }\n        \n\n        /**\n         * Calls unsubscribe middleware *after* unsubscription with a list of recently unsubscribed topics\n         * @param  {string} token\n         * @returns {void}\n         */\n        unsubscribe(token) {\n            const originalTopics = getTopicsFromSubsList(this.subscriptions);\n            super.unsubscribe(token);\n            const remainingTopics = getTopicsFromSubsList(this.subscriptions);\n            const unsubscribedTopics = difference(originalTopics, remainingTopics);\n\n            this.router.unsubscribeHandler(unsubscribedTopics, remainingTopics);\n        }\n\n        /**\n         * Calls unsubscribe middleware after unsubscribeAll on the channel\n         * @returns {void}\n         */\n        unsubscribeAll() {\n            const originalTopics = getTopicsFromSubsList(this.subscriptions);\n            super.unsubscribeAll();\n\n            return this.router.unsubscribeHandler(originalTopics, []);\n        }\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/channel-manager-enhancements/routable/index.js"],"sourceRoot":""}