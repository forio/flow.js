!function(modules){function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.l=!0,module.exports}var installedModules={};__webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.i=function(value){return value},__webpack_require__.d=function(exports,name,getter){__webpack_require__.o(exports,name)||Object.defineProperty(exports,name,{configurable:!1,enumerable:!0,get:getter})},__webpack_require__.n=function(module){var getter=module&&module.__esModule?function(){return module.default}:function(){return module};return __webpack_require__.d(getter,"a",getter),getter},__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=9)}([function(module,exports,__webpack_require__){"use strict";module.exports=function(){var xOffset=0;var yOffset=0;var isDragged=!1;return{makeDraggable:function($element){$element.on("mousedown",function(evt){return evt.preventDefault(),xOffset=evt.clientX-$element.offset().left,yOffset=evt.clientY-$element.offset().top,isDragged=$element,!1}),$(window.document).on("mousemove",function(evt){if(isDragged===$element)return evt.stopPropagation(),$element.css({top:evt.clientY-yOffset,left:evt.clientX-xOffset}),!1}),$(window.document).on("mouseup",function(evt){isDragged=!1})}}}()},function(module,exports,__webpack_require__){"use strict";var panelManager={list:{},register:function(alias,handler){this.list[alias]=handler},getPanel:function(alias){return this.list[alias]}};var availablePanels={context:__webpack_require__(5),filter:__webpack_require__(8)};_.each(availablePanels,function(panel,alias){panelManager.register(alias,panel)}),module.exports=panelManager},function(module,exports){module.exports='<div class="f-panel f-code-inspector">\n    <h6> Click on one of the highlighted variables or operations to inspect. </h6>\n    <code>\n        <pre>\n\n        </pre>\n    </code>\n</div>\n'},function(module,exports){module.exports='<div class="f-legend-panel f-panel">\n    <h6> Outputs </h6>\n\n    <label class="f-output">\n        <input type="checkbox" checked />\n        <div class="f-bind">\n            <span class="f-type">Bind</span>\n            <span class="f-val">Variable Name</span>\n            <span class="f-conv">Converters</span>\n        </div>\n    </label>\n    <label class="f-output">\n        <input type="checkbox" checked />\n        <div class="f-loop">\n            <span class="f-type">Loop</span>\n            <span class="f-val">Variable Name</span>\n            <span class="f-conv">Converters</span>\n        </div>\n    </label>\n    <label class="f-output">\n        <input type="checkbox" checked />\n        <div class="f-custom">\n            <span class="f-type">Custom</span>\n            <span class="f-val">Variable Name</span>\n            <span class="f-conv">Converters</span>\n        </div>\n    </label>\n\n    <h6> Inputs </h6>\n    <label class="f-input">\n        <input type="checkbox" checked />\n        <div class="f-bind">\n            <span class="f-type">Bind</span>\n            <span class="f-val">Variable Name</span>\n            <span class="f-conv">Converters</span>\n        </div>\n    </label>\n\n    <label class="f-input">\n        <input type="checkbox" checked />\n        <div class="f-on">\n            <span class="f-type">Event</span>\n            <span class="f-val">Operation</span>\n        </div>\n    </label>\n</div>\n'},function(module,exports,__webpack_require__){"use strict";var JuliaExtractor=__webpack_require__(6);var PythonExtractor=__webpack_require__(7);var Extractor=function(modelName,modelContents){this.contents=modelContents.split(/\n/);var extension=modelName.split(".")[1];return"py"===extension?this.extractor=PythonExtractor:"jl"===extension&&(this.extractor=JuliaExtractor),this};Extractor.prototype.showContext=function(reference,isFunction){var pattern=isFunction?this.extractor.fn:this.extractor.variable;reference=reference.split(/[\[\.\(]/)[0];var startIndex=_.findIndex(this.contents,pattern.start(reference),this);var fromStart=this.contents.slice(startIndex+1);var endIndex=pattern.end(fromStart,this.contents[startIndex]);var offset=pattern.offset+1;return endIndex===-1&&(endIndex=this.contents.length,offset=0),this.contents.slice(startIndex,startIndex+endIndex+offset).join("\n")},module.exports=Extractor},function(module,exports,__webpack_require__){"use strict";var ContextExtractor=__webpack_require__(4);var utils=__webpack_require__(0);module.exports=function($container,configFunction){var template=__webpack_require__(2);var $html=$(template);if(!configFunction)return console.warn("You're using an older version of FlowJS which does not support viewing model context."),!1;var config=configFunction();var modelType=config.model.split(".")[1];if("vmf"===modelType)return console.info("Cannot view context for Vensim models."),!1;if("eqn"===modelType)return console.info("Cannot view context for SimLang models."),!1;var defaults={folderType:"model"};var opts=$.extend(!0,{},defaults,config);new window.F.service.File(opts).getContents(config.model,"model").then(function(response){var extractor=new ContextExtractor(config.model,response);$container.on("click",".f-bind, .f-loop, .f-on",function(evt){var $target=$(evt.target).is(".f-val")?$(evt.target):$(evt.target).parent().find(".f-val");var variableName=$target.text().trim();var isFunction=$target.parent().is(".f-on");var context=extractor.showContext(variableName,isFunction);$html.find("pre").html(context)}),$container.append($html)}).fail(function(){console.info("Could not get model file contents; this is only available if you're logged in as an admin or team-member.")}),utils.makeDraggable($html)}},function(module,exports,__webpack_require__){"use strict";module.exports={fn:{start:function(reference){var regExp=new RegExp("^[ \t]*?function\\s+"+reference);return function(val){return regExp.test(val)}},end:function(fromStart){return _.findIndex(fromStart,function(val,index){return val.match(/^end/)},this)},offset:1},variable:{start:function(reference){var regExp=new RegExp("^[ \t]*?(global\\s*)?"+reference+"\\s?=");return function(val){return regExp.test(val)}},end:function(fromStart){return _.findIndex(fromStart,function(val,index){return""===val.trim()||val.indexOf("=")!==-1},this)},offset:0}}},function(module,exports,__webpack_require__){"use strict";module.exports={fn:{start:function(reference){var regExp=new RegExp("^[ \t]*?def\\s+"+reference);return function(val){return regExp.test(val)}},end:function(fromStart,startValue){var leadingSpacesInStart=startValue.match(/^[ \t]*/)[0].length;var indexOfLastGoodLine=0;return _.every(fromStart,function(line,index){var leadingSpacesInLine=line.match(/^[ \t]*/)[0].length;if(""!==line.trim()){if(leadingSpacesInLine===leadingSpacesInStart)return!1;indexOfLastGoodLine=index}return!0}),indexOfLastGoodLine+1},offset:0},variable:{start:function(reference){var regExp=new RegExp("^"+reference+"\\s?=");return function(val){return regExp.test(val)}},end:function(fromStart){return _.findIndex(fromStart,function(val,index){return""===val.trim()||val.indexOf("=")!==-1},this)},offset:0}}},function(module,exports,__webpack_require__){"use strict";var utils=__webpack_require__(0);module.exports=function($container,evtName){var template=__webpack_require__(3);var $html=$(template);$container.append($html),$container.on("click",":checkbox",function(evt){evt.stopPropagation();var $target=$(evt.target);var type=$target.parent().attr("class").replace("f-","");var subType=$target.parent().children("[class^=f-]").attr("class").replace("f-","");$container.trigger(evtName,type+"-"+subType)}),utils.makeDraggable($html)}},function(module,exports,__webpack_require__){"use strict";var panelManager=__webpack_require__(1);var FlowInspector=function(root){function draw(el,elementTop,elementLeft,elementWidth,elementHeight,fillColor){var ctx=el.getContext("2d");ctx.fillStyle=fillColor,ctx.fillRect(elementLeft,elementTop,elementWidth,elementHeight)}function eraseCanvas(el,elementTop,elementLeft,elementWidth,elementHeight){var ctx=el.getContext("2d");var offset=0;ctx.clearRect(elementLeft-offset,elementTop-offset,elementWidth+2*offset,elementHeight+2*offset)}var overlayCanvas=function($canvas){var windowHeight=$(document).height();var windowWidth=$(document).width();$canvas.attr({width:windowWidth,height:windowHeight}),draw($canvas.get(0),0,0,windowWidth,windowHeight,"rgba(0,0,0,.4)")};var drawModalCanvas=function(){var $canvas=$('<canvas class="f-modal"></canvas>');return overlayCanvas($canvas),$(window).on("resize",function(){overlayCanvas($canvas)}),$(root).append($canvas),$canvas.get(0)};var getClassNames=function(elem,attr){var elemType=elem.nodeName.toLowerCase();var isInputElement=["input","a","button"].indexOf(elemType)!==-1;var classNames=[];return classNames.push(isInputElement?"f-input":"f-output"),0===attr.indexOf("on-")?classNames.push("f-on"):0===attr.indexOf("bind")?classNames.push("f-bind"):0===attr.indexOf("foreach")||0===attr.indexOf("repeat")?classNames.push("f-loop"):attr.indexOf("model")===-1&&classNames.push("f-custom"),classNames.join(" ")};$(function(){var canvas=drawModalCanvas();var $overlayContainer=$('<div class="f-item-containers"></div>');var elemCounter=0;$(":f").each(function(index,elem){elemCounter++;var $thisElemContainer=$('<div id="f-container-'+elemCounter+'"></div');var pos=$(elem).offset();$thisElemContainer.css({top:pos.top-25+"px",left:pos.left+"px"}),$(elem).children().length||eraseCanvas(canvas,pos.top,pos.left,$(elem).innerWidth(),$(elem).innerHeight(),elem),$(elem.attributes).each(function(index,nodeMap){var attr=nodeMap.nodeName;var wantedPrefix="data-f-";if(0===attr.indexOf(wantedPrefix)){attr=attr.replace(wantedPrefix,"");var displayAttrName=attr.replace("on-","");var chain=_.invoke(nodeMap.value.split("|"),"trim");var originalVal=chain.shift();var $type=$('<span class="f-type"></span>').text(displayAttrName);var $val=$('<span class="f-val"></span>').text(originalVal);var $newEl=$("<div> </div>").append($type).append($val);chain.forEach(function(val){var cname=0===attr.indexOf("on")?"f-val":"f-conv";var $conv=$('<span class="'+cname+'"></span').text(val);$newEl.append($conv)}),$newEl.addClass(getClassNames(elem,attr)),$thisElemContainer.append($newEl)}}),$overlayContainer.append($thisElemContainer)});var evtName="f-select:type";panelManager.getPanel("filter")($overlayContainer,evtName),$overlayContainer.on(evtName,function(evt,type){$(root).toggleClass("hide-f-"+type)}),panelManager.getPanel("context")($overlayContainer,window.Flow.channel.run.getCurrentConfig),$(root).prepend($overlayContainer)})};window.Flow.Inspector=FlowInspector,module.exports=FlowInspector}]);
//# sourceMappingURL=flow-inspector.min.js.map